-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 9


-- !query 0
select avg(cast(v as interval)) from VALUES ('1 seconds'), ('2 seconds'), (null) t(v) where v is null
-- !query 0 schema
struct<avg(CAST(v AS INTERVAL)):interval>
-- !query 0 output
NULL


-- !query 1
select avg(cast(v as interval)) from VALUES ('1 seconds'), ('2 seconds'), (null) t(v) where 1=0
-- !query 1 schema
struct<avg(CAST(v AS INTERVAL)):interval>
-- !query 1 output
NULL


-- !query 2
select avg(cast(v as interval)) from VALUES ('1 seconds'), ('2 seconds'), (null) t(v)
-- !query 2 schema
struct<avg(CAST(v AS INTERVAL)):interval>
-- !query 2 output
interval 1 seconds 500 milliseconds


-- !query 3
select avg(cast(v as interval)) from VALUES ('-1 seconds'), ('2 seconds'), (null) t(v)
-- !query 3 schema
struct<avg(CAST(v AS INTERVAL)):interval>
-- !query 3 output
interval 500 milliseconds


-- !query 4
select avg(cast(v as interval)) from VALUES ('-1 seconds'), ('-2 seconds'), (null) t(v)
-- !query 4 schema
struct<avg(CAST(v AS INTERVAL)):interval>
-- !query 4 output
interval -1 seconds -500 milliseconds


-- !query 5
select avg(cast(v as interval)) from VALUES ('-1 weeks'), ('2 seconds'), (null) t(v)
-- !query 5 schema
struct<avg(CAST(v AS INTERVAL)):interval>
-- !query 5 output
interval -3 days -11 hours -59 minutes -59 seconds


-- !query 6
select
 i,
 avg(cast(v as interval))
from VALUES (1, '-1 weeks'), (2, '2 seconds'), (3, null), (1, '5 days') t(i, v)
group by i
-- !query 6 schema
struct<i:int,avg(CAST(v AS INTERVAL)):interval>
-- !query 6 output
1	interval -1 days
2	interval 2 seconds
3	NULL


-- !query 7
select
 avg(cast(v as interval)) as sv
from VALUES (1, '-1 weeks'), (2, '2 seconds'), (3, null), (1, '5 days') t(i, v)
having sv is not null
-- !query 7 schema
struct<sv:interval>
-- !query 7 output
interval -15 hours -59 minutes -59 seconds -333 milliseconds -333 microseconds


-- !query 8
SELECT
 i,
 avg(cast(v as interval)) OVER (ORDER BY i ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
FROM VALUES(1,'1 seconds'),(1,'2 seconds'),(2,NULL),(2,NULL) t(i,v)
-- !query 8 schema
struct<i:int,avg(CAST(v AS INTERVAL)) OVER (ORDER BY i ASC NULLS FIRST ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING):interval>
-- !query 8 output
1	interval 1 seconds 500 milliseconds
1	interval 2 seconds
2	NULL
2	NULL
