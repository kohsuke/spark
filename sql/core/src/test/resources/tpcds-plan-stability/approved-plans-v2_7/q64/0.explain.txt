== Parsed Logical Plan ==
CTE [cs_ui, cross_sales]
:  :- 'SubqueryAlias cs_ui
:  :  +- 'UnresolvedHaving ('sum('cs_ext_list_price) > (2 * 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit))))
:  :     +- 'Aggregate ['cs_item_sk], ['cs_item_sk, 'sum('cs_ext_list_price) AS sale#1, 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit)) AS refund#2]
:  :        +- 'Filter (('cs_item_sk = 'cr_item_sk) AND ('cs_order_number = 'cr_order_number))
:  :           +- 'Join Inner
:  :              :- 'UnresolvedRelation [catalog_sales]
:  :              +- 'UnresolvedRelation [catalog_returns]
:  +- 'SubqueryAlias cross_sales
:     +- 'Aggregate ['i_product_name, 'i_item_sk, 's_store_name, 's_zip, 'ad1.ca_street_number, 'ad1.ca_street_name, 'ad1.ca_city, 'ad1.ca_zip, 'ad2.ca_street_number, 'ad2.ca_street_name, 'ad2.ca_city, 'ad2.ca_zip, 'd1.d_year, 'd2.d_year, 'd3.d_year], ['i_product_name AS product_name#3, 'i_item_sk AS item_sk#4, 's_store_name AS store_name#5, 's_zip AS store_zip#6, 'ad1.ca_street_number AS b_street_number#7, 'ad1.ca_street_name AS b_streen_name#8, 'ad1.ca_city AS b_city#9, 'ad1.ca_zip AS b_zip#10, 'ad2.ca_street_number AS c_street_number#11, 'ad2.ca_street_name AS c_street_name#12, 'ad2.ca_city AS c_city#13, 'ad2.ca_zip AS c_zip#14, 'd1.d_year AS syear#15, 'd2.d_year AS fsyear#16, 'd3.d_year AS s2year#17, 'count(1) AS cnt#18, 'sum('ss_wholesale_cost) AS s1#19, 'sum('ss_list_price) AS s2#20, 'sum('ss_coupon_amt) AS s3#21]
:        +- 'Filter (((((('ss_store_sk = 's_store_sk) AND ('ss_sold_date_sk = 'd1.d_date_sk)) AND ('ss_customer_sk = 'c_customer_sk)) AND ((('ss_cdemo_sk = 'cd1.cd_demo_sk) AND ('ss_hdemo_sk = 'hd1.hd_demo_sk)) AND ('ss_addr_sk = 'ad1.ca_address_sk))) AND (((('ss_item_sk = 'i_item_sk) AND ('ss_item_sk = 'sr_item_sk)) AND ('ss_ticket_number = 'sr_ticket_number)) AND (('ss_item_sk = 'cs_ui.cs_item_sk) AND ('c_current_cdemo_sk = 'cd2.cd_demo_sk)))) AND ((((('c_current_hdemo_sk = 'hd2.hd_demo_sk) AND ('c_current_addr_sk = 'ad2.ca_address_sk)) AND ('c_first_sales_date_sk = 'd2.d_date_sk)) AND ((('c_first_shipto_date_sk = 'd3.d_date_sk) AND ('ss_promo_sk = 'p_promo_sk)) AND ('hd1.hd_income_band_sk = 'ib1.ib_income_band_sk))) AND (((('hd2.hd_income_band_sk = 'ib2.ib_income_band_sk) AND NOT ('cd1.cd_marital_status = 'cd2.cd_marital_status)) AND 'i_color IN (purple,burlywood,indian,spring,floral,medium)) AND ((('i_current_price >= 64) AND ('i_current_price <= (64 + 10))) AND (('i_current_price >= (64 + 1)) AND ('i_current_price <= (64 + 15)))))))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'Join Inner
:              :  :  :- 'Join Inner
:              :  :  :  :- 'Join Inner
:              :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'UnresolvedRelation [store_sales]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store_returns]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [cs_ui]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d1
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d2
:              :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim]
:              :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d3
:              :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim]
:              :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store]
:              :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [customer]
:              :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd1
:              :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
:              :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd2
:              :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
:              :  :  :  :  :  :  :  +- 'UnresolvedRelation [promotion]
:              :  :  :  :  :  :  +- 'SubqueryAlias hd1
:              :  :  :  :  :  :     +- 'UnresolvedRelation [household_demographics]
:              :  :  :  :  :  +- 'SubqueryAlias hd2
:              :  :  :  :  :     +- 'UnresolvedRelation [household_demographics]
:              :  :  :  :  +- 'SubqueryAlias ad1
:              :  :  :  :     +- 'UnresolvedRelation [customer_address]
:              :  :  :  +- 'SubqueryAlias ad2
:              :  :  :     +- 'UnresolvedRelation [customer_address]
:              :  :  +- 'SubqueryAlias ib1
:              :  :     +- 'UnresolvedRelation [income_band]
:              :  +- 'SubqueryAlias ib2
:              :     +- 'UnresolvedRelation [income_band]
:              +- 'UnresolvedRelation [item]
+- 'Sort ['cs1.product_name ASC NULLS FIRST, 'cs1.store_name ASC NULLS FIRST, 'cs2.cnt ASC NULLS FIRST, 'cs1.s1 ASC NULLS FIRST, 'cs2.s1 ASC NULLS FIRST], true
   +- 'Project ['cs1.product_name, 'cs1.store_name, 'cs1.store_zip, 'cs1.b_street_number, 'cs1.b_streen_name, 'cs1.b_city, 'cs1.b_zip, 'cs1.c_street_number, 'cs1.c_street_name, 'cs1.c_city, 'cs1.c_zip, 'cs1.syear, 'cs1.cnt, 'cs1.s1, 'cs1.s2, 'cs1.s3, 'cs2.s1, 'cs2.s2, 'cs2.s3, 'cs2.syear, 'cs2.cnt]
      +- 'Filter (((('cs1.item_sk = 'cs2.item_sk) AND ('cs1.syear = 1999)) AND ('cs2.syear = (1999 + 1))) AND ((('cs2.cnt <= 'cs1.cnt) AND ('cs1.store_name = 'cs2.store_name)) AND ('cs1.store_zip = 'cs2.store_zip)))
         +- 'Join Inner
            :- 'SubqueryAlias cs1
            :  +- 'UnresolvedRelation [cross_sales]
            +- 'SubqueryAlias cs2
               +- 'UnresolvedRelation [cross_sales]

== Analyzed Logical Plan ==
product_name: string, store_name: string, store_zip: string, b_street_number: string, b_streen_name: string, b_city: string, b_zip: string, c_street_number: string, c_street_name: string, c_city: string, c_zip: string, syear: int, cnt: bigint, s1: decimal(17,2), s2: decimal(17,2), s3: decimal(17,2), s1: decimal(17,2), s2: decimal(17,2), s3: decimal(17,2), syear: int, cnt: bigint
Sort [product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST, s1#19 ASC NULLS FIRST, s1#23 ASC NULLS FIRST], true
+- Project [product_name#3, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#24, s1#19, s2#20, s3#21, s1#23, s2#25, s3#26, syear#27, cnt#22]
   +- Filter ((((item_sk#4 = item_sk#28) AND (syear#15 = 1999)) AND (syear#27 = (1999 + 1))) AND (((cnt#22 <= cnt#24) AND (store_name#5 = store_name#29)) AND (store_zip#6 = store_zip#30)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], [i_product_name#31 AS product_name#3, i_item_sk#32 AS item_sk#4, s_store_name#33 AS store_name#5, s_zip#34 AS store_zip#6, ca_street_number#35 AS b_street_number#7, ca_street_name#36 AS b_streen_name#8, ca_city#37 AS b_city#9, ca_zip#38 AS b_zip#10, ca_street_number#39 AS c_street_number#11, ca_street_name#40 AS c_street_name#12, ca_city#41 AS c_city#13, ca_zip#42 AS c_zip#14, d_year#43 AS syear#15, d_year#44 AS fsyear#16, d_year#45 AS s2year#17, count(1) AS cnt#24, sum(ss_wholesale_cost#46) AS s1#19, sum(ss_list_price#47) AS s2#20, sum(ss_coupon_amt#48) AS s3#21]
         :        +- Filter ((((((ss_store_sk#49 = s_store_sk#50) AND (ss_sold_date_sk#51 = d_date_sk#52)) AND (ss_customer_sk#53 = c_customer_sk#54)) AND (((ss_cdemo_sk#55 = cd_demo_sk#56) AND (ss_hdemo_sk#57 = hd_demo_sk#58)) AND (ss_addr_sk#59 = ca_address_sk#60))) AND ((((ss_item_sk#61 = i_item_sk#32) AND (cast(ss_item_sk#61 as bigint) = sr_item_sk#62)) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64)) AND ((ss_item_sk#61 = cs_item_sk#65) AND (c_current_cdemo_sk#66 = cd_demo_sk#67)))) AND (((((c_current_hdemo_sk#68 = hd_demo_sk#69) AND (c_current_addr_sk#70 = ca_address_sk#71)) AND (c_first_sales_date_sk#72 = d_date_sk#73)) AND (((c_first_shipto_date_sk#74 = d_date_sk#75) AND (ss_promo_sk#76 = p_promo_sk#77)) AND (hd_income_band_sk#78 = ib_income_band_sk#79))) AND ((((hd_income_band_sk#80 = ib_income_band_sk#81) AND NOT (cd_marital_status#82 = cd_marital_status#83)) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#85 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#85 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias spark_catalog.default.store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#65, sale#1, refund#2]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#115)#116 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, sum(cs_ext_list_price#115) AS sale#1, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#2, sum(cs_ext_list_price#115) AS sum(cs_ext_list_price#115)#116, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias spark_catalog.default.catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,cs_ext_wholesale_cost#146,cs_ext_list_price#115,cs_ext_tax#147,cs_coupon_amt#148,cs_ext_ship_cost#149,cs_net_paid#150,cs_net_paid_inc_tax#151,cs_net_paid_inc_ship#152,cs_net_paid_inc_ship_tax#153,cs_net_profit#154] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias spark_catalog.default.catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#155,cr_returned_time_sk#156,cr_item_sk#121,cr_refunded_customer_sk#157,cr_refunded_cdemo_sk#158,cr_refunded_hdemo_sk#159,cr_refunded_addr_sk#160,cr_returning_customer_sk#161,cr_returning_cdemo_sk#162,cr_returning_hdemo_sk#163,cr_returning_addr_sk#164,cr_call_center_sk#165,cr_catalog_page_sk#166,cr_ship_mode_sk#167,cr_warehouse_sk#168,cr_reason_sk#169,cr_order_number#123,cr_return_quantity#170,cr_return_amount#171,cr_return_tax#172,cr_return_amt_inc_tax#173,cr_fee#174,cr_return_ship_cost#175,cr_refunded_cash#117,cr_reversed_charge#118,cr_store_credit#119,cr_net_loss#176] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#52,d_date_id#177,d_date#178,d_month_seq#179,d_week_seq#180,d_quarter_seq#181,d_year#43,d_dow#182,d_moy#183,d_dom#184,d_qoy#185,d_fy_year#186,d_fy_quarter_seq#187,d_fy_week_seq#188,d_day_name#189,d_quarter_name#190,d_holiday#191,d_weekend#192,d_following_holiday#193,d_first_dom#194,d_last_dom#195,d_same_day_ly#196,d_same_day_lq#197,d_current_day#198,d_current_week#199,d_current_month#200,d_current_quarter#201,d_current_year#202] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#73,d_date_id#203,d_date#204,d_month_seq#205,d_week_seq#206,d_quarter_seq#207,d_year#44,d_dow#208,d_moy#209,d_dom#210,d_qoy#211,d_fy_year#212,d_fy_quarter_seq#213,d_fy_week_seq#214,d_day_name#215,d_quarter_name#216,d_holiday#217,d_weekend#218,d_following_holiday#219,d_first_dom#220,d_last_dom#221,d_same_day_ly#222,d_same_day_lq#223,d_current_day#224,d_current_week#225,d_current_month#226,d_current_quarter#227,d_current_year#228] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#75,d_date_id#229,d_date#230,d_month_seq#231,d_week_seq#232,d_quarter_seq#233,d_year#45,d_dow#234,d_moy#235,d_dom#236,d_qoy#237,d_fy_year#238,d_fy_quarter_seq#239,d_fy_week_seq#240,d_day_name#241,d_quarter_name#242,d_holiday#243,d_weekend#244,d_following_holiday#245,d_first_dom#246,d_last_dom#247,d_same_day_ly#248,d_same_day_lq#249,d_current_day#250,d_current_week#251,d_current_month#252,d_current_quarter#253,d_current_year#254] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#50,s_store_id#255,s_rec_start_date#256,s_rec_end_date#257,s_closed_date_sk#258,s_store_name#33,s_number_employees#259,s_floor_space#260,s_hours#261,s_manager#262,s_market_id#263,s_geography_class#264,s_market_desc#265,s_market_manager#266,s_division_id#267,s_division_name#268,s_company_id#269,s_company_name#270,s_street_number#271,s_street_name#272,s_street_type#273,s_suite_number#274,s_city#275,s_county#276,s_state#277,s_zip#34,s_country#278,s_gmt_offset#279,s_tax_percentage#280] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#54,c_customer_id#281,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#282,c_first_name#283,c_last_name#284,c_preferred_cust_flag#285,c_birth_day#286,c_birth_month#287,c_birth_year#288,c_birth_country#289,c_login#290,c_email_address#291,c_last_review_date#292] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#56,cd_gender#293,cd_marital_status#82,cd_education_status#294,cd_purchase_estimate#295,cd_credit_rating#296,cd_dep_count#297,cd_dep_employed_count#298,cd_dep_college_count#299] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#67,cd_gender#300,cd_marital_status#83,cd_education_status#301,cd_purchase_estimate#302,cd_credit_rating#303,cd_dep_count#304,cd_dep_employed_count#305,cd_dep_college_count#306] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#77,p_promo_id#307,p_start_date_sk#308,p_end_date_sk#309,p_item_sk#310,p_cost#311,p_response_target#312,p_promo_name#313,p_channel_dmail#314,p_channel_email#315,p_channel_catalog#316,p_channel_tv#317,p_channel_radio#318,p_channel_press#319,p_channel_event#320,p_channel_demo#321,p_channel_details#322,p_purpose#323,p_discount_active#324] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#325,hd_dep_count#326,hd_vehicle_count#327] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#69,hd_income_band_sk#80,hd_buy_potential#328,hd_dep_count#329,hd_vehicle_count#330] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#60,ca_address_id#331,ca_street_number#35,ca_street_name#36,ca_street_type#332,ca_suite_number#333,ca_city#37,ca_county#334,ca_state#335,ca_zip#38,ca_country#336,ca_gmt_offset#337,ca_location_type#338] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
         :              :  :  :        +- Relation[ca_address_sk#71,ca_address_id#339,ca_street_number#39,ca_street_name#40,ca_street_type#340,ca_suite_number#341,ca_city#41,ca_county#342,ca_state#343,ca_zip#42,ca_country#344,ca_gmt_offset#345,ca_location_type#346] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias spark_catalog.default.income_band
         :              :  :        +- Relation[ib_income_band_sk#79,ib_lower_bound#347,ib_upper_bound#348] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias spark_catalog.default.income_band
         :              :        +- Relation[ib_income_band_sk#81,ib_lower_bound#349,ib_upper_bound#350] parquet
         :              +- SubqueryAlias spark_catalog.default.item
         :                 +- Relation[i_item_sk#32,i_item_id#351,i_rec_start_date#352,i_rec_end_date#353,i_item_desc#354,i_current_price#85,i_wholesale_cost#355,i_brand_id#356,i_brand#357,i_class_id#358,i_class#359,i_category_id#360,i_category#361,i_manufact_id#362,i_manufact#363,i_size#364,i_formulation#365,i_color#84,i_units#366,i_container#367,i_manager_id#368,i_product_name#31] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, d_year#43, d_year#373, d_year#374], [i_product_name#31 AS product_name#375, i_item_sk#32 AS item_sk#28, s_store_name#33 AS store_name#29, s_zip#34 AS store_zip#30, ca_street_number#35 AS b_street_number#376, ca_street_name#36 AS b_streen_name#377, ca_city#37 AS b_city#378, ca_zip#38 AS b_zip#379, ca_street_number#369 AS c_street_number#380, ca_street_name#370 AS c_street_name#381, ca_city#371 AS c_city#382, ca_zip#372 AS c_zip#383, d_year#43 AS syear#27, d_year#373 AS fsyear#384, d_year#374 AS s2year#385, count(1) AS cnt#22, sum(ss_wholesale_cost#46) AS s1#23, sum(ss_list_price#47) AS s2#25, sum(ss_coupon_amt#48) AS s3#26]
                  +- Filter ((((((ss_store_sk#49 = s_store_sk#50) AND (ss_sold_date_sk#51 = d_date_sk#52)) AND (ss_customer_sk#53 = c_customer_sk#54)) AND (((ss_cdemo_sk#55 = cd_demo_sk#56) AND (ss_hdemo_sk#57 = hd_demo_sk#58)) AND (ss_addr_sk#59 = ca_address_sk#60))) AND ((((ss_item_sk#61 = i_item_sk#32) AND (cast(ss_item_sk#61 as bigint) = sr_item_sk#62)) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64)) AND ((ss_item_sk#61 = cs_item_sk#65) AND (c_current_cdemo_sk#66 = cd_demo_sk#386)))) AND (((((c_current_hdemo_sk#68 = hd_demo_sk#387) AND (c_current_addr_sk#70 = ca_address_sk#388)) AND (c_first_sales_date_sk#72 = d_date_sk#389)) AND (((c_first_shipto_date_sk#74 = d_date_sk#390) AND (ss_promo_sk#76 = p_promo_sk#77)) AND (hd_income_band_sk#78 = ib_income_band_sk#79))) AND ((((hd_income_band_sk#391 = ib_income_band_sk#392) AND NOT (cd_marital_status#82 = cd_marital_status#393)) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#85 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#85 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias spark_catalog.default.store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#65, sale#1, refund#2]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#115)#394 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#395 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, sum(cs_ext_list_price#115) AS sale#1, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#2, sum(cs_ext_list_price#115) AS sum(cs_ext_list_price#115)#394, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#395]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias spark_catalog.default.catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,cs_ext_wholesale_cost#146,cs_ext_list_price#115,cs_ext_tax#147,cs_coupon_amt#148,cs_ext_ship_cost#149,cs_net_paid#150,cs_net_paid_inc_tax#151,cs_net_paid_inc_ship#152,cs_net_paid_inc_ship_tax#153,cs_net_profit#154] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias spark_catalog.default.catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#155,cr_returned_time_sk#156,cr_item_sk#121,cr_refunded_customer_sk#157,cr_refunded_cdemo_sk#158,cr_refunded_hdemo_sk#159,cr_refunded_addr_sk#160,cr_returning_customer_sk#161,cr_returning_cdemo_sk#162,cr_returning_hdemo_sk#163,cr_returning_addr_sk#164,cr_call_center_sk#165,cr_catalog_page_sk#166,cr_ship_mode_sk#167,cr_warehouse_sk#168,cr_reason_sk#169,cr_order_number#123,cr_return_quantity#170,cr_return_amount#171,cr_return_tax#172,cr_return_amt_inc_tax#173,cr_fee#174,cr_return_ship_cost#175,cr_refunded_cash#117,cr_reversed_charge#118,cr_store_credit#119,cr_net_loss#176] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#52,d_date_id#177,d_date#178,d_month_seq#179,d_week_seq#180,d_quarter_seq#181,d_year#43,d_dow#182,d_moy#183,d_dom#184,d_qoy#185,d_fy_year#186,d_fy_quarter_seq#187,d_fy_week_seq#188,d_day_name#189,d_quarter_name#190,d_holiday#191,d_weekend#192,d_following_holiday#193,d_first_dom#194,d_last_dom#195,d_same_day_ly#196,d_same_day_lq#197,d_current_day#198,d_current_week#199,d_current_month#200,d_current_quarter#201,d_current_year#202] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#389,d_date_id#396,d_date#397,d_month_seq#398,d_week_seq#399,d_quarter_seq#400,d_year#373,d_dow#401,d_moy#402,d_dom#403,d_qoy#404,d_fy_year#405,d_fy_quarter_seq#406,d_fy_week_seq#407,d_day_name#408,d_quarter_name#409,d_holiday#410,d_weekend#411,d_following_holiday#412,d_first_dom#413,d_last_dom#414,d_same_day_ly#415,d_same_day_lq#416,d_current_day#417,d_current_week#418,d_current_month#419,d_current_quarter#420,d_current_year#421] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#390,d_date_id#422,d_date#423,d_month_seq#424,d_week_seq#425,d_quarter_seq#426,d_year#374,d_dow#427,d_moy#428,d_dom#429,d_qoy#430,d_fy_year#431,d_fy_quarter_seq#432,d_fy_week_seq#433,d_day_name#434,d_quarter_name#435,d_holiday#436,d_weekend#437,d_following_holiday#438,d_first_dom#439,d_last_dom#440,d_same_day_ly#441,d_same_day_lq#442,d_current_day#443,d_current_week#444,d_current_month#445,d_current_quarter#446,d_current_year#447] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#50,s_store_id#255,s_rec_start_date#256,s_rec_end_date#257,s_closed_date_sk#258,s_store_name#33,s_number_employees#259,s_floor_space#260,s_hours#261,s_manager#262,s_market_id#263,s_geography_class#264,s_market_desc#265,s_market_manager#266,s_division_id#267,s_division_name#268,s_company_id#269,s_company_name#270,s_street_number#271,s_street_name#272,s_street_type#273,s_suite_number#274,s_city#275,s_county#276,s_state#277,s_zip#34,s_country#278,s_gmt_offset#279,s_tax_percentage#280] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#54,c_customer_id#281,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#282,c_first_name#283,c_last_name#284,c_preferred_cust_flag#285,c_birth_day#286,c_birth_month#287,c_birth_year#288,c_birth_country#289,c_login#290,c_email_address#291,c_last_review_date#292] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#56,cd_gender#293,cd_marital_status#82,cd_education_status#294,cd_purchase_estimate#295,cd_credit_rating#296,cd_dep_count#297,cd_dep_employed_count#298,cd_dep_college_count#299] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#386,cd_gender#448,cd_marital_status#393,cd_education_status#449,cd_purchase_estimate#450,cd_credit_rating#451,cd_dep_count#452,cd_dep_employed_count#453,cd_dep_college_count#454] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#77,p_promo_id#307,p_start_date_sk#308,p_end_date_sk#309,p_item_sk#310,p_cost#311,p_response_target#312,p_promo_name#313,p_channel_dmail#314,p_channel_email#315,p_channel_catalog#316,p_channel_tv#317,p_channel_radio#318,p_channel_press#319,p_channel_event#320,p_channel_demo#321,p_channel_details#322,p_purpose#323,p_discount_active#324] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#325,hd_dep_count#326,hd_vehicle_count#327] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#387,hd_income_band_sk#391,hd_buy_potential#455,hd_dep_count#456,hd_vehicle_count#457] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
                        :  :  :  :        +- Relation[ca_address_sk#60,ca_address_id#331,ca_street_number#35,ca_street_name#36,ca_street_type#332,ca_suite_number#333,ca_city#37,ca_county#334,ca_state#335,ca_zip#38,ca_country#336,ca_gmt_offset#337,ca_location_type#338] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
                        :  :  :        +- Relation[ca_address_sk#388,ca_address_id#458,ca_street_number#369,ca_street_name#370,ca_street_type#459,ca_suite_number#460,ca_city#371,ca_county#461,ca_state#462,ca_zip#372,ca_country#463,ca_gmt_offset#464,ca_location_type#465] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias spark_catalog.default.income_band
                        :  :        +- Relation[ib_income_band_sk#79,ib_lower_bound#347,ib_upper_bound#348] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias spark_catalog.default.income_band
                        :        +- Relation[ib_income_band_sk#392,ib_lower_bound#466,ib_upper_bound#467] parquet
                        +- SubqueryAlias spark_catalog.default.item
                           +- Relation[i_item_sk#32,i_item_id#351,i_rec_start_date#352,i_rec_end_date#353,i_item_desc#354,i_current_price#85,i_wholesale_cost#355,i_brand_id#356,i_brand#357,i_class_id#358,i_class#359,i_category_id#360,i_category#361,i_manufact_id#362,i_manufact#363,i_size#364,i_formulation#365,i_color#84,i_units#366,i_container#367,i_manager_id#368,i_product_name#31] parquet

== Optimized Logical Plan ==
Sort [product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST, s1#19 ASC NULLS FIRST, s1#23 ASC NULLS FIRST], true
+- Project [product_name#3, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#24, s1#19, s2#20, s3#21, s1#23, s2#25, s3#26, syear#27, cnt#22]
   +- Join Inner, ((((item_sk#4 = item_sk#28) AND (cnt#22 <= cnt#24)) AND (store_name#5 = store_name#29)) AND (store_zip#6 = store_zip#30))
      :- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], [i_product_name#31 AS product_name#3, i_item_sk#32 AS item_sk#4, s_store_name#33 AS store_name#5, s_zip#34 AS store_zip#6, ca_street_number#35 AS b_street_number#7, ca_street_name#36 AS b_streen_name#8, ca_city#37 AS b_city#9, ca_zip#38 AS b_zip#10, ca_street_number#39 AS c_street_number#11, ca_street_name#40 AS c_street_name#12, ca_city#41 AS c_city#13, ca_zip#42 AS c_zip#14, d_year#43 AS syear#15, count(1) AS cnt#24, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#46)),17,2) AS s1#19, MakeDecimal(sum(UnscaledValue(ss_list_price#47)),17,2) AS s2#20, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#48)),17,2) AS s3#21]
      :  +- Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#44, d_year#45, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, i_item_sk#32, i_product_name#31]
      :     +- Join Inner, (ss_item_sk#61 = i_item_sk#32)
      :        :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :  +- Join Inner, (hd_income_band_sk#80 = ib_income_band_sk#81)
      :        :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :     :  +- Join Inner, (hd_income_band_sk#78 = ib_income_band_sk#79)
      :        :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :     :     :  +- Join Inner, (c_current_addr_sk#70 = ca_address_sk#71)
      :        :     :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
      :        :     :     :     :  +- Join Inner, (ss_addr_sk#59 = ca_address_sk#60)
      :        :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80]
      :        :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#68 = hd_demo_sk#69)
      :        :     :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78]
      :        :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#57 = hd_demo_sk#58)
      :        :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
      :        :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#76 = p_promo_sk#77)
      :        :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
      :        :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#66 = cd_demo_sk#67) AND NOT (cd_marital_status#82 = cd_marital_status#83))
      :        :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, cd_marital_status#82]
      :        :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#55 = cd_demo_sk#56)
      :        :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
      :        :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#74 = d_date_sk#75)
      :        :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#44]
      :        :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#72 = d_date_sk#73)
      :        :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
      :        :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#53 = c_customer_sk#54)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#49 = s_store_sk#50)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#51 = d_date_sk#52)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#61 = cs_item_sk#65)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((cast(ss_item_sk#61 as bigint) = sr_item_sk#62) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_ticket_number#63, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#62, sr_ticket_number#64]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#62) AND isnotnull(sr_ticket_number#64))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#65]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#115)#116) AND (cast(sum(cs_ext_list_price#115)#116 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120)), DecimalType(21,2), true)))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#115)),17,2) AS sum(cs_ext_list_price#115)#116, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#65, cs_ext_list_price#115, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#65, cs_order_number#122, cs_ext_list_price#115]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#65) AND isnotnull(cs_order_number#122))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,cs_ext_wholesale_cost#146,cs_ext_list_price#115,cs_ext_tax#147,cs_coupon_amt#148,cs_ext_ship_cost#149,cs_net_paid#150,cs_net_paid_inc_tax#151,cs_net_paid_inc_ship#152,cs_net_paid_inc_ship_tax#153,cs_net_profit#154] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#121, cr_order_number#123, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#121) AND isnotnull(cr_order_number#123))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#155,cr_returned_time_sk#156,cr_item_sk#121,cr_refunded_customer_sk#157,cr_refunded_cdemo_sk#158,cr_refunded_hdemo_sk#159,cr_refunded_addr_sk#160,cr_returning_customer_sk#161,cr_returning_cdemo_sk#162,cr_returning_hdemo_sk#163,cr_returning_addr_sk#164,cr_call_center_sk#165,cr_catalog_page_sk#166,cr_ship_mode_sk#167,cr_warehouse_sk#168,cr_reason_sk#169,cr_order_number#123,cr_return_quantity#170,cr_return_amount#171,cr_return_tax#172,cr_return_amt_inc_tax#173,cr_fee#174,cr_return_ship_cost#175,cr_refunded_cash#117,cr_reversed_charge#118,cr_store_credit#119,cr_net_loss#176] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#52, d_year#43]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#43) AND (d_year#43 = 1999)) AND isnotnull(d_date_sk#52))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#52,d_date_id#177,d_date#178,d_month_seq#179,d_week_seq#180,d_quarter_seq#181,d_year#43,d_dow#182,d_moy#183,d_dom#184,d_qoy#185,d_fy_year#186,d_fy_quarter_seq#187,d_fy_week_seq#188,d_day_name#189,d_quarter_name#190,d_holiday#191,d_weekend#192,d_following_holiday#193,d_first_dom#194,d_last_dom#195,d_same_day_ly#196,d_same_day_lq#197,d_current_day#198,d_current_week#199,d_current_month#200,d_current_quarter#201,d_current_year#202] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#50, s_store_name#33, s_zip#34]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#50) AND isnotnull(s_zip#34)) AND isnotnull(s_store_name#33))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#50,s_store_id#255,s_rec_start_date#256,s_rec_end_date#257,s_closed_date_sk#258,s_store_name#33,s_number_employees#259,s_floor_space#260,s_hours#261,s_manager#262,s_market_id#263,s_geography_class#264,s_market_desc#265,s_market_manager#266,s_division_id#267,s_division_name#268,s_company_id#269,s_company_name#270,s_street_number#271,s_street_name#272,s_street_type#273,s_suite_number#274,s_city#275,s_county#276,s_state#277,s_zip#34,s_country#278,s_gmt_offset#279,s_tax_percentage#280] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#54, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
      :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#54) AND isnotnull(c_first_sales_date_sk#72)) AND isnotnull(c_first_shipto_date_sk#74)) AND isnotnull(c_current_cdemo_sk#66)) AND isnotnull(c_current_hdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
      :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#54,c_customer_id#281,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#282,c_first_name#283,c_last_name#284,c_preferred_cust_flag#285,c_birth_day#286,c_birth_month#287,c_birth_year#288,c_birth_country#289,c_login#290,c_email_address#291,c_last_review_date#292] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#73, d_year#44]
      :        :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#73)
      :        :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#73,d_date_id#203,d_date#204,d_month_seq#205,d_week_seq#206,d_quarter_seq#207,d_year#44,d_dow#208,d_moy#209,d_dom#210,d_qoy#211,d_fy_year#212,d_fy_quarter_seq#213,d_fy_week_seq#214,d_day_name#215,d_quarter_name#216,d_holiday#217,d_weekend#218,d_following_holiday#219,d_first_dom#220,d_last_dom#221,d_same_day_ly#222,d_same_day_lq#223,d_current_day#224,d_current_week#225,d_current_month#226,d_current_quarter#227,d_current_year#228] parquet
      :        :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#75, d_year#45]
      :        :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#75)
      :        :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#75,d_date_id#229,d_date#230,d_month_seq#231,d_week_seq#232,d_quarter_seq#233,d_year#45,d_dow#234,d_moy#235,d_dom#236,d_qoy#237,d_fy_year#238,d_fy_quarter_seq#239,d_fy_week_seq#240,d_day_name#241,d_quarter_name#242,d_holiday#243,d_weekend#244,d_following_holiday#245,d_first_dom#246,d_last_dom#247,d_same_day_ly#248,d_same_day_lq#249,d_current_day#250,d_current_week#251,d_current_month#252,d_current_quarter#253,d_current_year#254] parquet
      :        :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#56, cd_marital_status#82]
      :        :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#56) AND isnotnull(cd_marital_status#82))
      :        :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#56,cd_gender#293,cd_marital_status#82,cd_education_status#294,cd_purchase_estimate#295,cd_credit_rating#296,cd_dep_count#297,cd_dep_employed_count#298,cd_dep_college_count#299] parquet
      :        :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#67, cd_marital_status#83]
      :        :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#67) AND isnotnull(cd_marital_status#83))
      :        :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#67,cd_gender#300,cd_marital_status#83,cd_education_status#301,cd_purchase_estimate#302,cd_credit_rating#303,cd_dep_count#304,cd_dep_employed_count#305,cd_dep_college_count#306] parquet
      :        :     :     :     :     :     :     :     +- Project [p_promo_sk#77]
      :        :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#77)
      :        :     :     :     :     :     :     :           +- Relation[p_promo_sk#77,p_promo_id#307,p_start_date_sk#308,p_end_date_sk#309,p_item_sk#310,p_cost#311,p_response_target#312,p_promo_name#313,p_channel_dmail#314,p_channel_email#315,p_channel_catalog#316,p_channel_tv#317,p_channel_radio#318,p_channel_press#319,p_channel_event#320,p_channel_demo#321,p_channel_details#322,p_purpose#323,p_discount_active#324] parquet
      :        :     :     :     :     :     :     +- Project [hd_demo_sk#58, hd_income_band_sk#78]
      :        :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#58) AND isnotnull(hd_income_band_sk#78))
      :        :     :     :     :     :     :           +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#325,hd_dep_count#326,hd_vehicle_count#327] parquet
      :        :     :     :     :     :     +- Project [hd_demo_sk#69, hd_income_band_sk#80]
      :        :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#69) AND isnotnull(hd_income_band_sk#80))
      :        :     :     :     :     :           +- Relation[hd_demo_sk#69,hd_income_band_sk#80,hd_buy_potential#328,hd_dep_count#329,hd_vehicle_count#330] parquet
      :        :     :     :     :     +- Project [ca_address_sk#60, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
      :        :     :     :     :        +- Filter isnotnull(ca_address_sk#60)
      :        :     :     :     :           +- Relation[ca_address_sk#60,ca_address_id#331,ca_street_number#35,ca_street_name#36,ca_street_type#332,ca_suite_number#333,ca_city#37,ca_county#334,ca_state#335,ca_zip#38,ca_country#336,ca_gmt_offset#337,ca_location_type#338] parquet
      :        :     :     :     +- Project [ca_address_sk#71, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :     :     :        +- Filter isnotnull(ca_address_sk#71)
      :        :     :     :           +- Relation[ca_address_sk#71,ca_address_id#339,ca_street_number#39,ca_street_name#40,ca_street_type#340,ca_suite_number#341,ca_city#41,ca_county#342,ca_state#343,ca_zip#42,ca_country#344,ca_gmt_offset#345,ca_location_type#346] parquet
      :        :     :     +- Project [ib_income_band_sk#79]
      :        :     :        +- Filter isnotnull(ib_income_band_sk#79)
      :        :     :           +- Relation[ib_income_band_sk#79,ib_lower_bound#347,ib_upper_bound#348] parquet
      :        :     +- Project [ib_income_band_sk#81]
      :        :        +- Filter isnotnull(ib_income_band_sk#81)
      :        :           +- Relation[ib_income_band_sk#81,ib_lower_bound#349,ib_upper_bound#350] parquet
      :        +- Project [i_item_sk#32, i_product_name#31]
      :           +- Filter ((((((isnotnull(i_current_price#85) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#85 >= 64.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 74.00)) AND (cast(i_current_price#85 as decimal(12,2)) >= 65.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 79.00)) AND isnotnull(i_item_sk#32))
      :              +- Relation[i_item_sk#32,i_item_id#351,i_rec_start_date#352,i_rec_end_date#353,i_item_desc#354,i_current_price#85,i_wholesale_cost#355,i_brand_id#356,i_brand#357,i_class_id#358,i_class#359,i_category_id#360,i_category#361,i_manufact_id#362,i_manufact#363,i_size#364,i_formulation#365,i_color#84,i_units#366,i_container#367,i_manager_id#368,i_product_name#31] parquet
      +- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, d_year#43, d_year#373, d_year#374], [i_item_sk#32 AS item_sk#28, s_store_name#33 AS store_name#29, s_zip#34 AS store_zip#30, d_year#43 AS syear#27, count(1) AS cnt#22, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#46)),17,2) AS s1#23, MakeDecimal(sum(UnscaledValue(ss_list_price#47)),17,2) AS s2#25, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#48)),17,2) AS s3#26]
         +- Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#373, d_year#374, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, i_item_sk#32, i_product_name#31]
            +- Join Inner, (ss_item_sk#61 = i_item_sk#32)
               :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#373, d_year#374, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372]
               :  +- Join Inner, (hd_income_band_sk#391 = ib_income_band_sk#392)
               :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#373, d_year#374, hd_income_band_sk#391, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372]
               :     :  +- Join Inner, (hd_income_band_sk#78 = ib_income_band_sk#79)
               :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#373, d_year#374, hd_income_band_sk#78, hd_income_band_sk#391, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372]
               :     :     :  +- Join Inner, (c_current_addr_sk#70 = ca_address_sk#388)
               :     :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#373, d_year#374, hd_income_band_sk#78, hd_income_band_sk#391, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
               :     :     :     :  +- Join Inner, (ss_addr_sk#59 = ca_address_sk#60)
               :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#373, d_year#374, hd_income_band_sk#78, hd_income_band_sk#391]
               :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#68 = hd_demo_sk#387)
               :     :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374, hd_income_band_sk#78]
               :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#57 = hd_demo_sk#58)
               :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374]
               :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#76 = p_promo_sk#77)
               :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374]
               :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#66 = cd_demo_sk#386) AND NOT (cd_marital_status#82 = cd_marital_status#393))
               :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374, cd_marital_status#82]
               :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#55 = cd_demo_sk#56)
               :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374]
               :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#74 = d_date_sk#390)
               :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#373]
               :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#72 = d_date_sk#389)
               :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
               :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#53 = c_customer_sk#54)
               :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
               :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#49 = s_store_sk#50)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#51 = d_date_sk#52)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#61 = cs_item_sk#65)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((cast(ss_item_sk#61 as bigint) = sr_item_sk#62) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_ticket_number#63, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#62, sr_ticket_number#64]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#62) AND isnotnull(sr_ticket_number#64))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#65]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#115)#394) AND (cast(sum(cs_ext_list_price#115)#394 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#395)), DecimalType(21,2), true)))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#115)),17,2) AS sum(cs_ext_list_price#115)#394, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#395]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#65, cs_ext_list_price#115, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#65, cs_order_number#122, cs_ext_list_price#115]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#65) AND isnotnull(cs_order_number#122))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,cs_ext_wholesale_cost#146,cs_ext_list_price#115,cs_ext_tax#147,cs_coupon_amt#148,cs_ext_ship_cost#149,cs_net_paid#150,cs_net_paid_inc_tax#151,cs_net_paid_inc_ship#152,cs_net_paid_inc_ship_tax#153,cs_net_profit#154] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#121, cr_order_number#123, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#121) AND isnotnull(cr_order_number#123))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#155,cr_returned_time_sk#156,cr_item_sk#121,cr_refunded_customer_sk#157,cr_refunded_cdemo_sk#158,cr_refunded_hdemo_sk#159,cr_refunded_addr_sk#160,cr_returning_customer_sk#161,cr_returning_cdemo_sk#162,cr_returning_hdemo_sk#163,cr_returning_addr_sk#164,cr_call_center_sk#165,cr_catalog_page_sk#166,cr_ship_mode_sk#167,cr_warehouse_sk#168,cr_reason_sk#169,cr_order_number#123,cr_return_quantity#170,cr_return_amount#171,cr_return_tax#172,cr_return_amt_inc_tax#173,cr_fee#174,cr_return_ship_cost#175,cr_refunded_cash#117,cr_reversed_charge#118,cr_store_credit#119,cr_net_loss#176] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#52, d_year#43]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#43) AND (d_year#43 = 2000)) AND isnotnull(d_date_sk#52))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#52,d_date_id#177,d_date#178,d_month_seq#179,d_week_seq#180,d_quarter_seq#181,d_year#43,d_dow#182,d_moy#183,d_dom#184,d_qoy#185,d_fy_year#186,d_fy_quarter_seq#187,d_fy_week_seq#188,d_day_name#189,d_quarter_name#190,d_holiday#191,d_weekend#192,d_following_holiday#193,d_first_dom#194,d_last_dom#195,d_same_day_ly#196,d_same_day_lq#197,d_current_day#198,d_current_week#199,d_current_month#200,d_current_quarter#201,d_current_year#202] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#50, s_store_name#33, s_zip#34]
               :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#50) AND isnotnull(s_store_name#33)) AND isnotnull(s_zip#34))
               :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#50,s_store_id#255,s_rec_start_date#256,s_rec_end_date#257,s_closed_date_sk#258,s_store_name#33,s_number_employees#259,s_floor_space#260,s_hours#261,s_manager#262,s_market_id#263,s_geography_class#264,s_market_desc#265,s_market_manager#266,s_division_id#267,s_division_name#268,s_company_id#269,s_company_name#270,s_street_number#271,s_street_name#272,s_street_type#273,s_suite_number#274,s_city#275,s_county#276,s_state#277,s_zip#34,s_country#278,s_gmt_offset#279,s_tax_percentage#280] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#54, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
               :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#54) AND isnotnull(c_first_sales_date_sk#72)) AND isnotnull(c_first_shipto_date_sk#74)) AND isnotnull(c_current_cdemo_sk#66)) AND isnotnull(c_current_hdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
               :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#54,c_customer_id#281,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#282,c_first_name#283,c_last_name#284,c_preferred_cust_flag#285,c_birth_day#286,c_birth_month#287,c_birth_year#288,c_birth_country#289,c_login#290,c_email_address#291,c_last_review_date#292] parquet
               :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#389, d_year#373]
               :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#389)
               :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#389,d_date_id#396,d_date#397,d_month_seq#398,d_week_seq#399,d_quarter_seq#400,d_year#373,d_dow#401,d_moy#402,d_dom#403,d_qoy#404,d_fy_year#405,d_fy_quarter_seq#406,d_fy_week_seq#407,d_day_name#408,d_quarter_name#409,d_holiday#410,d_weekend#411,d_following_holiday#412,d_first_dom#413,d_last_dom#414,d_same_day_ly#415,d_same_day_lq#416,d_current_day#417,d_current_week#418,d_current_month#419,d_current_quarter#420,d_current_year#421] parquet
               :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#390, d_year#374]
               :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#390)
               :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#390,d_date_id#422,d_date#423,d_month_seq#424,d_week_seq#425,d_quarter_seq#426,d_year#374,d_dow#427,d_moy#428,d_dom#429,d_qoy#430,d_fy_year#431,d_fy_quarter_seq#432,d_fy_week_seq#433,d_day_name#434,d_quarter_name#435,d_holiday#436,d_weekend#437,d_following_holiday#438,d_first_dom#439,d_last_dom#440,d_same_day_ly#441,d_same_day_lq#442,d_current_day#443,d_current_week#444,d_current_month#445,d_current_quarter#446,d_current_year#447] parquet
               :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#56, cd_marital_status#82]
               :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#56) AND isnotnull(cd_marital_status#82))
               :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#56,cd_gender#293,cd_marital_status#82,cd_education_status#294,cd_purchase_estimate#295,cd_credit_rating#296,cd_dep_count#297,cd_dep_employed_count#298,cd_dep_college_count#299] parquet
               :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#386, cd_marital_status#393]
               :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_marital_status#393) AND isnotnull(cd_demo_sk#386))
               :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#386,cd_gender#448,cd_marital_status#393,cd_education_status#449,cd_purchase_estimate#450,cd_credit_rating#451,cd_dep_count#452,cd_dep_employed_count#453,cd_dep_college_count#454] parquet
               :     :     :     :     :     :     :     +- Project [p_promo_sk#77]
               :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#77)
               :     :     :     :     :     :     :           +- Relation[p_promo_sk#77,p_promo_id#307,p_start_date_sk#308,p_end_date_sk#309,p_item_sk#310,p_cost#311,p_response_target#312,p_promo_name#313,p_channel_dmail#314,p_channel_email#315,p_channel_catalog#316,p_channel_tv#317,p_channel_radio#318,p_channel_press#319,p_channel_event#320,p_channel_demo#321,p_channel_details#322,p_purpose#323,p_discount_active#324] parquet
               :     :     :     :     :     :     +- Project [hd_demo_sk#58, hd_income_band_sk#78]
               :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#58) AND isnotnull(hd_income_band_sk#78))
               :     :     :     :     :     :           +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#325,hd_dep_count#326,hd_vehicle_count#327] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#387, hd_income_band_sk#391]
               :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#387) AND isnotnull(hd_income_band_sk#391))
               :     :     :     :     :           +- Relation[hd_demo_sk#387,hd_income_band_sk#391,hd_buy_potential#455,hd_dep_count#456,hd_vehicle_count#457] parquet
               :     :     :     :     +- Project [ca_address_sk#60, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
               :     :     :     :        +- Filter isnotnull(ca_address_sk#60)
               :     :     :     :           +- Relation[ca_address_sk#60,ca_address_id#331,ca_street_number#35,ca_street_name#36,ca_street_type#332,ca_suite_number#333,ca_city#37,ca_county#334,ca_state#335,ca_zip#38,ca_country#336,ca_gmt_offset#337,ca_location_type#338] parquet
               :     :     :     +- Project [ca_address_sk#388, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372]
               :     :     :        +- Filter isnotnull(ca_address_sk#388)
               :     :     :           +- Relation[ca_address_sk#388,ca_address_id#458,ca_street_number#369,ca_street_name#370,ca_street_type#459,ca_suite_number#460,ca_city#371,ca_county#461,ca_state#462,ca_zip#372,ca_country#463,ca_gmt_offset#464,ca_location_type#465] parquet
               :     :     +- Project [ib_income_band_sk#79]
               :     :        +- Filter isnotnull(ib_income_band_sk#79)
               :     :           +- Relation[ib_income_band_sk#79,ib_lower_bound#347,ib_upper_bound#348] parquet
               :     +- Project [ib_income_band_sk#392]
               :        +- Filter isnotnull(ib_income_band_sk#392)
               :           +- Relation[ib_income_band_sk#392,ib_lower_bound#466,ib_upper_bound#467] parquet
               +- Project [i_item_sk#32, i_product_name#31]
                  +- Filter ((((((isnotnull(i_current_price#85) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#85 >= 64.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 74.00)) AND (cast(i_current_price#85 as decimal(12,2)) >= 65.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 79.00)) AND isnotnull(i_item_sk#32))
                     +- Relation[i_item_sk#32,i_item_id#351,i_rec_start_date#352,i_rec_end_date#353,i_item_desc#354,i_current_price#85,i_wholesale_cost#355,i_brand_id#356,i_brand#357,i_class_id#358,i_class#359,i_category_id#360,i_category#361,i_manufact_id#362,i_manufact#363,i_size#364,i_formulation#365,i_color#84,i_units#366,i_container#367,i_manager_id#368,i_product_name#31] parquet

== Physical Plan ==
*(43) Sort [product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST, s1#19 ASC NULLS FIRST, s1#23 ASC NULLS FIRST], true, 0
+- Exchange rangepartitioning(product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST, s1#19 ASC NULLS FIRST, s1#23 ASC NULLS FIRST, 5), true, [id=#468]
   +- *(42) Project [product_name#3, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#24, s1#19, s2#20, s3#21, s1#23, s2#25, s3#26, syear#27, cnt#22]
      +- *(42) BroadcastHashJoin [item_sk#4, store_name#5, store_zip#6], [item_sk#28, store_name#29, store_zip#30], Inner, BuildRight, (cnt#22 <= cnt#24)
         :- *(42) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#46)), sum(UnscaledValue(ss_list_price#47)), sum(UnscaledValue(ss_coupon_amt#48))], output=[product_name#3, item_sk#4, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#24, s1#19, s2#20, s3#21])
         :  +- Exchange hashpartitioning(i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45, 5), true, [id=#469]
         :     +- *(20) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#46)), partial_sum(UnscaledValue(ss_list_price#47)), partial_sum(UnscaledValue(ss_coupon_amt#48))], output=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45, count#470, sum#471, sum#472, sum#473])
         :        +- *(20) Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#44, d_year#45, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, i_item_sk#32, i_product_name#31]
         :           +- *(20) BroadcastHashJoin [ss_item_sk#61], [i_item_sk#32], Inner, BuildRight
         :              :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
         :              :  +- *(20) BroadcastHashJoin [hd_income_band_sk#80], [ib_income_band_sk#81], Inner, BuildRight
         :              :     :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
         :              :     :  +- *(20) BroadcastHashJoin [hd_income_band_sk#78], [ib_income_band_sk#79], Inner, BuildRight
         :              :     :     :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
         :              :     :     :  +- *(20) BroadcastHashJoin [c_current_addr_sk#70], [ca_address_sk#71], Inner, BuildRight
         :              :     :     :     :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
         :              :     :     :     :  +- *(20) BroadcastHashJoin [ss_addr_sk#59], [ca_address_sk#60], Inner, BuildRight
         :              :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80]
         :              :     :     :     :     :  +- *(20) BroadcastHashJoin [c_current_hdemo_sk#68], [hd_demo_sk#69], Inner, BuildRight
         :              :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78]
         :              :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_hdemo_sk#57], [hd_demo_sk#58], Inner, BuildRight
         :              :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
         :              :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_promo_sk#76], [p_promo_sk#77], Inner, BuildRight
         :              :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
         :              :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [c_current_cdemo_sk#66], [cd_demo_sk#67], Inner, BuildRight, NOT (cd_marital_status#82 = cd_marital_status#83)
         :              :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, cd_marital_status#82]
         :              :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_cdemo_sk#55], [cd_demo_sk#56], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
         :              :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [c_first_shipto_date_sk#74], [d_date_sk#75], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#44]
         :              :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [c_first_sales_date_sk#72], [d_date_sk#73], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
         :              :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_customer_sk#53], [c_customer_sk#54], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_store_sk#49], [s_store_sk#50], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_sold_date_sk#51], [d_date_sk#52], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_item_sk#61], [cs_item_sk#65], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [cast(ss_item_sk#61 as bigint), cast(ss_ticket_number#63 as bigint)], [sr_item_sk#62, sr_ticket_number#64], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_ticket_number#63, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- *(20) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- FileScan parquet default.store_sales[ss_sold_date_sk#51,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_wholesale_cost#46,ss_list_price#47,ss_coupon_amt#48] Batched: true, DataFilters: [isnotnull(ss_item_sk#61), isnotnull(ss_ticket_number#63), isnotnull(ss_sold_date_sk#51), i..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true], input[1, bigint, true])), [id=#474]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(1) Project [sr_item_sk#62, sr_ticket_number#64]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(1) Filter (isnotnull(sr_item_sk#62) AND isnotnull(sr_ticket_number#64))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(1) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet default.store_returns[sr_item_sk#62,sr_ticket_number#64] Batched: true, DataFilters: [isnotnull(sr_item_sk#62), isnotnull(sr_ticket_number#64)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:bigint,sr_ticket_number:bigint>
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#475]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(4) Project [cs_item_sk#65]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(4) Filter (isnotnull(sum(cs_ext_list_price#115)#116) AND (cast(sum(cs_ext_list_price#115)#116 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120)), DecimalType(21,2), true)))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(4) HashAggregate(keys=[cs_item_sk#65], functions=[sum(UnscaledValue(cs_ext_list_price#115)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#65, sum(cs_ext_list_price#115)#116, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120])
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Exchange hashpartitioning(cs_item_sk#65, 5), true, [id=#476]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- *(3) HashAggregate(keys=[cs_item_sk#65], functions=[partial_sum(UnscaledValue(cs_ext_list_price#115)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#65, sum#477, sum#478, isEmpty#479])
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- *(3) Project [cs_item_sk#65, cs_ext_list_price#115, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- *(3) BroadcastHashJoin [cs_item_sk#65, cs_order_number#122], [cr_item_sk#121, cr_order_number#123], Inner, BuildRight
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :- *(3) Project [cs_item_sk#65, cs_order_number#122, cs_ext_list_price#115]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :  +- *(3) Filter (isnotnull(cs_item_sk#65) AND isnotnull(cs_order_number#122))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :     +- *(3) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :        +- FileScan parquet default.catalog_sales[cs_item_sk#65,cs_order_number#122,cs_ext_list_price#115] Batched: true, DataFilters: [isnotnull(cs_item_sk#65), isnotnull(cs_order_number#122)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:decimal(7,2)>
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, true] as bigint), 32) | (cast(input[1, int, true] as bigint) & 4294967295)))), [id=#480]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- *(2) Project [cr_item_sk#121, cr_order_number#123, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- *(2) Filter (isnotnull(cr_item_sk#121) AND isnotnull(cr_order_number#123))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                      +- *(2) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                         +- FileScan parquet default.catalog_returns[cr_item_sk#121,cr_order_number#123,cr_refunded_cash#117,cr_reversed_charge#118,cr_store_credit#119] Batched: true, DataFilters: [isnotnull(cr_item_sk#121), isnotnull(cr_order_number#123)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:decimal(7,2),cr_reversed_charge:decima...
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#481]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(5) Project [d_date_sk#52, d_year#43]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(5) Filter ((isnotnull(d_year#43) AND (d_year#43 = 1999)) AND isnotnull(d_date_sk#52))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(5) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet default.date_dim[d_date_sk#52,d_year#43] Batched: true, DataFilters: [isnotnull(d_year#43), (d_year#43 = 1999), isnotnull(d_date_sk#52)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#482]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(6) Project [s_store_sk#50, s_store_name#33, s_zip#34]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(6) Filter ((isnotnull(s_store_sk#50) AND isnotnull(s_zip#34)) AND isnotnull(s_store_name#33))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(6) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet default.store[s_store_sk#50,s_store_name#33,s_zip#34] Batched: true, DataFilters: [isnotnull(s_store_sk#50), isnotnull(s_zip#34), isnotnull(s_store_name#33)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_zip), IsNotNull(s_store_name)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
         :              :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#483]
         :              :     :     :     :     :     :     :     :     :     :     :     :        +- *(7) Project [c_customer_sk#54, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
         :              :     :     :     :     :     :     :     :     :     :     :     :           +- *(7) Filter (((((isnotnull(c_customer_sk#54) AND isnotnull(c_first_sales_date_sk#72)) AND isnotnull(c_first_shipto_date_sk#74)) AND isnotnull(c_current_cdemo_sk#66)) AND isnotnull(c_current_hdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
         :              :     :     :     :     :     :     :     :     :     :     :     :              +- *(7) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet default.customer[c_customer_sk#54,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72] Batched: true, DataFilters: [isnotnull(c_customer_sk#54), isnotnull(c_first_sales_date_sk#72), isnotnull(c_first_shipto_d..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
         :              :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#484]
         :              :     :     :     :     :     :     :     :     :     :     :        +- *(8) Project [d_date_sk#73, d_year#44]
         :              :     :     :     :     :     :     :     :     :     :     :           +- *(8) Filter isnotnull(d_date_sk#73)
         :              :     :     :     :     :     :     :     :     :     :     :              +- *(8) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet default.date_dim[d_date_sk#73,d_year#44] Batched: true, DataFilters: [isnotnull(d_date_sk#73)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :              :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#75, d_year#45], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#484]
         :              :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#485]
         :              :     :     :     :     :     :     :     :     :        +- *(10) Project [cd_demo_sk#56, cd_marital_status#82]
         :              :     :     :     :     :     :     :     :     :           +- *(10) Filter (isnotnull(cd_demo_sk#56) AND isnotnull(cd_marital_status#82))
         :              :     :     :     :     :     :     :     :     :              +- *(10) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :                 +- FileScan parquet default.customer_demographics[cd_demo_sk#56,cd_marital_status#82] Batched: true, DataFilters: [isnotnull(cd_demo_sk#56), isnotnull(cd_marital_status#82)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
         :              :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#67, cd_marital_status#83], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#485]
         :              :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#486]
         :              :     :     :     :     :     :     :        +- *(12) Project [p_promo_sk#77]
         :              :     :     :     :     :     :     :           +- *(12) Filter isnotnull(p_promo_sk#77)
         :              :     :     :     :     :     :     :              +- *(12) ColumnarToRow
         :              :     :     :     :     :     :     :                 +- FileScan parquet default.promotion[p_promo_sk#77] Batched: true, DataFilters: [isnotnull(p_promo_sk#77)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
         :              :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#487]
         :              :     :     :     :     :     :        +- *(13) Project [hd_demo_sk#58, hd_income_band_sk#78]
         :              :     :     :     :     :     :           +- *(13) Filter (isnotnull(hd_demo_sk#58) AND isnotnull(hd_income_band_sk#78))
         :              :     :     :     :     :     :              +- *(13) ColumnarToRow
         :              :     :     :     :     :     :                 +- FileScan parquet default.household_demographics[hd_demo_sk#58,hd_income_band_sk#78] Batched: true, DataFilters: [isnotnull(hd_demo_sk#58), isnotnull(hd_income_band_sk#78)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
         :              :     :     :     :     :     +- ReusedExchange [hd_demo_sk#69, hd_income_band_sk#80], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#487]
         :              :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#488]
         :              :     :     :     :        +- *(15) Project [ca_address_sk#60, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
         :              :     :     :     :           +- *(15) Filter isnotnull(ca_address_sk#60)
         :              :     :     :     :              +- *(15) ColumnarToRow
         :              :     :     :     :                 +- FileScan parquet default.customer_address[ca_address_sk#60,ca_street_number#35,ca_street_name#36,ca_city#37,ca_zip#38] Batched: true, DataFilters: [isnotnull(ca_address_sk#60)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
         :              :     :     :     +- ReusedExchange [ca_address_sk#71, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#488]
         :              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#489]
         :              :     :        +- *(17) Project [ib_income_band_sk#79]
         :              :     :           +- *(17) Filter isnotnull(ib_income_band_sk#79)
         :              :     :              +- *(17) ColumnarToRow
         :              :     :                 +- FileScan parquet default.income_band[ib_income_band_sk#79] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#79)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
         :              :     +- ReusedExchange [ib_income_band_sk#81], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#489]
         :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#490]
         :                 +- *(19) Project [i_item_sk#32, i_product_name#31]
         :                    +- *(19) Filter ((((((isnotnull(i_current_price#85) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#85 >= 64.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 74.00)) AND (cast(i_current_price#85 as decimal(12,2)) >= 65.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 79.00)) AND isnotnull(i_item_sk#32))
         :                       +- *(19) ColumnarToRow
         :                          +- FileScan parquet default.item[i_item_sk#32,i_current_price#85,i_color#84,i_product_name#31] Batched: true, DataFilters: [isnotnull(i_current_price#85), i_color#84 IN (purple,burlywood,indian,spring,floral,medium),..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
         +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, int, true], input[1, string, true], input[2, string, true])), [id=#491]
            +- *(41) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, d_year#43, d_year#373, d_year#374], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#46)), sum(UnscaledValue(ss_list_price#47)), sum(UnscaledValue(ss_coupon_amt#48))], output=[item_sk#28, store_name#29, store_zip#30, syear#27, cnt#22, s1#23, s2#25, s3#26])
               +- Exchange hashpartitioning(i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, d_year#43, d_year#373, d_year#374, 5), true, [id=#492]
                  +- *(40) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, d_year#43, d_year#373, d_year#374], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#46)), partial_sum(UnscaledValue(ss_list_price#47)), partial_sum(UnscaledValue(ss_coupon_amt#48))], output=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, d_year#43, d_year#373, d_year#374, count#493, sum#494, sum#495, sum#496])
                     +- *(40) Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#373, d_year#374, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372, i_item_sk#32, i_product_name#31]
                        +- *(40) BroadcastHashJoin [ss_item_sk#61], [i_item_sk#32], Inner, BuildRight
                           :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#373, d_year#374, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372]
                           :  +- *(40) BroadcastHashJoin [hd_income_band_sk#391], [ib_income_band_sk#392], Inner, BuildRight
                           :     :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#373, d_year#374, hd_income_band_sk#391, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372]
                           :     :  +- *(40) BroadcastHashJoin [hd_income_band_sk#78], [ib_income_band_sk#79], Inner, BuildRight
                           :     :     :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#373, d_year#374, hd_income_band_sk#78, hd_income_band_sk#391, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372]
                           :     :     :  +- *(40) BroadcastHashJoin [c_current_addr_sk#70], [ca_address_sk#388], Inner, BuildRight
                           :     :     :     :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#373, d_year#374, hd_income_band_sk#78, hd_income_band_sk#391, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
                           :     :     :     :  +- *(40) BroadcastHashJoin [ss_addr_sk#59], [ca_address_sk#60], Inner, BuildRight
                           :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#373, d_year#374, hd_income_band_sk#78, hd_income_band_sk#391]
                           :     :     :     :     :  +- *(40) BroadcastHashJoin [c_current_hdemo_sk#68], [hd_demo_sk#387], Inner, BuildRight
                           :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374, hd_income_band_sk#78]
                           :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_hdemo_sk#57], [hd_demo_sk#58], Inner, BuildRight
                           :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374]
                           :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_promo_sk#76], [p_promo_sk#77], Inner, BuildRight
                           :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374]
                           :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [c_current_cdemo_sk#66], [cd_demo_sk#386], Inner, BuildRight, NOT (cd_marital_status#82 = cd_marital_status#393)
                           :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374, cd_marital_status#82]
                           :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_cdemo_sk#55], [cd_demo_sk#56], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#373, d_year#374]
                           :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [c_first_shipto_date_sk#74], [d_date_sk#390], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#373]
                           :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [c_first_sales_date_sk#72], [d_date_sk#389], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
                           :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_customer_sk#53], [c_customer_sk#54], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
                           :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_store_sk#49], [s_store_sk#50], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_sold_date_sk#51], [d_date_sk#52], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_item_sk#61], [cs_item_sk#65], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [cast(ss_item_sk#61 as bigint), cast(ss_ticket_number#63 as bigint)], [sr_item_sk#62, sr_ticket_number#64], Inner, BuildRight
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_ticket_number#63, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- *(40) ColumnarToRow
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- FileScan parquet default.store_sales[ss_sold_date_sk#51,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_wholesale_cost#46,ss_list_price#47,ss_coupon_amt#48] Batched: true, DataFilters: [isnotnull(ss_item_sk#61), isnotnull(ss_ticket_number#63), isnotnull(ss_sold_date_sk#51), i..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [sr_item_sk#62, sr_ticket_number#64], BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, true], input[1, bigint, true])), [id=#474]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [cs_item_sk#65], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#475]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#497]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(25) Project [d_date_sk#52, d_year#43]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(25) Filter ((isnotnull(d_year#43) AND (d_year#43 = 2000)) AND isnotnull(d_date_sk#52))
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(25) ColumnarToRow
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet default.date_dim[d_date_sk#52,d_year#43] Batched: true, DataFilters: [isnotnull(d_year#43), (d_year#43 = 2000), isnotnull(d_date_sk#52)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                           :     :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [s_store_sk#50, s_store_name#33, s_zip#34], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#482]
                           :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [c_customer_sk#54, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#483]
                           :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#389, d_year#373], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#484]
                           :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#390, d_year#374], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#484]
                           :     :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#56, cd_marital_status#82], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#485]
                           :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#386, cd_marital_status#393], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#485]
                           :     :     :     :     :     :     :     +- ReusedExchange [p_promo_sk#77], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#486]
                           :     :     :     :     :     :     +- ReusedExchange [hd_demo_sk#58, hd_income_band_sk#78], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#487]
                           :     :     :     :     :     +- ReusedExchange [hd_demo_sk#387, hd_income_band_sk#391], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#487]
                           :     :     :     :     +- ReusedExchange [ca_address_sk#60, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#488]
                           :     :     :     +- ReusedExchange [ca_address_sk#388, ca_street_number#369, ca_street_name#370, ca_city#371, ca_zip#372], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#488]
                           :     :     +- ReusedExchange [ib_income_band_sk#79], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#489]
                           :     +- ReusedExchange [ib_income_band_sk#392], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#489]
                           +- ReusedExchange [i_item_sk#32, i_product_name#31], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#490]
