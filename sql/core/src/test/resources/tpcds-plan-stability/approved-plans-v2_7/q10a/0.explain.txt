== Parsed Logical Plan ==
'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort ['cd_gender ASC NULLS FIRST, 'cd_marital_status ASC NULLS FIRST, 'cd_education_status ASC NULLS FIRST, 'cd_purchase_estimate ASC NULLS FIRST, 'cd_credit_rating ASC NULLS FIRST, 'cd_dep_count ASC NULLS FIRST, 'cd_dep_employed_count ASC NULLS FIRST, 'cd_dep_college_count ASC NULLS FIRST], true
      +- 'Aggregate ['cd_gender, 'cd_marital_status, 'cd_education_status, 'cd_purchase_estimate, 'cd_credit_rating, 'cd_dep_count, 'cd_dep_employed_count, 'cd_dep_college_count], ['cd_gender, 'cd_marital_status, 'cd_education_status, 'count(1) AS cnt1#1, 'cd_purchase_estimate, 'count(1) AS cnt2#2, 'cd_credit_rating, 'count(1) AS cnt3#3, 'cd_dep_count, 'count(1) AS cnt4#4, 'cd_dep_employed_count, 'count(1) AS cnt5#5, 'cd_dep_college_count, 'count(1) AS cnt6#6]
         +- 'Filter (((('c.c_current_addr_sk = 'ca.ca_address_sk) AND 'ca_county IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County)) AND ('cd_demo_sk = 'c.c_current_cdemo_sk)) AND (exists#7 [] AND exists#8 []))
            :  :- 'Project [*]
            :  :  +- 'Filter ((('c.c_customer_sk = 'ss_customer_sk) AND ('ss_sold_date_sk = 'd_date_sk)) AND (('d_year = 2002) AND (('d_moy >= 4) AND ('d_moy <= (4 + 3)))))
            :  :     +- 'Join Inner
            :  :        :- 'UnresolvedRelation [store_sales]
            :  :        +- 'UnresolvedRelation [date_dim]
            :  +- 'Project [*]
            :     +- 'Filter ('c.c_customer_sk = 'customer_sk)
            :        +- 'SubqueryAlias x
            :           +- 'Union
            :              :- 'Project ['ws_bill_customer_sk AS customer_sk#9, 'd_year, 'd_moy]
            :              :  +- 'Filter ((('ws_sold_date_sk = 'd_date_sk) AND ('d_year = 2002)) AND (('d_moy >= 4) AND ('d_moy <= (4 + 3))))
            :              :     +- 'Join Inner
            :              :        :- 'UnresolvedRelation [web_sales]
            :              :        +- 'UnresolvedRelation [date_dim]
            :              +- 'Project ['cs_ship_customer_sk AS customer_sk#10, 'd_year, 'd_moy]
            :                 +- 'Filter ((('cs_sold_date_sk = 'd_date_sk) AND ('d_year = 2002)) AND (('d_moy >= 4) AND ('d_moy <= (4 + 3))))
            :                    +- 'Join Inner
            :                       :- 'UnresolvedRelation [catalog_sales]
            :                       +- 'UnresolvedRelation [date_dim]
            +- 'Join Inner
               :- 'Join Inner
               :  :- 'SubqueryAlias c
               :  :  +- 'UnresolvedRelation [customer]
               :  +- 'SubqueryAlias ca
               :     +- 'UnresolvedRelation [customer_address]
               +- 'UnresolvedRelation [customer_demographics]

== Analyzed Logical Plan ==
cd_gender: string, cd_marital_status: string, cd_education_status: string, cnt1: bigint, cd_purchase_estimate: int, cnt2: bigint, cd_credit_rating: string, cnt3: bigint, cd_dep_count: int, cnt4: bigint, cd_dep_employed_count: int, cnt5: bigint, cd_dep_college_count: int, cnt6: bigint
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#11 ASC NULLS FIRST, cd_marital_status#12 ASC NULLS FIRST, cd_education_status#13 ASC NULLS FIRST, cd_purchase_estimate#14 ASC NULLS FIRST, cd_credit_rating#15 ASC NULLS FIRST, cd_dep_count#16 ASC NULLS FIRST, cd_dep_employed_count#17 ASC NULLS FIRST, cd_dep_college_count#18 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18], [cd_gender#11, cd_marital_status#12, cd_education_status#13, count(1) AS cnt1#19, cd_purchase_estimate#14, count(1) AS cnt2#20, cd_credit_rating#15, count(1) AS cnt3#21, cd_dep_count#16, count(1) AS cnt4#22, cd_dep_employed_count#17, count(1) AS cnt5#23, cd_dep_college_count#18, count(1) AS cnt6#24]
         +- Filter ((((c_current_addr_sk#25 = ca_address_sk#26) AND ca_county#27 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County)) AND (cd_demo_sk#28 = c_current_cdemo_sk#29)) AND (exists#7 [c_customer_sk#30] AND exists#8 [c_customer_sk#30]))
            :  :- Project [ss_sold_date_sk#31, ss_sold_time_sk#32, ss_item_sk#33, ss_customer_sk#34, ss_cdemo_sk#35, ss_hdemo_sk#36, ss_addr_sk#37, ss_store_sk#38, ss_promo_sk#39, ss_ticket_number#40, ss_quantity#41, ss_wholesale_cost#42, ss_list_price#43, ss_sales_price#44, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_ext_tax#49, ss_coupon_amt#50, ss_net_paid#51, ss_net_paid_inc_tax#52, ss_net_profit#53, d_date_sk#54, d_date_id#55, d_date#56, d_month_seq#57, d_week_seq#58, d_quarter_seq#59, d_year#60, d_dow#61, d_moy#62, d_dom#63, d_qoy#64, d_fy_year#65, d_fy_quarter_seq#66, d_fy_week_seq#67, d_day_name#68, d_quarter_name#69, d_holiday#70, d_weekend#71, d_following_holiday#72, d_first_dom#73, d_last_dom#74, d_same_day_ly#75, d_same_day_lq#76, d_current_day#77, d_current_week#78, d_current_month#79, d_current_quarter#80, d_current_year#81]
            :  :  +- Filter (((outer(c_customer_sk#30) = ss_customer_sk#34) AND (ss_sold_date_sk#31 = d_date_sk#54)) AND ((d_year#60 = 2002) AND ((d_moy#62 >= 4) AND (d_moy#62 <= (4 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias spark_catalog.default.store_sales
            :  :        :  +- Relation[ss_sold_date_sk#31,ss_sold_time_sk#32,ss_item_sk#33,ss_customer_sk#34,ss_cdemo_sk#35,ss_hdemo_sk#36,ss_addr_sk#37,ss_store_sk#38,ss_promo_sk#39,ss_ticket_number#40,ss_quantity#41,ss_wholesale_cost#42,ss_list_price#43,ss_sales_price#44,ss_ext_discount_amt#45,ss_ext_sales_price#46,ss_ext_wholesale_cost#47,ss_ext_list_price#48,ss_ext_tax#49,ss_coupon_amt#50,ss_net_paid#51,ss_net_paid_inc_tax#52,ss_net_profit#53] parquet
            :  :        +- SubqueryAlias spark_catalog.default.date_dim
            :  :           +- Relation[d_date_sk#54,d_date_id#55,d_date#56,d_month_seq#57,d_week_seq#58,d_quarter_seq#59,d_year#60,d_dow#61,d_moy#62,d_dom#63,d_qoy#64,d_fy_year#65,d_fy_quarter_seq#66,d_fy_week_seq#67,d_day_name#68,d_quarter_name#69,d_holiday#70,d_weekend#71,d_following_holiday#72,d_first_dom#73,d_last_dom#74,d_same_day_ly#75,d_same_day_lq#76,d_current_day#77,d_current_week#78,d_current_month#79,d_current_quarter#80,d_current_year#81] parquet
            :  +- Project [customer_sk#9, d_year#60, d_moy#62]
            :     +- Filter (outer(c_customer_sk#30) = customer_sk#9)
            :        +- SubqueryAlias x
            :           +- Union
            :              :- Project [ws_bill_customer_sk#82 AS customer_sk#9, d_year#60, d_moy#62]
            :              :  +- Filter (((ws_sold_date_sk#83 = d_date_sk#54) AND (d_year#60 = 2002)) AND ((d_moy#62 >= 4) AND (d_moy#62 <= (4 + 3))))
            :              :     +- Join Inner
            :              :        :- SubqueryAlias spark_catalog.default.web_sales
            :              :        :  +- Relation[ws_sold_date_sk#83,ws_sold_time_sk#84,ws_ship_date_sk#85,ws_item_sk#86,ws_bill_customer_sk#82,ws_bill_cdemo_sk#87,ws_bill_hdemo_sk#88,ws_bill_addr_sk#89,ws_ship_customer_sk#90,ws_ship_cdemo_sk#91,ws_ship_hdemo_sk#92,ws_ship_addr_sk#93,ws_web_page_sk#94,ws_web_site_sk#95,ws_ship_mode_sk#96,ws_warehouse_sk#97,ws_promo_sk#98,ws_order_number#99,ws_quantity#100,ws_wholesale_cost#101,ws_list_price#102,ws_sales_price#103,ws_ext_discount_amt#104,ws_ext_sales_price#105,ws_ext_wholesale_cost#106,ws_ext_list_price#107,ws_ext_tax#108,ws_coupon_amt#109,ws_ext_ship_cost#110,ws_net_paid#111,ws_net_paid_inc_tax#112,ws_net_paid_inc_ship#113,ws_net_paid_inc_ship_tax#114,ws_net_profit#115] parquet
            :              :        +- SubqueryAlias spark_catalog.default.date_dim
            :              :           +- Relation[d_date_sk#54,d_date_id#55,d_date#56,d_month_seq#57,d_week_seq#58,d_quarter_seq#59,d_year#60,d_dow#61,d_moy#62,d_dom#63,d_qoy#64,d_fy_year#65,d_fy_quarter_seq#66,d_fy_week_seq#67,d_day_name#68,d_quarter_name#69,d_holiday#70,d_weekend#71,d_following_holiday#72,d_first_dom#73,d_last_dom#74,d_same_day_ly#75,d_same_day_lq#76,d_current_day#77,d_current_week#78,d_current_month#79,d_current_quarter#80,d_current_year#81] parquet
            :              +- Project [customer_sk#10 AS customer_sk#116, d_year#60 AS d_year#117, d_moy#62 AS d_moy#118]
            :                 +- Project [cs_ship_customer_sk#119 AS customer_sk#10, d_year#60, d_moy#62]
            :                    +- Filter (((cs_sold_date_sk#120 = d_date_sk#54) AND (d_year#60 = 2002)) AND ((d_moy#62 >= 4) AND (d_moy#62 <= (4 + 3))))
            :                       +- Join Inner
            :                          :- SubqueryAlias spark_catalog.default.catalog_sales
            :                          :  +- Relation[cs_sold_date_sk#120,cs_sold_time_sk#121,cs_ship_date_sk#122,cs_bill_customer_sk#123,cs_bill_cdemo_sk#124,cs_bill_hdemo_sk#125,cs_bill_addr_sk#126,cs_ship_customer_sk#119,cs_ship_cdemo_sk#127,cs_ship_hdemo_sk#128,cs_ship_addr_sk#129,cs_call_center_sk#130,cs_catalog_page_sk#131,cs_ship_mode_sk#132,cs_warehouse_sk#133,cs_item_sk#134,cs_promo_sk#135,cs_order_number#136,cs_quantity#137,cs_wholesale_cost#138,cs_list_price#139,cs_sales_price#140,cs_ext_discount_amt#141,cs_ext_sales_price#142,cs_ext_wholesale_cost#143,cs_ext_list_price#144,cs_ext_tax#145,cs_coupon_amt#146,cs_ext_ship_cost#147,cs_net_paid#148,cs_net_paid_inc_tax#149,cs_net_paid_inc_ship#150,cs_net_paid_inc_ship_tax#151,cs_net_profit#152] parquet
            :                          +- SubqueryAlias spark_catalog.default.date_dim
            :                             +- Relation[d_date_sk#54,d_date_id#55,d_date#56,d_month_seq#57,d_week_seq#58,d_quarter_seq#59,d_year#60,d_dow#61,d_moy#62,d_dom#63,d_qoy#64,d_fy_year#65,d_fy_quarter_seq#66,d_fy_week_seq#67,d_day_name#68,d_quarter_name#69,d_holiday#70,d_weekend#71,d_following_holiday#72,d_first_dom#73,d_last_dom#74,d_same_day_ly#75,d_same_day_lq#76,d_current_day#77,d_current_week#78,d_current_month#79,d_current_quarter#80,d_current_year#81] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias c
               :  :  +- SubqueryAlias spark_catalog.default.customer
               :  :     +- Relation[c_customer_sk#30,c_customer_id#153,c_current_cdemo_sk#29,c_current_hdemo_sk#154,c_current_addr_sk#25,c_first_shipto_date_sk#155,c_first_sales_date_sk#156,c_salutation#157,c_first_name#158,c_last_name#159,c_preferred_cust_flag#160,c_birth_day#161,c_birth_month#162,c_birth_year#163,c_birth_country#164,c_login#165,c_email_address#166,c_last_review_date#167] parquet
               :  +- SubqueryAlias ca
               :     +- SubqueryAlias spark_catalog.default.customer_address
               :        +- Relation[ca_address_sk#26,ca_address_id#168,ca_street_number#169,ca_street_name#170,ca_street_type#171,ca_suite_number#172,ca_city#173,ca_county#27,ca_state#174,ca_zip#175,ca_country#176,ca_gmt_offset#177,ca_location_type#178] parquet
               +- SubqueryAlias spark_catalog.default.customer_demographics
                  +- Relation[cd_demo_sk#28,cd_gender#11,cd_marital_status#12,cd_education_status#13,cd_purchase_estimate#14,cd_credit_rating#15,cd_dep_count#16,cd_dep_employed_count#17,cd_dep_college_count#18] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#11 ASC NULLS FIRST, cd_marital_status#12 ASC NULLS FIRST, cd_education_status#13 ASC NULLS FIRST, cd_purchase_estimate#14 ASC NULLS FIRST, cd_credit_rating#15 ASC NULLS FIRST, cd_dep_count#16 ASC NULLS FIRST, cd_dep_employed_count#17 ASC NULLS FIRST, cd_dep_college_count#18 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18], [cd_gender#11, cd_marital_status#12, cd_education_status#13, count(1) AS cnt1#19, cd_purchase_estimate#14, count(1) AS cnt2#20, cd_credit_rating#15, count(1) AS cnt3#21, cd_dep_count#16, count(1) AS cnt4#22, cd_dep_employed_count#17, count(1) AS cnt5#23, cd_dep_college_count#18, count(1) AS cnt6#24]
         +- Project [cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18]
            +- Join Inner, (cd_demo_sk#28 = c_current_cdemo_sk#29)
               :- Project [c_current_cdemo_sk#29]
               :  +- Join Inner, (c_current_addr_sk#25 = ca_address_sk#26)
               :     :- Project [c_current_cdemo_sk#29, c_current_addr_sk#25]
               :     :  +- Join LeftSemi, (c_customer_sk#30 = customer_sk#9)
               :     :     :- Join LeftSemi, (c_customer_sk#30 = ss_customer_sk#34)
               :     :     :  :- Project [c_customer_sk#30, c_current_cdemo_sk#29, c_current_addr_sk#25]
               :     :     :  :  +- Filter (isnotnull(c_current_addr_sk#25) AND isnotnull(c_current_cdemo_sk#29))
               :     :     :  :     +- Relation[c_customer_sk#30,c_customer_id#153,c_current_cdemo_sk#29,c_current_hdemo_sk#154,c_current_addr_sk#25,c_first_shipto_date_sk#155,c_first_sales_date_sk#156,c_salutation#157,c_first_name#158,c_last_name#159,c_preferred_cust_flag#160,c_birth_day#161,c_birth_month#162,c_birth_year#163,c_birth_country#164,c_login#165,c_email_address#166,c_last_review_date#167] parquet
               :     :     :  +- Project [ss_customer_sk#34]
               :     :     :     +- Join Inner, (ss_sold_date_sk#31 = d_date_sk#54)
               :     :     :        :- Project [ss_sold_date_sk#31, ss_customer_sk#34]
               :     :     :        :  +- Filter isnotnull(ss_sold_date_sk#31)
               :     :     :        :     +- Relation[ss_sold_date_sk#31,ss_sold_time_sk#32,ss_item_sk#33,ss_customer_sk#34,ss_cdemo_sk#35,ss_hdemo_sk#36,ss_addr_sk#37,ss_store_sk#38,ss_promo_sk#39,ss_ticket_number#40,ss_quantity#41,ss_wholesale_cost#42,ss_list_price#43,ss_sales_price#44,ss_ext_discount_amt#45,ss_ext_sales_price#46,ss_ext_wholesale_cost#47,ss_ext_list_price#48,ss_ext_tax#49,ss_coupon_amt#50,ss_net_paid#51,ss_net_paid_inc_tax#52,ss_net_profit#53] parquet
               :     :     :        +- Project [d_date_sk#54]
               :     :     :           +- Filter (((((isnotnull(d_moy#62) AND isnotnull(d_year#60)) AND (d_year#60 = 2002)) AND (d_moy#62 >= 4)) AND (d_moy#62 <= 7)) AND isnotnull(d_date_sk#54))
               :     :     :              +- Relation[d_date_sk#54,d_date_id#55,d_date#56,d_month_seq#57,d_week_seq#58,d_quarter_seq#59,d_year#60,d_dow#61,d_moy#62,d_dom#63,d_qoy#64,d_fy_year#65,d_fy_quarter_seq#66,d_fy_week_seq#67,d_day_name#68,d_quarter_name#69,d_holiday#70,d_weekend#71,d_following_holiday#72,d_first_dom#73,d_last_dom#74,d_same_day_ly#75,d_same_day_lq#76,d_current_day#77,d_current_week#78,d_current_month#79,d_current_quarter#80,d_current_year#81] parquet
               :     :     +- Union
               :     :        :- Project [ws_bill_customer_sk#82 AS customer_sk#9]
               :     :        :  +- Join Inner, (ws_sold_date_sk#83 = d_date_sk#54)
               :     :        :     :- Project [ws_sold_date_sk#83, ws_bill_customer_sk#82]
               :     :        :     :  +- Filter isnotnull(ws_sold_date_sk#83)
               :     :        :     :     +- Relation[ws_sold_date_sk#83,ws_sold_time_sk#84,ws_ship_date_sk#85,ws_item_sk#86,ws_bill_customer_sk#82,ws_bill_cdemo_sk#87,ws_bill_hdemo_sk#88,ws_bill_addr_sk#89,ws_ship_customer_sk#90,ws_ship_cdemo_sk#91,ws_ship_hdemo_sk#92,ws_ship_addr_sk#93,ws_web_page_sk#94,ws_web_site_sk#95,ws_ship_mode_sk#96,ws_warehouse_sk#97,ws_promo_sk#98,ws_order_number#99,ws_quantity#100,ws_wholesale_cost#101,ws_list_price#102,ws_sales_price#103,ws_ext_discount_amt#104,ws_ext_sales_price#105,ws_ext_wholesale_cost#106,ws_ext_list_price#107,ws_ext_tax#108,ws_coupon_amt#109,ws_ext_ship_cost#110,ws_net_paid#111,ws_net_paid_inc_tax#112,ws_net_paid_inc_ship#113,ws_net_paid_inc_ship_tax#114,ws_net_profit#115] parquet
               :     :        :     +- Project [d_date_sk#54]
               :     :        :        +- Filter (((((isnotnull(d_moy#62) AND isnotnull(d_year#60)) AND (d_year#60 = 2002)) AND (d_moy#62 >= 4)) AND (d_moy#62 <= 7)) AND isnotnull(d_date_sk#54))
               :     :        :           +- Relation[d_date_sk#54,d_date_id#55,d_date#56,d_month_seq#57,d_week_seq#58,d_quarter_seq#59,d_year#60,d_dow#61,d_moy#62,d_dom#63,d_qoy#64,d_fy_year#65,d_fy_quarter_seq#66,d_fy_week_seq#67,d_day_name#68,d_quarter_name#69,d_holiday#70,d_weekend#71,d_following_holiday#72,d_first_dom#73,d_last_dom#74,d_same_day_ly#75,d_same_day_lq#76,d_current_day#77,d_current_week#78,d_current_month#79,d_current_quarter#80,d_current_year#81] parquet
               :     :        +- Project [cs_ship_customer_sk#119 AS customer_sk#116]
               :     :           +- Join Inner, (cs_sold_date_sk#120 = d_date_sk#54)
               :     :              :- Project [cs_sold_date_sk#120, cs_ship_customer_sk#119]
               :     :              :  +- Filter isnotnull(cs_sold_date_sk#120)
               :     :              :     +- Relation[cs_sold_date_sk#120,cs_sold_time_sk#121,cs_ship_date_sk#122,cs_bill_customer_sk#123,cs_bill_cdemo_sk#124,cs_bill_hdemo_sk#125,cs_bill_addr_sk#126,cs_ship_customer_sk#119,cs_ship_cdemo_sk#127,cs_ship_hdemo_sk#128,cs_ship_addr_sk#129,cs_call_center_sk#130,cs_catalog_page_sk#131,cs_ship_mode_sk#132,cs_warehouse_sk#133,cs_item_sk#134,cs_promo_sk#135,cs_order_number#136,cs_quantity#137,cs_wholesale_cost#138,cs_list_price#139,cs_sales_price#140,cs_ext_discount_amt#141,cs_ext_sales_price#142,cs_ext_wholesale_cost#143,cs_ext_list_price#144,cs_ext_tax#145,cs_coupon_amt#146,cs_ext_ship_cost#147,cs_net_paid#148,cs_net_paid_inc_tax#149,cs_net_paid_inc_ship#150,cs_net_paid_inc_ship_tax#151,cs_net_profit#152] parquet
               :     :              +- Project [d_date_sk#54]
               :     :                 +- Filter (((((isnotnull(d_moy#62) AND isnotnull(d_year#60)) AND (d_year#60 = 2002)) AND (d_moy#62 >= 4)) AND (d_moy#62 <= 7)) AND isnotnull(d_date_sk#54))
               :     :                    +- Relation[d_date_sk#54,d_date_id#55,d_date#56,d_month_seq#57,d_week_seq#58,d_quarter_seq#59,d_year#60,d_dow#61,d_moy#62,d_dom#63,d_qoy#64,d_fy_year#65,d_fy_quarter_seq#66,d_fy_week_seq#67,d_day_name#68,d_quarter_name#69,d_holiday#70,d_weekend#71,d_following_holiday#72,d_first_dom#73,d_last_dom#74,d_same_day_ly#75,d_same_day_lq#76,d_current_day#77,d_current_week#78,d_current_month#79,d_current_quarter#80,d_current_year#81] parquet
               :     +- Project [ca_address_sk#26]
               :        +- Filter (ca_county#27 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County) AND isnotnull(ca_address_sk#26))
               :           +- Relation[ca_address_sk#26,ca_address_id#168,ca_street_number#169,ca_street_name#170,ca_street_type#171,ca_suite_number#172,ca_city#173,ca_county#27,ca_state#174,ca_zip#175,ca_country#176,ca_gmt_offset#177,ca_location_type#178] parquet
               +- Filter isnotnull(cd_demo_sk#28)
                  +- Relation[cd_demo_sk#28,cd_gender#11,cd_marital_status#12,cd_education_status#13,cd_purchase_estimate#14,cd_credit_rating#15,cd_dep_count#16,cd_dep_employed_count#17,cd_dep_college_count#18] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[cd_gender#11 ASC NULLS FIRST,cd_marital_status#12 ASC NULLS FIRST,cd_education_status#13 ASC NULLS FIRST,cd_purchase_estimate#14 ASC NULLS FIRST,cd_credit_rating#15 ASC NULLS FIRST,cd_dep_count#16 ASC NULLS FIRST,cd_dep_employed_count#17 ASC NULLS FIRST,cd_dep_college_count#18 ASC NULLS FIRST], output=[cd_gender#11,cd_marital_status#12,cd_education_status#13,cnt1#19,cd_purchase_estimate#14,cnt2#20,cd_credit_rating#15,cnt3#21,cd_dep_count#16,cnt4#22,cd_dep_employed_count#17,cnt5#23,cd_dep_college_count#18,cnt6#24])
+- *(10) HashAggregate(keys=[cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18], functions=[count(1)], output=[cd_gender#11, cd_marital_status#12, cd_education_status#13, cnt1#19, cd_purchase_estimate#14, cnt2#20, cd_credit_rating#15, cnt3#21, cd_dep_count#16, cnt4#22, cd_dep_employed_count#17, cnt5#23, cd_dep_college_count#18, cnt6#24])
   +- Exchange hashpartitioning(cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18, 5), true, [id=#179]
      +- *(9) HashAggregate(keys=[cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18], functions=[partial_count(1)], output=[cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18, count#180])
         +- *(9) Project [cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18]
            +- *(9) BroadcastHashJoin [c_current_cdemo_sk#29], [cd_demo_sk#28], Inner, BuildRight
               :- *(9) Project [c_current_cdemo_sk#29]
               :  +- *(9) BroadcastHashJoin [c_current_addr_sk#25], [ca_address_sk#26], Inner, BuildRight
               :     :- *(9) Project [c_current_cdemo_sk#29, c_current_addr_sk#25]
               :     :  +- *(9) BroadcastHashJoin [c_customer_sk#30], [customer_sk#9], LeftSemi, BuildRight
               :     :     :- *(9) BroadcastHashJoin [c_customer_sk#30], [ss_customer_sk#34], LeftSemi, BuildRight
               :     :     :  :- *(9) Project [c_customer_sk#30, c_current_cdemo_sk#29, c_current_addr_sk#25]
               :     :     :  :  +- *(9) Filter (isnotnull(c_current_addr_sk#25) AND isnotnull(c_current_cdemo_sk#29))
               :     :     :  :     +- *(9) ColumnarToRow
               :     :     :  :        +- FileScan parquet default.customer[c_customer_sk#30,c_current_cdemo_sk#29,c_current_addr_sk#25] Batched: true, DataFilters: [isnotnull(c_current_addr_sk#25), isnotnull(c_current_cdemo_sk#29)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(c_current_addr_sk), IsNotNull(c_current_cdemo_sk)], ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int>
               :     :     :  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#181]
               :     :     :     +- *(2) Project [ss_customer_sk#34]
               :     :     :        +- *(2) BroadcastHashJoin [ss_sold_date_sk#31], [d_date_sk#54], Inner, BuildRight
               :     :     :           :- *(2) Project [ss_sold_date_sk#31, ss_customer_sk#34]
               :     :     :           :  +- *(2) Filter isnotnull(ss_sold_date_sk#31)
               :     :     :           :     +- *(2) ColumnarToRow
               :     :     :           :        +- FileScan parquet default.store_sales[ss_sold_date_sk#31,ss_customer_sk#34] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#31)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int>
               :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#182]
               :     :     :              +- *(1) Project [d_date_sk#54]
               :     :     :                 +- *(1) Filter (((((isnotnull(d_moy#62) AND isnotnull(d_year#60)) AND (d_year#60 = 2002)) AND (d_moy#62 >= 4)) AND (d_moy#62 <= 7)) AND isnotnull(d_date_sk#54))
               :     :     :                    +- *(1) ColumnarToRow
               :     :     :                       +- FileScan parquet default.date_dim[d_date_sk#54,d_year#60,d_moy#62] Batched: true, DataFilters: [isnotnull(d_moy#62), isnotnull(d_year#60), (d_year#60 = 2002), (d_moy#62 >= 4), (d_moy#183..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_moy), IsNotNull(d_year), EqualTo(d_year,2002), GreaterThanOrEqual(d_moy,4), LessThan..., ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#184]
               :     :        +- Union
               :     :           :- *(4) Project [ws_bill_customer_sk#82 AS customer_sk#9]
               :     :           :  +- *(4) BroadcastHashJoin [ws_sold_date_sk#83], [d_date_sk#54], Inner, BuildRight
               :     :           :     :- *(4) Project [ws_sold_date_sk#83, ws_bill_customer_sk#82]
               :     :           :     :  +- *(4) Filter isnotnull(ws_sold_date_sk#83)
               :     :           :     :     +- *(4) ColumnarToRow
               :     :           :     :        +- FileScan parquet default.web_sales[ws_sold_date_sk#83,ws_bill_customer_sk#82] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#83)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int>
               :     :           :     +- ReusedExchange [d_date_sk#54], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#182]
               :     :           +- *(6) Project [cs_ship_customer_sk#119 AS customer_sk#116]
               :     :              +- *(6) BroadcastHashJoin [cs_sold_date_sk#120], [d_date_sk#54], Inner, BuildRight
               :     :                 :- *(6) Project [cs_sold_date_sk#120, cs_ship_customer_sk#119]
               :     :                 :  +- *(6) Filter isnotnull(cs_sold_date_sk#120)
               :     :                 :     +- *(6) ColumnarToRow
               :     :                 :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#120,cs_ship_customer_sk#119] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#120)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ship_customer_sk:int>
               :     :                 +- ReusedExchange [d_date_sk#54], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#182]
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#185]
               :        +- *(7) Project [ca_address_sk#26]
               :           +- *(7) Filter (ca_county#27 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County) AND isnotnull(ca_address_sk#26))
               :              +- *(7) ColumnarToRow
               :                 +- FileScan parquet default.customer_address[ca_address_sk#26,ca_county#27] Batched: true, DataFilters: [ca_county#27 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County), ..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_county, [Walker County,Richland County,Gaines County,Douglas County,Dona Ana County]), IsN..., ReadSchema: struct<ca_address_sk:int,ca_county:string>
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#186]
                  +- *(8) Project [cd_demo_sk#28, cd_gender#11, cd_marital_status#12, cd_education_status#13, cd_purchase_estimate#14, cd_credit_rating#15, cd_dep_count#16, cd_dep_employed_count#17, cd_dep_college_count#18]
                     +- *(8) Filter isnotnull(cd_demo_sk#28)
                        +- *(8) ColumnarToRow
                           +- FileScan parquet default.customer_demographics[cd_demo_sk#28,cd_gender#11,cd_marital_status#12,cd_education_status#13,cd_purchase_estimate#14,cd_credit_rating#15,cd_dep_count#16,cd_dep_employed_count#17,cd_dep_college_count#18] Batched: true, DataFilters: [isnotnull(cd_demo_sk#28)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_marital_status:string,cd_education_status:string,cd_pur...
