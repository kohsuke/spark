== Parsed Logical Plan ==
CTE [cross_items, avg_sales, results]
:  :- 'SubqueryAlias cross_items
:  :  +- 'Project ['i_item_sk AS ss_item_sk#1]
:  :     +- 'Filter ((('i_brand_id = 'brand_id) AND ('i_class_id = 'class_id)) AND ('i_category_id = 'category_id))
:  :        +- 'Join Inner
:  :           :- 'UnresolvedRelation [item]
:  :           +- 'SubqueryAlias x
:  :              +- 'Intersect false
:  :                 :- 'Intersect false
:  :                 :  :- 'Project ['iss.i_brand_id AS brand_id#2, 'iss.i_class_id AS class_id#3, 'iss.i_category_id AS category_id#4]
:  :                 :  :  +- 'Filter ((('ss_item_sk = 'iss.i_item_sk) AND ('ss_sold_date_sk = 'd1.d_date_sk)) AND (('d1.d_year >= 1999) AND ('d1.d_year <= (1999 + 2))))
:  :                 :  :     +- 'Join Inner
:  :                 :  :        :- 'Join Inner
:  :                 :  :        :  :- 'UnresolvedRelation [store_sales]
:  :                 :  :        :  +- 'SubqueryAlias iss
:  :                 :  :        :     +- 'UnresolvedRelation [item]
:  :                 :  :        +- 'SubqueryAlias d1
:  :                 :  :           +- 'UnresolvedRelation [date_dim]
:  :                 :  +- 'Project ['ics.i_brand_id, 'ics.i_class_id, 'ics.i_category_id]
:  :                 :     +- 'Filter ((('cs_item_sk = 'ics.i_item_sk) AND ('cs_sold_date_sk = 'd2.d_date_sk)) AND (('d2.d_year >= 1999) AND ('d2.d_year <= (1999 + 2))))
:  :                 :        +- 'Join Inner
:  :                 :           :- 'Join Inner
:  :                 :           :  :- 'UnresolvedRelation [catalog_sales]
:  :                 :           :  +- 'SubqueryAlias ics
:  :                 :           :     +- 'UnresolvedRelation [item]
:  :                 :           +- 'SubqueryAlias d2
:  :                 :              +- 'UnresolvedRelation [date_dim]
:  :                 +- 'Project ['iws.i_brand_id, 'iws.i_class_id, 'iws.i_category_id]
:  :                    +- 'Filter ((('ws_item_sk = 'iws.i_item_sk) AND ('ws_sold_date_sk = 'd3.d_date_sk)) AND (('d3.d_year >= 1999) AND ('d3.d_year <= (1999 + 2))))
:  :                       +- 'Join Inner
:  :                          :- 'Join Inner
:  :                          :  :- 'UnresolvedRelation [web_sales]
:  :                          :  +- 'SubqueryAlias iws
:  :                          :     +- 'UnresolvedRelation [item]
:  :                          +- 'SubqueryAlias d3
:  :                             +- 'UnresolvedRelation [date_dim]
:  :- 'SubqueryAlias avg_sales
:  :  +- 'Project ['avg(('quantity * 'list_price)) AS average_sales#5]
:  :     +- 'SubqueryAlias x
:  :        +- 'Union
:  :           :- 'Union
:  :           :  :- 'Project ['ss_quantity AS quantity#6, 'ss_list_price AS list_price#7]
:  :           :  :  +- 'Filter (('ss_sold_date_sk = 'd_date_sk) AND (('d_year >= 1999) AND ('d_year <= 2001)))
:  :           :  :     +- 'Join Inner
:  :           :  :        :- 'UnresolvedRelation [store_sales]
:  :           :  :        +- 'UnresolvedRelation [date_dim]
:  :           :  +- 'Project ['cs_quantity AS quantity#8, 'cs_list_price AS list_price#9]
:  :           :     +- 'Filter (('cs_sold_date_sk = 'd_date_sk) AND (('d_year >= 1998) AND ('d_year <= (1998 + 2))))
:  :           :        +- 'Join Inner
:  :           :           :- 'UnresolvedRelation [catalog_sales]
:  :           :           +- 'UnresolvedRelation [date_dim]
:  :           +- 'Project ['ws_quantity AS quantity#10, 'ws_list_price AS list_price#11]
:  :              +- 'Filter (('ws_sold_date_sk = 'd_date_sk) AND (('d_year >= 1998) AND ('d_year <= (1998 + 2))))
:  :                 +- 'Join Inner
:  :                    :- 'UnresolvedRelation [web_sales]
:  :                    +- 'UnresolvedRelation [date_dim]
:  +- 'SubqueryAlias results
:     +- 'Aggregate ['channel, 'i_brand_id, 'i_class_id, 'i_category_id], ['channel, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum('sales) AS sum_sales#12, 'sum('number_sales) AS number_sales#13]
:        +- 'SubqueryAlias y
:           +- 'Union
:              :- 'Union
:              :  :- 'UnresolvedHaving ('sum(('ss_quantity * 'ss_list_price)) > scalar-subquery#14 [])
:              :  :  :  +- 'Project ['average_sales]
:              :  :  :     +- 'UnresolvedRelation [avg_sales]
:              :  :  +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [store AS channel#15, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('ss_quantity * 'ss_list_price)) AS sales#16, 'count(1) AS number_sales#17]
:              :  :     +- 'Filter ((('ss_item_sk IN (list#18 []) AND ('ss_item_sk = 'i_item_sk)) AND ('ss_sold_date_sk = 'd_date_sk)) AND (('d_year = (1998 + 2)) AND ('d_moy = 11)))
:              :  :        :  +- 'Project ['ss_item_sk]
:              :  :        :     +- 'UnresolvedRelation [cross_items]
:              :  :        +- 'Join Inner
:              :  :           :- 'Join Inner
:              :  :           :  :- 'UnresolvedRelation [store_sales]
:              :  :           :  +- 'UnresolvedRelation [item]
:              :  :           +- 'UnresolvedRelation [date_dim]
:              :  +- 'UnresolvedHaving ('sum(('cs_quantity * 'cs_list_price)) > scalar-subquery#19 [])
:              :     :  +- 'Project ['average_sales]
:              :     :     +- 'UnresolvedRelation [avg_sales]
:              :     +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [catalog AS channel#20, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('cs_quantity * 'cs_list_price)) AS sales#21, 'count(1) AS number_sales#22]
:              :        +- 'Filter ((('cs_item_sk IN (list#23 []) AND ('cs_item_sk = 'i_item_sk)) AND ('cs_sold_date_sk = 'd_date_sk)) AND (('d_year = (1998 + 2)) AND ('d_moy = 11)))
:              :           :  +- 'Project ['ss_item_sk]
:              :           :     +- 'UnresolvedRelation [cross_items]
:              :           +- 'Join Inner
:              :              :- 'Join Inner
:              :              :  :- 'UnresolvedRelation [catalog_sales]
:              :              :  +- 'UnresolvedRelation [item]
:              :              +- 'UnresolvedRelation [date_dim]
:              +- 'UnresolvedHaving ('sum(('ws_quantity * 'ws_list_price)) > scalar-subquery#24 [])
:                 :  +- 'Project ['average_sales]
:                 :     +- 'UnresolvedRelation [avg_sales]
:                 +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [web AS channel#25, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('ws_quantity * 'ws_list_price)) AS sales#26, 'count(1) AS number_sales#27]
:                    +- 'Filter ((('ws_item_sk IN (list#28 []) AND ('ws_item_sk = 'i_item_sk)) AND ('ws_sold_date_sk = 'd_date_sk)) AND (('d_year = (1998 + 2)) AND ('d_moy = 11)))
:                       :  +- 'Project ['ss_item_sk]
:                       :     +- 'UnresolvedRelation [cross_items]
:                       +- 'Join Inner
:                          :- 'Join Inner
:                          :  :- 'UnresolvedRelation [web_sales]
:                          :  +- 'UnresolvedRelation [item]
:                          +- 'UnresolvedRelation [date_dim]
+- 'GlobalLimit 100
   +- 'LocalLimit 100
      +- 'Sort ['channel ASC NULLS FIRST, 'i_brand_id ASC NULLS FIRST, 'i_class_id ASC NULLS FIRST, 'i_category_id ASC NULLS FIRST], true
         +- 'Project ['channel, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum_sales, 'number_sales]
            +- 'SubqueryAlias z
               +- 'Distinct
                  +- 'Union
                     :- 'Distinct
                     :  +- 'Union
                     :     :- 'Distinct
                     :     :  +- 'Union
                     :     :     :- 'Distinct
                     :     :     :  +- 'Union
                     :     :     :     :- 'Project ['channel, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum_sales, 'number_sales]
                     :     :     :     :  +- 'UnresolvedRelation [results]
                     :     :     :     +- 'Aggregate ['channel, 'i_brand_id, 'i_class_id], ['channel, 'i_brand_id, 'i_class_id, null AS i_category_id#29, unresolvedalias('sum('sum_sales), None), unresolvedalias('sum('number_sales), None)]
                     :     :     :        +- 'UnresolvedRelation [results]
                     :     :     +- 'Aggregate ['channel, 'i_brand_id], ['channel, 'i_brand_id, null AS i_class_id#30, null AS i_category_id#31, unresolvedalias('sum('sum_sales), None), unresolvedalias('sum('number_sales), None)]
                     :     :        +- 'UnresolvedRelation [results]
                     :     +- 'Aggregate ['channel], ['channel, null AS i_brand_id#32, null AS i_class_id#33, null AS i_category_id#34, unresolvedalias('sum('sum_sales), None), unresolvedalias('sum('number_sales), None)]
                     :        +- 'UnresolvedRelation [results]
                     +- 'Project [null AS channel#35, null AS i_brand_id#36, null AS i_class_id#37, null AS i_category_id#38, unresolvedalias('sum('sum_sales), None), unresolvedalias('sum('number_sales), None)]
                        +- 'UnresolvedRelation [results]

== Analyzed Logical Plan ==
channel: string, i_brand_id: int, i_class_id: int, i_category_id: int, sum_sales: decimal(38,2), number_sales: bigint
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#15 ASC NULLS FIRST, i_brand_id#39 ASC NULLS FIRST, i_class_id#40 ASC NULLS FIRST, i_category_id#41 ASC NULLS FIRST], true
      +- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
         +- SubqueryAlias z
            +- Distinct
               +- Union
                  :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
                  :  +- Distinct
                  :     +- Union
                  :        :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
                  :        :  +- Distinct
                  :        :     +- Union
                  :        :        :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
                  :        :        :  +- Distinct
                  :        :        :     +- Union
                  :        :        :        :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
                  :        :        :        :  +- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
                  :        :        :        :     +- SubqueryAlias results
                  :        :        :        :        +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
                  :        :        :        :           +- SubqueryAlias y
                  :        :        :        :              +- Union
                  :        :        :        :                 :- Union
                  :        :        :        :                 :  :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
                  :        :        :        :                 :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6)))
                  :        :        :        :                 :  :     :  +- Project [average_sales#5]
                  :        :        :        :                 :  :     :     +- SubqueryAlias avg_sales
                  :        :        :        :                 :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :        :        :                 :  :     :           +- SubqueryAlias x
                  :        :        :        :                 :  :     :              +- Union
                  :        :        :        :                 :  :     :                 :- Union
                  :        :        :        :                 :  :     :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :        :        :                 :  :     :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :        :        :                 :  :     :                 :  :     +- Join Inner
                  :        :        :        :                 :  :     :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :        :                 :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :        :                 :  :     :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :  :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :  :     :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :        :        :                 :  :     :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :        :                 :  :     :                 :        +- Join Inner
                  :        :        :        :                 :  :     :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :        :                 :  :     :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :        :                 :  :     :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :  :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :  :     :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :        :        :                 :  :     :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :        :                 :  :     :                       +- Join Inner
                  :        :        :        :                 :  :     :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :        :                 :  :     :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :        :                 :  :     :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :  :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :  :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46]
                  :        :        :        :                 :  :        +- Filter (((ss_item_sk#51 IN (list#18 []) AND (ss_item_sk#51 = i_item_sk#164)) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :        :        :                 :  :           :  +- Project [ss_item_sk#1]
                  :        :        :        :                 :  :           :     +- SubqueryAlias cross_items
                  :        :        :        :                 :  :           :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :        :        :                 :  :           :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :        :        :                 :  :           :              +- Join Inner
                  :        :        :        :                 :  :           :                 :- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :  :           :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :  :           :                 +- SubqueryAlias x
                  :        :        :        :                 :  :           :                    +- Intersect false
                  :        :        :        :                 :  :           :                       :- Intersect false
                  :        :        :        :                 :  :           :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :        :        :                 :  :           :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                 :  :           :                       :  :     +- Join Inner
                  :        :        :        :                 :  :           :                       :  :        :- Join Inner
                  :        :        :        :                 :  :           :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :        :                 :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :        :                 :  :           :                       :  :        :  +- SubqueryAlias iss
                  :        :        :        :                 :  :           :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :  :           :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :  :           :                       :  :        +- SubqueryAlias d1
                  :        :        :        :                 :  :           :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :  :           :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :  :           :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :        :                 :  :           :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                 :  :           :                       :        +- Join Inner
                  :        :        :        :                 :  :           :                       :           :- Join Inner
                  :        :        :        :                 :  :           :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :        :                 :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :        :                 :  :           :                       :           :  +- SubqueryAlias ics
                  :        :        :        :                 :  :           :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :  :           :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :  :           :                       :           +- SubqueryAlias d2
                  :        :        :        :                 :  :           :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :  :           :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :  :           :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :        :                 :  :           :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                 :  :           :                             +- Join Inner
                  :        :        :        :                 :  :           :                                :- Join Inner
                  :        :        :        :                 :  :           :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :        :                 :  :           :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :        :                 :  :           :                                :  +- SubqueryAlias iws
                  :        :        :        :                 :  :           :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :  :           :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :  :           :                                +- SubqueryAlias d3
                  :        :        :        :                 :  :           :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :  :           :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :  :           +- Join Inner
                  :        :        :        :                 :  :              :- Join Inner
                  :        :        :        :                 :  :              :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :        :                 :  :              :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :        :                 :  :              :  +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :  :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :  :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :  :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :  +- Project [channel#20 AS channel#183, i_brand_id#39 AS i_brand_id#184, i_class_id#40 AS i_class_id#185, i_category_id#41 AS i_category_id#186, sales#21 AS sales#187, number_sales#188 AS number_sales#189]
                  :        :        :        :                 :     +- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
                  :        :        :        :                 :        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6)))
                  :        :        :        :                 :           :  +- Project [average_sales#5]
                  :        :        :        :                 :           :     +- SubqueryAlias avg_sales
                  :        :        :        :                 :           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :        :        :                 :           :           +- SubqueryAlias x
                  :        :        :        :                 :           :              +- Union
                  :        :        :        :                 :           :                 :- Union
                  :        :        :        :                 :           :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :        :        :                 :           :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :        :        :                 :           :                 :  :     +- Join Inner
                  :        :        :        :                 :           :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :        :                 :           :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :        :                 :           :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :           :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :           :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :        :        :                 :           :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :        :                 :           :                 :        +- Join Inner
                  :        :        :        :                 :           :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :        :                 :           :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :        :                 :           :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :           :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :           :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :        :        :                 :           :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :        :                 :           :                       +- Join Inner
                  :        :        :        :                 :           :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :        :                 :           :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :        :                 :           :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :           :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :           +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190]
                  :        :        :        :                 :              +- Filter (((cs_item_sk#113 IN (list#23 []) AND (cs_item_sk#113 = i_item_sk#164)) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :        :        :                 :                 :  +- Project [ss_item_sk#1]
                  :        :        :        :                 :                 :     +- SubqueryAlias cross_items
                  :        :        :        :                 :                 :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :        :        :                 :                 :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :        :        :                 :                 :              +- Join Inner
                  :        :        :        :                 :                 :                 :- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :                 :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :                 :                 +- SubqueryAlias x
                  :        :        :        :                 :                 :                    +- Intersect false
                  :        :        :        :                 :                 :                       :- Intersect false
                  :        :        :        :                 :                 :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :        :        :                 :                 :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                 :                 :                       :  :     +- Join Inner
                  :        :        :        :                 :                 :                       :  :        :- Join Inner
                  :        :        :        :                 :                 :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :        :                 :                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :        :                 :                 :                       :  :        :  +- SubqueryAlias iss
                  :        :        :        :                 :                 :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :                 :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :                 :                       :  :        +- SubqueryAlias d1
                  :        :        :        :                 :                 :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :                 :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :                 :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :        :                 :                 :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                 :                 :                       :        +- Join Inner
                  :        :        :        :                 :                 :                       :           :- Join Inner
                  :        :        :        :                 :                 :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :        :                 :                 :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :        :                 :                 :                       :           :  +- SubqueryAlias ics
                  :        :        :        :                 :                 :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :                 :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :                 :                       :           +- SubqueryAlias d2
                  :        :        :        :                 :                 :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :                 :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :                 :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :        :                 :                 :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                 :                 :                             +- Join Inner
                  :        :        :        :                 :                 :                                :- Join Inner
                  :        :        :        :                 :                 :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :        :                 :                 :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :        :                 :                 :                                :  +- SubqueryAlias iws
                  :        :        :        :                 :                 :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :                 :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :                 :                                +- SubqueryAlias d3
                  :        :        :        :                 :                 :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :                 :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 :                 +- Join Inner
                  :        :        :        :                 :                    :- Join Inner
                  :        :        :        :                 :                    :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :        :                 :                    :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :        :                 :                    :  +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                 :                    :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                 :                    +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                 :                       +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                 +- Project [channel#25 AS channel#191, i_brand_id#39 AS i_brand_id#192, i_class_id#40 AS i_class_id#193, i_category_id#41 AS i_category_id#194, sales#26 AS sales#195, number_sales#196 AS number_sales#197]
                  :        :        :        :                    +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
                  :        :        :        :                       +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6)))
                  :        :        :        :                          :  +- Project [average_sales#5]
                  :        :        :        :                          :     +- SubqueryAlias avg_sales
                  :        :        :        :                          :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :        :        :                          :           +- SubqueryAlias x
                  :        :        :        :                          :              +- Union
                  :        :        :        :                          :                 :- Union
                  :        :        :        :                          :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :        :        :                          :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :        :        :                          :                 :  :     +- Join Inner
                  :        :        :        :                          :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :        :                          :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :        :                          :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                          :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                          :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :        :        :                          :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :        :                          :                 :        +- Join Inner
                  :        :        :        :                          :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :        :                          :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :        :                          :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                          :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                          :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :        :        :                          :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :        :                          :                       +- Join Inner
                  :        :        :        :                          :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :        :                          :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :        :                          :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                          :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                          +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198]
                  :        :        :        :                             +- Filter (((ws_item_sk#135 IN (list#28 []) AND (ws_item_sk#135 = i_item_sk#164)) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :        :        :                                :  +- Project [ss_item_sk#1]
                  :        :        :        :                                :     +- SubqueryAlias cross_items
                  :        :        :        :                                :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :        :        :                                :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :        :        :                                :              +- Join Inner
                  :        :        :        :                                :                 :- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                                :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                                :                 +- SubqueryAlias x
                  :        :        :        :                                :                    +- Intersect false
                  :        :        :        :                                :                       :- Intersect false
                  :        :        :        :                                :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :        :        :                                :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                                :                       :  :     +- Join Inner
                  :        :        :        :                                :                       :  :        :- Join Inner
                  :        :        :        :                                :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :        :                                :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :        :                                :                       :  :        :  +- SubqueryAlias iss
                  :        :        :        :                                :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                                :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                                :                       :  :        +- SubqueryAlias d1
                  :        :        :        :                                :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                                :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                                :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :        :                                :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                                :                       :        +- Join Inner
                  :        :        :        :                                :                       :           :- Join Inner
                  :        :        :        :                                :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :        :                                :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :        :                                :                       :           :  +- SubqueryAlias ics
                  :        :        :        :                                :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                                :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                                :                       :           +- SubqueryAlias d2
                  :        :        :        :                                :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                                :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                                :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :        :                                :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :        :                                :                             +- Join Inner
                  :        :        :        :                                :                                :- Join Inner
                  :        :        :        :                                :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :        :                                :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :        :                                :                                :  +- SubqueryAlias iws
                  :        :        :        :                                :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                                :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                                :                                +- SubqueryAlias d3
                  :        :        :        :                                :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                                :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        :                                +- Join Inner
                  :        :        :        :                                   :- Join Inner
                  :        :        :        :                                   :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :        :                                   :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :        :                                   :  +- SubqueryAlias spark_catalog.default.item
                  :        :        :        :                                   :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :        :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :        :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :        +- Project [channel#15 AS channel#199, i_brand_id#39 AS i_brand_id#200, i_class_id#40 AS i_class_id#201, i_category_id#202 AS i_category_id#203, sum(sum_sales)#204 AS sum(sum_sales)#205, sum(number_sales)#206 AS sum(number_sales)#207]
                  :        :        :           +- Project [channel#15, i_brand_id#39, i_class_id#40, cast(i_category_id#29 as int) AS i_category_id#202, sum(sum_sales)#204, sum(number_sales)#206]
                  :        :        :              +- Aggregate [channel#15, i_brand_id#39, i_class_id#40], [channel#15, i_brand_id#39, i_class_id#40, null AS i_category_id#29, sum(sum_sales#12) AS sum(sum_sales)#204, sum(number_sales#42) AS sum(number_sales)#206]
                  :        :        :                 +- SubqueryAlias results
                  :        :        :                    +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
                  :        :        :                       +- SubqueryAlias y
                  :        :        :                          +- Union
                  :        :        :                             :- Union
                  :        :        :                             :  :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
                  :        :        :                             :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6)))
                  :        :        :                             :  :     :  +- Project [average_sales#5]
                  :        :        :                             :  :     :     +- SubqueryAlias avg_sales
                  :        :        :                             :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :        :                             :  :     :           +- SubqueryAlias x
                  :        :        :                             :  :     :              +- Union
                  :        :        :                             :  :     :                 :- Union
                  :        :        :                             :  :     :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :        :                             :  :     :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :        :                             :  :     :                 :  :     +- Join Inner
                  :        :        :                             :  :     :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :                             :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :                             :  :     :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :  :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :  :     :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :        :                             :  :     :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :                             :  :     :                 :        +- Join Inner
                  :        :        :                             :  :     :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :                             :  :     :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :                             :  :     :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :  :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :  :     :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :        :                             :  :     :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :                             :  :     :                       +- Join Inner
                  :        :        :                             :  :     :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :                             :  :     :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :                             :  :     :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :  :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :  :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208]
                  :        :        :                             :  :        +- Filter (((ss_item_sk#51 IN (list#18 []) AND (ss_item_sk#51 = i_item_sk#164)) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :        :                             :  :           :  +- Project [ss_item_sk#1]
                  :        :        :                             :  :           :     +- SubqueryAlias cross_items
                  :        :        :                             :  :           :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :        :                             :  :           :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :        :                             :  :           :              +- Join Inner
                  :        :        :                             :  :           :                 :- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :  :           :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :  :           :                 +- SubqueryAlias x
                  :        :        :                             :  :           :                    +- Intersect false
                  :        :        :                             :  :           :                       :- Intersect false
                  :        :        :                             :  :           :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :        :                             :  :           :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                             :  :           :                       :  :     +- Join Inner
                  :        :        :                             :  :           :                       :  :        :- Join Inner
                  :        :        :                             :  :           :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :                             :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :                             :  :           :                       :  :        :  +- SubqueryAlias iss
                  :        :        :                             :  :           :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :  :           :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :  :           :                       :  :        +- SubqueryAlias d1
                  :        :        :                             :  :           :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :  :           :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :  :           :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :                             :  :           :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                             :  :           :                       :        +- Join Inner
                  :        :        :                             :  :           :                       :           :- Join Inner
                  :        :        :                             :  :           :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :                             :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :                             :  :           :                       :           :  +- SubqueryAlias ics
                  :        :        :                             :  :           :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :  :           :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :  :           :                       :           +- SubqueryAlias d2
                  :        :        :                             :  :           :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :  :           :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :  :           :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :                             :  :           :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                             :  :           :                             +- Join Inner
                  :        :        :                             :  :           :                                :- Join Inner
                  :        :        :                             :  :           :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :                             :  :           :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :                             :  :           :                                :  +- SubqueryAlias iws
                  :        :        :                             :  :           :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :  :           :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :  :           :                                +- SubqueryAlias d3
                  :        :        :                             :  :           :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :  :           :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :  :           +- Join Inner
                  :        :        :                             :  :              :- Join Inner
                  :        :        :                             :  :              :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :                             :  :              :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :                             :  :              :  +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :  :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :  :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :  :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :  +- Project [channel#20 AS channel#209, i_brand_id#39 AS i_brand_id#210, i_class_id#40 AS i_class_id#211, i_category_id#41 AS i_category_id#212, sales#21 AS sales#213, number_sales#188 AS number_sales#214]
                  :        :        :                             :     +- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
                  :        :        :                             :        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6)))
                  :        :        :                             :           :  +- Project [average_sales#5]
                  :        :        :                             :           :     +- SubqueryAlias avg_sales
                  :        :        :                             :           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :        :                             :           :           +- SubqueryAlias x
                  :        :        :                             :           :              +- Union
                  :        :        :                             :           :                 :- Union
                  :        :        :                             :           :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :        :                             :           :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :        :                             :           :                 :  :     +- Join Inner
                  :        :        :                             :           :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :                             :           :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :                             :           :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :           :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :           :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :        :                             :           :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :                             :           :                 :        +- Join Inner
                  :        :        :                             :           :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :                             :           :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :                             :           :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :           :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :           :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :        :                             :           :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :                             :           :                       +- Join Inner
                  :        :        :                             :           :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :                             :           :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :                             :           :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :           :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :           +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215]
                  :        :        :                             :              +- Filter (((cs_item_sk#113 IN (list#23 []) AND (cs_item_sk#113 = i_item_sk#164)) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :        :                             :                 :  +- Project [ss_item_sk#1]
                  :        :        :                             :                 :     +- SubqueryAlias cross_items
                  :        :        :                             :                 :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :        :                             :                 :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :        :                             :                 :              +- Join Inner
                  :        :        :                             :                 :                 :- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :                 :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :                 :                 +- SubqueryAlias x
                  :        :        :                             :                 :                    +- Intersect false
                  :        :        :                             :                 :                       :- Intersect false
                  :        :        :                             :                 :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :        :                             :                 :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                             :                 :                       :  :     +- Join Inner
                  :        :        :                             :                 :                       :  :        :- Join Inner
                  :        :        :                             :                 :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :                             :                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :                             :                 :                       :  :        :  +- SubqueryAlias iss
                  :        :        :                             :                 :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :                 :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :                 :                       :  :        +- SubqueryAlias d1
                  :        :        :                             :                 :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :                 :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :                 :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :                             :                 :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                             :                 :                       :        +- Join Inner
                  :        :        :                             :                 :                       :           :- Join Inner
                  :        :        :                             :                 :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :                             :                 :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :                             :                 :                       :           :  +- SubqueryAlias ics
                  :        :        :                             :                 :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :                 :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :                 :                       :           +- SubqueryAlias d2
                  :        :        :                             :                 :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :                 :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :                 :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :                             :                 :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                             :                 :                             +- Join Inner
                  :        :        :                             :                 :                                :- Join Inner
                  :        :        :                             :                 :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :                             :                 :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :                             :                 :                                :  +- SubqueryAlias iws
                  :        :        :                             :                 :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :                 :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :                 :                                +- SubqueryAlias d3
                  :        :        :                             :                 :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :                 :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             :                 +- Join Inner
                  :        :        :                             :                    :- Join Inner
                  :        :        :                             :                    :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :                             :                    :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :                             :                    :  +- SubqueryAlias spark_catalog.default.item
                  :        :        :                             :                    :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                             :                    +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                             :                       +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                             +- Project [channel#25 AS channel#216, i_brand_id#39 AS i_brand_id#217, i_class_id#40 AS i_class_id#218, i_category_id#41 AS i_category_id#219, sales#26 AS sales#220, number_sales#196 AS number_sales#221]
                  :        :        :                                +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
                  :        :        :                                   +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6)))
                  :        :        :                                      :  +- Project [average_sales#5]
                  :        :        :                                      :     +- SubqueryAlias avg_sales
                  :        :        :                                      :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :        :                                      :           +- SubqueryAlias x
                  :        :        :                                      :              +- Union
                  :        :        :                                      :                 :- Union
                  :        :        :                                      :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :        :                                      :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :        :                                      :                 :  :     +- Join Inner
                  :        :        :                                      :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :                                      :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :                                      :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                                      :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                                      :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :        :                                      :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :                                      :                 :        +- Join Inner
                  :        :        :                                      :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :                                      :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :                                      :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                                      :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                                      :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :        :                                      :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :        :                                      :                       +- Join Inner
                  :        :        :                                      :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :                                      :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :                                      :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                                      :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                                      +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222]
                  :        :        :                                         +- Filter (((ws_item_sk#135 IN (list#28 []) AND (ws_item_sk#135 = i_item_sk#164)) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :        :                                            :  +- Project [ss_item_sk#1]
                  :        :        :                                            :     +- SubqueryAlias cross_items
                  :        :        :                                            :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :        :                                            :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :        :                                            :              +- Join Inner
                  :        :        :                                            :                 :- SubqueryAlias spark_catalog.default.item
                  :        :        :                                            :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                                            :                 +- SubqueryAlias x
                  :        :        :                                            :                    +- Intersect false
                  :        :        :                                            :                       :- Intersect false
                  :        :        :                                            :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :        :                                            :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                                            :                       :  :     +- Join Inner
                  :        :        :                                            :                       :  :        :- Join Inner
                  :        :        :                                            :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :        :                                            :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :        :                                            :                       :  :        :  +- SubqueryAlias iss
                  :        :        :                                            :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                                            :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                                            :                       :  :        +- SubqueryAlias d1
                  :        :        :                                            :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                                            :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                                            :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :                                            :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                                            :                       :        +- Join Inner
                  :        :        :                                            :                       :           :- Join Inner
                  :        :        :                                            :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :        :                                            :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :        :                                            :                       :           :  +- SubqueryAlias ics
                  :        :        :                                            :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                                            :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                                            :                       :           +- SubqueryAlias d2
                  :        :        :                                            :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                                            :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                                            :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :        :                                            :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :        :                                            :                             +- Join Inner
                  :        :        :                                            :                                :- Join Inner
                  :        :        :                                            :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :                                            :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :                                            :                                :  +- SubqueryAlias iws
                  :        :        :                                            :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :        :                                            :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                                            :                                +- SubqueryAlias d3
                  :        :        :                                            :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                                            :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        :                                            +- Join Inner
                  :        :        :                                               :- Join Inner
                  :        :        :                                               :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :        :                                               :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :        :                                               :  +- SubqueryAlias spark_catalog.default.item
                  :        :        :                                               :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :        :                                               +- SubqueryAlias spark_catalog.default.date_dim
                  :        :        :                                                  +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :        +- Project [channel#15 AS channel#223, i_brand_id#39 AS i_brand_id#224, i_class_id#225 AS i_class_id#226, i_category_id#227 AS i_category_id#228, sum(sum_sales)#229 AS sum(sum_sales)#230, sum(number_sales)#231 AS sum(number_sales)#232]
                  :        :           +- Project [channel#15, i_brand_id#39, cast(i_class_id#30 as int) AS i_class_id#225, cast(i_category_id#31 as int) AS i_category_id#227, sum(sum_sales)#229, sum(number_sales)#231]
                  :        :              +- Aggregate [channel#15, i_brand_id#39], [channel#15, i_brand_id#39, null AS i_class_id#30, null AS i_category_id#31, sum(sum_sales#12) AS sum(sum_sales)#229, sum(number_sales#42) AS sum(number_sales)#231]
                  :        :                 +- SubqueryAlias results
                  :        :                    +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
                  :        :                       +- SubqueryAlias y
                  :        :                          +- Union
                  :        :                             :- Union
                  :        :                             :  :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
                  :        :                             :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6)))
                  :        :                             :  :     :  +- Project [average_sales#5]
                  :        :                             :  :     :     +- SubqueryAlias avg_sales
                  :        :                             :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :                             :  :     :           +- SubqueryAlias x
                  :        :                             :  :     :              +- Union
                  :        :                             :  :     :                 :- Union
                  :        :                             :  :     :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :                             :  :     :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :                             :  :     :                 :  :     +- Join Inner
                  :        :                             :  :     :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :                             :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :                             :  :     :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :  :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :  :     :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :                             :  :     :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :                             :  :     :                 :        +- Join Inner
                  :        :                             :  :     :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :                             :  :     :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :                             :  :     :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :  :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :  :     :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :                             :  :     :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :                             :  :     :                       +- Join Inner
                  :        :                             :  :     :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :                             :  :     :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :                             :  :     :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :  :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :  :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233]
                  :        :                             :  :        +- Filter (((ss_item_sk#51 IN (list#18 []) AND (ss_item_sk#51 = i_item_sk#164)) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :                             :  :           :  +- Project [ss_item_sk#1]
                  :        :                             :  :           :     +- SubqueryAlias cross_items
                  :        :                             :  :           :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :                             :  :           :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :                             :  :           :              +- Join Inner
                  :        :                             :  :           :                 :- SubqueryAlias spark_catalog.default.item
                  :        :                             :  :           :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :  :           :                 +- SubqueryAlias x
                  :        :                             :  :           :                    +- Intersect false
                  :        :                             :  :           :                       :- Intersect false
                  :        :                             :  :           :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :                             :  :           :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                             :  :           :                       :  :     +- Join Inner
                  :        :                             :  :           :                       :  :        :- Join Inner
                  :        :                             :  :           :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :                             :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :                             :  :           :                       :  :        :  +- SubqueryAlias iss
                  :        :                             :  :           :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :                             :  :           :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :  :           :                       :  :        +- SubqueryAlias d1
                  :        :                             :  :           :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :  :           :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :  :           :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :                             :  :           :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                             :  :           :                       :        +- Join Inner
                  :        :                             :  :           :                       :           :- Join Inner
                  :        :                             :  :           :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :                             :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :                             :  :           :                       :           :  +- SubqueryAlias ics
                  :        :                             :  :           :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :                             :  :           :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :  :           :                       :           +- SubqueryAlias d2
                  :        :                             :  :           :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :  :           :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :  :           :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :                             :  :           :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                             :  :           :                             +- Join Inner
                  :        :                             :  :           :                                :- Join Inner
                  :        :                             :  :           :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :                             :  :           :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :                             :  :           :                                :  +- SubqueryAlias iws
                  :        :                             :  :           :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :                             :  :           :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :  :           :                                +- SubqueryAlias d3
                  :        :                             :  :           :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :  :           :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :  :           +- Join Inner
                  :        :                             :  :              :- Join Inner
                  :        :                             :  :              :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :                             :  :              :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :                             :  :              :  +- SubqueryAlias spark_catalog.default.item
                  :        :                             :  :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :  :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :  :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :  +- Project [channel#20 AS channel#234, i_brand_id#39 AS i_brand_id#235, i_class_id#40 AS i_class_id#236, i_category_id#41 AS i_category_id#237, sales#21 AS sales#238, number_sales#188 AS number_sales#239]
                  :        :                             :     +- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
                  :        :                             :        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6)))
                  :        :                             :           :  +- Project [average_sales#5]
                  :        :                             :           :     +- SubqueryAlias avg_sales
                  :        :                             :           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :                             :           :           +- SubqueryAlias x
                  :        :                             :           :              +- Union
                  :        :                             :           :                 :- Union
                  :        :                             :           :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :                             :           :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :                             :           :                 :  :     +- Join Inner
                  :        :                             :           :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :                             :           :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :                             :           :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :           :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :           :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :                             :           :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :                             :           :                 :        +- Join Inner
                  :        :                             :           :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :                             :           :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :                             :           :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :           :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :           :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :                             :           :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :                             :           :                       +- Join Inner
                  :        :                             :           :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :                             :           :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :                             :           :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :           :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :           +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240]
                  :        :                             :              +- Filter (((cs_item_sk#113 IN (list#23 []) AND (cs_item_sk#113 = i_item_sk#164)) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :                             :                 :  +- Project [ss_item_sk#1]
                  :        :                             :                 :     +- SubqueryAlias cross_items
                  :        :                             :                 :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :                             :                 :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :                             :                 :              +- Join Inner
                  :        :                             :                 :                 :- SubqueryAlias spark_catalog.default.item
                  :        :                             :                 :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :                 :                 +- SubqueryAlias x
                  :        :                             :                 :                    +- Intersect false
                  :        :                             :                 :                       :- Intersect false
                  :        :                             :                 :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :                             :                 :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                             :                 :                       :  :     +- Join Inner
                  :        :                             :                 :                       :  :        :- Join Inner
                  :        :                             :                 :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :                             :                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :                             :                 :                       :  :        :  +- SubqueryAlias iss
                  :        :                             :                 :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :                             :                 :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :                 :                       :  :        +- SubqueryAlias d1
                  :        :                             :                 :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :                 :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :                 :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :                             :                 :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                             :                 :                       :        +- Join Inner
                  :        :                             :                 :                       :           :- Join Inner
                  :        :                             :                 :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :                             :                 :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :                             :                 :                       :           :  +- SubqueryAlias ics
                  :        :                             :                 :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :                             :                 :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :                 :                       :           +- SubqueryAlias d2
                  :        :                             :                 :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :                 :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :                 :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :                             :                 :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                             :                 :                             +- Join Inner
                  :        :                             :                 :                                :- Join Inner
                  :        :                             :                 :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :                             :                 :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :                             :                 :                                :  +- SubqueryAlias iws
                  :        :                             :                 :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :                             :                 :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :                 :                                +- SubqueryAlias d3
                  :        :                             :                 :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :                 :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             :                 +- Join Inner
                  :        :                             :                    :- Join Inner
                  :        :                             :                    :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :                             :                    :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :                             :                    :  +- SubqueryAlias spark_catalog.default.item
                  :        :                             :                    :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                             :                    +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                             :                       +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                             +- Project [channel#25 AS channel#241, i_brand_id#39 AS i_brand_id#242, i_class_id#40 AS i_class_id#243, i_category_id#41 AS i_category_id#244, sales#26 AS sales#245, number_sales#196 AS number_sales#246]
                  :        :                                +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
                  :        :                                   +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6)))
                  :        :                                      :  +- Project [average_sales#5]
                  :        :                                      :     +- SubqueryAlias avg_sales
                  :        :                                      :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :        :                                      :           +- SubqueryAlias x
                  :        :                                      :              +- Union
                  :        :                                      :                 :- Union
                  :        :                                      :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :        :                                      :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :        :                                      :                 :  :     +- Join Inner
                  :        :                                      :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :        :                                      :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :                                      :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                                      :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                                      :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :        :                                      :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :                                      :                 :        +- Join Inner
                  :        :                                      :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :                                      :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :                                      :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                                      :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                                      :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :        :                                      :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :        :                                      :                       +- Join Inner
                  :        :                                      :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :        :                                      :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :                                      :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                                      :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                                      +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247]
                  :        :                                         +- Filter (((ws_item_sk#135 IN (list#28 []) AND (ws_item_sk#135 = i_item_sk#164)) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :        :                                            :  +- Project [ss_item_sk#1]
                  :        :                                            :     +- SubqueryAlias cross_items
                  :        :                                            :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :        :                                            :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :        :                                            :              +- Join Inner
                  :        :                                            :                 :- SubqueryAlias spark_catalog.default.item
                  :        :                                            :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                                            :                 +- SubqueryAlias x
                  :        :                                            :                    +- Intersect false
                  :        :                                            :                       :- Intersect false
                  :        :                                            :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :        :                                            :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                                            :                       :  :     +- Join Inner
                  :        :                                            :                       :  :        :- Join Inner
                  :        :                                            :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :        :                                            :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :        :                                            :                       :  :        :  +- SubqueryAlias iss
                  :        :                                            :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :        :                                            :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                                            :                       :  :        +- SubqueryAlias d1
                  :        :                                            :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                                            :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                                            :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :                                            :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                                            :                       :        +- Join Inner
                  :        :                                            :                       :           :- Join Inner
                  :        :                                            :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :        :                                            :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :        :                                            :                       :           :  +- SubqueryAlias ics
                  :        :                                            :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :        :                                            :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                                            :                       :           +- SubqueryAlias d2
                  :        :                                            :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                                            :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                                            :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :        :                                            :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :        :                                            :                             +- Join Inner
                  :        :                                            :                                :- Join Inner
                  :        :                                            :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :                                            :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :                                            :                                :  +- SubqueryAlias iws
                  :        :                                            :                                :     +- SubqueryAlias spark_catalog.default.item
                  :        :                                            :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                                            :                                +- SubqueryAlias d3
                  :        :                                            :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                                            :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        :                                            +- Join Inner
                  :        :                                               :- Join Inner
                  :        :                                               :  :- SubqueryAlias spark_catalog.default.web_sales
                  :        :                                               :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :        :                                               :  +- SubqueryAlias spark_catalog.default.item
                  :        :                                               :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :        :                                               +- SubqueryAlias spark_catalog.default.date_dim
                  :        :                                                  +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :        +- Project [channel#15 AS channel#248, i_brand_id#249 AS i_brand_id#250, i_class_id#251 AS i_class_id#252, i_category_id#253 AS i_category_id#254, sum(sum_sales)#255 AS sum(sum_sales)#256, sum(number_sales)#257 AS sum(number_sales)#258]
                  :           +- Project [channel#15, cast(i_brand_id#32 as int) AS i_brand_id#249, cast(i_class_id#33 as int) AS i_class_id#251, cast(i_category_id#34 as int) AS i_category_id#253, sum(sum_sales)#255, sum(number_sales)#257]
                  :              +- Aggregate [channel#15], [channel#15, null AS i_brand_id#32, null AS i_class_id#33, null AS i_category_id#34, sum(sum_sales#12) AS sum(sum_sales)#255, sum(number_sales#42) AS sum(number_sales)#257]
                  :                 +- SubqueryAlias results
                  :                    +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
                  :                       +- SubqueryAlias y
                  :                          +- Union
                  :                             :- Union
                  :                             :  :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
                  :                             :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6)))
                  :                             :  :     :  +- Project [average_sales#5]
                  :                             :  :     :     +- SubqueryAlias avg_sales
                  :                             :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :                             :  :     :           +- SubqueryAlias x
                  :                             :  :     :              +- Union
                  :                             :  :     :                 :- Union
                  :                             :  :     :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :                             :  :     :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :                             :  :     :                 :  :     +- Join Inner
                  :                             :  :     :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :                             :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :                             :  :     :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :  :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :  :     :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :                             :  :     :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :                             :  :     :                 :        +- Join Inner
                  :                             :  :     :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :                             :  :     :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :                             :  :     :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :  :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :  :     :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :                             :  :     :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :                             :  :     :                       +- Join Inner
                  :                             :  :     :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :                             :  :     :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :                             :  :     :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :  :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :  :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259]
                  :                             :  :        +- Filter (((ss_item_sk#51 IN (list#18 []) AND (ss_item_sk#51 = i_item_sk#164)) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :                             :  :           :  +- Project [ss_item_sk#1]
                  :                             :  :           :     +- SubqueryAlias cross_items
                  :                             :  :           :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :                             :  :           :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :                             :  :           :              +- Join Inner
                  :                             :  :           :                 :- SubqueryAlias spark_catalog.default.item
                  :                             :  :           :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :  :           :                 +- SubqueryAlias x
                  :                             :  :           :                    +- Intersect false
                  :                             :  :           :                       :- Intersect false
                  :                             :  :           :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :                             :  :           :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                             :  :           :                       :  :     +- Join Inner
                  :                             :  :           :                       :  :        :- Join Inner
                  :                             :  :           :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :                             :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :                             :  :           :                       :  :        :  +- SubqueryAlias iss
                  :                             :  :           :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :                             :  :           :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :  :           :                       :  :        +- SubqueryAlias d1
                  :                             :  :           :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :  :           :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :  :           :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :                             :  :           :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                             :  :           :                       :        +- Join Inner
                  :                             :  :           :                       :           :- Join Inner
                  :                             :  :           :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :                             :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :                             :  :           :                       :           :  +- SubqueryAlias ics
                  :                             :  :           :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :                             :  :           :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :  :           :                       :           +- SubqueryAlias d2
                  :                             :  :           :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :  :           :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :  :           :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :                             :  :           :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                             :  :           :                             +- Join Inner
                  :                             :  :           :                                :- Join Inner
                  :                             :  :           :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :                             :  :           :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :                             :  :           :                                :  +- SubqueryAlias iws
                  :                             :  :           :                                :     +- SubqueryAlias spark_catalog.default.item
                  :                             :  :           :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :  :           :                                +- SubqueryAlias d3
                  :                             :  :           :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :  :           :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :  :           +- Join Inner
                  :                             :  :              :- Join Inner
                  :                             :  :              :  :- SubqueryAlias spark_catalog.default.store_sales
                  :                             :  :              :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :                             :  :              :  +- SubqueryAlias spark_catalog.default.item
                  :                             :  :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :  :              +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :  :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :  +- Project [channel#20 AS channel#260, i_brand_id#39 AS i_brand_id#261, i_class_id#40 AS i_class_id#262, i_category_id#41 AS i_category_id#263, sales#21 AS sales#264, number_sales#188 AS number_sales#265]
                  :                             :     +- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
                  :                             :        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6)))
                  :                             :           :  +- Project [average_sales#5]
                  :                             :           :     +- SubqueryAlias avg_sales
                  :                             :           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :                             :           :           +- SubqueryAlias x
                  :                             :           :              +- Union
                  :                             :           :                 :- Union
                  :                             :           :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :                             :           :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :                             :           :                 :  :     +- Join Inner
                  :                             :           :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :                             :           :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :                             :           :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :           :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :           :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :                             :           :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :                             :           :                 :        +- Join Inner
                  :                             :           :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :                             :           :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :                             :           :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :           :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :           :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :                             :           :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :                             :           :                       +- Join Inner
                  :                             :           :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :                             :           :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :                             :           :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :           :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :           +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266]
                  :                             :              +- Filter (((cs_item_sk#113 IN (list#23 []) AND (cs_item_sk#113 = i_item_sk#164)) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :                             :                 :  +- Project [ss_item_sk#1]
                  :                             :                 :     +- SubqueryAlias cross_items
                  :                             :                 :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :                             :                 :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :                             :                 :              +- Join Inner
                  :                             :                 :                 :- SubqueryAlias spark_catalog.default.item
                  :                             :                 :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :                 :                 +- SubqueryAlias x
                  :                             :                 :                    +- Intersect false
                  :                             :                 :                       :- Intersect false
                  :                             :                 :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :                             :                 :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                             :                 :                       :  :     +- Join Inner
                  :                             :                 :                       :  :        :- Join Inner
                  :                             :                 :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :                             :                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :                             :                 :                       :  :        :  +- SubqueryAlias iss
                  :                             :                 :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :                             :                 :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :                 :                       :  :        +- SubqueryAlias d1
                  :                             :                 :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :                 :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :                 :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :                             :                 :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                             :                 :                       :        +- Join Inner
                  :                             :                 :                       :           :- Join Inner
                  :                             :                 :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :                             :                 :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :                             :                 :                       :           :  +- SubqueryAlias ics
                  :                             :                 :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :                             :                 :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :                 :                       :           +- SubqueryAlias d2
                  :                             :                 :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :                 :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :                 :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :                             :                 :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                             :                 :                             +- Join Inner
                  :                             :                 :                                :- Join Inner
                  :                             :                 :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :                             :                 :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :                             :                 :                                :  +- SubqueryAlias iws
                  :                             :                 :                                :     +- SubqueryAlias spark_catalog.default.item
                  :                             :                 :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :                 :                                +- SubqueryAlias d3
                  :                             :                 :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :                 :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             :                 +- Join Inner
                  :                             :                    :- Join Inner
                  :                             :                    :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :                             :                    :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :                             :                    :  +- SubqueryAlias spark_catalog.default.item
                  :                             :                    :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                             :                    +- SubqueryAlias spark_catalog.default.date_dim
                  :                             :                       +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                             +- Project [channel#25 AS channel#267, i_brand_id#39 AS i_brand_id#268, i_class_id#40 AS i_class_id#269, i_category_id#41 AS i_category_id#270, sales#26 AS sales#271, number_sales#196 AS number_sales#272]
                  :                                +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
                  :                                   +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6)))
                  :                                      :  +- Project [average_sales#5]
                  :                                      :     +- SubqueryAlias avg_sales
                  :                                      :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                  :                                      :           +- SubqueryAlias x
                  :                                      :              +- Union
                  :                                      :                 :- Union
                  :                                      :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                  :                                      :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                  :                                      :                 :  :     +- Join Inner
                  :                                      :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                  :                                      :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :                                      :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                  :                                      :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                                      :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                  :                                      :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :                                      :                 :        +- Join Inner
                  :                                      :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                  :                                      :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :                                      :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                  :                                      :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                                      :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                  :                                      :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                  :                                      :                       +- Join Inner
                  :                                      :                          :- SubqueryAlias spark_catalog.default.web_sales
                  :                                      :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :                                      :                          +- SubqueryAlias spark_catalog.default.date_dim
                  :                                      :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                                      +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273]
                  :                                         +- Filter (((ws_item_sk#135 IN (list#28 []) AND (ws_item_sk#135 = i_item_sk#164)) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                  :                                            :  +- Project [ss_item_sk#1]
                  :                                            :     +- SubqueryAlias cross_items
                  :                                            :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                  :                                            :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                  :                                            :              +- Join Inner
                  :                                            :                 :- SubqueryAlias spark_catalog.default.item
                  :                                            :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                                            :                 +- SubqueryAlias x
                  :                                            :                    +- Intersect false
                  :                                            :                       :- Intersect false
                  :                                            :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                  :                                            :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                                            :                       :  :     +- Join Inner
                  :                                            :                       :  :        :- Join Inner
                  :                                            :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                  :                                            :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                  :                                            :                       :  :        :  +- SubqueryAlias iss
                  :                                            :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                  :                                            :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                                            :                       :  :        +- SubqueryAlias d1
                  :                                            :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                  :                                            :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                                            :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :                                            :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                                            :                       :        +- Join Inner
                  :                                            :                       :           :- Join Inner
                  :                                            :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                  :                                            :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                  :                                            :                       :           :  +- SubqueryAlias ics
                  :                                            :                       :           :     +- SubqueryAlias spark_catalog.default.item
                  :                                            :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                                            :                       :           +- SubqueryAlias d2
                  :                                            :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                  :                                            :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                                            :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                  :                                            :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                  :                                            :                             +- Join Inner
                  :                                            :                                :- Join Inner
                  :                                            :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                  :                                            :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :                                            :                                :  +- SubqueryAlias iws
                  :                                            :                                :     +- SubqueryAlias spark_catalog.default.item
                  :                                            :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                                            :                                +- SubqueryAlias d3
                  :                                            :                                   +- SubqueryAlias spark_catalog.default.date_dim
                  :                                            :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  :                                            +- Join Inner
                  :                                               :- Join Inner
                  :                                               :  :- SubqueryAlias spark_catalog.default.web_sales
                  :                                               :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                  :                                               :  +- SubqueryAlias spark_catalog.default.item
                  :                                               :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                  :                                               +- SubqueryAlias spark_catalog.default.date_dim
                  :                                                  +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                  +- Project [cast(channel#35 as string) AS channel#274, cast(i_brand_id#36 as int) AS i_brand_id#275, cast(i_class_id#37 as int) AS i_class_id#276, cast(i_category_id#38 as int) AS i_category_id#277, sum(sum_sales)#278, sum(number_sales)#279]
                     +- Aggregate [null AS channel#35, null AS i_brand_id#36, null AS i_class_id#37, null AS i_category_id#38, sum(sum_sales#12) AS sum(sum_sales)#278, sum(number_sales#42) AS sum(number_sales)#279]
                        +- SubqueryAlias results
                           +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
                              +- SubqueryAlias y
                                 +- Union
                                    :- Union
                                    :  :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
                                    :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6)))
                                    :  :     :  +- Project [average_sales#5]
                                    :  :     :     +- SubqueryAlias avg_sales
                                    :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                                    :  :     :           +- SubqueryAlias x
                                    :  :     :              +- Union
                                    :  :     :                 :- Union
                                    :  :     :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                                    :  :     :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                                    :  :     :                 :  :     +- Join Inner
                                    :  :     :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                                    :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                    :  :     :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                                    :  :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :  :     :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                                    :  :     :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                                    :  :     :                 :        +- Join Inner
                                    :  :     :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                                    :  :     :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                    :  :     :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                                    :  :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :  :     :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                                    :  :     :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                                    :  :     :                       +- Join Inner
                                    :  :     :                          :- SubqueryAlias spark_catalog.default.web_sales
                                    :  :     :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                    :  :     :                          +- SubqueryAlias spark_catalog.default.date_dim
                                    :  :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :  :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280]
                                    :  :        +- Filter (((ss_item_sk#51 IN (list#18 []) AND (ss_item_sk#51 = i_item_sk#164)) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                                    :  :           :  +- Project [ss_item_sk#1]
                                    :  :           :     +- SubqueryAlias cross_items
                                    :  :           :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                                    :  :           :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                                    :  :           :              +- Join Inner
                                    :  :           :                 :- SubqueryAlias spark_catalog.default.item
                                    :  :           :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :  :           :                 +- SubqueryAlias x
                                    :  :           :                    +- Intersect false
                                    :  :           :                       :- Intersect false
                                    :  :           :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                                    :  :           :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                    :  :           :                       :  :     +- Join Inner
                                    :  :           :                       :  :        :- Join Inner
                                    :  :           :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                                    :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                    :  :           :                       :  :        :  +- SubqueryAlias iss
                                    :  :           :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                                    :  :           :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :  :           :                       :  :        +- SubqueryAlias d1
                                    :  :           :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                                    :  :           :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :  :           :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :  :           :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                    :  :           :                       :        +- Join Inner
                                    :  :           :                       :           :- Join Inner
                                    :  :           :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                                    :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                    :  :           :                       :           :  +- SubqueryAlias ics
                                    :  :           :                       :           :     +- SubqueryAlias spark_catalog.default.item
                                    :  :           :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :  :           :                       :           +- SubqueryAlias d2
                                    :  :           :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                                    :  :           :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :  :           :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :  :           :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                    :  :           :                             +- Join Inner
                                    :  :           :                                :- Join Inner
                                    :  :           :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                                    :  :           :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                    :  :           :                                :  +- SubqueryAlias iws
                                    :  :           :                                :     +- SubqueryAlias spark_catalog.default.item
                                    :  :           :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :  :           :                                +- SubqueryAlias d3
                                    :  :           :                                   +- SubqueryAlias spark_catalog.default.date_dim
                                    :  :           :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :  :           +- Join Inner
                                    :  :              :- Join Inner
                                    :  :              :  :- SubqueryAlias spark_catalog.default.store_sales
                                    :  :              :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                    :  :              :  +- SubqueryAlias spark_catalog.default.item
                                    :  :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :  :              +- SubqueryAlias spark_catalog.default.date_dim
                                    :  :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :  +- Project [channel#20 AS channel#281, i_brand_id#39 AS i_brand_id#282, i_class_id#40 AS i_class_id#283, i_category_id#41 AS i_category_id#284, sales#21 AS sales#285, number_sales#188 AS number_sales#286]
                                    :     +- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
                                    :        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6)))
                                    :           :  +- Project [average_sales#5]
                                    :           :     +- SubqueryAlias avg_sales
                                    :           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                                    :           :           +- SubqueryAlias x
                                    :           :              +- Union
                                    :           :                 :- Union
                                    :           :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                                    :           :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                                    :           :                 :  :     +- Join Inner
                                    :           :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                                    :           :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                    :           :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                                    :           :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :           :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                                    :           :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                                    :           :                 :        +- Join Inner
                                    :           :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                                    :           :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                    :           :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                                    :           :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :           :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                                    :           :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                                    :           :                       +- Join Inner
                                    :           :                          :- SubqueryAlias spark_catalog.default.web_sales
                                    :           :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                    :           :                          +- SubqueryAlias spark_catalog.default.date_dim
                                    :           :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :           +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287]
                                    :              +- Filter (((cs_item_sk#113 IN (list#23 []) AND (cs_item_sk#113 = i_item_sk#164)) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                                    :                 :  +- Project [ss_item_sk#1]
                                    :                 :     +- SubqueryAlias cross_items
                                    :                 :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                                    :                 :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                                    :                 :              +- Join Inner
                                    :                 :                 :- SubqueryAlias spark_catalog.default.item
                                    :                 :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                 :                 +- SubqueryAlias x
                                    :                 :                    +- Intersect false
                                    :                 :                       :- Intersect false
                                    :                 :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                                    :                 :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                    :                 :                       :  :     +- Join Inner
                                    :                 :                       :  :        :- Join Inner
                                    :                 :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                                    :                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                    :                 :                       :  :        :  +- SubqueryAlias iss
                                    :                 :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                                    :                 :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                 :                       :  :        +- SubqueryAlias d1
                                    :                 :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                                    :                 :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :                 :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                 :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                    :                 :                       :        +- Join Inner
                                    :                 :                       :           :- Join Inner
                                    :                 :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                                    :                 :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                    :                 :                       :           :  +- SubqueryAlias ics
                                    :                 :                       :           :     +- SubqueryAlias spark_catalog.default.item
                                    :                 :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                 :                       :           +- SubqueryAlias d2
                                    :                 :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                                    :                 :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :                 :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                 :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                    :                 :                             +- Join Inner
                                    :                 :                                :- Join Inner
                                    :                 :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                                    :                 :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                    :                 :                                :  +- SubqueryAlias iws
                                    :                 :                                :     +- SubqueryAlias spark_catalog.default.item
                                    :                 :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                 :                                +- SubqueryAlias d3
                                    :                 :                                   +- SubqueryAlias spark_catalog.default.date_dim
                                    :                 :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :                 +- Join Inner
                                    :                    :- Join Inner
                                    :                    :  :- SubqueryAlias spark_catalog.default.catalog_sales
                                    :                    :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                    :                    :  +- SubqueryAlias spark_catalog.default.item
                                    :                    :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                    +- SubqueryAlias spark_catalog.default.date_dim
                                    :                       +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    +- Project [channel#25 AS channel#288, i_brand_id#39 AS i_brand_id#289, i_class_id#40 AS i_class_id#290, i_category_id#41 AS i_category_id#291, sales#26 AS sales#292, number_sales#196 AS number_sales#293]
                                       +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
                                          +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6)))
                                             :  +- Project [average_sales#5]
                                             :     +- SubqueryAlias avg_sales
                                             :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                                             :           +- SubqueryAlias x
                                             :              +- Union
                                             :                 :- Union
                                             :                 :  :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                                             :                 :  :  +- Filter ((ss_sold_date_sk#47 = d_date_sk#48) AND ((d_year#49 >= 1999) AND (d_year#49 <= 2001)))
                                             :                 :  :     +- Join Inner
                                             :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                                             :                 :  :        :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                             :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                                             :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                             :                 :  +- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                                             :                 :     +- Filter ((cs_sold_date_sk#98 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                                             :                 :        +- Join Inner
                                             :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                                             :                 :           :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                             :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                                             :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                             :                 +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                                             :                    +- Filter ((ws_sold_date_sk#132 = d_date_sk#48) AND ((d_year#49 >= 1998) AND (d_year#49 <= (1998 + 2))))
                                             :                       +- Join Inner
                                             :                          :- SubqueryAlias spark_catalog.default.web_sales
                                             :                          :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                             :                          +- SubqueryAlias spark_catalog.default.date_dim
                                             :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                             +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294]
                                                +- Filter (((ws_item_sk#135 IN (list#28 []) AND (ws_item_sk#135 = i_item_sk#164)) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 = (1998 + 2)) AND (d_moy#76 = 11)))
                                                   :  +- Project [ss_item_sk#1]
                                                   :     +- SubqueryAlias cross_items
                                                   :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                                                   :           +- Filter (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                                                   :              +- Join Inner
                                                   :                 :- SubqueryAlias spark_catalog.default.item
                                                   :                 :  +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                                   :                 +- SubqueryAlias x
                                                   :                    +- Intersect false
                                                   :                       :- Intersect false
                                                   :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                                                   :                       :  :  +- Filter (((ss_item_sk#51 = i_item_sk#164) AND (ss_sold_date_sk#47 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                                   :                       :  :     +- Join Inner
                                                   :                       :  :        :- Join Inner
                                                   :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                                                   :                       :  :        :  :  +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                                   :                       :  :        :  +- SubqueryAlias iss
                                                   :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                                                   :                       :  :        :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                                   :                       :  :        +- SubqueryAlias d1
                                                   :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                                                   :                       :  :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                                   :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                                   :                       :     +- Filter (((cs_item_sk#113 = i_item_sk#164) AND (cs_sold_date_sk#98 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                                   :                       :        +- Join Inner
                                                   :                       :           :- Join Inner
                                                   :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                                                   :                       :           :  :  +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                                   :                       :           :  +- SubqueryAlias ics
                                                   :                       :           :     +- SubqueryAlias spark_catalog.default.item
                                                   :                       :           :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                                   :                       :           +- SubqueryAlias d2
                                                   :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                                                   :                       :                 +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                                   :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                                   :                          +- Filter (((ws_item_sk#135 = i_item_sk#164) AND (ws_sold_date_sk#132 = d_date_sk#48)) AND ((d_year#49 >= 1999) AND (d_year#49 <= (1999 + 2))))
                                                   :                             +- Join Inner
                                                   :                                :- Join Inner
                                                   :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                                                   :                                :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                                   :                                :  +- SubqueryAlias iws
                                                   :                                :     +- SubqueryAlias spark_catalog.default.item
                                                   :                                :        +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                                   :                                +- SubqueryAlias d3
                                                   :                                   +- SubqueryAlias spark_catalog.default.date_dim
                                                   :                                      +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                                   +- Join Inner
                                                      :- Join Inner
                                                      :  :- SubqueryAlias spark_catalog.default.web_sales
                                                      :  :  +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                                      :  +- SubqueryAlias spark_catalog.default.item
                                                      :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                                      +- SubqueryAlias spark_catalog.default.date_dim
                                                         +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#15 ASC NULLS FIRST, i_brand_id#39 ASC NULLS FIRST, i_class_id#40 ASC NULLS FIRST, i_category_id#41 ASC NULLS FIRST], true
      +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
         +- Union
            :- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
            :  +- Union
            :     :- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
            :     :  +- Union
            :     :     :- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42]
            :     :     :  +- Union
            :     :     :     :- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
            :     :     :     :  +- Union
            :     :     :     :     :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :     :     :     :     :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6))))
            :     :     :     :     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :     :     :     :     :     +- Union
            :     :     :     :     :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :     :     :     :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :     :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :     :     :     :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#48]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :     :     :     :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :     :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :     :     :     :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#48]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :     :     :     :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :     :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :     :     :     :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :     :     :     :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :     :     :              +- Project [d_date_sk#48]
            :     :     :     :     :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46]
            :     :     :     :     :        +- Project [ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :           +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :     :              :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :     :     :              :     :- Join LeftSemi, (ss_item_sk#51 = ss_item_sk#1)
            :     :     :     :     :              :     :  :- Project [ss_sold_date_sk#47, ss_item_sk#51, ss_quantity#44, ss_list_price#45]
            :     :     :     :     :              :     :  :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :     :     :              :     :  :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :     :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :     :     :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :     :     :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :     :     :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :     :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :     :     :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :     :     :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :     :     :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :     :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :                 :  :     +- Project [d_date_sk#48]
            :     :     :     :     :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :     :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :     :     :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :     :     :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :     :     :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :     :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :                 :        +- Project [d_date_sk#48]
            :     :     :     :     :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :     :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :     :     :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :     :     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :     :     :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :     :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :                       +- Project [d_date_sk#48]
            :     :     :     :     :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :     :     :     :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :        :  +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :     :     :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :     :     :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :     :     :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :     :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :     :     :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :     :     :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :     :     :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :     :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :                       :  :     +- Project [d_date_sk#48]
            :     :     :     :     :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :     :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :     :     :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :     :     :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :     :     :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :     :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :                       :        +- Project [d_date_sk#48]
            :     :     :     :     :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :     :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :     :     :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :     :     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :     :     :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :     :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :                             +- Project [d_date_sk#48]
            :     :     :     :     :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              +- Project [d_date_sk#48]
            :     :     :     :     :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :     :     :     :     :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6))))
            :     :     :     :     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :     :     :     :     :     +- Union
            :     :     :     :     :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :     :     :     :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :     :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :     :     :     :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#48]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :     :     :     :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :     :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :     :     :     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :     :     :     :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :     :     :        :     +- Project [d_date_sk#48]
            :     :     :     :     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :     :     :     :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :     :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :     :     :     :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :     :     :     :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :     :     :              +- Project [d_date_sk#48]
            :     :     :     :     :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190]
            :     :     :     :     :        +- Project [cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :           +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :     :              :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :     :     :              :     :- Join LeftSemi, (cs_item_sk#113 = ss_item_sk#1)
            :     :     :     :     :              :     :  :- Project [cs_sold_date_sk#98, cs_item_sk#113, cs_quantity#96, cs_list_price#97]
            :     :     :     :     :              :     :  :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :     :     :              :     :  :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :     :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :     :     :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :     :     :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :     :     :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :     :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :     :     :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :     :     :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :     :     :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :     :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :                 :  :     +- Project [d_date_sk#48]
            :     :     :     :     :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :     :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :     :     :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :     :     :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :     :     :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :     :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :                 :        +- Project [d_date_sk#48]
            :     :     :     :     :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :     :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :     :     :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :     :     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :     :     :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :     :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :     :                       +- Project [d_date_sk#48]
            :     :     :     :     :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :     :     :     :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :        :  +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :     :     :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :     :     :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :     :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :     :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :     :     :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :     :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :     :     :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :     :     :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :     :     :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :     :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :     :     :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :                       :  :     +- Project [d_date_sk#48]
            :     :     :     :     :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :     :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :     :     :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :     :     :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :     :     :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :     :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :                       :        +- Project [d_date_sk#48]
            :     :     :     :     :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :     :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :     :     :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :     :     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :     :     :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :     :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :     :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :     :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :     :              :                             +- Project [d_date_sk#48]
            :     :     :     :     :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     :              +- Project [d_date_sk#48]
            :     :     :     :     :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :     :     :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :     +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :     :     :     :        +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6))))
            :     :     :     :           :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :     :     :           :     +- Union
            :     :     :     :           :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :     :     :           :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :           :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :     :     :           :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :     :     :           :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :           :        :     +- Project [d_date_sk#48]
            :     :     :     :           :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :           :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :           :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :     :     :           :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :           :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :     :     :           :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :     :     :           :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :           :        :     +- Project [d_date_sk#48]
            :     :     :     :           :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :     :           :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :           :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :     :     :           :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :           :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :     :     :           :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :     :     :           :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :           :              +- Project [d_date_sk#48]
            :     :     :     :           :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :     :           :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :           +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198]
            :     :     :     :              +- Project [ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                 +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :                    :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :     :                    :     :- Join LeftSemi, (ws_item_sk#135 = ss_item_sk#1)
            :     :     :     :                    :     :  :- Project [ws_sold_date_sk#132, ws_item_sk#135, ws_quantity#130, ws_list_price#131]
            :     :     :     :                    :     :  :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :     :                    :     :  :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :                    :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :     :                    :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :     :                    :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :     :                    :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :                    :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :                    :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :                    :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :                    :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :     :                    :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :                    :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :     :                    :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :     :                    :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :     :                    :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :                    :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :     :                    :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :     :                 :  :     +- Project [d_date_sk#48]
            :     :     :     :                    :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :                    :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :                    :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :                    :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :     :                    :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :     :                    :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :     :                    :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :                    :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :                    :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :     :                 :        +- Project [d_date_sk#48]
            :     :     :     :                    :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :                    :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :                    :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :                    :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :     :                    :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :     :                    :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :     :                    :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :                    :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :                    :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :     :                       +- Project [d_date_sk#48]
            :     :     :     :                    :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :                    :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :                    :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :     :     :                    :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :        :  +- Filter isnotnull(i_item_sk#164)
            :     :     :     :                    :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :     :                    :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :     :                    :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :     :                    :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :                    :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :     :                    :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :                    :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :     :                    :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :     :                    :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :     :                    :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :     :                    :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :     :                    :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :     :                    :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :     :                    :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :     :                    :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :                       :  :     +- Project [d_date_sk#48]
            :     :     :     :                    :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :                    :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :                    :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :     :                    :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :     :                    :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :     :                    :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :     :                    :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :     :                    :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :                    :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :                       :        +- Project [d_date_sk#48]
            :     :     :     :                    :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :                    :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :                    :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :     :                    :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :     :                    :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :     :                    :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :     :                    :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :     :                    :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :     :                    :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :     :     :                    :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :     :                    :                             +- Project [d_date_sk#48]
            :     :     :     :                    :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :     :                    :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     :                    +- Project [d_date_sk#48]
            :     :     :     :                       +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :     :     :                          +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :     +- Aggregate [channel#15, i_brand_id#39, i_class_id#40], [channel#15, i_brand_id#39, i_class_id#40, null AS i_category_id#203, sum(sum_sales#12) AS sum(sum_sales)#205, sum(number_sales#42) AS sum(number_sales)#207]
            :     :     :        +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, i_class_id#40, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
            :     :     :           +- Union
            :     :     :              :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :     :     :              :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6))))
            :     :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :     :              :     :     +- Union
            :     :     :              :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :              :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :     :              :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#48]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :              :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :     :              :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#48]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :     :              :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :              :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :     :              :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :              :     :              +- Project [d_date_sk#48]
            :     :     :              :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :              :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208]
            :     :     :              :        +- Project [ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :           +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :              :              :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :              :              :     :- Join LeftSemi, (ss_item_sk#51 = ss_item_sk#1)
            :     :     :              :              :     :  :- Project [ss_sold_date_sk#47, ss_item_sk#51, ss_quantity#44, ss_list_price#45]
            :     :     :              :              :     :  :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :              :              :     :  :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :              :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :              :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :              :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :              :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :              :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :              :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :              :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :              :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :              :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :                 :  :     +- Project [d_date_sk#48]
            :     :     :              :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :              :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :              :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :              :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :              :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :              :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :                 :        +- Project [d_date_sk#48]
            :     :     :              :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :              :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :              :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :              :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :                       +- Project [d_date_sk#48]
            :     :     :              :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :     :              :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :        :  +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :              :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :              :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :              :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :              :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :              :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :              :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :              :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :              :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :                       :  :     +- Project [d_date_sk#48]
            :     :     :              :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :              :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :              :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :              :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :              :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :              :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :                       :        +- Project [d_date_sk#48]
            :     :     :              :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :              :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :              :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :              :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :                             +- Project [d_date_sk#48]
            :     :     :              :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              +- Project [d_date_sk#48]
            :     :     :              :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :     :              :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :     :     :              :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6))))
            :     :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :     :              :     :     +- Union
            :     :     :              :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :              :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :     :              :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#48]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :              :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :     :              :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :              :     :        :     +- Project [d_date_sk#48]
            :     :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :     :              :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :              :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :     :              :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :              :     :              +- Project [d_date_sk#48]
            :     :     :              :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :              :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215]
            :     :     :              :        +- Project [cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :           +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :              :              :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :              :              :     :- Join LeftSemi, (cs_item_sk#113 = ss_item_sk#1)
            :     :     :              :              :     :  :- Project [cs_sold_date_sk#98, cs_item_sk#113, cs_quantity#96, cs_list_price#97]
            :     :     :              :              :     :  :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :              :              :     :  :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :              :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :              :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :              :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :              :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :              :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :              :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :              :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :              :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :              :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :                 :  :     +- Project [d_date_sk#48]
            :     :     :              :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :              :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :              :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :              :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :              :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :              :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :                 :        +- Project [d_date_sk#48]
            :     :     :              :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :              :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :              :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :              :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :     :                       +- Project [d_date_sk#48]
            :     :     :              :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :     :              :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :        :  +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :              :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :              :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :              :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :              :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :              :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :              :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :              :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :              :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :              :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :              :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :              :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :                       :  :     +- Project [d_date_sk#48]
            :     :     :              :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :              :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :              :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :              :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :              :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :              :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :                       :        +- Project [d_date_sk#48]
            :     :     :              :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :              :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :              :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :              :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :              :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :     :              :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :              :              :                             +- Project [d_date_sk#48]
            :     :     :              :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :              :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              :              +- Project [d_date_sk#48]
            :     :     :              :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :     :              :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :              +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :     :     :                 +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6))))
            :     :     :                    :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :     :                    :     +- Union
            :     :     :                    :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :     :                    :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :                    :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :     :                    :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :     :                    :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :                    :        :     +- Project [d_date_sk#48]
            :     :     :                    :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :                    :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                    :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :     :                    :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :                    :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :     :                    :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :     :                    :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :                    :        :     +- Project [d_date_sk#48]
            :     :     :                    :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :                    :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                    :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :     :                    :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :                    :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :     :                    :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :     :                    :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :                    :              +- Project [d_date_sk#48]
            :     :     :                    :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :     :                    :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                    +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222]
            :     :     :                       +- Project [ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :                             :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :                             :     :- Join LeftSemi, (ws_item_sk#135 = ss_item_sk#1)
            :     :     :                             :     :  :- Project [ws_sold_date_sk#132, ws_item_sk#135, ws_quantity#130, ws_list_price#131]
            :     :     :                             :     :  :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :                             :     :  :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :                             :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :                             :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :                             :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :                             :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :                             :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :                             :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :                             :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :                             :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :                             :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :                             :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :                             :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :                             :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :                             :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :                             :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :                             :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :     :                 :  :     +- Project [d_date_sk#48]
            :     :     :                             :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :                             :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                             :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :                             :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :                             :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :                             :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :                             :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :                             :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :                             :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :     :                 :        +- Project [d_date_sk#48]
            :     :     :                             :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :                             :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                             :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :                             :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :                             :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :                             :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :                             :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :                             :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :     :                             :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :     :                       +- Project [d_date_sk#48]
            :     :     :                             :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :                             :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                             :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :     :                             :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :        :  +- Filter isnotnull(i_item_sk#164)
            :     :     :                             :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :     :                             :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :     :                             :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :     :                             :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :                             :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :     :                             :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :                             :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :     :                             :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :     :                             :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :     :                             :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :     :                             :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :     :                             :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :     :                             :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :     :                             :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :     :                             :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :                       :  :     +- Project [d_date_sk#48]
            :     :     :                             :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :                             :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                             :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :     :                             :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :     :                             :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :     :                             :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :     :                             :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :     :                             :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :     :                             :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :                       :        +- Project [d_date_sk#48]
            :     :     :                             :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :                             :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                             :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :     :                             :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :     :                             :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :     :                             :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :     :                             :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :     :                             :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :     :                             :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :     :                             :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :     :                             :                             +- Project [d_date_sk#48]
            :     :     :                             :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :     :                             :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     :                             +- Project [d_date_sk#48]
            :     :     :                                +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :     :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :     +- Aggregate [channel#15, i_brand_id#39], [channel#15, i_brand_id#39, null AS i_class_id#226, null AS i_category_id#228, sum(sum_sales#12) AS sum(sum_sales)#230, sum(number_sales#42) AS sum(number_sales)#232]
            :     :        +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, i_brand_id#39, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
            :     :           +- Union
            :     :              :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :     :              :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6))))
            :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :              :     :     +- Union
            :     :              :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :              :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :              :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :              :     :        :     +- Project [d_date_sk#48]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :              :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :              :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :              :     :        :     +- Project [d_date_sk#48]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :              :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :              :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :              :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :              :     :              +- Project [d_date_sk#48]
            :     :              :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :              :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233]
            :     :              :        +- Project [ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :           +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :              :              :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :              :              :     :- Join LeftSemi, (ss_item_sk#51 = ss_item_sk#1)
            :     :              :              :     :  :- Project [ss_sold_date_sk#47, ss_item_sk#51, ss_quantity#44, ss_list_price#45]
            :     :              :              :     :  :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :              :              :     :  :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :              :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :              :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :              :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :              :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :              :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :              :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :              :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :              :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :              :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :              :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :              :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :                 :  :     +- Project [d_date_sk#48]
            :     :              :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :              :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :              :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :              :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :              :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :              :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :                 :        +- Project [d_date_sk#48]
            :     :              :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :              :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :              :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :              :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :                       +- Project [d_date_sk#48]
            :     :              :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :              :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :        :  +- Filter isnotnull(i_item_sk#164)
            :     :              :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :              :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :              :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :              :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :              :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :              :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :              :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :              :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :              :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :              :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :              :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :                       :  :     +- Project [d_date_sk#48]
            :     :              :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :              :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :              :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :              :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :              :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :              :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :                       :        +- Project [d_date_sk#48]
            :     :              :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :              :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :              :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :              :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :                             +- Project [d_date_sk#48]
            :     :              :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              +- Project [d_date_sk#48]
            :     :              :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :              :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :     :              :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6))))
            :     :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :              :     :     +- Union
            :     :              :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :              :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :              :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :              :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :              :     :        :     +- Project [d_date_sk#48]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :              :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :              :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :              :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :              :     :        :     +- Project [d_date_sk#48]
            :     :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :              :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :              :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :              :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :              :     :              +- Project [d_date_sk#48]
            :     :              :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :              :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240]
            :     :              :        +- Project [cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :           +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :              :              :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :              :              :     :- Join LeftSemi, (cs_item_sk#113 = ss_item_sk#1)
            :     :              :              :     :  :- Project [cs_sold_date_sk#98, cs_item_sk#113, cs_quantity#96, cs_list_price#97]
            :     :              :              :     :  :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :              :              :     :  :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :              :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :              :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :              :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :              :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :              :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :              :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :              :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :              :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :              :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :              :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :              :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :                 :  :     +- Project [d_date_sk#48]
            :     :              :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :              :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :              :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :              :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :              :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :              :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :                 :        +- Project [d_date_sk#48]
            :     :              :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :              :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :              :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :              :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :     :                       +- Project [d_date_sk#48]
            :     :              :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :              :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :        :  +- Filter isnotnull(i_item_sk#164)
            :     :              :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :              :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :              :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :              :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :              :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :              :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :              :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :              :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :              :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :              :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :              :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :              :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :              :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :                       :  :     +- Project [d_date_sk#48]
            :     :              :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :              :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :              :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :              :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :              :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :              :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :                       :        +- Project [d_date_sk#48]
            :     :              :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :              :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :              :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :              :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :              :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :              :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :              :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :              :              :                             +- Project [d_date_sk#48]
            :     :              :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :              :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              :              +- Project [d_date_sk#48]
            :     :              :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :              :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :              +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :     :                 +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6))))
            :     :                    :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :     :                    :     +- Union
            :     :                    :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :     :                    :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :                    :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :     :                    :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :     :                    :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :                    :        :     +- Project [d_date_sk#48]
            :     :                    :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :                    :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                    :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :     :                    :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :                    :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :     :                    :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :     :                    :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :                    :        :     +- Project [d_date_sk#48]
            :     :                    :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :                    :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                    :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :     :                    :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :                    :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :     :                    :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :     :                    :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :                    :              +- Project [d_date_sk#48]
            :     :                    :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :     :                    :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                    +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247]
            :     :                       +- Project [ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :                             :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :                             :     :- Join LeftSemi, (ws_item_sk#135 = ss_item_sk#1)
            :     :                             :     :  :- Project [ws_sold_date_sk#132, ws_item_sk#135, ws_quantity#130, ws_list_price#131]
            :     :                             :     :  :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :                             :     :  :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :                             :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :                             :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :                             :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :                             :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :                             :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :                             :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :                             :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :                             :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :                             :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :                             :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :                             :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :                             :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :                             :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :                             :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :                             :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :     :                 :  :     +- Project [d_date_sk#48]
            :     :                             :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :                             :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                             :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :                             :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :                             :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :                             :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :                             :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :                             :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :     :                             :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :     :                 :        +- Project [d_date_sk#48]
            :     :                             :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :                             :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                             :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :                             :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :                             :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :                             :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :                             :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :                             :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :     :                             :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :     :                       +- Project [d_date_sk#48]
            :     :                             :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :                             :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                             :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :     :                             :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :        :  +- Filter isnotnull(i_item_sk#164)
            :     :                             :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :     :                             :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :     :                             :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :     :                             :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :                             :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :     :                             :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :                             :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :     :                             :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :     :                             :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :     :                             :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :     :                             :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :     :                             :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :     :                             :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :     :                             :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :     :                             :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :                       :  :     +- Project [d_date_sk#48]
            :     :                             :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :                             :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                             :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :     :                             :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :     :                             :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :     :                             :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :     :                             :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :     :                             :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :     :                             :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :                       :        +- Project [d_date_sk#48]
            :     :                             :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :                             :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                             :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :     :                             :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :     :                             :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :     :                             :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :     :                             :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :     :                             :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :     :                             :                             :        +- Filter isnotnull(i_item_sk#164)
            :     :                             :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :     :                             :                             +- Project [d_date_sk#48]
            :     :                             :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :     :                             :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     :                             +- Project [d_date_sk#48]
            :     :                                +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :     :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :     +- Aggregate [channel#15], [channel#15, null AS i_brand_id#250, null AS i_class_id#252, null AS i_category_id#254, sum(sum_sales#12) AS sum(sum_sales)#256, sum(number_sales#42) AS sum(number_sales)#258]
            :        +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [channel#15, sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
            :           +- Union
            :              :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :              :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6))))
            :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :              :     :     +- Union
            :              :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :              :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :              :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :              :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :              :     :        :     +- Project [d_date_sk#48]
            :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :              :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :              :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :              :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :              :     :        :     +- Project [d_date_sk#48]
            :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :              :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :              :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :              :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :              :     :              +- Project [d_date_sk#48]
            :              :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :              :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259]
            :              :        +- Project [ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :           +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :              :              :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :              :              :     :- Join LeftSemi, (ss_item_sk#51 = ss_item_sk#1)
            :              :              :     :  :- Project [ss_sold_date_sk#47, ss_item_sk#51, ss_quantity#44, ss_list_price#45]
            :              :              :     :  :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :              :              :     :  :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :              :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :              :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :              :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :              :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :              :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :              :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :              :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :              :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :              :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :              :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :              :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :                 :  :     +- Project [d_date_sk#48]
            :              :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :              :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :              :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :              :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :              :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :              :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :              :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :                 :        +- Project [d_date_sk#48]
            :              :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :              :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :              :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :              :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :              :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :                       +- Project [d_date_sk#48]
            :              :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :              :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :        :  +- Filter isnotnull(i_item_sk#164)
            :              :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :              :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :              :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :              :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :              :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :              :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :              :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :              :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :              :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :              :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :              :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :                       :  :     +- Project [d_date_sk#48]
            :              :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :              :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :              :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :              :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :              :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :              :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :              :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :                       :        +- Project [d_date_sk#48]
            :              :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :              :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :              :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :              :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :              :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :              :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :                             +- Project [d_date_sk#48]
            :              :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              +- Project [d_date_sk#48]
            :              :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :              :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :              :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6))))
            :              :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :              :     :     +- Union
            :              :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :              :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :              :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :              :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :              :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :              :     :        :     +- Project [d_date_sk#48]
            :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :              :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :              :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :              :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :              :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :              :     :        :     +- Project [d_date_sk#48]
            :              :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :              :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :              :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :              :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :              :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :              :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :              :     :              +- Project [d_date_sk#48]
            :              :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :              :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266]
            :              :        +- Project [cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :           +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :              :              :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :              :              :     :- Join LeftSemi, (cs_item_sk#113 = ss_item_sk#1)
            :              :              :     :  :- Project [cs_sold_date_sk#98, cs_item_sk#113, cs_quantity#96, cs_list_price#97]
            :              :              :     :  :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :              :              :     :  :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :              :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :              :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :              :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :              :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :              :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :              :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :              :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :              :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :              :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :              :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :              :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :                 :  :     +- Project [d_date_sk#48]
            :              :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :              :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :              :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :              :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :              :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :              :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :              :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :                 :        +- Project [d_date_sk#48]
            :              :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :              :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :              :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :              :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :              :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :              :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :              :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :     :                       +- Project [d_date_sk#48]
            :              :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :              :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :        :  +- Filter isnotnull(i_item_sk#164)
            :              :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :              :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :              :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :              :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :              :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :              :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :              :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :              :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :              :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :              :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :              :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :              :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :              :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :                       :  :     +- Project [d_date_sk#48]
            :              :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :              :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :              :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :              :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :              :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :              :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :              :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :                       :        +- Project [d_date_sk#48]
            :              :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :              :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :              :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :              :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :              :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :              :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :              :              :                             :        +- Filter isnotnull(i_item_sk#164)
            :              :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :              :              :                             +- Project [d_date_sk#48]
            :              :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :              :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              :              +- Project [d_date_sk#48]
            :              :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :              :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :              +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :                 +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6))))
            :                    :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
            :                    :     +- Union
            :                    :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :                    :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :                    :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :                    :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
            :                    :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :                    :        :     +- Project [d_date_sk#48]
            :                    :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :                    :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                    :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :                    :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :                    :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :                    :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
            :                    :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :                    :        :     +- Project [d_date_sk#48]
            :                    :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :                    :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                    :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :                    :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :                    :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :                    :              :  +- Filter isnotnull(ws_sold_date_sk#132)
            :                    :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :                    :              +- Project [d_date_sk#48]
            :                    :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :                    :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                    +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273]
            :                       +- Project [ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :                             :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :                             :     :- Join LeftSemi, (ws_item_sk#135 = ss_item_sk#1)
            :                             :     :  :- Project [ws_sold_date_sk#132, ws_item_sk#135, ws_quantity#130, ws_list_price#131]
            :                             :     :  :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :                             :     :  :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :                             :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
            :                             :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :                             :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :                             :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :                             :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :                             :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :                             :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :                             :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :                             :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :                             :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :                             :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :                             :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :                             :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :                             :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :                             :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :     :                 :  :     +- Project [d_date_sk#48]
            :                             :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :                             :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                             :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :                             :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :                             :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :                             :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :                             :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :                             :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
            :                             :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :     :                 :        +- Project [d_date_sk#48]
            :                             :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :                             :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                             :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :                             :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :                             :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :                             :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :                             :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :                             :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :     :                       :        +- Filter isnotnull(i_item_sk#164)
            :                             :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :     :                       +- Project [d_date_sk#48]
            :                             :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :                             :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                             :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
            :                             :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :        :  +- Filter isnotnull(i_item_sk#164)
            :                             :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :        +- Project [i_item_sk#164 AS ss_item_sk#1]
            :                             :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
            :                             :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :                             :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :                             :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
            :                             :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :                             :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
            :                             :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :                             :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
            :                             :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
            :                             :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
            :                             :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :                             :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
            :                             :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :                             :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :                       :  :     +- Project [d_date_sk#48]
            :                             :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :                             :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                             :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
            :                             :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
            :                             :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
            :                             :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :                             :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
            :                             :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                       :        :        +- Filter isnotnull(i_item_sk#164)
            :                             :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :                       :        +- Project [d_date_sk#48]
            :                             :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :                             :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                             :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
            :                             :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
            :                             :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
            :                             :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :                             :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
            :                             :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :                             :                             :        +- Filter isnotnull(i_item_sk#164)
            :                             :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
            :                             :                             +- Project [d_date_sk#48]
            :                             :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :                             :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            :                             +- Project [d_date_sk#48]
            :                                +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
            +- Aggregate [null AS channel#274, null AS i_brand_id#275, null AS i_class_id#276, null AS i_category_id#277, sum(sum_sales#12) AS sum(sum_sales)#278, sum(number_sales#42) AS sum(number_sales)#279]
               +- Aggregate [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], [sum(sales#16) AS sum_sales#12, sum(number_sales#43) AS number_sales#42]
                  +- Union
                     :- Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
                     :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280 as decimal(32,6)) > cast(scalar-subquery#14 [] as decimal(32,6))))
                     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                     :     :     +- Union
                     :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                     :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                     :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
                     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
                     :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                     :     :        :     +- Project [d_date_sk#48]
                     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                     :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                     :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
                     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
                     :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                     :     :        :     +- Project [d_date_sk#48]
                     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
                     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                     :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                     :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
                     :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
                     :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                     :     :              +- Project [d_date_sk#48]
                     :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
                     :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [store AS channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#16, count(1) AS number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280]
                     :        +- Project [ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :           +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                     :              :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
                     :              :     :- Join LeftSemi, (ss_item_sk#51 = ss_item_sk#1)
                     :              :     :  :- Project [ss_sold_date_sk#47, ss_item_sk#51, ss_quantity#44, ss_list_price#45]
                     :              :     :  :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
                     :              :     :  :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                     :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
                     :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                     :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
                     :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                     :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                     :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
                     :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
                     :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
                     :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                     :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
                     :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :                 :  :     +- Project [d_date_sk#48]
                     :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                     :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
                     :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
                     :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
                     :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                     :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
                     :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :                 :        +- Project [d_date_sk#48]
                     :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                     :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
                     :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
                     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
                     :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                     :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
                     :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :                       +- Project [d_date_sk#48]
                     :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
                     :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :        :  +- Filter isnotnull(i_item_sk#164)
                     :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                     :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                     :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
                     :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                     :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                     :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
                     :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
                     :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
                     :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                     :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
                     :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :                       :  :     +- Project [d_date_sk#48]
                     :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                     :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
                     :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
                     :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
                     :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                     :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
                     :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :                       :        +- Project [d_date_sk#48]
                     :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                     :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
                     :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
                     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
                     :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                     :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                             :        +- Filter isnotnull(i_item_sk#164)
                     :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :                             +- Project [d_date_sk#48]
                     :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              +- Project [d_date_sk#48]
                     :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
                     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :- Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
                     :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287 as decimal(32,6)) > cast(scalar-subquery#19 [] as decimal(32,6))))
                     :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                     :     :     +- Union
                     :     :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                     :     :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                     :     :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
                     :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
                     :     :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                     :     :        :     +- Project [d_date_sk#48]
                     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :     :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                     :     :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                     :     :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
                     :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
                     :     :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                     :     :        :     +- Project [d_date_sk#48]
                     :     :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
                     :     :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :     :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                     :     :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                     :     :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
                     :     :              :  +- Filter isnotnull(ws_sold_date_sk#132)
                     :     :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                     :     :              +- Project [d_date_sk#48]
                     :     :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
                     :     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :     +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [catalog AS channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#21, count(1) AS number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287]
                     :        +- Project [cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :           +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                     :              :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
                     :              :     :- Join LeftSemi, (cs_item_sk#113 = ss_item_sk#1)
                     :              :     :  :- Project [cs_sold_date_sk#98, cs_item_sk#113, cs_quantity#96, cs_list_price#97]
                     :              :     :  :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
                     :              :     :  :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                     :              :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
                     :              :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                     :              :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
                     :              :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                     :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                     :              :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
                     :              :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
                     :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
                     :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                     :              :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
                     :              :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :                 :  :     +- Project [d_date_sk#48]
                     :              :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                     :              :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
                     :              :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
                     :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
                     :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                     :              :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
                     :              :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :                 :        +- Project [d_date_sk#48]
                     :              :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                     :              :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
                     :              :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
                     :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
                     :              :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                     :              :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :     :                       :        +- Filter isnotnull(i_item_sk#164)
                     :              :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :     :                       +- Project [d_date_sk#48]
                     :              :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
                     :              :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :        :  +- Filter isnotnull(i_item_sk#164)
                     :              :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                     :              :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                     :              :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
                     :              :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                     :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                     :              :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                     :              :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                     :              :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
                     :              :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
                     :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
                     :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                     :              :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
                     :              :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :                       :  :     +- Project [d_date_sk#48]
                     :              :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                     :              :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
                     :              :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
                     :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
                     :              :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                     :              :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                       :        :        +- Filter isnotnull(i_item_sk#164)
                     :              :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :                       :        +- Project [d_date_sk#48]
                     :              :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                     :              :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
                     :              :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
                     :              :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
                     :              :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                     :              :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                     :              :                             :        +- Filter isnotnull(i_item_sk#164)
                     :              :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                     :              :                             +- Project [d_date_sk#48]
                     :              :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                     :              :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     :              +- Project [d_date_sk#48]
                     :                 +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
                     :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                     +- Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
                        +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294 as decimal(32,6)) > cast(scalar-subquery#24 [] as decimal(32,6))))
                           :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                           :     +- Union
                           :        :- Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
                           :        :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                           :        :     :- Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
                           :        :     :  +- Filter isnotnull(ss_sold_date_sk#47)
                           :        :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                           :        :     +- Project [d_date_sk#48]
                           :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                           :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                           :        :- Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
                           :        :  +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                           :        :     :- Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
                           :        :     :  +- Filter isnotnull(cs_sold_date_sk#98)
                           :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                           :        :     +- Project [d_date_sk#48]
                           :        :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
                           :        :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                           :        +- Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
                           :           +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                           :              :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
                           :              :  +- Filter isnotnull(ws_sold_date_sk#132)
                           :              :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                           :              +- Project [d_date_sk#48]
                           :                 +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
                           :                    +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                           +- Aggregate [i_brand_id#39, i_class_id#40, i_category_id#41], [web AS channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#26, count(1) AS number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294]
                              +- Project [ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
                                 +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                                    :- Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
                                    :     :- Join LeftSemi, (ws_item_sk#135 = ss_item_sk#1)
                                    :     :  :- Project [ws_sold_date_sk#132, ws_item_sk#135, ws_quantity#130, ws_list_price#131]
                                    :     :  :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
                                    :     :  :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                    :     :  +- Project [i_item_sk#164 AS ss_item_sk#1]
                                    :     :     +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                                    :     :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :        :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
                                    :     :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                                    :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                                    :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                                    :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                                    :     :                 :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                                    :     :                 :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                                    :     :                 :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                 :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
                                    :     :                 :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
                                    :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
                                    :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                    :     :                 :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
                                    :     :                 :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :     :                 :  :     +- Project [d_date_sk#48]
                                    :     :                 :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                                    :     :                 :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :     :                 :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                 :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                                    :     :                 :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                 :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
                                    :     :                 :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
                                    :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
                                    :     :                 :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                    :     :                 :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                 :        :        +- Filter isnotnull(i_item_sk#164)
                                    :     :                 :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :     :                 :        +- Project [d_date_sk#48]
                                    :     :                 :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                                    :     :                 :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :     :                 +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                    +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                                    :     :                       :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                       :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
                                    :     :                       :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
                                    :     :                       :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
                                    :     :                       :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                    :     :                       :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :     :                       :        +- Filter isnotnull(i_item_sk#164)
                                    :     :                       :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :     :                       +- Project [d_date_sk#48]
                                    :     :                          +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                                    :     :                             +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :     +- Join LeftSemi, (i_item_sk#164 = ss_item_sk#1)
                                    :        :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :        :  +- Filter isnotnull(i_item_sk#164)
                                    :        :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :        +- Project [i_item_sk#164 AS ss_item_sk#1]
                                    :           +- Join Inner, (((i_brand_id#39 = brand_id#2) AND (i_class_id#40 = class_id#3)) AND (i_category_id#41 = category_id#4))
                                    :              :- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :              :  +- Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
                                    :              :     +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                                    :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                                    :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                                    :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#39) AND (class_id#3 <=> i_class_id#40)) AND (category_id#4 <=> i_category_id#41))
                                    :                       :  :- Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
                                    :                       :  :  +- Join Inner, (ss_sold_date_sk#47 = d_date_sk#48)
                                    :                       :  :     :- Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                       :  :     :  +- Join Inner, (ss_item_sk#51 = i_item_sk#164)
                                    :                       :  :     :     :- Project [ss_sold_date_sk#47, ss_item_sk#51]
                                    :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
                                    :                       :  :     :     :     +- Relation[ss_sold_date_sk#47,ss_sold_time_sk#50,ss_item_sk#51,ss_customer_sk#52,ss_cdemo_sk#53,ss_hdemo_sk#54,ss_addr_sk#55,ss_store_sk#56,ss_promo_sk#57,ss_ticket_number#58,ss_quantity#44,ss_wholesale_cost#59,ss_list_price#45,ss_sales_price#60,ss_ext_discount_amt#61,ss_ext_sales_price#62,ss_ext_wholesale_cost#63,ss_ext_list_price#64,ss_ext_tax#65,ss_coupon_amt#66,ss_net_paid#67,ss_net_paid_inc_tax#68,ss_net_profit#69] parquet
                                    :                       :  :     :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                       :  :     :        +- Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
                                    :                       :  :     :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                       :  :     +- Project [d_date_sk#48]
                                    :                       :  :        +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                                    :                       :  :           +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :                       :  +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                       :     +- Join Inner, (cs_sold_date_sk#98 = d_date_sk#48)
                                    :                       :        :- Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                       :        :  +- Join Inner, (cs_item_sk#113 = i_item_sk#164)
                                    :                       :        :     :- Project [cs_sold_date_sk#98, cs_item_sk#113]
                                    :                       :        :     :  +- Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
                                    :                       :        :     :     +- Relation[cs_sold_date_sk#98,cs_sold_time_sk#99,cs_ship_date_sk#100,cs_bill_customer_sk#101,cs_bill_cdemo_sk#102,cs_bill_hdemo_sk#103,cs_bill_addr_sk#104,cs_ship_customer_sk#105,cs_ship_cdemo_sk#106,cs_ship_hdemo_sk#107,cs_ship_addr_sk#108,cs_call_center_sk#109,cs_catalog_page_sk#110,cs_ship_mode_sk#111,cs_warehouse_sk#112,cs_item_sk#113,cs_promo_sk#114,cs_order_number#115,cs_quantity#96,cs_wholesale_cost#116,cs_list_price#97,cs_sales_price#117,cs_ext_discount_amt#118,cs_ext_sales_price#119,cs_ext_wholesale_cost#120,cs_ext_list_price#121,cs_ext_tax#122,cs_coupon_amt#123,cs_ext_ship_cost#124,cs_net_paid#125,cs_net_paid_inc_tax#126,cs_net_paid_inc_ship#127,cs_net_paid_inc_ship_tax#128,cs_net_profit#129] parquet
                                    :                       :        :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                       :        :        +- Filter isnotnull(i_item_sk#164)
                                    :                       :        :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                       :        +- Project [d_date_sk#48]
                                    :                       :           +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                                    :                       :              +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    :                       +- Project [i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                          +- Join Inner, (ws_sold_date_sk#132 = d_date_sk#48)
                                    :                             :- Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                             :  +- Join Inner, (ws_item_sk#135 = i_item_sk#164)
                                    :                             :     :- Project [ws_sold_date_sk#132, ws_item_sk#135]
                                    :                             :     :  +- Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
                                    :                             :     :     +- Relation[ws_sold_date_sk#132,ws_sold_time_sk#133,ws_ship_date_sk#134,ws_item_sk#135,ws_bill_customer_sk#136,ws_bill_cdemo_sk#137,ws_bill_hdemo_sk#138,ws_bill_addr_sk#139,ws_ship_customer_sk#140,ws_ship_cdemo_sk#141,ws_ship_hdemo_sk#142,ws_ship_addr_sk#143,ws_web_page_sk#144,ws_web_site_sk#145,ws_ship_mode_sk#146,ws_warehouse_sk#147,ws_promo_sk#148,ws_order_number#149,ws_quantity#130,ws_wholesale_cost#150,ws_list_price#131,ws_sales_price#151,ws_ext_discount_amt#152,ws_ext_sales_price#153,ws_ext_wholesale_cost#154,ws_ext_list_price#155,ws_ext_tax#156,ws_coupon_amt#157,ws_ext_ship_cost#158,ws_net_paid#159,ws_net_paid_inc_tax#160,ws_net_paid_inc_ship#161,ws_net_paid_inc_ship_tax#162,ws_net_profit#163] parquet
                                    :                             :     +- Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
                                    :                             :        +- Filter isnotnull(i_item_sk#164)
                                    :                             :           +- Relation[i_item_sk#164,i_item_id#165,i_rec_start_date#166,i_rec_end_date#167,i_item_desc#168,i_current_price#169,i_wholesale_cost#170,i_brand_id#39,i_brand#171,i_class_id#40,i_class#172,i_category_id#41,i_category#173,i_manufact_id#174,i_manufact#175,i_size#176,i_formulation#177,i_color#178,i_units#179,i_container#180,i_manager_id#181,i_product_name#182] parquet
                                    :                             +- Project [d_date_sk#48]
                                    :                                +- Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
                                    :                                   +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet
                                    +- Project [d_date_sk#48]
                                       +- Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
                                          +- Relation[d_date_sk#48,d_date_id#70,d_date#71,d_month_seq#72,d_week_seq#73,d_quarter_seq#74,d_year#49,d_dow#75,d_moy#76,d_dom#77,d_qoy#78,d_fy_year#79,d_fy_quarter_seq#80,d_fy_week_seq#81,d_day_name#82,d_quarter_name#83,d_holiday#84,d_weekend#85,d_following_holiday#86,d_first_dom#87,d_last_dom#88,d_same_day_ly#89,d_same_day_lq#90,d_current_day#91,d_current_week#92,d_current_month#93,d_current_quarter#94,d_current_year#95] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[channel#15 ASC NULLS FIRST,i_brand_id#39 ASC NULLS FIRST,i_class_id#40 ASC NULLS FIRST,i_category_id#41 ASC NULLS FIRST], output=[channel#15,i_brand_id#39,i_class_id#40,i_category_id#41,sum_sales#12,number_sales#42])
+- *(412) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
   +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42, 5), true, [id=#295]
      +- *(411) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
         +- Union
            :- *(329) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
            :  +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42, 5), true, [id=#296]
            :     +- *(328) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
            :        +- Union
            :           :- *(246) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
            :           :  +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42, 5), true, [id=#297]
            :           :     +- *(245) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
            :           :        +- Union
            :           :           :- *(163) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
            :           :           :  +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42, 5), true, [id=#298]
            :           :           :     +- *(162) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42], functions=[], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
            :           :           :        +- Union
            :           :           :           :- *(80) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(sales#16), sum(number_sales#43)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum_sales#12, number_sales#42])
            :           :           :           :  +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#299]
            :           :           :           :     +- *(79) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(sales#16), partial_sum(number_sales#43)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum#300, isEmpty#301, sum#302])
            :           :           :           :        +- Union
            :           :           :           :           :- *(26) Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :           :           :           :           :  +- *(26) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46 as decimal(32,6)) > cast(Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :           :           :           :     :  +- Subquery scalar-subquery#14, [id=#303]
            :           :           :           :           :     :     +- *(8) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5])
            :           :           :           :           :     :        +- Exchange SinglePartition, true, [id=#304]
            :           :           :           :           :     :           +- *(7) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#305, count#306])
            :           :           :           :           :     :              +- Union
            :           :           :           :           :     :                 :- *(2) Project [ss_quantity#44 AS quantity#6, ss_list_price#45 AS list_price#7]
            :           :           :           :           :     :                 :  +- *(2) BroadcastHashJoin [ss_sold_date_sk#47], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :     :                 :     :- *(2) Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45]
            :           :           :           :           :     :                 :     :  +- *(2) Filter isnotnull(ss_sold_date_sk#47)
            :           :           :           :           :     :                 :     :     +- *(2) ColumnarToRow
            :           :           :           :           :     :                 :     :        +- FileScan parquet default.store_sales[ss_sold_date_sk#47,ss_quantity#44,ss_list_price#45] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
            :           :           :           :           :     :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#307]
            :           :           :           :           :     :                 :        +- *(1) Project [d_date_sk#48]
            :           :           :           :           :     :                 :           +- *(1) Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :           :           :           :           :     :                 :              +- *(1) ColumnarToRow
            :           :           :           :           :     :                 :                 +- FileScan parquet default.date_dim[d_date_sk#48,d_year#49] Batched: true, DataFilters: [isnotnull(d_year#49), (d_year#49 >= 1999), (d_year#49 <= 2001), isnotnull(d_date_sk#48)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
            :           :           :           :           :     :                 :- *(4) Project [cs_quantity#96 AS quantity#8, cs_list_price#97 AS list_price#9]
            :           :           :           :           :     :                 :  +- *(4) BroadcastHashJoin [cs_sold_date_sk#98], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :     :                 :     :- *(4) Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97]
            :           :           :           :           :     :                 :     :  +- *(4) Filter isnotnull(cs_sold_date_sk#98)
            :           :           :           :           :     :                 :     :     +- *(4) ColumnarToRow
            :           :           :           :           :     :                 :     :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#98,cs_quantity#96,cs_list_price#97] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#98)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
            :           :           :           :           :     :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#308]
            :           :           :           :           :     :                 :        +- *(3) Project [d_date_sk#48]
            :           :           :           :           :     :                 :           +- *(3) Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1998)) AND (d_year#49 <= 2000)) AND isnotnull(d_date_sk#48))
            :           :           :           :           :     :                 :              +- *(3) ColumnarToRow
            :           :           :           :           :     :                 :                 +- FileScan parquet default.date_dim[d_date_sk#48,d_year#49] Batched: true, DataFilters: [isnotnull(d_year#49), (d_year#49 >= 1998), (d_year#49 <= 2000), isnotnull(d_date_sk#48)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
            :           :           :           :           :     :                 +- *(6) Project [ws_quantity#130 AS quantity#10, ws_list_price#131 AS list_price#11]
            :           :           :           :           :     :                    +- *(6) BroadcastHashJoin [ws_sold_date_sk#132], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :     :                       :- *(6) Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131]
            :           :           :           :           :     :                       :  +- *(6) Filter isnotnull(ws_sold_date_sk#132)
            :           :           :           :           :     :                       :     +- *(6) ColumnarToRow
            :           :           :           :           :     :                       :        +- FileScan parquet default.web_sales[ws_sold_date_sk#132,ws_quantity#130,ws_list_price#131] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#132)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
            :           :           :           :           :     :                       +- ReusedExchange [d_date_sk#48], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#308]
            :           :           :           :           :     +- *(26) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#46])
            :           :           :           :           :        +- Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#309]
            :           :           :           :           :           +- *(25) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#39, i_class_id#40, i_category_id#41, sum#310, isEmpty#311, count#312])
            :           :           :           :           :              +- *(25) Project [ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                 +- *(25) BroadcastHashJoin [ss_sold_date_sk#47], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :                    :- *(25) Project [ss_sold_date_sk#47, ss_quantity#44, ss_list_price#45, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :  +- *(25) BroadcastHashJoin [ss_item_sk#51], [i_item_sk#164], Inner, BuildRight
            :           :           :           :           :                    :     :- *(25) BroadcastHashJoin [ss_item_sk#51], [ss_item_sk#1], LeftSemi, BuildRight
            :           :           :           :           :                    :     :  :- *(25) Project [ss_sold_date_sk#47, ss_item_sk#51, ss_quantity#44, ss_list_price#45]
            :           :           :           :           :                    :     :  :  +- *(25) Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :           :           :           :           :                    :     :  :     +- *(25) ColumnarToRow
            :           :           :           :           :                    :     :  :        +- FileScan parquet default.store_sales[ss_sold_date_sk#47,ss_item_sk#51,ss_quantity#44,ss_list_price#45] Batched: true, DataFilters: [isnotnull(ss_item_sk#51), isnotnull(ss_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
            :           :           :           :           :                    :     :  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#313]
            :           :           :           :           :                    :     :     +- *(11) Project [i_item_sk#164 AS ss_item_sk#1]
            :           :           :           :           :                    :     :        +- *(11) BroadcastHashJoin [i_brand_id#39, i_class_id#40, i_category_id#41], [brand_id#2, class_id#3, category_id#4], Inner, BuildRight
            :           :           :           :           :                    :     :           :- *(11) Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :           :  +- *(11) Filter ((isnotnull(i_class_id#40) AND isnotnull(i_category_id#41)) AND isnotnull(i_brand_id#39))
            :           :           :           :           :                    :     :           :     +- *(11) ColumnarToRow
            :           :           :           :           :                    :     :           :        +- FileScan parquet default.item[i_item_sk#164,i_brand_id#39,i_class_id#40,i_category_id#41] Batched: true, DataFilters: [isnotnull(i_class_id#40), isnotnull(i_category_id#41), isnotnull(i_brand_id#39)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_class_id), IsNotNull(i_category_id), IsNotNull(i_brand_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
            :           :           :           :           :                    :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, int, true], input[1, int, true], input[2, int, true])), [id=#314]
            :           :           :           :           :                    :     :              +- *(10) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
            :           :           :           :           :                    :     :                 +- *(10) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
            :           :           :           :           :                    :     :                    +- *(10) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
            :           :           :           :           :                    :     :                       +- Exchange hashpartitioning(brand_id#2, class_id#3, category_id#4, 5), true, [id=#315]
            :           :           :           :           :                    :     :                          +- *(9) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
            :           :           :           :           :                    :     :                             +- *(9) BroadcastHashJoin [coalesce(brand_id#2, 0), isnull(brand_id#2), coalesce(class_id#3, 0), isnull(class_id#3), coalesce(category_id#4, 0), isnull(category_id#4)], [coalesce(i_brand_id#39, 0), isnull(i_brand_id#39), coalesce(i_class_id#40, 0), isnull(i_class_id#40), coalesce(i_category_id#41, 0), isnull(i_category_id#41)], LeftSemi, BuildRight
            :           :           :           :           :                    :     :                                :- *(9) BroadcastHashJoin [coalesce(brand_id#2, 0), isnull(brand_id#2), coalesce(class_id#3, 0), isnull(class_id#3), coalesce(category_id#4, 0), isnull(category_id#4)], [coalesce(i_brand_id#39, 0), isnull(i_brand_id#39), coalesce(i_class_id#40, 0), isnull(i_class_id#40), coalesce(i_category_id#41, 0), isnull(i_category_id#41)], LeftSemi, BuildRight
            :           :           :           :           :                    :     :                                :  :- *(9) Project [i_brand_id#39 AS brand_id#2, i_class_id#40 AS class_id#3, i_category_id#41 AS category_id#4]
            :           :           :           :           :                    :     :                                :  :  +- *(9) BroadcastHashJoin [ss_sold_date_sk#47], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :                    :     :                                :  :     :- *(9) Project [ss_sold_date_sk#47, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :                                :  :     :  +- *(9) BroadcastHashJoin [ss_item_sk#51], [i_item_sk#164], Inner, BuildRight
            :           :           :           :           :                    :     :                                :  :     :     :- *(9) Project [ss_sold_date_sk#47, ss_item_sk#51]
            :           :           :           :           :                    :     :                                :  :     :     :  +- *(9) Filter (isnotnull(ss_item_sk#51) AND isnotnull(ss_sold_date_sk#47))
            :           :           :           :           :                    :     :                                :  :     :     :     +- *(9) ColumnarToRow
            :           :           :           :           :                    :     :                                :  :     :     :        +- FileScan parquet default.store_sales[ss_sold_date_sk#47,ss_item_sk#51] Batched: true, DataFilters: [isnotnull(ss_item_sk#51), isnotnull(ss_sold_date_sk#47)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
            :           :           :           :           :                    :     :                                :  :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#316]
            :           :           :           :           :                    :     :                                :  :     :        +- *(1) Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :                                :  :     :           +- *(1) Filter (((isnotnull(i_item_sk#164) AND isnotnull(i_category_id#41)) AND isnotnull(i_class_id#40)) AND isnotnull(i_brand_id#39))
            :           :           :           :           :                    :     :                                :  :     :              +- *(1) ColumnarToRow
            :           :           :           :           :                    :     :                                :  :     :                 +- FileScan parquet default.item[i_item_sk#164,i_brand_id#39,i_class_id#40,i_category_id#41] Batched: true, DataFilters: [isnotnull(i_item_sk#164), isnotnull(i_category_id#41), isnotnull(i_class_id#40), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_category_id), IsNotNull(i_class_id), IsNotNull(i_brand_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
            :           :           :           :           :                    :     :                                :  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#317]
            :           :           :           :           :                    :     :                                :  :        +- *(2) Project [d_date_sk#48]
            :           :           :           :           :                    :     :                                :  :           +- *(2) Filter (((isnotnull(d_year#49) AND (d_year#49 >= 1999)) AND (d_year#49 <= 2001)) AND isnotnull(d_date_sk#48))
            :           :           :           :           :                    :     :                                :  :              +- *(2) ColumnarToRow
            :           :           :           :           :                    :     :                                :  :                 +- FileScan parquet default.date_dim[d_date_sk#48,d_year#49] Batched: true, DataFilters: [isnotnull(d_year#49), (d_year#49 >= 1999), (d_year#49 <= 2001), isnotnull(d_date_sk#48)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
            :           :           :           :           :                    :     :                                :  +- BroadcastExchange HashedRelationBroadcastMode(List(coalesce(input[0, int, true], 0), isnull(input[0, int, true]), coalesce(input[1, int, true], 0), isnull(input[1, int, true]), coalesce(input[2, int, true], 0), isnull(input[2, int, true]))), [id=#318]
            :           :           :           :           :                    :     :                                :     +- *(5) Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :                                :        +- *(5) BroadcastHashJoin [cs_sold_date_sk#98], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :                    :     :                                :           :- *(5) Project [cs_sold_date_sk#98, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :                                :           :  +- *(5) BroadcastHashJoin [cs_item_sk#113], [i_item_sk#164], Inner, BuildRight
            :           :           :           :           :                    :     :                                :           :     :- *(5) Project [cs_sold_date_sk#98, cs_item_sk#113]
            :           :           :           :           :                    :     :                                :           :     :  +- *(5) Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :           :           :           :           :                    :     :                                :           :     :     +- *(5) ColumnarToRow
            :           :           :           :           :                    :     :                                :           :     :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#98,cs_item_sk#113] Batched: true, DataFilters: [isnotnull(cs_item_sk#113), isnotnull(cs_sold_date_sk#98)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
            :           :           :           :           :                    :     :                                :           :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#319]
            :           :           :           :           :                    :     :                                :           :        +- *(3) Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :                                :           :           +- *(3) Filter isnotnull(i_item_sk#164)
            :           :           :           :           :                    :     :                                :           :              +- *(3) ColumnarToRow
            :           :           :           :           :                    :     :                                :           :                 +- FileScan parquet default.item[i_item_sk#164,i_brand_id#39,i_class_id#40,i_category_id#41] Batched: true, DataFilters: [isnotnull(i_item_sk#164)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
            :           :           :           :           :                    :     :                                :           +- ReusedExchange [d_date_sk#48], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#317]
            :           :           :           :           :                    :     :                                +- BroadcastExchange HashedRelationBroadcastMode(List(coalesce(input[0, int, true], 0), isnull(input[0, int, true]), coalesce(input[1, int, true], 0), isnull(input[1, int, true]), coalesce(input[2, int, true], 0), isnull(input[2, int, true]))), [id=#320]
            :           :           :           :           :                    :     :                                   +- *(8) Project [i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :                                      +- *(8) BroadcastHashJoin [ws_sold_date_sk#132], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :                    :     :                                         :- *(8) Project [ws_sold_date_sk#132, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :     :                                         :  +- *(8) BroadcastHashJoin [ws_item_sk#135], [i_item_sk#164], Inner, BuildRight
            :           :           :           :           :                    :     :                                         :     :- *(8) Project [ws_sold_date_sk#132, ws_item_sk#135]
            :           :           :           :           :                    :     :                                         :     :  +- *(8) Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :           :           :           :           :                    :     :                                         :     :     +- *(8) ColumnarToRow
            :           :           :           :           :                    :     :                                         :     :        +- FileScan parquet default.web_sales[ws_sold_date_sk#132,ws_item_sk#135] Batched: true, DataFilters: [isnotnull(ws_item_sk#135), isnotnull(ws_sold_date_sk#132)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
            :           :           :           :           :                    :     :                                         :     +- ReusedExchange [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#319]
            :           :           :           :           :                    :     :                                         +- ReusedExchange [d_date_sk#48], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#317]
            :           :           :           :           :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#321]
            :           :           :           :           :                    :        +- *(23) BroadcastHashJoin [i_item_sk#164], [ss_item_sk#1], LeftSemi, BuildRight
            :           :           :           :           :                    :           :- *(23) Project [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :           :  +- *(23) Filter isnotnull(i_item_sk#164)
            :           :           :           :           :                    :           :     +- *(23) ColumnarToRow
            :           :           :           :           :                    :           :        +- FileScan parquet default.item[i_item_sk#164,i_brand_id#39,i_class_id#40,i_category_id#41] Batched: true, DataFilters: [isnotnull(i_item_sk#164)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
            :           :           :           :           :                    :           +- ReusedExchange [ss_item_sk#1], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#313]
            :           :           :           :           :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#322]
            :           :           :           :           :                       +- *(24) Project [d_date_sk#48]
            :           :           :           :           :                          +- *(24) Filter ((((isnotnull(d_year#49) AND isnotnull(d_moy#76)) AND (d_year#49 = 2000)) AND (d_moy#76 = 11)) AND isnotnull(d_date_sk#48))
            :           :           :           :           :                             +- *(24) ColumnarToRow
            :           :           :           :           :                                +- FileScan parquet default.date_dim[d_date_sk#48,d_year#49,d_moy#76] Batched: true, DataFilters: [isnotnull(d_year#49), isnotnull(d_moy#76), (d_year#49 = 2000), (d_moy#76 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
            :           :           :           :           :- *(52) Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :           :           :           :           :  +- *(52) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :           :           :           :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :           :           :           :     +- *(52) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#190])
            :           :           :           :           :        +- Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#323]
            :           :           :           :           :           +- *(51) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#39, i_class_id#40, i_category_id#41, sum#324, isEmpty#325, count#326])
            :           :           :           :           :              +- *(51) Project [cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                 +- *(51) BroadcastHashJoin [cs_sold_date_sk#98], [d_date_sk#48], Inner, BuildRight
            :           :           :           :           :                    :- *(51) Project [cs_sold_date_sk#98, cs_quantity#96, cs_list_price#97, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :           :                    :  +- *(51) BroadcastHashJoin [cs_item_sk#113], [i_item_sk#164], Inner, BuildRight
            :           :           :           :           :                    :     :- *(51) BroadcastHashJoin [cs_item_sk#113], [ss_item_sk#1], LeftSemi, BuildRight
            :           :           :           :           :                    :     :  :- *(51) Project [cs_sold_date_sk#98, cs_item_sk#113, cs_quantity#96, cs_list_price#97]
            :           :           :           :           :                    :     :  :  +- *(51) Filter (isnotnull(cs_item_sk#113) AND isnotnull(cs_sold_date_sk#98))
            :           :           :           :           :                    :     :  :     +- *(51) ColumnarToRow
            :           :           :           :           :                    :     :  :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#98,cs_item_sk#113,cs_quantity#96,cs_list_price#97] Batched: true, DataFilters: [isnotnull(cs_item_sk#113), isnotnull(cs_sold_date_sk#98)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
            :           :           :           :           :                    :     :  +- ReusedExchange [ss_item_sk#1], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#313]
            :           :           :           :           :                    :     +- ReusedExchange [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#321]
            :           :           :           :           :                    +- ReusedExchange [d_date_sk#48], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#322]
            :           :           :           :           +- *(78) Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :           :           :           :              +- *(78) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :           :           :                 :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :           :           :                 +- *(78) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#198])
            :           :           :           :                    +- Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#327]
            :           :           :           :                       +- *(77) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#39, i_class_id#40, i_category_id#41, sum#328, isEmpty#329, count#330])
            :           :           :           :                          +- *(77) Project [ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :                             +- *(77) BroadcastHashJoin [ws_sold_date_sk#132], [d_date_sk#48], Inner, BuildRight
            :           :           :           :                                :- *(77) Project [ws_sold_date_sk#132, ws_quantity#130, ws_list_price#131, i_brand_id#39, i_class_id#40, i_category_id#41]
            :           :           :           :                                :  +- *(77) BroadcastHashJoin [ws_item_sk#135], [i_item_sk#164], Inner, BuildRight
            :           :           :           :                                :     :- *(77) BroadcastHashJoin [ws_item_sk#135], [ss_item_sk#1], LeftSemi, BuildRight
            :           :           :           :                                :     :  :- *(77) Project [ws_sold_date_sk#132, ws_item_sk#135, ws_quantity#130, ws_list_price#131]
            :           :           :           :                                :     :  :  +- *(77) Filter (isnotnull(ws_item_sk#135) AND isnotnull(ws_sold_date_sk#132))
            :           :           :           :                                :     :  :     +- *(77) ColumnarToRow
            :           :           :           :                                :     :  :        +- FileScan parquet default.web_sales[ws_sold_date_sk#132,ws_item_sk#135,ws_quantity#130,ws_list_price#131] Batched: true, DataFilters: [isnotnull(ws_item_sk#135), isnotnull(ws_sold_date_sk#132)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
            :           :           :           :                                :     :  +- ReusedExchange [ss_item_sk#1], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#313]
            :           :           :           :                                :     +- ReusedExchange [i_item_sk#164, i_brand_id#39, i_class_id#40, i_category_id#41], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#321]
            :           :           :           :                                +- ReusedExchange [d_date_sk#48], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#322]
            :           :           :           +- *(161) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40], functions=[sum(sum_sales#12), sum(number_sales#42)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#203, sum(sum_sales)#205, sum(number_sales)#207])
            :           :           :              +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, 5), true, [id=#331]
            :           :           :                 +- *(160) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40], functions=[partial_sum(sum_sales#12), partial_sum(number_sales#42)], output=[channel#15, i_brand_id#39, i_class_id#40, sum#332, isEmpty#333, sum#334])
            :           :           :                    +- *(160) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(sales#16), sum(number_sales#43)], output=[channel#15, i_brand_id#39, i_class_id#40, sum_sales#12, number_sales#42])
            :           :           :                       +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#335]
            :           :           :                          +- *(159) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(sales#16), partial_sum(number_sales#43)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum#336, isEmpty#337, sum#338])
            :           :           :                             +- Union
            :           :           :                                :- *(106) Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :           :           :                                :  +- *(106) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :           :                                :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :           :                                :     +- *(106) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#208])
            :           :           :                                :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#339, isEmpty#340, count#341], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#309]
            :           :           :                                :- *(132) Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :           :           :                                :  +- *(132) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :           :                                :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :           :                                :     +- *(132) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#215])
            :           :           :                                :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#342, isEmpty#343, count#344], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#323]
            :           :           :                                +- *(158) Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :           :           :                                   +- *(158) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :           :                                      :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :           :                                      +- *(158) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#222])
            :           :           :                                         +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#345, isEmpty#346, count#347], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#327]
            :           :           +- *(244) HashAggregate(keys=[channel#15, i_brand_id#39], functions=[sum(sum_sales#12), sum(number_sales#42)], output=[channel#15, i_brand_id#39, i_class_id#226, i_category_id#228, sum(sum_sales)#230, sum(number_sales)#232])
            :           :              +- Exchange hashpartitioning(channel#15, i_brand_id#39, 5), true, [id=#348]
            :           :                 +- *(243) HashAggregate(keys=[channel#15, i_brand_id#39], functions=[partial_sum(sum_sales#12), partial_sum(number_sales#42)], output=[channel#15, i_brand_id#39, sum#349, isEmpty#350, sum#351])
            :           :                    +- *(243) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(sales#16), sum(number_sales#43)], output=[channel#15, i_brand_id#39, sum_sales#12, number_sales#42])
            :           :                       +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#352]
            :           :                          +- *(242) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(sales#16), partial_sum(number_sales#43)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum#353, isEmpty#354, sum#355])
            :           :                             +- Union
            :           :                                :- *(189) Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :           :                                :  +- *(189) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :                                :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :                                :     +- *(189) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#233])
            :           :                                :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#356, isEmpty#357, count#358], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#309]
            :           :                                :- *(215) Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :           :                                :  +- *(215) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :                                :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :                                :     +- *(215) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#240])
            :           :                                :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#359, isEmpty#360, count#361], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#323]
            :           :                                +- *(241) Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :           :                                   +- *(241) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :           :                                      :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :           :                                      +- *(241) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#247])
            :           :                                         +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#362, isEmpty#363, count#364], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#327]
            :           +- *(327) HashAggregate(keys=[channel#15], functions=[sum(sum_sales#12), sum(number_sales#42)], output=[channel#15, i_brand_id#250, i_class_id#252, i_category_id#254, sum(sum_sales)#256, sum(number_sales)#258])
            :              +- Exchange hashpartitioning(channel#15, 5), true, [id=#365]
            :                 +- *(326) HashAggregate(keys=[channel#15], functions=[partial_sum(sum_sales#12), partial_sum(number_sales#42)], output=[channel#15, sum#366, isEmpty#367, sum#368])
            :                    +- *(326) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(sales#16), sum(number_sales#43)], output=[channel#15, sum_sales#12, number_sales#42])
            :                       +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#369]
            :                          +- *(325) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(sales#16), partial_sum(number_sales#43)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum#370, isEmpty#371, sum#372])
            :                             +- Union
            :                                :- *(272) Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
            :                                :  +- *(272) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :                                :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :                                :     +- *(272) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#259])
            :                                :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#373, isEmpty#374, count#375], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#309]
            :                                :- *(298) Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
            :                                :  +- *(298) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :                                :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :                                :     +- *(298) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#266])
            :                                :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#376, isEmpty#377, count#378], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#323]
            :                                +- *(324) Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
            :                                   +- *(324) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
            :                                      :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
            :                                      +- *(324) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#273])
            :                                         +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#379, isEmpty#380, count#381], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#327]
            +- *(410) HashAggregate(keys=[], functions=[sum(sum_sales#12), sum(number_sales#42)], output=[channel#274, i_brand_id#275, i_class_id#276, i_category_id#277, sum(sum_sales)#278, sum(number_sales)#279])
               +- Exchange SinglePartition, true, [id=#382]
                  +- *(409) HashAggregate(keys=[], functions=[partial_sum(sum_sales#12), partial_sum(number_sales#42)], output=[sum#383, isEmpty#384, sum#385])
                     +- *(409) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(sales#16), sum(number_sales#43)], output=[sum_sales#12, number_sales#42])
                        +- Exchange hashpartitioning(channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#386]
                           +- *(408) HashAggregate(keys=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41], functions=[partial_sum(sales#16), partial_sum(number_sales#43)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sum#387, isEmpty#388, sum#389])
                              +- Union
                                 :- *(355) Project [channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43]
                                 :  +- *(355) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
                                 :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
                                 :     +- *(355) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#15, i_brand_id#39, i_class_id#40, i_category_id#41, sales#16, number_sales#43, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#44 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#45 as decimal(12,2)))), DecimalType(18,2), true))#280])
                                 :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#390, isEmpty#391, count#392], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#309]
                                 :- *(381) Project [channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188]
                                 :  +- *(381) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
                                 :     :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
                                 :     +- *(381) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#20, i_brand_id#39, i_class_id#40, i_category_id#41, sales#21, number_sales#188, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#96 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#97 as decimal(12,2)))), DecimalType(18,2), true))#287])
                                 :        +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#393, isEmpty#394, count#395], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#323]
                                 +- *(407) Project [channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196]
                                    +- *(407) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#14, [id=#303] as decimal(32,6))))
                                       :  +- ReusedSubquery Subquery scalar-subquery#14, [id=#303]
                                       +- *(407) HashAggregate(keys=[i_brand_id#39, i_class_id#40, i_category_id#41], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#25, i_brand_id#39, i_class_id#40, i_category_id#41, sales#26, number_sales#196, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#130 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#131 as decimal(12,2)))), DecimalType(18,2), true))#294])
                                          +- ReusedExchange [i_brand_id#39, i_class_id#40, i_category_id#41, sum#396, isEmpty#397, count#398], Exchange hashpartitioning(i_brand_id#39, i_class_id#40, i_category_id#41, 5), true, [id=#327]
