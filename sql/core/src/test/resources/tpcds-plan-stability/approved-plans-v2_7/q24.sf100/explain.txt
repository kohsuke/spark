== Parsed Logical Plan ==
CTE [ssales]
:  +- 'SubqueryAlias ssales
:     +- 'Aggregate ['c_last_name, 'c_first_name, 's_store_name, 'ca_state, 's_state, 'i_color, 'i_current_price, 'i_manager_id, 'i_units, 'i_size], ['c_last_name, 'c_first_name, 's_store_name, 'ca_state, 's_state, 'i_color, 'i_current_price, 'i_manager_id, 'i_units, 'i_size, 'sum('ss_net_paid) AS netpaid#1]
:        +- 'Filter ((((('ss_ticket_number = 'sr_ticket_number) AND ('ss_item_sk = 'sr_item_sk)) AND ('ss_customer_sk = 'c_customer_sk)) AND (('ss_item_sk = 'i_item_sk) AND ('ss_store_sk = 's_store_sk))) AND ((('c_current_addr_sk = 'ca_address_sk) AND ('c_birth_country = 'upper('ca_country))) AND (('s_zip = 'ca_zip) AND ('s_market_id = 8))))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'Join Inner
:              :  :  :- 'Join Inner
:              :  :  :  :- 'Join Inner
:              :  :  :  :  :- 'UnresolvedRelation [store_sales]
:              :  :  :  :  +- 'UnresolvedRelation [store_returns]
:              :  :  :  +- 'UnresolvedRelation [store]
:              :  :  +- 'UnresolvedRelation [item]
:              :  +- 'UnresolvedRelation [customer]
:              +- 'UnresolvedRelation [customer_address]
+- 'Sort ['c_last_name ASC NULLS FIRST, 'c_first_name ASC NULLS FIRST, 's_store_name ASC NULLS FIRST], true
   +- 'UnresolvedHaving ('sum('netpaid) > scalar-subquery#2 [])
      :  +- 'Project [unresolvedalias((0.05 * 'avg('netpaid)), None)]
      :     +- 'UnresolvedRelation [ssales]
      +- 'Aggregate ['c_last_name, 'c_first_name, 's_store_name], ['c_last_name, 'c_first_name, 's_store_name, 'sum('netpaid) AS paid#3]
         +- 'Filter ('i_color = pale)
            +- 'UnresolvedRelation [ssales]

== Analyzed Logical Plan ==
c_last_name: string, c_first_name: string, s_store_name: string, paid: decimal(27,2)
Sort [c_last_name#4 ASC NULLS FIRST, c_first_name#5 ASC NULLS FIRST, s_store_name#6 ASC NULLS FIRST], true
+- Project [c_last_name#4, c_first_name#5, s_store_name#6, paid#3]
   +- Filter (cast(sum(netpaid#1)#7 as decimal(33,8)) > cast(scalar-subquery#2 [] as decimal(33,8)))
      :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#1) as decimal(21,6)))), DecimalType(24,8), true) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#8]
      :     +- SubqueryAlias ssales
      :        +- Aggregate [c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], [c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15, sum(ss_net_paid#16) AS netpaid#1]
      :           +- Filter (((((cast(ss_ticket_number#17 as bigint) = sr_ticket_number#18) AND (cast(ss_item_sk#19 as bigint) = sr_item_sk#20)) AND (ss_customer_sk#21 = c_customer_sk#22)) AND ((ss_item_sk#19 = i_item_sk#23) AND (ss_store_sk#24 = s_store_sk#25))) AND (((c_current_addr_sk#26 = ca_address_sk#27) AND (c_birth_country#28 = upper(ca_country#29))) AND ((s_zip#30 = ca_zip#31) AND (s_market_id#32 = 8))))
      :              +- Join Inner
      :                 :- Join Inner
      :                 :  :- Join Inner
      :                 :  :  :- Join Inner
      :                 :  :  :  :- Join Inner
      :                 :  :  :  :  :- SubqueryAlias spark_catalog.default.store_sales
      :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#33,ss_sold_time_sk#34,ss_item_sk#19,ss_customer_sk#21,ss_cdemo_sk#35,ss_hdemo_sk#36,ss_addr_sk#37,ss_store_sk#24,ss_promo_sk#38,ss_ticket_number#17,ss_quantity#39,ss_wholesale_cost#40,ss_list_price#41,ss_sales_price#42,ss_ext_discount_amt#43,ss_ext_sales_price#44,ss_ext_wholesale_cost#45,ss_ext_list_price#46,ss_ext_tax#47,ss_coupon_amt#48,ss_net_paid#16,ss_net_paid_inc_tax#49,ss_net_profit#50] parquet
      :                 :  :  :  :  +- SubqueryAlias spark_catalog.default.store_returns
      :                 :  :  :  :     +- Relation[sr_returned_date_sk#51,sr_return_time_sk#52,sr_item_sk#20,sr_customer_sk#53,sr_cdemo_sk#54,sr_hdemo_sk#55,sr_addr_sk#56,sr_store_sk#57,sr_reason_sk#58,sr_ticket_number#18,sr_return_quantity#59,sr_return_amt#60,sr_return_tax#61,sr_return_amt_inc_tax#62,sr_fee#63,sr_return_ship_cost#64,sr_refunded_cash#65,sr_reversed_charge#66,sr_store_credit#67,sr_net_loss#68] parquet
      :                 :  :  :  +- SubqueryAlias spark_catalog.default.store
      :                 :  :  :     +- Relation[s_store_sk#25,s_store_id#69,s_rec_start_date#70,s_rec_end_date#71,s_closed_date_sk#72,s_store_name#6,s_number_employees#73,s_floor_space#74,s_hours#75,s_manager#76,s_market_id#32,s_geography_class#77,s_market_desc#78,s_market_manager#79,s_division_id#80,s_division_name#81,s_company_id#82,s_company_name#83,s_street_number#84,s_street_name#85,s_street_type#86,s_suite_number#87,s_city#88,s_county#89,... 5 more fields] parquet
      :                 :  :  +- SubqueryAlias spark_catalog.default.item
      :                 :  :     +- Relation[i_item_sk#23,i_item_id#90,i_rec_start_date#91,i_rec_end_date#92,i_item_desc#93,i_current_price#12,i_wholesale_cost#94,i_brand_id#95,i_brand#96,i_class_id#97,i_class#98,i_category_id#99,i_category#100,i_manufact_id#101,i_manufact#102,i_size#15,i_formulation#103,i_color#11,i_units#14,i_container#104,i_manager_id#13,i_product_name#105] parquet
      :                 :  +- SubqueryAlias spark_catalog.default.customer
      :                 :     +- Relation[c_customer_sk#22,c_customer_id#106,c_current_cdemo_sk#107,c_current_hdemo_sk#108,c_current_addr_sk#26,c_first_shipto_date_sk#109,c_first_sales_date_sk#110,c_salutation#111,c_first_name#5,c_last_name#4,c_preferred_cust_flag#112,c_birth_day#113,c_birth_month#114,c_birth_year#115,c_birth_country#28,c_login#116,c_email_address#117,c_last_review_date#118] parquet
      :                 +- SubqueryAlias spark_catalog.default.customer_address
      :                    +- Relation[ca_address_sk#27,ca_address_id#119,ca_street_number#120,ca_street_name#121,ca_street_type#122,ca_suite_number#123,ca_city#124,ca_county#125,ca_state#9,ca_zip#31,ca_country#29,ca_gmt_offset#126,ca_location_type#127] parquet
      +- Aggregate [c_last_name#4, c_first_name#5, s_store_name#6], [c_last_name#4, c_first_name#5, s_store_name#6, sum(netpaid#1) AS paid#3, sum(netpaid#1) AS sum(netpaid#1)#7]
         +- Filter (i_color#11 = pale)
            +- SubqueryAlias ssales
               +- Aggregate [c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], [c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15, sum(ss_net_paid#16) AS netpaid#1]
                  +- Filter (((((cast(ss_ticket_number#17 as bigint) = sr_ticket_number#18) AND (cast(ss_item_sk#19 as bigint) = sr_item_sk#20)) AND (ss_customer_sk#21 = c_customer_sk#22)) AND ((ss_item_sk#19 = i_item_sk#23) AND (ss_store_sk#24 = s_store_sk#25))) AND (((c_current_addr_sk#26 = ca_address_sk#27) AND (c_birth_country#28 = upper(ca_country#29))) AND ((s_zip#30 = ca_zip#31) AND (s_market_id#32 = 8))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- SubqueryAlias spark_catalog.default.store_sales
                        :  :  :  :  :  +- Relation[ss_sold_date_sk#33,ss_sold_time_sk#34,ss_item_sk#19,ss_customer_sk#21,ss_cdemo_sk#35,ss_hdemo_sk#36,ss_addr_sk#37,ss_store_sk#24,ss_promo_sk#38,ss_ticket_number#17,ss_quantity#39,ss_wholesale_cost#40,ss_list_price#41,ss_sales_price#42,ss_ext_discount_amt#43,ss_ext_sales_price#44,ss_ext_wholesale_cost#45,ss_ext_list_price#46,ss_ext_tax#47,ss_coupon_amt#48,ss_net_paid#16,ss_net_paid_inc_tax#49,ss_net_profit#50] parquet
                        :  :  :  :  +- SubqueryAlias spark_catalog.default.store_returns
                        :  :  :  :     +- Relation[sr_returned_date_sk#51,sr_return_time_sk#52,sr_item_sk#20,sr_customer_sk#53,sr_cdemo_sk#54,sr_hdemo_sk#55,sr_addr_sk#56,sr_store_sk#57,sr_reason_sk#58,sr_ticket_number#18,sr_return_quantity#59,sr_return_amt#60,sr_return_tax#61,sr_return_amt_inc_tax#62,sr_fee#63,sr_return_ship_cost#64,sr_refunded_cash#65,sr_reversed_charge#66,sr_store_credit#67,sr_net_loss#68] parquet
                        :  :  :  +- SubqueryAlias spark_catalog.default.store
                        :  :  :     +- Relation[s_store_sk#25,s_store_id#69,s_rec_start_date#70,s_rec_end_date#71,s_closed_date_sk#72,s_store_name#6,s_number_employees#73,s_floor_space#74,s_hours#75,s_manager#76,s_market_id#32,s_geography_class#77,s_market_desc#78,s_market_manager#79,s_division_id#80,s_division_name#81,s_company_id#82,s_company_name#83,s_street_number#84,s_street_name#85,s_street_type#86,s_suite_number#87,s_city#88,s_county#89,... 5 more fields] parquet
                        :  :  +- SubqueryAlias spark_catalog.default.item
                        :  :     +- Relation[i_item_sk#23,i_item_id#90,i_rec_start_date#91,i_rec_end_date#92,i_item_desc#93,i_current_price#12,i_wholesale_cost#94,i_brand_id#95,i_brand#96,i_class_id#97,i_class#98,i_category_id#99,i_category#100,i_manufact_id#101,i_manufact#102,i_size#15,i_formulation#103,i_color#11,i_units#14,i_container#104,i_manager_id#13,i_product_name#105] parquet
                        :  +- SubqueryAlias spark_catalog.default.customer
                        :     +- Relation[c_customer_sk#22,c_customer_id#106,c_current_cdemo_sk#107,c_current_hdemo_sk#108,c_current_addr_sk#26,c_first_shipto_date_sk#109,c_first_sales_date_sk#110,c_salutation#111,c_first_name#5,c_last_name#4,c_preferred_cust_flag#112,c_birth_day#113,c_birth_month#114,c_birth_year#115,c_birth_country#28,c_login#116,c_email_address#117,c_last_review_date#118] parquet
                        +- SubqueryAlias spark_catalog.default.customer_address
                           +- Relation[ca_address_sk#27,ca_address_id#119,ca_street_number#120,ca_street_name#121,ca_street_type#122,ca_suite_number#123,ca_city#124,ca_county#125,ca_state#9,ca_zip#31,ca_country#29,ca_gmt_offset#126,ca_location_type#127] parquet

== Optimized Logical Plan ==
Sort [c_last_name#4 ASC NULLS FIRST, c_first_name#5 ASC NULLS FIRST, s_store_name#6 ASC NULLS FIRST], true
+- Project [c_last_name#4, c_first_name#5, s_store_name#6, paid#3]
   +- Filter (isnotnull(sum(netpaid#1)#7) AND (cast(sum(netpaid#1)#7 as decimal(33,8)) > cast(scalar-subquery#2 [] as decimal(33,8))))
      :  +- Aggregate [CheckOverflow((0.050000 * promote_precision(avg(netpaid#1))), DecimalType(24,8), true) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#8]
      :     +- Aggregate [c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], [MakeDecimal(sum(UnscaledValue(ss_net_paid#16)),17,2) AS netpaid#1]
      :        +- Project [ss_net_paid#16, s_store_name#6, s_state#10, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13, c_first_name#5, c_last_name#4, ca_state#9]
      :           +- Join Inner, ((cast(ss_item_sk#19 as bigint) = sr_item_sk#20) AND (cast(ss_ticket_number#17 as bigint) = sr_ticket_number#18))
      :              :- Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
      :              :  +- Join Inner, (ss_item_sk#19 = i_item_sk#23)
      :              :     :- Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16]
      :              :     :  +- Join Inner, ((ss_store_sk#24 = s_store_sk#25) AND (ss_customer_sk#21 = c_customer_sk#22))
      :              :     :     :- Project [s_store_sk#25, s_store_name#6, s_state#10, ca_state#9, c_customer_sk#22, c_first_name#5, c_last_name#4]
      :              :     :     :  +- Join Inner, ((c_current_addr_sk#26 = ca_address_sk#27) AND (c_birth_country#28 = upper(ca_country#29)))
      :              :     :     :     :- Project [s_store_sk#25, s_store_name#6, s_state#10, ca_address_sk#27, ca_state#9, ca_country#29]
      :              :     :     :     :  +- Join Inner, (s_zip#30 = ca_zip#31)
      :              :     :     :     :     :- Project [s_store_sk#25, s_store_name#6, s_state#10, s_zip#30]
      :              :     :     :     :     :  +- Filter (((isnotnull(s_market_id#32) AND (s_market_id#32 = 8)) AND isnotnull(s_store_sk#25)) AND isnotnull(s_zip#30))
      :              :     :     :     :     :     +- Relation[s_store_sk#25,s_store_id#69,s_rec_start_date#70,s_rec_end_date#71,s_closed_date_sk#72,s_store_name#6,s_number_employees#73,s_floor_space#74,s_hours#75,s_manager#76,s_market_id#32,s_geography_class#77,s_market_desc#78,s_market_manager#79,s_division_id#80,s_division_name#81,s_company_id#82,s_company_name#83,s_street_number#84,s_street_name#85,s_street_type#86,s_suite_number#87,s_city#88,s_county#89,... 5 more fields] parquet
      :              :     :     :     :     +- Project [ca_address_sk#27, ca_state#9, ca_zip#31, ca_country#29]
      :              :     :     :     :        +- Filter ((isnotnull(ca_address_sk#27) AND isnotnull(ca_country#29)) AND isnotnull(ca_zip#31))
      :              :     :     :     :           +- Relation[ca_address_sk#27,ca_address_id#119,ca_street_number#120,ca_street_name#121,ca_street_type#122,ca_suite_number#123,ca_city#124,ca_county#125,ca_state#9,ca_zip#31,ca_country#29,ca_gmt_offset#126,ca_location_type#127] parquet
      :              :     :     :     +- Project [c_customer_sk#22, c_current_addr_sk#26, c_first_name#5, c_last_name#4, c_birth_country#28]
      :              :     :     :        +- Filter ((isnotnull(c_customer_sk#22) AND isnotnull(c_birth_country#28)) AND isnotnull(c_current_addr_sk#26))
      :              :     :     :           +- Relation[c_customer_sk#22,c_customer_id#106,c_current_cdemo_sk#107,c_current_hdemo_sk#108,c_current_addr_sk#26,c_first_shipto_date_sk#109,c_first_sales_date_sk#110,c_salutation#111,c_first_name#5,c_last_name#4,c_preferred_cust_flag#112,c_birth_day#113,c_birth_month#114,c_birth_year#115,c_birth_country#28,c_login#116,c_email_address#117,c_last_review_date#118] parquet
      :              :     :     +- Project [ss_item_sk#19, ss_customer_sk#21, ss_store_sk#24, ss_ticket_number#17, ss_net_paid#16]
      :              :     :        +- Filter (((isnotnull(ss_ticket_number#17) AND isnotnull(ss_item_sk#19)) AND isnotnull(ss_store_sk#24)) AND isnotnull(ss_customer_sk#21))
      :              :     :           +- Relation[ss_sold_date_sk#33,ss_sold_time_sk#34,ss_item_sk#19,ss_customer_sk#21,ss_cdemo_sk#35,ss_hdemo_sk#36,ss_addr_sk#37,ss_store_sk#24,ss_promo_sk#38,ss_ticket_number#17,ss_quantity#39,ss_wholesale_cost#40,ss_list_price#41,ss_sales_price#42,ss_ext_discount_amt#43,ss_ext_sales_price#44,ss_ext_wholesale_cost#45,ss_ext_list_price#46,ss_ext_tax#47,ss_coupon_amt#48,ss_net_paid#16,ss_net_paid_inc_tax#49,ss_net_profit#50] parquet
      :              :     +- Project [i_item_sk#23, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
      :              :        +- Filter isnotnull(i_item_sk#23)
      :              :           +- Relation[i_item_sk#23,i_item_id#90,i_rec_start_date#91,i_rec_end_date#92,i_item_desc#93,i_current_price#12,i_wholesale_cost#94,i_brand_id#95,i_brand#96,i_class_id#97,i_class#98,i_category_id#99,i_category#100,i_manufact_id#101,i_manufact#102,i_size#15,i_formulation#103,i_color#11,i_units#14,i_container#104,i_manager_id#13,i_product_name#105] parquet
      :              +- Project [sr_item_sk#20, sr_ticket_number#18]
      :                 +- Filter (isnotnull(sr_ticket_number#18) AND isnotnull(sr_item_sk#20))
      :                    +- Relation[sr_returned_date_sk#51,sr_return_time_sk#52,sr_item_sk#20,sr_customer_sk#53,sr_cdemo_sk#54,sr_hdemo_sk#55,sr_addr_sk#56,sr_store_sk#57,sr_reason_sk#58,sr_ticket_number#18,sr_return_quantity#59,sr_return_amt#60,sr_return_tax#61,sr_return_amt_inc_tax#62,sr_fee#63,sr_return_ship_cost#64,sr_refunded_cash#65,sr_reversed_charge#66,sr_store_credit#67,sr_net_loss#68] parquet
      +- Aggregate [c_last_name#4, c_first_name#5, s_store_name#6], [c_last_name#4, c_first_name#5, s_store_name#6, sum(netpaid#1) AS paid#3, sum(netpaid#1) AS sum(netpaid#1)#7]
         +- Aggregate [c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], [c_last_name#4, c_first_name#5, s_store_name#6, MakeDecimal(sum(UnscaledValue(ss_net_paid#16)),17,2) AS netpaid#1]
            +- Project [ss_net_paid#16, s_store_name#6, s_state#10, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13, c_first_name#5, c_last_name#4, ca_state#9]
               +- Join Inner, ((cast(ss_item_sk#19 as bigint) = sr_item_sk#20) AND (cast(ss_ticket_number#17 as bigint) = sr_ticket_number#18))
                  :- Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
                  :  +- Join Inner, (ss_item_sk#19 = i_item_sk#23)
                  :     :- Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16]
                  :     :  +- Join Inner, ((ss_store_sk#24 = s_store_sk#25) AND (ss_customer_sk#21 = c_customer_sk#22))
                  :     :     :- Project [s_store_sk#25, s_store_name#6, s_state#10, ca_state#9, c_customer_sk#22, c_first_name#5, c_last_name#4]
                  :     :     :  +- Join Inner, ((c_current_addr_sk#26 = ca_address_sk#27) AND (c_birth_country#28 = upper(ca_country#29)))
                  :     :     :     :- Project [s_store_sk#25, s_store_name#6, s_state#10, ca_address_sk#27, ca_state#9, ca_country#29]
                  :     :     :     :  +- Join Inner, (s_zip#30 = ca_zip#31)
                  :     :     :     :     :- Project [s_store_sk#25, s_store_name#6, s_state#10, s_zip#30]
                  :     :     :     :     :  +- Filter (((isnotnull(s_market_id#32) AND (s_market_id#32 = 8)) AND isnotnull(s_store_sk#25)) AND isnotnull(s_zip#30))
                  :     :     :     :     :     +- Relation[s_store_sk#25,s_store_id#69,s_rec_start_date#70,s_rec_end_date#71,s_closed_date_sk#72,s_store_name#6,s_number_employees#73,s_floor_space#74,s_hours#75,s_manager#76,s_market_id#32,s_geography_class#77,s_market_desc#78,s_market_manager#79,s_division_id#80,s_division_name#81,s_company_id#82,s_company_name#83,s_street_number#84,s_street_name#85,s_street_type#86,s_suite_number#87,s_city#88,s_county#89,... 5 more fields] parquet
                  :     :     :     :     +- Project [ca_address_sk#27, ca_state#9, ca_zip#31, ca_country#29]
                  :     :     :     :        +- Filter ((isnotnull(ca_address_sk#27) AND isnotnull(ca_country#29)) AND isnotnull(ca_zip#31))
                  :     :     :     :           +- Relation[ca_address_sk#27,ca_address_id#119,ca_street_number#120,ca_street_name#121,ca_street_type#122,ca_suite_number#123,ca_city#124,ca_county#125,ca_state#9,ca_zip#31,ca_country#29,ca_gmt_offset#126,ca_location_type#127] parquet
                  :     :     :     +- Project [c_customer_sk#22, c_current_addr_sk#26, c_first_name#5, c_last_name#4, c_birth_country#28]
                  :     :     :        +- Filter ((isnotnull(c_customer_sk#22) AND isnotnull(c_birth_country#28)) AND isnotnull(c_current_addr_sk#26))
                  :     :     :           +- Relation[c_customer_sk#22,c_customer_id#106,c_current_cdemo_sk#107,c_current_hdemo_sk#108,c_current_addr_sk#26,c_first_shipto_date_sk#109,c_first_sales_date_sk#110,c_salutation#111,c_first_name#5,c_last_name#4,c_preferred_cust_flag#112,c_birth_day#113,c_birth_month#114,c_birth_year#115,c_birth_country#28,c_login#116,c_email_address#117,c_last_review_date#118] parquet
                  :     :     +- Project [ss_item_sk#19, ss_customer_sk#21, ss_store_sk#24, ss_ticket_number#17, ss_net_paid#16]
                  :     :        +- Filter (((isnotnull(ss_ticket_number#17) AND isnotnull(ss_item_sk#19)) AND isnotnull(ss_store_sk#24)) AND isnotnull(ss_customer_sk#21))
                  :     :           +- Relation[ss_sold_date_sk#33,ss_sold_time_sk#34,ss_item_sk#19,ss_customer_sk#21,ss_cdemo_sk#35,ss_hdemo_sk#36,ss_addr_sk#37,ss_store_sk#24,ss_promo_sk#38,ss_ticket_number#17,ss_quantity#39,ss_wholesale_cost#40,ss_list_price#41,ss_sales_price#42,ss_ext_discount_amt#43,ss_ext_sales_price#44,ss_ext_wholesale_cost#45,ss_ext_list_price#46,ss_ext_tax#47,ss_coupon_amt#48,ss_net_paid#16,ss_net_paid_inc_tax#49,ss_net_profit#50] parquet
                  :     +- Project [i_item_sk#23, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
                  :        +- Filter ((isnotnull(i_color#11) AND (i_color#11 = pale)) AND isnotnull(i_item_sk#23))
                  :           +- Relation[i_item_sk#23,i_item_id#90,i_rec_start_date#91,i_rec_end_date#92,i_item_desc#93,i_current_price#12,i_wholesale_cost#94,i_brand_id#95,i_brand#96,i_class_id#97,i_class#98,i_category_id#99,i_category#100,i_manufact_id#101,i_manufact#102,i_size#15,i_formulation#103,i_color#11,i_units#14,i_container#104,i_manager_id#13,i_product_name#105] parquet
                  +- Project [sr_item_sk#20, sr_ticket_number#18]
                     +- Filter (isnotnull(sr_ticket_number#18) AND isnotnull(sr_item_sk#20))
                        +- Relation[sr_returned_date_sk#51,sr_return_time_sk#52,sr_item_sk#20,sr_customer_sk#53,sr_cdemo_sk#54,sr_hdemo_sk#55,sr_addr_sk#56,sr_store_sk#57,sr_reason_sk#58,sr_ticket_number#18,sr_return_quantity#59,sr_return_amt#60,sr_return_tax#61,sr_return_amt_inc_tax#62,sr_fee#63,sr_return_ship_cost#64,sr_refunded_cash#65,sr_reversed_charge#66,sr_store_credit#67,sr_net_loss#68] parquet

== Physical Plan ==
*(12) Sort [c_last_name#4 ASC NULLS FIRST, c_first_name#5 ASC NULLS FIRST, s_store_name#6 ASC NULLS FIRST], true, 0
+- Exchange rangepartitioning(c_last_name#4 ASC NULLS FIRST, c_first_name#5 ASC NULLS FIRST, s_store_name#6 ASC NULLS FIRST, 5), true, [id=#128]
   +- *(11) Project [c_last_name#4, c_first_name#5, s_store_name#6, paid#3]
      +- *(11) Filter (isnotnull(sum(netpaid#1)#7) AND (cast(sum(netpaid#1)#7 as decimal(33,8)) > cast(Subquery scalar-subquery#2, [id=#129] as decimal(33,8))))
         :  +- Subquery scalar-subquery#2, [id=#129]
         :     +- *(14) HashAggregate(keys=[], functions=[avg(netpaid#1)], output=[(CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#8])
         :        +- Exchange SinglePartition, true, [id=#130]
         :           +- *(13) HashAggregate(keys=[], functions=[partial_avg(netpaid#1)], output=[sum#131, count#132])
         :              +- *(13) HashAggregate(keys=[c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], functions=[sum(UnscaledValue(ss_net_paid#16))], output=[netpaid#1])
         :                 +- Exchange hashpartitioning(c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15, 5), true, [id=#133]
         :                    +- *(12) HashAggregate(keys=[c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], functions=[partial_sum(UnscaledValue(ss_net_paid#16))], output=[c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15, sum#134])
         :                       +- *(12) Project [ss_net_paid#16, s_store_name#6, s_state#10, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13, c_first_name#5, c_last_name#4, ca_state#9]
         :                          +- *(12) SortMergeJoin [cast(ss_item_sk#19 as bigint), cast(ss_ticket_number#17 as bigint)], [sr_item_sk#20, sr_ticket_number#18], Inner
         :                             :- *(9) Sort [cast(ss_item_sk#19 as bigint) ASC NULLS FIRST, cast(ss_ticket_number#17 as bigint) ASC NULLS FIRST], false, 0
         :                             :  +- Exchange hashpartitioning(cast(ss_item_sk#19 as bigint), cast(ss_ticket_number#17 as bigint), 5), true, [id=#135]
         :                             :     +- *(8) Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
         :                             :        +- *(8) SortMergeJoin [ss_item_sk#19], [i_item_sk#23], Inner
         :                             :           :- *(5) Sort [ss_item_sk#19 ASC NULLS FIRST], false, 0
         :                             :           :  +- Exchange hashpartitioning(ss_item_sk#19, 5), true, [id=#136]
         :                             :           :     +- *(4) Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16]
         :                             :           :        +- *(4) BroadcastHashJoin [s_store_sk#25, c_customer_sk#22], [ss_store_sk#24, ss_customer_sk#21], Inner, BuildLeft, false
         :                             :           :           :- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, true] as bigint), 32) | (cast(input[4, int, true] as bigint) & 4294967295))),false), [id=#137]
         :                             :           :           :  +- *(3) Project [s_store_sk#25, s_store_name#6, s_state#10, ca_state#9, c_customer_sk#22, c_first_name#5, c_last_name#4]
         :                             :           :           :     +- *(3) BroadcastHashJoin [ca_address_sk#27, upper(ca_country#29)], [c_current_addr_sk#26, c_birth_country#28], Inner, BuildLeft, false
         :                             :           :           :        :- BroadcastExchange HashedRelationBroadcastMode(List(input[3, int, true], upper(input[5, string, true])),false), [id=#138]
         :                             :           :           :        :  +- *(2) Project [s_store_sk#25, s_store_name#6, s_state#10, ca_address_sk#27, ca_state#9, ca_country#29]
         :                             :           :           :        :     +- *(2) BroadcastHashJoin [s_zip#30], [ca_zip#31], Inner, BuildLeft, false
         :                             :           :           :        :        :- BroadcastExchange HashedRelationBroadcastMode(List(input[3, string, true]),false), [id=#139]
         :                             :           :           :        :        :  +- *(1) Project [s_store_sk#25, s_store_name#6, s_state#10, s_zip#30]
         :                             :           :           :        :        :     +- *(1) Filter (((isnotnull(s_market_id#32) AND (s_market_id#32 = 8)) AND isnotnull(s_store_sk#25)) AND isnotnull(s_zip#30))
         :                             :           :           :        :        :        +- *(1) ColumnarToRow
         :                             :           :           :        :        :           +- FileScan parquet default.store[s_store_sk#25,s_store_name#6,s_market_id#32,s_state#10,s_zip#30] Batched: true, DataFilters: [isnotnull(s_market_id#32), (s_market_id#32 = 8), isnotnull(s_store_sk#25), isnotnull(s_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(s_market_id), EqualTo(s_market_id,8), IsNotNull(s_store_sk), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_market_id:int,s_state:string,s_zip:string>
         :                             :           :           :        :        +- *(2) Project [ca_address_sk#27, ca_state#9, ca_zip#31, ca_country#29]
         :                             :           :           :        :           +- *(2) Filter ((isnotnull(ca_address_sk#27) AND isnotnull(ca_country#29)) AND isnotnull(ca_zip#31))
         :                             :           :           :        :              +- *(2) ColumnarToRow
         :                             :           :           :        :                 +- FileScan parquet default.customer_address[ca_address_sk#27,ca_state#9,ca_zip#31,ca_country#29] Batched: true, DataFilters: [isnotnull(ca_address_sk#27), isnotnull(ca_country#29), isnotnull(ca_zip#31)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_country), IsNotNull(ca_zip)], ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_zip:string,ca_country:string>
         :                             :           :           :        +- *(3) Project [c_customer_sk#22, c_current_addr_sk#26, c_first_name#5, c_last_name#4, c_birth_country#28]
         :                             :           :           :           +- *(3) Filter ((isnotnull(c_customer_sk#22) AND isnotnull(c_birth_country#28)) AND isnotnull(c_current_addr_sk#26))
         :                             :           :           :              +- *(3) ColumnarToRow
         :                             :           :           :                 +- FileScan parquet default.customer[c_customer_sk#22,c_current_addr_sk#26,c_first_name#5,c_last_name#4,c_birth_country#28] Batched: true, DataFilters: [isnotnull(c_customer_sk#22), isnotnull(c_birth_country#28), isnotnull(c_current_addr_sk#140..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_birth_country), IsNotNull(c_current_addr_sk)], ReadSchema: struct<c_customer_sk:int,c_current_addr_sk:int,c_first_name:string,c_last_name:string,c_birth_cou...
         :                             :           :           +- *(4) Project [ss_item_sk#19, ss_customer_sk#21, ss_store_sk#24, ss_ticket_number#17, ss_net_paid#16]
         :                             :           :              +- *(4) Filter (((isnotnull(ss_ticket_number#17) AND isnotnull(ss_item_sk#19)) AND isnotnull(ss_store_sk#24)) AND isnotnull(ss_customer_sk#21))
         :                             :           :                 +- *(4) ColumnarToRow
         :                             :           :                    +- FileScan parquet default.store_sales[ss_item_sk#19,ss_customer_sk#21,ss_store_sk#24,ss_ticket_number#17,ss_net_paid#16] Batched: true, DataFilters: [isnotnull(ss_ticket_number#17), isnotnull(ss_item_sk#19), isnotnull(ss_store_sk#24), is..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_ticket_number), IsNotNull(ss_item_sk), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int,ss_net_paid:decimal...
         :                             :           +- *(7) Sort [i_item_sk#23 ASC NULLS FIRST], false, 0
         :                             :              +- Exchange hashpartitioning(i_item_sk#23, 5), true, [id=#141]
         :                             :                 +- *(6) Project [i_item_sk#23, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
         :                             :                    +- *(6) Filter isnotnull(i_item_sk#23)
         :                             :                       +- *(6) ColumnarToRow
         :                             :                          +- FileScan parquet default.item[i_item_sk#23,i_current_price#12,i_size#15,i_color#11,i_units#14,i_manager_id#13] Batched: true, DataFilters: [isnotnull(i_item_sk#23)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_m...
         :                             +- *(11) Sort [sr_item_sk#20 ASC NULLS FIRST, sr_ticket_number#18 ASC NULLS FIRST], false, 0
         :                                +- Exchange hashpartitioning(sr_item_sk#20, sr_ticket_number#18, 5), true, [id=#142]
         :                                   +- *(10) Project [sr_item_sk#20, sr_ticket_number#18]
         :                                      +- *(10) Filter (isnotnull(sr_ticket_number#18) AND isnotnull(sr_item_sk#20))
         :                                         +- *(10) ColumnarToRow
         :                                            +- FileScan parquet default.store_returns[sr_item_sk#20,sr_ticket_number#18] Batched: true, DataFilters: [isnotnull(sr_ticket_number#18), isnotnull(sr_item_sk#20)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(sr_ticket_number), IsNotNull(sr_item_sk)], ReadSchema: struct<sr_item_sk:bigint,sr_ticket_number:bigint>
         +- *(11) HashAggregate(keys=[c_last_name#4, c_first_name#5, s_store_name#6], functions=[sum(netpaid#1)], output=[c_last_name#4, c_first_name#5, s_store_name#6, paid#3, sum(netpaid#1)#7])
            +- Exchange hashpartitioning(c_last_name#4, c_first_name#5, s_store_name#6, 5), true, [id=#143]
               +- *(10) HashAggregate(keys=[c_last_name#4, c_first_name#5, s_store_name#6], functions=[partial_sum(netpaid#1)], output=[c_last_name#4, c_first_name#5, s_store_name#6, sum#144, isEmpty#145])
                  +- *(10) HashAggregate(keys=[c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], functions=[sum(UnscaledValue(ss_net_paid#16))], output=[c_last_name#4, c_first_name#5, s_store_name#6, netpaid#1])
                     +- Exchange hashpartitioning(c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15, 5), true, [id=#146]
                        +- *(9) HashAggregate(keys=[c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15], functions=[partial_sum(UnscaledValue(ss_net_paid#16))], output=[c_last_name#4, c_first_name#5, s_store_name#6, ca_state#9, s_state#10, i_color#11, i_current_price#12, i_manager_id#13, i_units#14, i_size#15, sum#147])
                           +- *(9) Project [ss_net_paid#16, s_store_name#6, s_state#10, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13, c_first_name#5, c_last_name#4, ca_state#9]
                              +- *(9) SortMergeJoin [cast(ss_item_sk#19 as bigint), cast(ss_ticket_number#17 as bigint)], [sr_item_sk#20, sr_ticket_number#18], Inner
                                 :- *(6) Sort [cast(ss_item_sk#19 as bigint) ASC NULLS FIRST, cast(ss_ticket_number#17 as bigint) ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(cast(ss_item_sk#19 as bigint), cast(ss_ticket_number#17 as bigint), 5), true, [id=#148]
                                 :     +- *(5) Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
                                 :        +- *(5) BroadcastHashJoin [ss_item_sk#19], [i_item_sk#23], Inner, BuildRight, false
                                 :           :- *(5) Project [s_store_name#6, s_state#10, ca_state#9, c_first_name#5, c_last_name#4, ss_item_sk#19, ss_ticket_number#17, ss_net_paid#16]
                                 :           :  +- *(5) BroadcastHashJoin [s_store_sk#25, c_customer_sk#22], [ss_store_sk#24, ss_customer_sk#21], Inner, BuildLeft, false
                                 :           :     :- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, true] as bigint), 32) | (cast(input[4, int, true] as bigint) & 4294967295))),false), [id=#149]
                                 :           :     :  +- *(3) Project [s_store_sk#25, s_store_name#6, s_state#10, ca_state#9, c_customer_sk#22, c_first_name#5, c_last_name#4]
                                 :           :     :     +- *(3) BroadcastHashJoin [ca_address_sk#27, upper(ca_country#29)], [c_current_addr_sk#26, c_birth_country#28], Inner, BuildLeft, false
                                 :           :     :        :- BroadcastExchange HashedRelationBroadcastMode(List(input[3, int, true], upper(input[5, string, true])),false), [id=#150]
                                 :           :     :        :  +- *(2) Project [s_store_sk#25, s_store_name#6, s_state#10, ca_address_sk#27, ca_state#9, ca_country#29]
                                 :           :     :        :     +- *(2) BroadcastHashJoin [s_zip#30], [ca_zip#31], Inner, BuildLeft, false
                                 :           :     :        :        :- BroadcastExchange HashedRelationBroadcastMode(List(input[3, string, true]),false), [id=#151]
                                 :           :     :        :        :  +- *(1) Project [s_store_sk#25, s_store_name#6, s_state#10, s_zip#30]
                                 :           :     :        :        :     +- *(1) Filter (((isnotnull(s_market_id#32) AND (s_market_id#32 = 8)) AND isnotnull(s_store_sk#25)) AND isnotnull(s_zip#30))
                                 :           :     :        :        :        +- *(1) ColumnarToRow
                                 :           :     :        :        :           +- FileScan parquet default.store[s_store_sk#25,s_store_name#6,s_market_id#32,s_state#10,s_zip#30] Batched: true, DataFilters: [isnotnull(s_market_id#32), (s_market_id#32 = 8), isnotnull(s_store_sk#25), isnotnull(s_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(s_market_id), EqualTo(s_market_id,8), IsNotNull(s_store_sk), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_market_id:int,s_state:string,s_zip:string>
                                 :           :     :        :        +- *(2) Project [ca_address_sk#27, ca_state#9, ca_zip#31, ca_country#29]
                                 :           :     :        :           +- *(2) Filter ((isnotnull(ca_address_sk#27) AND isnotnull(ca_country#29)) AND isnotnull(ca_zip#31))
                                 :           :     :        :              +- *(2) ColumnarToRow
                                 :           :     :        :                 +- FileScan parquet default.customer_address[ca_address_sk#27,ca_state#9,ca_zip#31,ca_country#29] Batched: true, DataFilters: [isnotnull(ca_address_sk#27), isnotnull(ca_country#29), isnotnull(ca_zip#31)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_country), IsNotNull(ca_zip)], ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_zip:string,ca_country:string>
                                 :           :     :        +- *(3) Project [c_customer_sk#22, c_current_addr_sk#26, c_first_name#5, c_last_name#4, c_birth_country#28]
                                 :           :     :           +- *(3) Filter ((isnotnull(c_customer_sk#22) AND isnotnull(c_birth_country#28)) AND isnotnull(c_current_addr_sk#26))
                                 :           :     :              +- *(3) ColumnarToRow
                                 :           :     :                 +- FileScan parquet default.customer[c_customer_sk#22,c_current_addr_sk#26,c_first_name#5,c_last_name#4,c_birth_country#28] Batched: true, DataFilters: [isnotnull(c_customer_sk#22), isnotnull(c_birth_country#28), isnotnull(c_current_addr_sk#140..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_birth_country), IsNotNull(c_current_addr_sk)], ReadSchema: struct<c_customer_sk:int,c_current_addr_sk:int,c_first_name:string,c_last_name:string,c_birth_cou...
                                 :           :     +- *(5) Project [ss_item_sk#19, ss_customer_sk#21, ss_store_sk#24, ss_ticket_number#17, ss_net_paid#16]
                                 :           :        +- *(5) Filter (((isnotnull(ss_ticket_number#17) AND isnotnull(ss_item_sk#19)) AND isnotnull(ss_store_sk#24)) AND isnotnull(ss_customer_sk#21))
                                 :           :           +- *(5) ColumnarToRow
                                 :           :              +- FileScan parquet default.store_sales[ss_item_sk#19,ss_customer_sk#21,ss_store_sk#24,ss_ticket_number#17,ss_net_paid#16] Batched: true, DataFilters: [isnotnull(ss_ticket_number#17), isnotnull(ss_item_sk#19), isnotnull(ss_store_sk#24), is..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_ticket_number), IsNotNull(ss_item_sk), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int,ss_net_paid:decimal...
                                 :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#152]
                                 :              +- *(4) Project [i_item_sk#23, i_current_price#12, i_size#15, i_color#11, i_units#14, i_manager_id#13]
                                 :                 +- *(4) Filter ((isnotnull(i_color#11) AND (i_color#11 = pale)) AND isnotnull(i_item_sk#23))
                                 :                    +- *(4) ColumnarToRow
                                 :                       +- FileScan parquet default.item[i_item_sk#23,i_current_price#12,i_size#15,i_color#11,i_units#14,i_manager_id#13] Batched: true, DataFilters: [isnotnull(i_color#11), (i_color#11 = pale), isnotnull(i_item_sk#23)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_color), EqualTo(i_color,pale), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_m...
                                 +- *(8) Sort [sr_item_sk#20 ASC NULLS FIRST, sr_ticket_number#18 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(sr_item_sk#20, sr_ticket_number#18, 5), true, [id=#153]
                                       +- *(7) Project [sr_item_sk#20, sr_ticket_number#18]
                                          +- *(7) Filter (isnotnull(sr_ticket_number#18) AND isnotnull(sr_item_sk#20))
                                             +- *(7) ColumnarToRow
                                                +- FileScan parquet default.store_returns[sr_item_sk#20,sr_ticket_number#18] Batched: true, DataFilters: [isnotnull(sr_ticket_number#18), isnotnull(sr_item_sk#20)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(sr_ticket_number), IsNotNull(sr_item_sk)], ReadSchema: struct<sr_item_sk:bigint,sr_ticket_number:bigint>
