== Parsed Logical Plan ==
CTE [results]
:  +- 'SubqueryAlias results
:     +- 'Project ['i_item_id, 'ca_country, 'ca_state, 'ca_county, cast('cs_quantity as decimal(12,2)) AS agg1#1, cast('cs_list_price as decimal(12,2)) AS agg2#2, cast('cs_coupon_amt as decimal(12,2)) AS agg3#3, cast('cs_sales_price as decimal(12,2)) AS agg4#4, cast('cs_net_profit as decimal(12,2)) AS agg5#5, cast('c_birth_year as decimal(12,2)) AS agg6#6, cast('cd1.cd_dep_count as decimal(12,2)) AS agg7#7]
:        +- 'Filter ((((('cs_sold_date_sk = 'd_date_sk) AND ('cs_item_sk = 'i_item_sk)) AND ('cs_bill_cdemo_sk = 'cd1.cd_demo_sk)) AND ((('cs_bill_customer_sk = 'c_customer_sk) AND ('cd1.cd_gender = M)) AND ('cd1.cd_education_status = College))) AND (((('c_current_cdemo_sk = 'cd2.cd_demo_sk) AND ('c_current_addr_sk = 'ca_address_sk)) AND 'c_birth_month IN (9,5,12,4,1,10)) AND (('d_year = 2001) AND 'ca_state IN (ND,WI,AL,NC,OK,MS,TN))))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'Join Inner
:              :  :  :- 'Join Inner
:              :  :  :  :- 'Join Inner
:              :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :- 'UnresolvedRelation [catalog_sales]
:              :  :  :  :  :  +- 'SubqueryAlias cd1
:              :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
:              :  :  :  :  +- 'SubqueryAlias cd2
:              :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
:              :  :  :  +- 'UnresolvedRelation [customer]
:              :  :  +- 'UnresolvedRelation [customer_address]
:              :  +- 'UnresolvedRelation [date_dim]
:              +- 'UnresolvedRelation [item]
+- 'GlobalLimit 100
   +- 'LocalLimit 100
      +- 'Sort ['ca_country ASC NULLS FIRST, 'ca_state ASC NULLS FIRST, 'ca_county ASC NULLS FIRST, 'i_item_id ASC NULLS FIRST], true
         +- 'Project ['i_item_id, 'ca_country, 'ca_state, 'ca_county, 'agg1, 'agg2, 'agg3, 'agg4, 'agg5, 'agg6, 'agg7]
            +- 'SubqueryAlias foo
               +- 'Union false, false
                  :- 'Union false, false
                  :  :- 'Union false, false
                  :  :  :- 'Union false, false
                  :  :  :  :- 'Aggregate ['i_item_id, 'ca_country, 'ca_state, 'ca_county], ['i_item_id, 'ca_country, 'ca_state, 'ca_county, 'avg('agg1) AS agg1#8, 'avg('agg2) AS agg2#9, 'avg('agg3) AS agg3#10, 'avg('agg4) AS agg4#11, 'avg('agg5) AS agg5#12, 'avg('agg6) AS agg6#13, 'avg('agg7) AS agg7#14]
                  :  :  :  :  +- 'UnresolvedRelation [results]
                  :  :  :  +- 'Aggregate ['i_item_id, 'ca_country, 'ca_state], ['i_item_id, 'ca_country, 'ca_state, null AS county#15, 'avg('agg1) AS agg1#16, 'avg('agg2) AS agg2#17, 'avg('agg3) AS agg3#18, 'avg('agg4) AS agg4#19, 'avg('agg5) AS agg5#20, 'avg('agg6) AS agg6#21, 'avg('agg7) AS agg7#22]
                  :  :  :     +- 'UnresolvedRelation [results]
                  :  :  +- 'Aggregate ['i_item_id, 'ca_country], ['i_item_id, 'ca_country, null AS ca_state#23, null AS county#24, 'avg('agg1) AS agg1#25, 'avg('agg2) AS agg2#26, 'avg('agg3) AS agg3#27, 'avg('agg4) AS agg4#28, 'avg('agg5) AS agg5#29, 'avg('agg6) AS agg6#30, 'avg('agg7) AS agg7#31]
                  :  :     +- 'UnresolvedRelation [results]
                  :  +- 'Aggregate ['i_item_id], ['i_item_id, null AS ca_country#32, null AS ca_state#33, null AS county#34, 'avg('agg1) AS agg1#35, 'avg('agg2) AS agg2#36, 'avg('agg3) AS agg3#37, 'avg('agg4) AS agg4#38, 'avg('agg5) AS agg5#39, 'avg('agg6) AS agg6#40, 'avg('agg7) AS agg7#41]
                  :     +- 'UnresolvedRelation [results]
                  +- 'Project [null AS i_item_id#42, null AS ca_country#43, null AS ca_state#44, null AS county#45, 'avg('agg1) AS agg1#46, 'avg('agg2) AS agg2#47, 'avg('agg3) AS agg3#48, 'avg('agg4) AS agg4#49, 'avg('agg5) AS agg5#50, 'avg('agg6) AS agg6#51, 'avg('agg7) AS agg7#52]
                     +- 'UnresolvedRelation [results]

== Analyzed Logical Plan ==
i_item_id: string, ca_country: string, ca_state: string, ca_county: string, agg1: decimal(16,6), agg2: decimal(16,6), agg3: decimal(16,6), agg4: decimal(16,6), agg5: decimal(16,6), agg6: decimal(16,6), agg7: decimal(16,6)
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#53 ASC NULLS FIRST, ca_state#54 ASC NULLS FIRST, ca_county#55 ASC NULLS FIRST, i_item_id#56 ASC NULLS FIRST], true
      +- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, agg1#8, agg2#9, agg3#10, agg4#11, agg5#12, agg6#13, agg7#14]
         +- SubqueryAlias foo
            +- Union false, false
               :- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, agg1#8, agg2#9, agg3#10, agg4#11, agg5#12, agg6#13, agg7#14]
               :  +- Union false, false
               :     :- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, agg1#8, agg2#9, agg3#10, agg4#11, agg5#12, agg6#13, agg7#14]
               :     :  +- Union false, false
               :     :     :- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, agg1#8, agg2#9, agg3#10, agg4#11, agg5#12, agg6#13, agg7#14]
               :     :     :  +- Union false, false
               :     :     :     :- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, agg1#8, agg2#9, agg3#10, agg4#11, agg5#12, agg6#13, agg7#14]
               :     :     :     :  +- Aggregate [i_item_id#56, ca_country#53, ca_state#54, ca_county#55], [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, avg(agg1#1) AS agg1#8, avg(agg2#2) AS agg2#9, avg(agg3#3) AS agg3#10, avg(agg4#4) AS agg4#11, avg(agg5#5) AS agg5#12, avg(agg6#6) AS agg6#13, avg(agg7#7) AS agg7#14]
               :     :     :     :     +- SubqueryAlias results
               :     :     :     :        +- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
               :     :     :     :           +- Filter (((((cs_sold_date_sk#64 = d_date_sk#65) AND (cs_item_sk#66 = i_item_sk#67)) AND (cs_bill_cdemo_sk#68 = cd_demo_sk#69)) AND (((cs_bill_customer_sk#70 = c_customer_sk#71) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College))) AND ((((c_current_cdemo_sk#74 = cd_demo_sk#75) AND (c_current_addr_sk#76 = ca_address_sk#77)) AND c_birth_month#78 IN (9,5,12,4,1,10)) AND ((d_year#79 = 2001) AND ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN))))
               :     :     :     :              +- Join Inner
               :     :     :     :                 :- Join Inner
               :     :     :     :                 :  :- Join Inner
               :     :     :     :                 :  :  :- Join Inner
               :     :     :     :                 :  :  :  :- Join Inner
               :     :     :     :                 :  :  :  :  :- Join Inner
               :     :     :     :                 :  :  :  :  :  :- SubqueryAlias spark_catalog.default.catalog_sales
               :     :     :     :                 :  :  :  :  :  :  +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
               :     :     :     :                 :  :  :  :  :  +- SubqueryAlias cd1
               :     :     :     :                 :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :     :     :     :                 :  :  :  :  :        +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
               :     :     :     :                 :  :  :  :  +- SubqueryAlias cd2
               :     :     :     :                 :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :     :     :     :                 :  :  :  :        +- Relation[cd_demo_sk#75,cd_gender#102,cd_marital_status#103,cd_education_status#104,cd_purchase_estimate#105,cd_credit_rating#106,cd_dep_count#107,cd_dep_employed_count#108,cd_dep_college_count#109] parquet
               :     :     :     :                 :  :  :  +- SubqueryAlias spark_catalog.default.customer
               :     :     :     :                 :  :  :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
               :     :     :     :                 :  :  +- SubqueryAlias spark_catalog.default.customer_address
               :     :     :     :                 :  :     +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
               :     :     :     :                 :  +- SubqueryAlias spark_catalog.default.date_dim
               :     :     :     :                 :     +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
               :     :     :     :                 +- SubqueryAlias spark_catalog.default.item
               :     :     :     :                    +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
               :     :     :     +- Project [i_item_id#56 AS i_item_id#174, ca_country#53 AS ca_country#175, ca_state#54 AS ca_state#176, county#177 AS county#178, agg1#16 AS agg1#179, agg2#17 AS agg2#180, agg3#18 AS agg3#181, agg4#19 AS agg4#182, agg5#20 AS agg5#183, agg6#21 AS agg6#184, agg7#22 AS agg7#185]
               :     :     :        +- Project [i_item_id#56, ca_country#53, ca_state#54, cast(county#15 as string) AS county#177, agg1#16, agg2#17, agg3#18, agg4#19, agg5#20, agg6#21, agg7#22]
               :     :     :           +- Aggregate [i_item_id#56, ca_country#53, ca_state#54], [i_item_id#56, ca_country#53, ca_state#54, null AS county#15, avg(agg1#1) AS agg1#16, avg(agg2#2) AS agg2#17, avg(agg3#3) AS agg3#18, avg(agg4#4) AS agg4#19, avg(agg5#5) AS agg5#20, avg(agg6#6) AS agg6#21, avg(agg7#7) AS agg7#22]
               :     :     :              +- SubqueryAlias results
               :     :     :                 +- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
               :     :     :                    +- Filter (((((cs_sold_date_sk#64 = d_date_sk#65) AND (cs_item_sk#66 = i_item_sk#67)) AND (cs_bill_cdemo_sk#68 = cd_demo_sk#69)) AND (((cs_bill_customer_sk#70 = c_customer_sk#71) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College))) AND ((((c_current_cdemo_sk#74 = cd_demo_sk#186) AND (c_current_addr_sk#76 = ca_address_sk#77)) AND c_birth_month#78 IN (9,5,12,4,1,10)) AND ((d_year#79 = 2001) AND ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN))))
               :     :     :                       +- Join Inner
               :     :     :                          :- Join Inner
               :     :     :                          :  :- Join Inner
               :     :     :                          :  :  :- Join Inner
               :     :     :                          :  :  :  :- Join Inner
               :     :     :                          :  :  :  :  :- Join Inner
               :     :     :                          :  :  :  :  :  :- SubqueryAlias spark_catalog.default.catalog_sales
               :     :     :                          :  :  :  :  :  :  +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
               :     :     :                          :  :  :  :  :  +- SubqueryAlias cd1
               :     :     :                          :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :     :     :                          :  :  :  :  :        +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
               :     :     :                          :  :  :  :  +- SubqueryAlias cd2
               :     :     :                          :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :     :     :                          :  :  :  :        +- Relation[cd_demo_sk#186,cd_gender#187,cd_marital_status#188,cd_education_status#189,cd_purchase_estimate#190,cd_credit_rating#191,cd_dep_count#192,cd_dep_employed_count#193,cd_dep_college_count#194] parquet
               :     :     :                          :  :  :  +- SubqueryAlias spark_catalog.default.customer
               :     :     :                          :  :  :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
               :     :     :                          :  :  +- SubqueryAlias spark_catalog.default.customer_address
               :     :     :                          :  :     +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
               :     :     :                          :  +- SubqueryAlias spark_catalog.default.date_dim
               :     :     :                          :     +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
               :     :     :                          +- SubqueryAlias spark_catalog.default.item
               :     :     :                             +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
               :     :     +- Project [i_item_id#56 AS i_item_id#195, ca_country#53 AS ca_country#196, ca_state#197 AS ca_state#198, county#199 AS county#200, agg1#25 AS agg1#201, agg2#26 AS agg2#202, agg3#27 AS agg3#203, agg4#28 AS agg4#204, agg5#29 AS agg5#205, agg6#30 AS agg6#206, agg7#31 AS agg7#207]
               :     :        +- Project [i_item_id#56, ca_country#53, cast(ca_state#23 as string) AS ca_state#197, cast(county#24 as string) AS county#199, agg1#25, agg2#26, agg3#27, agg4#28, agg5#29, agg6#30, agg7#31]
               :     :           +- Aggregate [i_item_id#56, ca_country#53], [i_item_id#56, ca_country#53, null AS ca_state#23, null AS county#24, avg(agg1#1) AS agg1#25, avg(agg2#2) AS agg2#26, avg(agg3#3) AS agg3#27, avg(agg4#4) AS agg4#28, avg(agg5#5) AS agg5#29, avg(agg6#6) AS agg6#30, avg(agg7#7) AS agg7#31]
               :     :              +- SubqueryAlias results
               :     :                 +- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
               :     :                    +- Filter (((((cs_sold_date_sk#64 = d_date_sk#65) AND (cs_item_sk#66 = i_item_sk#67)) AND (cs_bill_cdemo_sk#68 = cd_demo_sk#69)) AND (((cs_bill_customer_sk#70 = c_customer_sk#71) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College))) AND ((((c_current_cdemo_sk#74 = cd_demo_sk#208) AND (c_current_addr_sk#76 = ca_address_sk#77)) AND c_birth_month#78 IN (9,5,12,4,1,10)) AND ((d_year#79 = 2001) AND ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN))))
               :     :                       +- Join Inner
               :     :                          :- Join Inner
               :     :                          :  :- Join Inner
               :     :                          :  :  :- Join Inner
               :     :                          :  :  :  :- Join Inner
               :     :                          :  :  :  :  :- Join Inner
               :     :                          :  :  :  :  :  :- SubqueryAlias spark_catalog.default.catalog_sales
               :     :                          :  :  :  :  :  :  +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
               :     :                          :  :  :  :  :  +- SubqueryAlias cd1
               :     :                          :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :     :                          :  :  :  :  :        +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
               :     :                          :  :  :  :  +- SubqueryAlias cd2
               :     :                          :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :     :                          :  :  :  :        +- Relation[cd_demo_sk#208,cd_gender#209,cd_marital_status#210,cd_education_status#211,cd_purchase_estimate#212,cd_credit_rating#213,cd_dep_count#214,cd_dep_employed_count#215,cd_dep_college_count#216] parquet
               :     :                          :  :  :  +- SubqueryAlias spark_catalog.default.customer
               :     :                          :  :  :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
               :     :                          :  :  +- SubqueryAlias spark_catalog.default.customer_address
               :     :                          :  :     +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
               :     :                          :  +- SubqueryAlias spark_catalog.default.date_dim
               :     :                          :     +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
               :     :                          +- SubqueryAlias spark_catalog.default.item
               :     :                             +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
               :     +- Project [i_item_id#56 AS i_item_id#217, ca_country#218 AS ca_country#219, ca_state#220 AS ca_state#221, county#222 AS county#223, agg1#35 AS agg1#224, agg2#36 AS agg2#225, agg3#37 AS agg3#226, agg4#38 AS agg4#227, agg5#39 AS agg5#228, agg6#40 AS agg6#229, agg7#41 AS agg7#230]
               :        +- Project [i_item_id#56, cast(ca_country#32 as string) AS ca_country#218, cast(ca_state#33 as string) AS ca_state#220, cast(county#34 as string) AS county#222, agg1#35, agg2#36, agg3#37, agg4#38, agg5#39, agg6#40, agg7#41]
               :           +- Aggregate [i_item_id#56], [i_item_id#56, null AS ca_country#32, null AS ca_state#33, null AS county#34, avg(agg1#1) AS agg1#35, avg(agg2#2) AS agg2#36, avg(agg3#3) AS agg3#37, avg(agg4#4) AS agg4#38, avg(agg5#5) AS agg5#39, avg(agg6#6) AS agg6#40, avg(agg7#7) AS agg7#41]
               :              +- SubqueryAlias results
               :                 +- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
               :                    +- Filter (((((cs_sold_date_sk#64 = d_date_sk#65) AND (cs_item_sk#66 = i_item_sk#67)) AND (cs_bill_cdemo_sk#68 = cd_demo_sk#69)) AND (((cs_bill_customer_sk#70 = c_customer_sk#71) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College))) AND ((((c_current_cdemo_sk#74 = cd_demo_sk#231) AND (c_current_addr_sk#76 = ca_address_sk#77)) AND c_birth_month#78 IN (9,5,12,4,1,10)) AND ((d_year#79 = 2001) AND ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN))))
               :                       +- Join Inner
               :                          :- Join Inner
               :                          :  :- Join Inner
               :                          :  :  :- Join Inner
               :                          :  :  :  :- Join Inner
               :                          :  :  :  :  :- Join Inner
               :                          :  :  :  :  :  :- SubqueryAlias spark_catalog.default.catalog_sales
               :                          :  :  :  :  :  :  +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
               :                          :  :  :  :  :  +- SubqueryAlias cd1
               :                          :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :                          :  :  :  :  :        +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
               :                          :  :  :  :  +- SubqueryAlias cd2
               :                          :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
               :                          :  :  :  :        +- Relation[cd_demo_sk#231,cd_gender#232,cd_marital_status#233,cd_education_status#234,cd_purchase_estimate#235,cd_credit_rating#236,cd_dep_count#237,cd_dep_employed_count#238,cd_dep_college_count#239] parquet
               :                          :  :  :  +- SubqueryAlias spark_catalog.default.customer
               :                          :  :  :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
               :                          :  :  +- SubqueryAlias spark_catalog.default.customer_address
               :                          :  :     +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
               :                          :  +- SubqueryAlias spark_catalog.default.date_dim
               :                          :     +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
               :                          +- SubqueryAlias spark_catalog.default.item
               :                             +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
               +- Project [cast(i_item_id#42 as string) AS i_item_id#240, cast(ca_country#43 as string) AS ca_country#241, cast(ca_state#44 as string) AS ca_state#242, cast(county#45 as string) AS county#243, agg1#46, agg2#47, agg3#48, agg4#49, agg5#50, agg6#51, agg7#52]
                  +- Aggregate [null AS i_item_id#42, null AS ca_country#43, null AS ca_state#44, null AS county#45, avg(agg1#1) AS agg1#46, avg(agg2#2) AS agg2#47, avg(agg3#3) AS agg3#48, avg(agg4#4) AS agg4#49, avg(agg5#5) AS agg5#50, avg(agg6#6) AS agg6#51, avg(agg7#7) AS agg7#52]
                     +- SubqueryAlias results
                        +- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
                           +- Filter (((((cs_sold_date_sk#64 = d_date_sk#65) AND (cs_item_sk#66 = i_item_sk#67)) AND (cs_bill_cdemo_sk#68 = cd_demo_sk#69)) AND (((cs_bill_customer_sk#70 = c_customer_sk#71) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College))) AND ((((c_current_cdemo_sk#74 = cd_demo_sk#244) AND (c_current_addr_sk#76 = ca_address_sk#77)) AND c_birth_month#78 IN (9,5,12,4,1,10)) AND ((d_year#79 = 2001) AND ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- Join Inner
                                 :  :  :  :- Join Inner
                                 :  :  :  :  :- Join Inner
                                 :  :  :  :  :  :- SubqueryAlias spark_catalog.default.catalog_sales
                                 :  :  :  :  :  :  +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
                                 :  :  :  :  :  +- SubqueryAlias cd1
                                 :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                                 :  :  :  :  :        +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
                                 :  :  :  :  +- SubqueryAlias cd2
                                 :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                                 :  :  :  :        +- Relation[cd_demo_sk#244,cd_gender#245,cd_marital_status#246,cd_education_status#247,cd_purchase_estimate#248,cd_credit_rating#249,cd_dep_count#250,cd_dep_employed_count#251,cd_dep_college_count#252] parquet
                                 :  :  :  +- SubqueryAlias spark_catalog.default.customer
                                 :  :  :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
                                 :  :  +- SubqueryAlias spark_catalog.default.customer_address
                                 :  :     +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
                                 :  +- SubqueryAlias spark_catalog.default.date_dim
                                 :     +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
                                 +- SubqueryAlias spark_catalog.default.item
                                    +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#53 ASC NULLS FIRST, ca_state#54 ASC NULLS FIRST, ca_county#55 ASC NULLS FIRST, i_item_id#56 ASC NULLS FIRST], true
      +- Union false, false
         :- Aggregate [i_item_id#56, ca_country#53, ca_state#54, ca_county#55], [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, avg(agg1#1) AS agg1#8, avg(agg2#2) AS agg2#9, avg(agg3#3) AS agg3#10, avg(agg4#4) AS agg4#11, avg(agg5#5) AS agg5#12, avg(agg6#6) AS agg6#13, avg(agg7#7) AS agg7#14]
         :  +- Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
         :     +- Join Inner, (cs_bill_customer_sk#70 = c_customer_sk#71)
         :        :- Project [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, i_item_id#56]
         :        :  +- Join Inner, (cs_item_sk#66 = i_item_sk#67)
         :        :     :- Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :  +- Join Inner, (cs_sold_date_sk#64 = d_date_sk#65)
         :        :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :     :  +- Join Inner, (cs_bill_cdemo_sk#68 = cd_demo_sk#69)
         :        :     :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_bill_cdemo_sk#68, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61]
         :        :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
         :        :     :     :     :     +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
         :        :     :     :     +- Project [cd_demo_sk#69, cd_dep_count#63]
         :        :     :     :        +- Filter ((((isnotnull(cd_gender#72) AND isnotnull(cd_education_status#73)) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College)) AND isnotnull(cd_demo_sk#69))
         :        :     :     :           +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
         :        :     :     +- Project [d_date_sk#65]
         :        :     :        +- Filter ((isnotnull(d_year#79) AND (d_year#79 = 2001)) AND isnotnull(d_date_sk#65))
         :        :     :           +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
         :        :     +- Project [i_item_sk#67, i_item_id#56]
         :        :        +- Filter isnotnull(i_item_sk#67)
         :        :           +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
         :        +- Project [c_customer_sk#71, c_birth_year#62, ca_county#55, ca_state#54, ca_country#53]
         :           +- Join Inner, (c_current_cdemo_sk#74 = cd_demo_sk#75)
         :              :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62, ca_county#55, ca_state#54, ca_country#53]
         :              :  +- Join Inner, (c_current_addr_sk#76 = ca_address_sk#77)
         :              :     :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
         :              :     :  +- Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
         :              :     :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
         :              :     +- Project [ca_address_sk#77, ca_county#55, ca_state#54, ca_country#53]
         :              :        +- Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
         :              :           +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
         :              +- Project [cd_demo_sk#75]
         :                 +- Filter isnotnull(cd_demo_sk#75)
         :                    +- Relation[cd_demo_sk#75,cd_gender#102,cd_marital_status#103,cd_education_status#104,cd_purchase_estimate#105,cd_credit_rating#106,cd_dep_count#107,cd_dep_employed_count#108,cd_dep_college_count#109] parquet
         :- Aggregate [i_item_id#56, ca_country#53, ca_state#54], [i_item_id#56, ca_country#53, ca_state#54, null AS county#178, avg(agg1#1) AS agg1#179, avg(agg2#2) AS agg2#180, avg(agg3#3) AS agg3#181, avg(agg4#4) AS agg4#182, avg(agg5#5) AS agg5#183, avg(agg6#6) AS agg6#184, avg(agg7#7) AS agg7#185]
         :  +- Project [i_item_id#56, ca_country#53, ca_state#54, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
         :     +- Join Inner, (cs_bill_customer_sk#70 = c_customer_sk#71)
         :        :- Project [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, i_item_id#56]
         :        :  +- Join Inner, (cs_item_sk#66 = i_item_sk#67)
         :        :     :- Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :  +- Join Inner, (cs_sold_date_sk#64 = d_date_sk#65)
         :        :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :     :  +- Join Inner, (cs_bill_cdemo_sk#68 = cd_demo_sk#69)
         :        :     :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_bill_cdemo_sk#68, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61]
         :        :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
         :        :     :     :     :     +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
         :        :     :     :     +- Project [cd_demo_sk#69, cd_dep_count#63]
         :        :     :     :        +- Filter ((((isnotnull(cd_gender#72) AND isnotnull(cd_education_status#73)) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College)) AND isnotnull(cd_demo_sk#69))
         :        :     :     :           +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
         :        :     :     +- Project [d_date_sk#65]
         :        :     :        +- Filter ((isnotnull(d_year#79) AND (d_year#79 = 2001)) AND isnotnull(d_date_sk#65))
         :        :     :           +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
         :        :     +- Project [i_item_sk#67, i_item_id#56]
         :        :        +- Filter isnotnull(i_item_sk#67)
         :        :           +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
         :        +- Project [c_customer_sk#71, c_birth_year#62, ca_state#54, ca_country#53]
         :           +- Join Inner, (c_current_cdemo_sk#74 = cd_demo_sk#186)
         :              :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62, ca_state#54, ca_country#53]
         :              :  +- Join Inner, (c_current_addr_sk#76 = ca_address_sk#77)
         :              :     :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
         :              :     :  +- Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
         :              :     :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
         :              :     +- Project [ca_address_sk#77, ca_state#54, ca_country#53]
         :              :        +- Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
         :              :           +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
         :              +- Project [cd_demo_sk#186]
         :                 +- Filter isnotnull(cd_demo_sk#186)
         :                    +- Relation[cd_demo_sk#186,cd_gender#187,cd_marital_status#188,cd_education_status#189,cd_purchase_estimate#190,cd_credit_rating#191,cd_dep_count#192,cd_dep_employed_count#193,cd_dep_college_count#194] parquet
         :- Aggregate [i_item_id#56, ca_country#53], [i_item_id#56, ca_country#53, null AS ca_state#198, null AS county#200, avg(agg1#1) AS agg1#201, avg(agg2#2) AS agg2#202, avg(agg3#3) AS agg3#203, avg(agg4#4) AS agg4#204, avg(agg5#5) AS agg5#205, avg(agg6#6) AS agg6#206, avg(agg7#7) AS agg7#207]
         :  +- Project [i_item_id#56, ca_country#53, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
         :     +- Join Inner, (cs_bill_customer_sk#70 = c_customer_sk#71)
         :        :- Project [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, i_item_id#56]
         :        :  +- Join Inner, (cs_item_sk#66 = i_item_sk#67)
         :        :     :- Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :  +- Join Inner, (cs_sold_date_sk#64 = d_date_sk#65)
         :        :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :     :  +- Join Inner, (cs_bill_cdemo_sk#68 = cd_demo_sk#69)
         :        :     :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_bill_cdemo_sk#68, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61]
         :        :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
         :        :     :     :     :     +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
         :        :     :     :     +- Project [cd_demo_sk#69, cd_dep_count#63]
         :        :     :     :        +- Filter ((((isnotnull(cd_gender#72) AND isnotnull(cd_education_status#73)) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College)) AND isnotnull(cd_demo_sk#69))
         :        :     :     :           +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
         :        :     :     +- Project [d_date_sk#65]
         :        :     :        +- Filter ((isnotnull(d_year#79) AND (d_year#79 = 2001)) AND isnotnull(d_date_sk#65))
         :        :     :           +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
         :        :     +- Project [i_item_sk#67, i_item_id#56]
         :        :        +- Filter isnotnull(i_item_sk#67)
         :        :           +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
         :        +- Project [c_customer_sk#71, c_birth_year#62, ca_country#53]
         :           +- Join Inner, (c_current_cdemo_sk#74 = cd_demo_sk#208)
         :              :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62, ca_country#53]
         :              :  +- Join Inner, (c_current_addr_sk#76 = ca_address_sk#77)
         :              :     :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
         :              :     :  +- Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
         :              :     :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
         :              :     +- Project [ca_address_sk#77, ca_country#53]
         :              :        +- Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
         :              :           +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
         :              +- Project [cd_demo_sk#208]
         :                 +- Filter isnotnull(cd_demo_sk#208)
         :                    +- Relation[cd_demo_sk#208,cd_gender#209,cd_marital_status#210,cd_education_status#211,cd_purchase_estimate#212,cd_credit_rating#213,cd_dep_count#214,cd_dep_employed_count#215,cd_dep_college_count#216] parquet
         :- Aggregate [i_item_id#56], [i_item_id#56, null AS ca_country#219, null AS ca_state#221, null AS county#223, avg(agg1#1) AS agg1#224, avg(agg2#2) AS agg2#225, avg(agg3#3) AS agg3#226, avg(agg4#4) AS agg4#227, avg(agg5#5) AS agg5#228, avg(agg6#6) AS agg6#229, avg(agg7#7) AS agg7#230]
         :  +- Project [i_item_id#56, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
         :     +- Join Inner, (cs_item_sk#66 = i_item_sk#67)
         :        :- Project [cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, c_birth_year#62]
         :        :  +- Join Inner, (cs_bill_customer_sk#70 = c_customer_sk#71)
         :        :     :- Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :  +- Join Inner, (cs_sold_date_sk#64 = d_date_sk#65)
         :        :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
         :        :     :     :  +- Join Inner, (cs_bill_cdemo_sk#68 = cd_demo_sk#69)
         :        :     :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_bill_cdemo_sk#68, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61]
         :        :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
         :        :     :     :     :     +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
         :        :     :     :     +- Project [cd_demo_sk#69, cd_dep_count#63]
         :        :     :     :        +- Filter ((((isnotnull(cd_gender#72) AND isnotnull(cd_education_status#73)) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College)) AND isnotnull(cd_demo_sk#69))
         :        :     :     :           +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
         :        :     :     +- Project [d_date_sk#65]
         :        :     :        +- Filter ((isnotnull(d_year#79) AND (d_year#79 = 2001)) AND isnotnull(d_date_sk#65))
         :        :     :           +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
         :        :     +- Project [c_customer_sk#71, c_birth_year#62]
         :        :        +- Join Inner, (c_current_cdemo_sk#74 = cd_demo_sk#231)
         :        :           :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62]
         :        :           :  +- Join Inner, (c_current_addr_sk#76 = ca_address_sk#77)
         :        :           :     :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
         :        :           :     :  +- Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
         :        :           :     :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
         :        :           :     +- Project [ca_address_sk#77]
         :        :           :        +- Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
         :        :           :           +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
         :        :           +- Project [cd_demo_sk#231]
         :        :              +- Filter isnotnull(cd_demo_sk#231)
         :        :                 +- Relation[cd_demo_sk#231,cd_gender#232,cd_marital_status#233,cd_education_status#234,cd_purchase_estimate#235,cd_credit_rating#236,cd_dep_count#237,cd_dep_employed_count#238,cd_dep_college_count#239] parquet
         :        +- Project [i_item_sk#67, i_item_id#56]
         :           +- Filter isnotnull(i_item_sk#67)
         :              +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
         +- Aggregate [null AS i_item_id#240, null AS ca_country#241, null AS ca_state#242, null AS county#243, avg(agg1#1) AS agg1#46, avg(agg2#2) AS agg2#47, avg(agg3#3) AS agg3#48, avg(agg4#4) AS agg4#49, avg(agg5#5) AS agg5#50, avg(agg6#6) AS agg6#51, avg(agg7#7) AS agg7#52]
            +- Project [cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
               +- Join Inner, (cs_bill_customer_sk#70 = c_customer_sk#71)
                  :- Project [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
                  :  +- Join Inner, (cs_item_sk#66 = i_item_sk#67)
                  :     :- Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
                  :     :  +- Join Inner, (cs_sold_date_sk#64 = d_date_sk#65)
                  :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
                  :     :     :  +- Join Inner, (cs_bill_cdemo_sk#68 = cd_demo_sk#69)
                  :     :     :     :- Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_bill_cdemo_sk#68, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61]
                  :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
                  :     :     :     :     +- Relation[cs_sold_date_sk#64,cs_sold_time_sk#80,cs_ship_date_sk#81,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_bill_hdemo_sk#82,cs_bill_addr_sk#83,cs_ship_customer_sk#84,cs_ship_cdemo_sk#85,cs_ship_hdemo_sk#86,cs_ship_addr_sk#87,cs_call_center_sk#88,cs_catalog_page_sk#89,cs_ship_mode_sk#90,cs_warehouse_sk#91,cs_item_sk#66,cs_promo_sk#92,cs_order_number#93,cs_quantity#57,cs_wholesale_cost#94,cs_list_price#58,cs_sales_price#60,cs_ext_discount_amt#95,cs_ext_sales_price#96,... 10 more fields] parquet
                  :     :     :     +- Project [cd_demo_sk#69, cd_dep_count#63]
                  :     :     :        +- Filter ((((isnotnull(cd_gender#72) AND isnotnull(cd_education_status#73)) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College)) AND isnotnull(cd_demo_sk#69))
                  :     :     :           +- Relation[cd_demo_sk#69,cd_gender#72,cd_marital_status#97,cd_education_status#73,cd_purchase_estimate#98,cd_credit_rating#99,cd_dep_count#63,cd_dep_employed_count#100,cd_dep_college_count#101] parquet
                  :     :     +- Project [d_date_sk#65]
                  :     :        +- Filter ((isnotnull(d_year#79) AND (d_year#79 = 2001)) AND isnotnull(d_date_sk#65))
                  :     :           +- Relation[d_date_sk#65,d_date_id#132,d_date#133,d_month_seq#134,d_week_seq#135,d_quarter_seq#136,d_year#79,d_dow#137,d_moy#138,d_dom#139,d_qoy#140,d_fy_year#141,d_fy_quarter_seq#142,d_fy_week_seq#143,d_day_name#144,d_quarter_name#145,d_holiday#146,d_weekend#147,d_following_holiday#148,d_first_dom#149,d_last_dom#150,d_same_day_ly#151,d_same_day_lq#152,d_current_day#153,... 4 more fields] parquet
                  :     +- Project [i_item_sk#67]
                  :        +- Filter isnotnull(i_item_sk#67)
                  :           +- Relation[i_item_sk#67,i_item_id#56,i_rec_start_date#154,i_rec_end_date#155,i_item_desc#156,i_current_price#157,i_wholesale_cost#158,i_brand_id#159,i_brand#160,i_class_id#161,i_class#162,i_category_id#163,i_category#164,i_manufact_id#165,i_manufact#166,i_size#167,i_formulation#168,i_color#169,i_units#170,i_container#171,i_manager_id#172,i_product_name#173] parquet
                  +- Project [c_customer_sk#71, c_birth_year#62]
                     +- Join Inner, (c_current_cdemo_sk#74 = cd_demo_sk#244)
                        :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62]
                        :  +- Join Inner, (c_current_addr_sk#76 = ca_address_sk#77)
                        :     :- Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
                        :     :  +- Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
                        :     :     +- Relation[c_customer_sk#71,c_customer_id#110,c_current_cdemo_sk#74,c_current_hdemo_sk#111,c_current_addr_sk#76,c_first_shipto_date_sk#112,c_first_sales_date_sk#113,c_salutation#114,c_first_name#115,c_last_name#116,c_preferred_cust_flag#117,c_birth_day#118,c_birth_month#78,c_birth_year#62,c_birth_country#119,c_login#120,c_email_address#121,c_last_review_date#122] parquet
                        :     +- Project [ca_address_sk#77]
                        :        +- Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
                        :           +- Relation[ca_address_sk#77,ca_address_id#123,ca_street_number#124,ca_street_name#125,ca_street_type#126,ca_suite_number#127,ca_city#128,ca_county#55,ca_state#54,ca_zip#129,ca_country#53,ca_gmt_offset#130,ca_location_type#131] parquet
                        +- Project [cd_demo_sk#244]
                           +- Filter isnotnull(cd_demo_sk#244)
                              +- Relation[cd_demo_sk#244,cd_gender#245,cd_marital_status#246,cd_education_status#247,cd_purchase_estimate#248,cd_credit_rating#249,cd_dep_count#250,cd_dep_employed_count#251,cd_dep_college_count#252] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[ca_country#53 ASC NULLS FIRST,ca_state#54 ASC NULLS FIRST,ca_county#55 ASC NULLS FIRST,i_item_id#56 ASC NULLS FIRST], output=[i_item_id#56,ca_country#53,ca_state#54,ca_county#55,agg1#8,agg2#9,agg3#10,agg4#11,agg5#12,agg6#13,agg7#14])
+- Union
   :- *(14) HashAggregate(keys=[i_item_id#56, ca_country#53, ca_state#54, ca_county#55], functions=[avg(agg1#1), avg(agg2#2), avg(agg3#3), avg(agg4#4), avg(agg5#5), avg(agg6#6), avg(agg7#7)], output=[i_item_id#56, ca_country#53, ca_state#54, ca_county#55, agg1#8, agg2#9, agg3#10, agg4#11, agg5#12, agg6#13, agg7#14])
   :  +- Exchange hashpartitioning(i_item_id#56, ca_country#53, ca_state#54, ca_county#55, 5), true, [id=#253]
   :     +- *(13) HashAggregate(keys=[i_item_id#56, ca_country#53, ca_state#54, ca_county#55], functions=[partial_avg(agg1#1), partial_avg(agg2#2), partial_avg(agg3#3), partial_avg(agg4#4), partial_avg(agg5#5), partial_avg(agg6#6), partial_avg(agg7#7)], output=[i_item_id#56, ca_country#53, ca_state#54, ca_county#55, sum#254, count#255, sum#256, count#257, sum#258, count#259, sum#260, count#261, sum#262, count#263, sum#264, count#265, sum#266, count#267])
   :        +- *(13) Project [i_item_id#56, ca_country#53, ca_state#54, ca_county#55, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
   :           +- *(13) SortMergeJoin [cs_bill_customer_sk#70], [c_customer_sk#71], Inner
   :              :- *(5) Sort [cs_bill_customer_sk#70 ASC NULLS FIRST], false, 0
   :              :  +- Exchange hashpartitioning(cs_bill_customer_sk#70, 5), true, [id=#268]
   :              :     +- *(4) Project [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, i_item_id#56]
   :              :        +- *(4) BroadcastHashJoin [cs_item_sk#66], [i_item_sk#67], Inner, BuildRight, false
   :              :           :- *(4) Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
   :              :           :  +- *(4) BroadcastHashJoin [cs_sold_date_sk#64], [d_date_sk#65], Inner, BuildRight, false
   :              :           :     :- *(4) Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
   :              :           :     :  +- *(4) BroadcastHashJoin [cs_bill_cdemo_sk#68], [cd_demo_sk#69], Inner, BuildRight, false
   :              :           :     :     :- *(4) Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
   :              :           :     :     :  +- *(4) ColumnarToRow
   :              :           :     :     :     +- FileScan parquet default.catalog_sales[cs_sold_date_sk#64,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_item_sk#66,cs_quantity#57,cs_list_price#58,cs_sales_price#60,cs_coupon_amt#59,cs_net_profit#61] Batched: true, DataFilters: [isnotnull(cs_bill_cdemo_sk#68), isnotnull(cs_bill_customer_sk#70), isnotnull(cs_sold_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk), IsNotNu..., ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantit...
   :              :           :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#269]
   :              :           :     :        +- *(1) Project [cd_demo_sk#69, cd_dep_count#63]
   :              :           :     :           +- *(1) Filter ((((isnotnull(cd_gender#72) AND isnotnull(cd_education_status#73)) AND (cd_gender#72 = M)) AND (cd_education_status#73 = College)) AND isnotnull(cd_demo_sk#69))
   :              :           :     :              +- *(1) ColumnarToRow
   :              :           :     :                 +- FileScan parquet default.customer_demographics[cd_demo_sk#69,cd_gender#72,cd_education_status#73,cd_dep_count#63] Batched: true, DataFilters: [isnotnull(cd_gender#72), isnotnull(cd_education_status#73), (cd_gender#72 = M), (cd_edu..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_gender), IsNotNull(cd_education_status), EqualTo(cd_gender,M), EqualTo(cd_education..., ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_education_status:string,cd_dep_count:int>
   :              :           :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#270]
   :              :           :        +- *(2) Project [d_date_sk#65]
   :              :           :           +- *(2) Filter ((isnotnull(d_year#79) AND (d_year#79 = 2001)) AND isnotnull(d_date_sk#65))
   :              :           :              +- *(2) ColumnarToRow
   :              :           :                 +- FileScan parquet default.date_dim[d_date_sk#65,d_year#79] Batched: true, DataFilters: [isnotnull(d_year#79), (d_year#79 = 2001), isnotnull(d_date_sk#65)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
   :              :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#271]
   :              :              +- *(3) Filter isnotnull(i_item_sk#67)
   :              :                 +- *(3) ColumnarToRow
   :              :                    +- FileScan parquet default.item[i_item_sk#67,i_item_id#56] Batched: true, DataFilters: [isnotnull(i_item_sk#67)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
   :              +- *(12) Sort [c_customer_sk#71 ASC NULLS FIRST], false, 0
   :                 +- Exchange hashpartitioning(c_customer_sk#71, 5), true, [id=#272]
   :                    +- *(11) Project [c_customer_sk#71, c_birth_year#62, ca_county#55, ca_state#54, ca_country#53]
   :                       +- *(11) SortMergeJoin [c_current_cdemo_sk#74], [cd_demo_sk#75], Inner
   :                          :- *(8) Sort [c_current_cdemo_sk#74 ASC NULLS FIRST], false, 0
   :                          :  +- Exchange hashpartitioning(c_current_cdemo_sk#74, 5), true, [id=#273]
   :                          :     +- *(7) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62, ca_county#55, ca_state#54, ca_country#53]
   :                          :        +- *(7) BroadcastHashJoin [c_current_addr_sk#76], [ca_address_sk#77], Inner, BuildRight, false
   :                          :           :- *(7) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
   :                          :           :  +- *(7) Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
   :                          :           :     +- *(7) ColumnarToRow
   :                          :           :        +- FileScan parquet default.customer[c_customer_sk#71,c_current_cdemo_sk#74,c_current_addr_sk#76,c_birth_month#78,c_birth_year#62] Batched: true, DataFilters: [c_birth_month#78 IN (9,5,12,4,1,10), isnotnull(c_customer_sk#71), isnotnull(c_current_cdem..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(c_birth_month, [9,5,12,4,1,10]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsN..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_y...
   :                          :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#274]
   :                          :              +- *(6) Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
   :                          :                 +- *(6) ColumnarToRow
   :                          :                    +- FileScan parquet default.customer_address[ca_address_sk#77,ca_county#55,ca_state#54,ca_country#53] Batched: true, DataFilters: [ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN), isnotnull(ca_address_sk#77)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_state, [ND,WI,AL,NC,OK,MS,TN]), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_county:string,ca_state:string,ca_country:string>
   :                          +- *(10) Sort [cd_demo_sk#75 ASC NULLS FIRST], false, 0
   :                             +- Exchange hashpartitioning(cd_demo_sk#75, 5), true, [id=#275]
   :                                +- *(9) Filter isnotnull(cd_demo_sk#75)
   :                                   +- *(9) ColumnarToRow
   :                                      +- FileScan parquet default.customer_demographics[cd_demo_sk#75] Batched: true, DataFilters: [isnotnull(cd_demo_sk#75)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int>
   :- *(28) HashAggregate(keys=[i_item_id#56, ca_country#53, ca_state#54], functions=[avg(agg1#1), avg(agg2#2), avg(agg3#3), avg(agg4#4), avg(agg5#5), avg(agg6#6), avg(agg7#7)], output=[i_item_id#56, ca_country#53, ca_state#54, county#178, agg1#179, agg2#180, agg3#181, agg4#182, agg5#183, agg6#184, agg7#185])
   :  +- Exchange hashpartitioning(i_item_id#56, ca_country#53, ca_state#54, 5), true, [id=#276]
   :     +- *(27) HashAggregate(keys=[i_item_id#56, ca_country#53, ca_state#54], functions=[partial_avg(agg1#1), partial_avg(agg2#2), partial_avg(agg3#3), partial_avg(agg4#4), partial_avg(agg5#5), partial_avg(agg6#6), partial_avg(agg7#7)], output=[i_item_id#56, ca_country#53, ca_state#54, sum#277, count#278, sum#279, count#280, sum#281, count#282, sum#283, count#284, sum#285, count#286, sum#287, count#288, sum#289, count#290])
   :        +- *(27) Project [i_item_id#56, ca_country#53, ca_state#54, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
   :           +- *(27) SortMergeJoin [cs_bill_customer_sk#70], [c_customer_sk#71], Inner
   :              :- *(19) Sort [cs_bill_customer_sk#70 ASC NULLS FIRST], false, 0
   :              :  +- ReusedExchange [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, i_item_id#56], Exchange hashpartitioning(cs_bill_customer_sk#70, 5), true, [id=#268]
   :              +- *(26) Sort [c_customer_sk#71 ASC NULLS FIRST], false, 0
   :                 +- Exchange hashpartitioning(c_customer_sk#71, 5), true, [id=#291]
   :                    +- *(25) Project [c_customer_sk#71, c_birth_year#62, ca_state#54, ca_country#53]
   :                       +- *(25) SortMergeJoin [c_current_cdemo_sk#74], [cd_demo_sk#186], Inner
   :                          :- *(22) Sort [c_current_cdemo_sk#74 ASC NULLS FIRST], false, 0
   :                          :  +- Exchange hashpartitioning(c_current_cdemo_sk#74, 5), true, [id=#292]
   :                          :     +- *(21) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62, ca_state#54, ca_country#53]
   :                          :        +- *(21) BroadcastHashJoin [c_current_addr_sk#76], [ca_address_sk#77], Inner, BuildRight, false
   :                          :           :- *(21) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
   :                          :           :  +- *(21) Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
   :                          :           :     +- *(21) ColumnarToRow
   :                          :           :        +- FileScan parquet default.customer[c_customer_sk#71,c_current_cdemo_sk#74,c_current_addr_sk#76,c_birth_month#78,c_birth_year#62] Batched: true, DataFilters: [c_birth_month#78 IN (9,5,12,4,1,10), isnotnull(c_customer_sk#71), isnotnull(c_current_cdem..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(c_birth_month, [9,5,12,4,1,10]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsN..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_y...
   :                          :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#293]
   :                          :              +- *(20) Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
   :                          :                 +- *(20) ColumnarToRow
   :                          :                    +- FileScan parquet default.customer_address[ca_address_sk#77,ca_state#54,ca_country#53] Batched: true, DataFilters: [ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN), isnotnull(ca_address_sk#77)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_state, [ND,WI,AL,NC,OK,MS,TN]), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
   :                          +- *(24) Sort [cd_demo_sk#186 ASC NULLS FIRST], false, 0
   :                             +- ReusedExchange [cd_demo_sk#186], Exchange hashpartitioning(cd_demo_sk#75, 5), true, [id=#275]
   :- *(42) HashAggregate(keys=[i_item_id#56, ca_country#53], functions=[avg(agg1#1), avg(agg2#2), avg(agg3#3), avg(agg4#4), avg(agg5#5), avg(agg6#6), avg(agg7#7)], output=[i_item_id#56, ca_country#53, ca_state#198, county#200, agg1#201, agg2#202, agg3#203, agg4#204, agg5#205, agg6#206, agg7#207])
   :  +- Exchange hashpartitioning(i_item_id#56, ca_country#53, 5), true, [id=#294]
   :     +- *(41) HashAggregate(keys=[i_item_id#56, ca_country#53], functions=[partial_avg(agg1#1), partial_avg(agg2#2), partial_avg(agg3#3), partial_avg(agg4#4), partial_avg(agg5#5), partial_avg(agg6#6), partial_avg(agg7#7)], output=[i_item_id#56, ca_country#53, sum#295, count#296, sum#297, count#298, sum#299, count#300, sum#301, count#302, sum#303, count#304, sum#305, count#306, sum#307, count#308])
   :        +- *(41) Project [i_item_id#56, ca_country#53, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
   :           +- *(41) SortMergeJoin [cs_bill_customer_sk#70], [c_customer_sk#71], Inner
   :              :- *(33) Sort [cs_bill_customer_sk#70 ASC NULLS FIRST], false, 0
   :              :  +- ReusedExchange [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, i_item_id#56], Exchange hashpartitioning(cs_bill_customer_sk#70, 5), true, [id=#268]
   :              +- *(40) Sort [c_customer_sk#71 ASC NULLS FIRST], false, 0
   :                 +- Exchange hashpartitioning(c_customer_sk#71, 5), true, [id=#309]
   :                    +- *(39) Project [c_customer_sk#71, c_birth_year#62, ca_country#53]
   :                       +- *(39) SortMergeJoin [c_current_cdemo_sk#74], [cd_demo_sk#208], Inner
   :                          :- *(36) Sort [c_current_cdemo_sk#74 ASC NULLS FIRST], false, 0
   :                          :  +- Exchange hashpartitioning(c_current_cdemo_sk#74, 5), true, [id=#310]
   :                          :     +- *(35) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62, ca_country#53]
   :                          :        +- *(35) BroadcastHashJoin [c_current_addr_sk#76], [ca_address_sk#77], Inner, BuildRight, false
   :                          :           :- *(35) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
   :                          :           :  +- *(35) Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
   :                          :           :     +- *(35) ColumnarToRow
   :                          :           :        +- FileScan parquet default.customer[c_customer_sk#71,c_current_cdemo_sk#74,c_current_addr_sk#76,c_birth_month#78,c_birth_year#62] Batched: true, DataFilters: [c_birth_month#78 IN (9,5,12,4,1,10), isnotnull(c_customer_sk#71), isnotnull(c_current_cdem..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(c_birth_month, [9,5,12,4,1,10]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsN..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_y...
   :                          :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#311]
   :                          :              +- *(34) Project [ca_address_sk#77, ca_country#53]
   :                          :                 +- *(34) Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
   :                          :                    +- *(34) ColumnarToRow
   :                          :                       +- FileScan parquet default.customer_address[ca_address_sk#77,ca_state#54,ca_country#53] Batched: true, DataFilters: [ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN), isnotnull(ca_address_sk#77)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_state, [ND,WI,AL,NC,OK,MS,TN]), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
   :                          +- *(38) Sort [cd_demo_sk#208 ASC NULLS FIRST], false, 0
   :                             +- ReusedExchange [cd_demo_sk#208], Exchange hashpartitioning(cd_demo_sk#75, 5), true, [id=#275]
   :- *(50) HashAggregate(keys=[i_item_id#56], functions=[avg(agg1#1), avg(agg2#2), avg(agg3#3), avg(agg4#4), avg(agg5#5), avg(agg6#6), avg(agg7#7)], output=[i_item_id#56, ca_country#219, ca_state#221, county#223, agg1#224, agg2#225, agg3#226, agg4#227, agg5#228, agg6#229, agg7#230])
   :  +- Exchange hashpartitioning(i_item_id#56, 5), true, [id=#312]
   :     +- *(49) HashAggregate(keys=[i_item_id#56], functions=[partial_avg(agg1#1), partial_avg(agg2#2), partial_avg(agg3#3), partial_avg(agg4#4), partial_avg(agg5#5), partial_avg(agg6#6), partial_avg(agg7#7)], output=[i_item_id#56, sum#313, count#314, sum#315, count#316, sum#317, count#318, sum#319, count#320, sum#321, count#322, sum#323, count#324, sum#325, count#326])
   :        +- *(49) Project [i_item_id#56, cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
   :           +- *(49) BroadcastHashJoin [cs_item_sk#66], [i_item_sk#67], Inner, BuildRight, false
   :              :- *(49) Project [cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63, c_birth_year#62]
   :              :  +- *(49) BroadcastHashJoin [cs_bill_customer_sk#70], [c_customer_sk#71], Inner, BuildRight, false
   :              :     :- *(49) Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
   :              :     :  +- *(49) BroadcastHashJoin [cs_sold_date_sk#64], [d_date_sk#65], Inner, BuildRight, false
   :              :     :     :- *(49) Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
   :              :     :     :  +- *(49) BroadcastHashJoin [cs_bill_cdemo_sk#68], [cd_demo_sk#69], Inner, BuildRight, false
   :              :     :     :     :- *(49) Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
   :              :     :     :     :  +- *(49) ColumnarToRow
   :              :     :     :     :     +- FileScan parquet default.catalog_sales[cs_sold_date_sk#64,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_item_sk#66,cs_quantity#57,cs_list_price#58,cs_sales_price#60,cs_coupon_amt#59,cs_net_profit#61] Batched: true, DataFilters: [isnotnull(cs_bill_cdemo_sk#68), isnotnull(cs_bill_customer_sk#70), isnotnull(cs_sold_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk), IsNotNu..., ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantit...
   :              :     :     :     +- ReusedExchange [cd_demo_sk#69, cd_dep_count#63], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#269]
   :              :     :     +- ReusedExchange [d_date_sk#65], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#270]
   :              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#327]
   :              :        +- *(47) Project [c_customer_sk#71, c_birth_year#62]
   :              :           +- *(47) BroadcastHashJoin [c_current_cdemo_sk#74], [cd_demo_sk#231], Inner, BuildLeft, false
   :              :              :- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, true] as bigint)),false), [id=#328]
   :              :              :  +- *(46) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_birth_year#62]
   :              :              :     +- *(46) BroadcastHashJoin [c_current_addr_sk#76], [ca_address_sk#77], Inner, BuildRight, false
   :              :              :        :- *(46) Project [c_customer_sk#71, c_current_cdemo_sk#74, c_current_addr_sk#76, c_birth_year#62]
   :              :              :        :  +- *(46) Filter (((c_birth_month#78 IN (9,5,12,4,1,10) AND isnotnull(c_customer_sk#71)) AND isnotnull(c_current_cdemo_sk#74)) AND isnotnull(c_current_addr_sk#76))
   :              :              :        :     +- *(46) ColumnarToRow
   :              :              :        :        +- FileScan parquet default.customer[c_customer_sk#71,c_current_cdemo_sk#74,c_current_addr_sk#76,c_birth_month#78,c_birth_year#62] Batched: true, DataFilters: [c_birth_month#78 IN (9,5,12,4,1,10), isnotnull(c_customer_sk#71), isnotnull(c_current_cdem..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(c_birth_month, [9,5,12,4,1,10]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsN..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_y...
   :              :              :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#329]
   :              :              :           +- *(45) Project [ca_address_sk#77]
   :              :              :              +- *(45) Filter (ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN) AND isnotnull(ca_address_sk#77))
   :              :              :                 +- *(45) ColumnarToRow
   :              :              :                    +- FileScan parquet default.customer_address[ca_address_sk#77,ca_state#54] Batched: true, DataFilters: [ca_state#54 IN (ND,WI,AL,NC,OK,MS,TN), isnotnull(ca_address_sk#77)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_state, [ND,WI,AL,NC,OK,MS,TN]), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string>
   :              :              +- *(47) Filter isnotnull(cd_demo_sk#231)
   :              :                 +- *(47) ColumnarToRow
   :              :                    +- FileScan parquet default.customer_demographics[cd_demo_sk#231] Batched: true, DataFilters: [isnotnull(cd_demo_sk#231)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int>
   :              +- ReusedExchange [i_item_sk#67, i_item_id#56], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#271]
   +- *(58) HashAggregate(keys=[], functions=[avg(agg1#1), avg(agg2#2), avg(agg3#3), avg(agg4#4), avg(agg5#5), avg(agg6#6), avg(agg7#7)], output=[i_item_id#240, ca_country#241, ca_state#242, county#243, agg1#46, agg2#47, agg3#48, agg4#49, agg5#50, agg6#51, agg7#52])
      +- Exchange SinglePartition, true, [id=#330]
         +- *(57) HashAggregate(keys=[], functions=[partial_avg(agg1#1), partial_avg(agg2#2), partial_avg(agg3#3), partial_avg(agg4#4), partial_avg(agg5#5), partial_avg(agg6#6), partial_avg(agg7#7)], output=[sum#331, count#332, sum#333, count#334, sum#335, count#336, sum#337, count#338, sum#339, count#340, sum#341, count#342, sum#343, count#344])
            +- *(57) Project [cast(cs_quantity#57 as decimal(12,2)) AS agg1#1, cast(cs_list_price#58 as decimal(12,2)) AS agg2#2, cast(cs_coupon_amt#59 as decimal(12,2)) AS agg3#3, cast(cs_sales_price#60 as decimal(12,2)) AS agg4#4, cast(cs_net_profit#61 as decimal(12,2)) AS agg5#5, cast(c_birth_year#62 as decimal(12,2)) AS agg6#6, cast(cd_dep_count#63 as decimal(12,2)) AS agg7#7]
               +- *(57) BroadcastHashJoin [cs_bill_customer_sk#70], [c_customer_sk#71], Inner, BuildRight, false
                  :- *(57) Project [cs_bill_customer_sk#70, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
                  :  +- *(57) BroadcastHashJoin [cs_item_sk#66], [i_item_sk#67], Inner, BuildRight, false
                  :     :- *(57) Project [cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
                  :     :  +- *(57) BroadcastHashJoin [cs_sold_date_sk#64], [d_date_sk#65], Inner, BuildRight, false
                  :     :     :- *(57) Project [cs_sold_date_sk#64, cs_bill_customer_sk#70, cs_item_sk#66, cs_quantity#57, cs_list_price#58, cs_sales_price#60, cs_coupon_amt#59, cs_net_profit#61, cd_dep_count#63]
                  :     :     :  +- *(57) BroadcastHashJoin [cs_bill_cdemo_sk#68], [cd_demo_sk#69], Inner, BuildRight, false
                  :     :     :     :- *(57) Filter (((isnotnull(cs_bill_cdemo_sk#68) AND isnotnull(cs_bill_customer_sk#70)) AND isnotnull(cs_sold_date_sk#64)) AND isnotnull(cs_item_sk#66))
                  :     :     :     :  +- *(57) ColumnarToRow
                  :     :     :     :     +- FileScan parquet default.catalog_sales[cs_sold_date_sk#64,cs_bill_customer_sk#70,cs_bill_cdemo_sk#68,cs_item_sk#66,cs_quantity#57,cs_list_price#58,cs_sales_price#60,cs_coupon_amt#59,cs_net_profit#61] Batched: true, DataFilters: [isnotnull(cs_bill_cdemo_sk#68), isnotnull(cs_bill_customer_sk#70), isnotnull(cs_sold_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk), IsNotNu..., ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantit...
                  :     :     :     +- ReusedExchange [cd_demo_sk#69, cd_dep_count#63], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#269]
                  :     :     +- ReusedExchange [d_date_sk#65], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#270]
                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#345]
                  :        +- *(53) Filter isnotnull(i_item_sk#67)
                  :           +- *(53) ColumnarToRow
                  :              +- FileScan parquet default.item[i_item_sk#67] Batched: true, DataFilters: [isnotnull(i_item_sk#67)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int>
                  +- ReusedExchange [c_customer_sk#71, c_birth_year#62], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#327]
