== Parsed Logical Plan ==
'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort ['i_item_id ASC NULLS FIRST, 'i_item_desc ASC NULLS FIRST, 's_store_id ASC NULLS FIRST, 's_store_name ASC NULLS FIRST], true
      +- 'Aggregate ['i_item_id, 'i_item_desc, 's_store_id, 's_store_name], ['i_item_id, 'i_item_desc, 's_store_id, 's_store_name, 'sum('ss_quantity) AS store_sales_quantity#1, 'sum('sr_return_quantity) AS store_returns_quantity#2, 'sum('cs_quantity) AS catalog_sales_quantity#3]
         +- 'Filter ((((('d1.d_moy = 9) AND ('d1.d_year = 1999)) AND (('d1.d_date_sk = 'ss_sold_date_sk) AND ('i_item_sk = 'ss_item_sk))) AND ((('s_store_sk = 'ss_store_sk) AND ('ss_customer_sk = 'sr_customer_sk)) AND (('ss_item_sk = 'sr_item_sk) AND ('ss_ticket_number = 'sr_ticket_number)))) AND (((('sr_returned_date_sk = 'd2.d_date_sk) AND (('d2.d_moy >= 9) AND ('d2.d_moy <= (9 + 3)))) AND (('d2.d_year = 1999) AND ('sr_customer_sk = 'cs_bill_customer_sk))) AND ((('sr_item_sk = 'cs_item_sk) AND ('cs_sold_date_sk = 'd3.d_date_sk)) AND 'd3.d_year IN (1999,(1999 + 1),(1999 + 2)))))
            +- 'Join Inner
               :- 'Join Inner
               :  :- 'Join Inner
               :  :  :- 'Join Inner
               :  :  :  :- 'Join Inner
               :  :  :  :  :- 'Join Inner
               :  :  :  :  :  :- 'Join Inner
               :  :  :  :  :  :  :- 'UnresolvedRelation [store_sales]
               :  :  :  :  :  :  +- 'UnresolvedRelation [store_returns]
               :  :  :  :  :  +- 'UnresolvedRelation [catalog_sales]
               :  :  :  :  +- 'SubqueryAlias d1
               :  :  :  :     +- 'UnresolvedRelation [date_dim]
               :  :  :  +- 'SubqueryAlias d2
               :  :  :     +- 'UnresolvedRelation [date_dim]
               :  :  +- 'SubqueryAlias d3
               :  :     +- 'UnresolvedRelation [date_dim]
               :  +- 'UnresolvedRelation [store]
               +- 'UnresolvedRelation [item]

== Analyzed Logical Plan ==
i_item_id: string, i_item_desc: string, s_store_id: string, s_store_name: string, store_sales_quantity: bigint, store_returns_quantity: bigint, catalog_sales_quantity: bigint
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7, store_sales_quantity#8, store_returns_quantity#9, catalog_sales_quantity#10]
      +- Sort [i_item_id#4 ASC NULLS FIRST, i_item_desc#5 ASC NULLS FIRST, s_store_id#6 ASC NULLS FIRST, s_store_name#7 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7], [i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7, sum(cast(ss_quantity#11 as bigint)) AS store_sales_quantity#8, sum(cast(sr_return_quantity#12 as bigint)) AS store_returns_quantity#9, sum(cast(cs_quantity#13 as bigint)) AS catalog_sales_quantity#10]
            +- Filter (((((d_moy#14 = 9) AND (d_year#15 = 1999)) AND ((d_date_sk#16 = ss_sold_date_sk#17) AND (i_item_sk#18 = ss_item_sk#19))) AND (((s_store_sk#20 = ss_store_sk#21) AND (cast(ss_customer_sk#22 as bigint) = sr_customer_sk#23)) AND ((cast(ss_item_sk#19 as bigint) = sr_item_sk#24) AND (cast(ss_ticket_number#25 as bigint) = sr_ticket_number#26)))) AND ((((sr_returned_date_sk#27 = cast(d_date_sk#28 as bigint)) AND ((d_moy#29 >= 9) AND (d_moy#29 <= (9 + 3)))) AND ((d_year#30 = 1999) AND (sr_customer_sk#23 = cast(cs_bill_customer_sk#31 as bigint)))) AND (((sr_item_sk#24 = cast(cs_item_sk#32 as bigint)) AND (cs_sold_date_sk#33 = d_date_sk#34)) AND d_year#35 IN (1999,(1999 + 1),(1999 + 2)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.store_sales
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#17,ss_sold_time_sk#36,ss_item_sk#19,ss_customer_sk#22,ss_cdemo_sk#37,ss_hdemo_sk#38,ss_addr_sk#39,ss_store_sk#21,ss_promo_sk#40,ss_ticket_number#25,ss_quantity#11,ss_wholesale_cost#41,ss_list_price#42,ss_sales_price#43,ss_ext_discount_amt#44,ss_ext_sales_price#45,ss_ext_wholesale_cost#46,ss_ext_list_price#47,ss_ext_tax#48,ss_coupon_amt#49,ss_net_paid#50,ss_net_paid_inc_tax#51,ss_net_profit#52] parquet
                  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.store_returns
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#27,sr_return_time_sk#53,sr_item_sk#24,sr_customer_sk#23,sr_cdemo_sk#54,sr_hdemo_sk#55,sr_addr_sk#56,sr_store_sk#57,sr_reason_sk#58,sr_ticket_number#26,sr_return_quantity#12,sr_return_amt#59,sr_return_tax#60,sr_return_amt_inc_tax#61,sr_fee#62,sr_return_ship_cost#63,sr_refunded_cash#64,sr_reversed_charge#65,sr_store_credit#66,sr_net_loss#67] parquet
                  :  :  :  :  :  +- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.catalog_sales
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#33,cs_sold_time_sk#68,cs_ship_date_sk#69,cs_bill_customer_sk#31,cs_bill_cdemo_sk#70,cs_bill_hdemo_sk#71,cs_bill_addr_sk#72,cs_ship_customer_sk#73,cs_ship_cdemo_sk#74,cs_ship_hdemo_sk#75,cs_ship_addr_sk#76,cs_call_center_sk#77,cs_catalog_page_sk#78,cs_ship_mode_sk#79,cs_warehouse_sk#80,cs_item_sk#32,cs_promo_sk#81,cs_order_number#82,cs_quantity#13,cs_wholesale_cost#83,cs_list_price#84,cs_sales_price#85,cs_ext_discount_amt#86,cs_ext_sales_price#87,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias d1
                  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.date_dim
                  :  :  :  :        +- Relation[d_date_sk#16,d_date_id#88,d_date#89,d_month_seq#90,d_week_seq#91,d_quarter_seq#92,d_year#15,d_dow#93,d_moy#14,d_dom#94,d_qoy#95,d_fy_year#96,d_fy_quarter_seq#97,d_fy_week_seq#98,d_day_name#99,d_quarter_name#100,d_holiday#101,d_weekend#102,d_following_holiday#103,d_first_dom#104,d_last_dom#105,d_same_day_ly#106,d_same_day_lq#107,d_current_day#108,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias d2
                  :  :  :     +- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.date_dim
                  :  :  :        +- Relation[d_date_sk#28,d_date_id#109,d_date#110,d_month_seq#111,d_week_seq#112,d_quarter_seq#113,d_year#30,d_dow#114,d_moy#29,d_dom#115,d_qoy#116,d_fy_year#117,d_fy_quarter_seq#118,d_fy_week_seq#119,d_day_name#120,d_quarter_name#121,d_holiday#122,d_weekend#123,d_following_holiday#124,d_first_dom#125,d_last_dom#126,d_same_day_ly#127,d_same_day_lq#128,d_current_day#129,... 4 more fields] parquet
                  :  :  +- SubqueryAlias d3
                  :  :     +- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.date_dim
                  :  :        +- Relation[d_date_sk#34,d_date_id#130,d_date#131,d_month_seq#132,d_week_seq#133,d_quarter_seq#134,d_year#35,d_dow#135,d_moy#136,d_dom#137,d_qoy#138,d_fy_year#139,d_fy_quarter_seq#140,d_fy_week_seq#141,d_day_name#142,d_quarter_name#143,d_holiday#144,d_weekend#145,d_following_holiday#146,d_first_dom#147,d_last_dom#148,d_same_day_ly#149,d_same_day_lq#150,d_current_day#151,... 4 more fields] parquet
                  :  +- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.store
                  :     +- Relation[s_store_sk#20,s_store_id#6,s_rec_start_date#152,s_rec_end_date#153,s_closed_date_sk#154,s_store_name#7,s_number_employees#155,s_floor_space#156,s_hours#157,s_manager#158,s_market_id#159,s_geography_class#160,s_market_desc#161,s_market_manager#162,s_division_id#163,s_division_name#164,s_company_id#165,s_company_name#166,s_street_number#167,s_street_name#168,s_street_type#169,s_suite_number#170,s_city#171,s_county#172,... 5 more fields] parquet
                  +- SubqueryAlias spark_catalog.tpcds_sf1_parquet_stats.item
                     +- Relation[i_item_sk#18,i_item_id#4,i_rec_start_date#173,i_rec_end_date#174,i_item_desc#5,i_current_price#175,i_wholesale_cost#176,i_brand_id#177,i_brand#178,i_class_id#179,i_class#180,i_category_id#181,i_category#182,i_manufact_id#183,i_manufact#184,i_size#185,i_formulation#186,i_color#187,i_units#188,i_container#189,i_manager_id#190,i_product_name#191] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#4 ASC NULLS FIRST, i_item_desc#5 ASC NULLS FIRST, s_store_id#6 ASC NULLS FIRST, s_store_name#7 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7], [i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7, sum(cast(ss_quantity#11 as bigint)) AS store_sales_quantity#8, sum(cast(sr_return_quantity#12 as bigint)) AS store_returns_quantity#9, sum(cast(cs_quantity#13 as bigint)) AS catalog_sales_quantity#10]
         +- Project [ss_quantity#11, sr_return_quantity#12, cs_quantity#13, s_store_id#6, s_store_name#7, i_item_id#4, i_item_desc#5]
            +- Join Inner, (i_item_sk#18 = ss_item_sk#19)
               :- Project [ss_item_sk#19, ss_quantity#11, sr_return_quantity#12, cs_quantity#13, s_store_id#6, s_store_name#7]
               :  +- Join Inner, (s_store_sk#20 = ss_store_sk#21)
               :     :- Project [ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_return_quantity#12, cs_quantity#13]
               :     :  +- Join Inner, (cs_sold_date_sk#33 = d_date_sk#34)
               :     :     :- Project [ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_return_quantity#12, cs_sold_date_sk#33, cs_quantity#13]
               :     :     :  +- Join Inner, (sr_returned_date_sk#27 = cast(d_date_sk#28 as bigint))
               :     :     :     :- Project [ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_returned_date_sk#27, sr_return_quantity#12, cs_sold_date_sk#33, cs_quantity#13]
               :     :     :     :  +- Join Inner, (d_date_sk#16 = ss_sold_date_sk#17)
               :     :     :     :     :- Project [ss_sold_date_sk#17, ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_returned_date_sk#27, sr_return_quantity#12, cs_sold_date_sk#33, cs_quantity#13]
               :     :     :     :     :  +- Join Inner, ((sr_customer_sk#23 = cast(cs_bill_customer_sk#31 as bigint)) AND (sr_item_sk#24 = cast(cs_item_sk#32 as bigint)))
               :     :     :     :     :     :- Project [ss_sold_date_sk#17, ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_returned_date_sk#27, sr_item_sk#24, sr_customer_sk#23, sr_return_quantity#12]
               :     :     :     :     :     :  +- Join Inner, (((cast(ss_customer_sk#22 as bigint) = sr_customer_sk#23) AND (cast(ss_item_sk#19 as bigint) = sr_item_sk#24)) AND (cast(ss_ticket_number#25 as bigint) = sr_ticket_number#26))
               :     :     :     :     :     :     :- Project [ss_sold_date_sk#17, ss_item_sk#19, ss_customer_sk#22, ss_store_sk#21, ss_ticket_number#25, ss_quantity#11]
               :     :     :     :     :     :     :  +- Filter ((((isnotnull(ss_item_sk#19) AND isnotnull(ss_ticket_number#25)) AND isnotnull(ss_customer_sk#22)) AND isnotnull(ss_sold_date_sk#17)) AND isnotnull(ss_store_sk#21))
               :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#17,ss_sold_time_sk#36,ss_item_sk#19,ss_customer_sk#22,ss_cdemo_sk#37,ss_hdemo_sk#38,ss_addr_sk#39,ss_store_sk#21,ss_promo_sk#40,ss_ticket_number#25,ss_quantity#11,ss_wholesale_cost#41,ss_list_price#42,ss_sales_price#43,ss_ext_discount_amt#44,ss_ext_sales_price#45,ss_ext_wholesale_cost#46,ss_ext_list_price#47,ss_ext_tax#48,ss_coupon_amt#49,ss_net_paid#50,ss_net_paid_inc_tax#51,ss_net_profit#52] parquet
               :     :     :     :     :     :     +- Project [sr_returned_date_sk#27, sr_item_sk#24, sr_customer_sk#23, sr_ticket_number#26, sr_return_quantity#12]
               :     :     :     :     :     :        +- Filter (((isnotnull(sr_item_sk#24) AND isnotnull(sr_ticket_number#26)) AND isnotnull(sr_customer_sk#23)) AND isnotnull(sr_returned_date_sk#27))
               :     :     :     :     :     :           +- Relation[sr_returned_date_sk#27,sr_return_time_sk#53,sr_item_sk#24,sr_customer_sk#23,sr_cdemo_sk#54,sr_hdemo_sk#55,sr_addr_sk#56,sr_store_sk#57,sr_reason_sk#58,sr_ticket_number#26,sr_return_quantity#12,sr_return_amt#59,sr_return_tax#60,sr_return_amt_inc_tax#61,sr_fee#62,sr_return_ship_cost#63,sr_refunded_cash#64,sr_reversed_charge#65,sr_store_credit#66,sr_net_loss#67] parquet
               :     :     :     :     :     +- Project [cs_sold_date_sk#33, cs_bill_customer_sk#31, cs_item_sk#32, cs_quantity#13]
               :     :     :     :     :        +- Filter ((isnotnull(cs_bill_customer_sk#31) AND isnotnull(cs_item_sk#32)) AND isnotnull(cs_sold_date_sk#33))
               :     :     :     :     :           +- Relation[cs_sold_date_sk#33,cs_sold_time_sk#68,cs_ship_date_sk#69,cs_bill_customer_sk#31,cs_bill_cdemo_sk#70,cs_bill_hdemo_sk#71,cs_bill_addr_sk#72,cs_ship_customer_sk#73,cs_ship_cdemo_sk#74,cs_ship_hdemo_sk#75,cs_ship_addr_sk#76,cs_call_center_sk#77,cs_catalog_page_sk#78,cs_ship_mode_sk#79,cs_warehouse_sk#80,cs_item_sk#32,cs_promo_sk#81,cs_order_number#82,cs_quantity#13,cs_wholesale_cost#83,cs_list_price#84,cs_sales_price#85,cs_ext_discount_amt#86,cs_ext_sales_price#87,... 10 more fields] parquet
               :     :     :     :     +- Project [d_date_sk#16]
               :     :     :     :        +- Filter ((((isnotnull(d_moy#14) AND isnotnull(d_year#15)) AND (d_moy#14 = 9)) AND (d_year#15 = 1999)) AND isnotnull(d_date_sk#16))
               :     :     :     :           +- Relation[d_date_sk#16,d_date_id#88,d_date#89,d_month_seq#90,d_week_seq#91,d_quarter_seq#92,d_year#15,d_dow#93,d_moy#14,d_dom#94,d_qoy#95,d_fy_year#96,d_fy_quarter_seq#97,d_fy_week_seq#98,d_day_name#99,d_quarter_name#100,d_holiday#101,d_weekend#102,d_following_holiday#103,d_first_dom#104,d_last_dom#105,d_same_day_ly#106,d_same_day_lq#107,d_current_day#108,... 4 more fields] parquet
               :     :     :     +- Project [d_date_sk#28]
               :     :     :        +- Filter (((((isnotnull(d_moy#29) AND isnotnull(d_year#30)) AND (d_moy#29 >= 9)) AND (d_moy#29 <= 12)) AND (d_year#30 = 1999)) AND isnotnull(d_date_sk#28))
               :     :     :           +- Relation[d_date_sk#28,d_date_id#109,d_date#110,d_month_seq#111,d_week_seq#112,d_quarter_seq#113,d_year#30,d_dow#114,d_moy#29,d_dom#115,d_qoy#116,d_fy_year#117,d_fy_quarter_seq#118,d_fy_week_seq#119,d_day_name#120,d_quarter_name#121,d_holiday#122,d_weekend#123,d_following_holiday#124,d_first_dom#125,d_last_dom#126,d_same_day_ly#127,d_same_day_lq#128,d_current_day#129,... 4 more fields] parquet
               :     :     +- Project [d_date_sk#34]
               :     :        +- Filter (d_year#35 IN (1999,2000,2001) AND isnotnull(d_date_sk#34))
               :     :           +- Relation[d_date_sk#34,d_date_id#130,d_date#131,d_month_seq#132,d_week_seq#133,d_quarter_seq#134,d_year#35,d_dow#135,d_moy#136,d_dom#137,d_qoy#138,d_fy_year#139,d_fy_quarter_seq#140,d_fy_week_seq#141,d_day_name#142,d_quarter_name#143,d_holiday#144,d_weekend#145,d_following_holiday#146,d_first_dom#147,d_last_dom#148,d_same_day_ly#149,d_same_day_lq#150,d_current_day#151,... 4 more fields] parquet
               :     +- Project [s_store_sk#20, s_store_id#6, s_store_name#7]
               :        +- Filter isnotnull(s_store_sk#20)
               :           +- Relation[s_store_sk#20,s_store_id#6,s_rec_start_date#152,s_rec_end_date#153,s_closed_date_sk#154,s_store_name#7,s_number_employees#155,s_floor_space#156,s_hours#157,s_manager#158,s_market_id#159,s_geography_class#160,s_market_desc#161,s_market_manager#162,s_division_id#163,s_division_name#164,s_company_id#165,s_company_name#166,s_street_number#167,s_street_name#168,s_street_type#169,s_suite_number#170,s_city#171,s_county#172,... 5 more fields] parquet
               +- Project [i_item_sk#18, i_item_id#4, i_item_desc#5]
                  +- Filter isnotnull(i_item_sk#18)
                     +- Relation[i_item_sk#18,i_item_id#4,i_rec_start_date#173,i_rec_end_date#174,i_item_desc#5,i_current_price#175,i_wholesale_cost#176,i_brand_id#177,i_brand#178,i_class_id#179,i_class#180,i_category_id#181,i_category#182,i_manufact_id#183,i_manufact#184,i_size#185,i_formulation#186,i_color#187,i_units#188,i_container#189,i_manager_id#190,i_product_name#191] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[i_item_id#4 ASC NULLS FIRST,i_item_desc#5 ASC NULLS FIRST,s_store_id#6 ASC NULLS FIRST,s_store_name#7 ASC NULLS FIRST], output=[i_item_id#4,i_item_desc#5,s_store_id#6,s_store_name#7,store_sales_quantity#8,store_returns_quantity#9,catalog_sales_quantity#10])
+- *(12) HashAggregate(keys=[i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7], functions=[sum(cast(ss_quantity#11 as bigint)), sum(cast(sr_return_quantity#12 as bigint)), sum(cast(cs_quantity#13 as bigint))], output=[i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7, store_sales_quantity#8, store_returns_quantity#9, catalog_sales_quantity#10])
   +- Exchange hashpartitioning(i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7, 5), true, [id=#192]
      +- *(11) HashAggregate(keys=[i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7], functions=[partial_sum(cast(ss_quantity#11 as bigint)), partial_sum(cast(sr_return_quantity#12 as bigint)), partial_sum(cast(cs_quantity#13 as bigint))], output=[i_item_id#4, i_item_desc#5, s_store_id#6, s_store_name#7, sum#193, sum#194, sum#195])
         +- *(11) Project [ss_quantity#11, sr_return_quantity#12, cs_quantity#13, s_store_id#6, s_store_name#7, i_item_id#4, i_item_desc#5]
            +- *(11) BroadcastHashJoin [ss_item_sk#19], [i_item_sk#18], Inner, BuildRight, false
               :- *(11) Project [ss_item_sk#19, ss_quantity#11, sr_return_quantity#12, cs_quantity#13, s_store_id#6, s_store_name#7]
               :  +- *(11) BroadcastHashJoin [ss_store_sk#21], [s_store_sk#20], Inner, BuildRight, false
               :     :- *(11) Project [ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_return_quantity#12, cs_quantity#13]
               :     :  +- *(11) BroadcastHashJoin [cs_sold_date_sk#33], [d_date_sk#34], Inner, BuildRight, false
               :     :     :- *(11) Project [ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_return_quantity#12, cs_sold_date_sk#33, cs_quantity#13]
               :     :     :  +- *(11) BroadcastHashJoin [sr_returned_date_sk#27], [cast(d_date_sk#28 as bigint)], Inner, BuildRight, false
               :     :     :     :- *(11) Project [ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_returned_date_sk#27, sr_return_quantity#12, cs_sold_date_sk#33, cs_quantity#13]
               :     :     :     :  +- *(11) BroadcastHashJoin [ss_sold_date_sk#17], [d_date_sk#16], Inner, BuildRight, false
               :     :     :     :     :- *(11) Project [ss_sold_date_sk#17, ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_returned_date_sk#27, sr_return_quantity#12, cs_sold_date_sk#33, cs_quantity#13]
               :     :     :     :     :  +- *(11) SortMergeJoin [sr_customer_sk#23, sr_item_sk#24], [cast(cs_bill_customer_sk#31 as bigint), cast(cs_item_sk#32 as bigint)], Inner
               :     :     :     :     :     :- *(3) Sort [sr_customer_sk#23 ASC NULLS FIRST, sr_item_sk#24 ASC NULLS FIRST], false, 0
               :     :     :     :     :     :  +- Exchange hashpartitioning(sr_customer_sk#23, sr_item_sk#24, 5), true, [id=#196]
               :     :     :     :     :     :     +- *(2) Project [ss_sold_date_sk#17, ss_item_sk#19, ss_store_sk#21, ss_quantity#11, sr_returned_date_sk#27, sr_item_sk#24, sr_customer_sk#23, sr_return_quantity#12]
               :     :     :     :     :     :        +- *(2) BroadcastHashJoin [cast(ss_customer_sk#22 as bigint), cast(ss_item_sk#19 as bigint), cast(ss_ticket_number#25 as bigint)], [sr_customer_sk#23, sr_item_sk#24, sr_ticket_number#26], Inner, BuildRight, false
               :     :     :     :     :     :           :- *(2) Project [ss_sold_date_sk#17, ss_item_sk#19, ss_customer_sk#22, ss_store_sk#21, ss_ticket_number#25, ss_quantity#11]
               :     :     :     :     :     :           :  +- *(2) Filter ((((isnotnull(ss_item_sk#19) AND isnotnull(ss_ticket_number#25)) AND isnotnull(ss_customer_sk#22)) AND isnotnull(ss_sold_date_sk#17)) AND isnotnull(ss_store_sk#21))
               :     :     :     :     :     :           :     +- *(2) ColumnarToRow
               :     :     :     :     :     :           :        +- FileScan parquet tpcds_sf1_parquet_stats.store_sales[ss_sold_date_sk#17,ss_item_sk#19,ss_customer_sk#22,ss_store_sk#21,ss_ticket_number#25,ss_quantity#11] Batched: true, DataFilters: [isnotnull(ss_item_sk#19), isnotnull(ss_ticket_number#25), isnotnull(ss_customer_sk#22), isnot..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_customer_sk), IsNotNull(ss_sold..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int...
               :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(input[2, bigint, true], input[1, bigint, true], input[3, bigint, true]),false), [id=#197]
               :     :     :     :     :     :              +- *(1) Project [sr_returned_date_sk#27, sr_item_sk#24, sr_customer_sk#23, sr_ticket_number#26, sr_return_quantity#12]
               :     :     :     :     :     :                 +- *(1) Filter (((isnotnull(sr_item_sk#24) AND isnotnull(sr_ticket_number#26)) AND isnotnull(sr_customer_sk#23)) AND isnotnull(sr_returned_date_sk#27))
               :     :     :     :     :     :                    +- *(1) ColumnarToRow
               :     :     :     :     :     :                       +- FileScan parquet tpcds_sf1_parquet_stats.store_returns[sr_returned_date_sk#27,sr_item_sk#24,sr_customer_sk#23,sr_ticket_number#26,sr_return_quantity#12] Batched: true, DataFilters: [isnotnull(sr_item_sk#24), isnotnull(sr_ticket_number#26), isnotnull(sr_customer_sk#23), isnotnu..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number), IsNotNull(sr_customer_sk), IsNotNull(sr_retu..., ReadSchema: struct<sr_returned_date_sk:bigint,sr_item_sk:bigint,sr_customer_sk:bigint,sr_ticket_number:bigint...
               :     :     :     :     :     +- *(5) Sort [cast(cs_bill_customer_sk#31 as bigint) ASC NULLS FIRST, cast(cs_item_sk#32 as bigint) ASC NULLS FIRST], false, 0
               :     :     :     :     :        +- Exchange hashpartitioning(cast(cs_bill_customer_sk#31 as bigint), cast(cs_item_sk#32 as bigint), 5), true, [id=#198]
               :     :     :     :     :           +- *(4) Project [cs_sold_date_sk#33, cs_bill_customer_sk#31, cs_item_sk#32, cs_quantity#13]
               :     :     :     :     :              +- *(4) Filter ((isnotnull(cs_bill_customer_sk#31) AND isnotnull(cs_item_sk#32)) AND isnotnull(cs_sold_date_sk#33))
               :     :     :     :     :                 +- *(4) ColumnarToRow
               :     :     :     :     :                    +- FileScan parquet tpcds_sf1_parquet_stats.catalog_sales[cs_sold_date_sk#33,cs_bill_customer_sk#31,cs_item_sk#32,cs_quantity#13] Batched: true, DataFilters: [isnotnull(cs_bill_customer_sk#31), isnotnull(cs_item_sk#32), isnotnull(cs_sold_date_sk#33)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_item_sk:int,cs_quantity:int>
               :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#199]
               :     :     :     :        +- *(6) Project [d_date_sk#16]
               :     :     :     :           +- *(6) Filter ((((isnotnull(d_moy#14) AND isnotnull(d_year#15)) AND (d_moy#14 = 9)) AND (d_year#15 = 1999)) AND isnotnull(d_date_sk#16))
               :     :     :     :              +- *(6) ColumnarToRow
               :     :     :     :                 +- FileScan parquet tpcds_sf1_parquet_stats.date_dim[d_date_sk#16,d_year#15,d_moy#14] Batched: true, DataFilters: [isnotnull(d_moy#14), isnotnull(d_year#15), (d_moy#14 = 9), (d_year#15 = 1999), isnotnull(d_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_moy), IsNotNull(d_year), EqualTo(d_moy,9), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#200]
               :     :     :        +- *(7) Project [d_date_sk#28]
               :     :     :           +- *(7) Filter (((((isnotnull(d_moy#29) AND isnotnull(d_year#30)) AND (d_moy#29 >= 9)) AND (d_moy#29 <= 12)) AND (d_year#30 = 1999)) AND isnotnull(d_date_sk#28))
               :     :     :              +- *(7) ColumnarToRow
               :     :     :                 +- FileScan parquet tpcds_sf1_parquet_stats.date_dim[d_date_sk#28,d_year#30,d_moy#29] Batched: true, DataFilters: [isnotnull(d_moy#29), isnotnull(d_year#30), (d_moy#29 >= 9), (d_moy#29 <= 12), (d_year#90..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_moy), IsNotNull(d_year), GreaterThanOrEqual(d_moy,9), LessThanOrEqual(d_moy,12), Equ..., ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#201]
               :     :        +- *(8) Project [d_date_sk#34]
               :     :           +- *(8) Filter (d_year#35 IN (1999,2000,2001) AND isnotnull(d_date_sk#34))
               :     :              +- *(8) ColumnarToRow
               :     :                 +- FileScan parquet tpcds_sf1_parquet_stats.date_dim[d_date_sk#34,d_year#35] Batched: true, DataFilters: [d_year#35 IN (1999,2000,2001), isnotnull(d_date_sk#34)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(d_year, [1999,2000,2001]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#202]
               :        +- *(9) Project [s_store_sk#20, s_store_id#6, s_store_name#7]
               :           +- *(9) Filter isnotnull(s_store_sk#20)
               :              +- *(9) ColumnarToRow
               :                 +- FileScan parquet tpcds_sf1_parquet_stats.store[s_store_sk#20,s_store_id#6,s_store_name#7] Batched: true, DataFilters: [isnotnull(s_store_sk#20)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_store_name:string>
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#203]
                  +- *(10) Project [i_item_sk#18, i_item_id#4, i_item_desc#5]
                     +- *(10) Filter isnotnull(i_item_sk#18)
                        +- *(10) ColumnarToRow
                           +- FileScan parquet tpcds_sf1_parquet_stats.item[i_item_sk#18,i_item_id#4,i_item_desc#5] Batched: true, DataFilters: [isnotnull(i_item_sk#18)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string,i_item_desc:string>
