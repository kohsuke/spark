== Parsed Logical Plan ==
'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort ['cd_gender ASC NULLS FIRST, 'cd_marital_status ASC NULLS FIRST, 'cd_education_status ASC NULLS FIRST, 'cd_purchase_estimate ASC NULLS FIRST, 'cd_credit_rating ASC NULLS FIRST, 'cd_dep_count ASC NULLS FIRST, 'cd_dep_employed_count ASC NULLS FIRST, 'cd_dep_college_count ASC NULLS FIRST], true
      +- 'Aggregate ['cd_gender, 'cd_marital_status, 'cd_education_status, 'cd_purchase_estimate, 'cd_credit_rating, 'cd_dep_count, 'cd_dep_employed_count, 'cd_dep_college_count], ['cd_gender, 'cd_marital_status, 'cd_education_status, 'count(1) AS cnt1#1, 'cd_purchase_estimate, 'count(1) AS cnt2#2, 'cd_credit_rating, 'count(1) AS cnt3#3, 'cd_dep_count, 'count(1) AS cnt4#4, 'cd_dep_employed_count, 'count(1) AS cnt5#5, 'cd_dep_college_count, 'count(1) AS cnt6#6]
         +- 'Filter (((('c.c_current_addr_sk = 'ca.ca_address_sk) AND 'ca_county IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) AND ('cd_demo_sk = 'c.c_current_cdemo_sk)) AND (exists#7 [] AND (exists#8 [] OR exists#9 [])))
            :  :- 'Project [*]
            :  :  +- 'Filter ((('c.c_customer_sk = 'ss_customer_sk) AND ('ss_sold_date_sk = 'd_date_sk)) AND (('d_year = 2002) AND (('d_moy >= 1) AND ('d_moy <= (1 + 3)))))
            :  :     +- 'Join Inner
            :  :        :- 'UnresolvedRelation [store_sales]
            :  :        +- 'UnresolvedRelation [date_dim]
            :  :- 'Project [*]
            :  :  +- 'Filter ((('c.c_customer_sk = 'ws_bill_customer_sk) AND ('ws_sold_date_sk = 'd_date_sk)) AND (('d_year = 2002) AND (('d_moy >= 1) AND ('d_moy <= (1 + 3)))))
            :  :     +- 'Join Inner
            :  :        :- 'UnresolvedRelation [web_sales]
            :  :        +- 'UnresolvedRelation [date_dim]
            :  +- 'Project [*]
            :     +- 'Filter ((('c.c_customer_sk = 'cs_ship_customer_sk) AND ('cs_sold_date_sk = 'd_date_sk)) AND (('d_year = 2002) AND (('d_moy >= 1) AND ('d_moy <= (1 + 3)))))
            :        +- 'Join Inner
            :           :- 'UnresolvedRelation [catalog_sales]
            :           +- 'UnresolvedRelation [date_dim]
            +- 'Join Inner
               :- 'Join Inner
               :  :- 'SubqueryAlias c
               :  :  +- 'UnresolvedRelation [customer]
               :  +- 'SubqueryAlias ca
               :     +- 'UnresolvedRelation [customer_address]
               +- 'UnresolvedRelation [customer_demographics]

== Analyzed Logical Plan ==
cd_gender: string, cd_marital_status: string, cd_education_status: string, cnt1: bigint, cd_purchase_estimate: int, cnt2: bigint, cd_credit_rating: string, cnt3: bigint, cd_dep_count: int, cnt4: bigint, cd_dep_employed_count: int, cnt5: bigint, cd_dep_college_count: int, cnt6: bigint
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#10 ASC NULLS FIRST, cd_marital_status#11 ASC NULLS FIRST, cd_education_status#12 ASC NULLS FIRST, cd_purchase_estimate#13 ASC NULLS FIRST, cd_credit_rating#14 ASC NULLS FIRST, cd_dep_count#15 ASC NULLS FIRST, cd_dep_employed_count#16 ASC NULLS FIRST, cd_dep_college_count#17 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], [cd_gender#10, cd_marital_status#11, cd_education_status#12, count(1) AS cnt1#18, cd_purchase_estimate#13, count(1) AS cnt2#19, cd_credit_rating#14, count(1) AS cnt3#20, cd_dep_count#15, count(1) AS cnt4#21, cd_dep_employed_count#16, count(1) AS cnt5#22, cd_dep_college_count#17, count(1) AS cnt6#23]
         +- Filter ((((c_current_addr_sk#24 = ca_address_sk#25) AND ca_county#26 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) AND (cd_demo_sk#27 = c_current_cdemo_sk#28)) AND (exists#7 [c_customer_sk#29] AND (exists#8 [c_customer_sk#29] OR exists#9 [c_customer_sk#29])))
            :  :- Project [ss_sold_date_sk#30, ss_sold_time_sk#31, ss_item_sk#32, ss_customer_sk#33, ss_cdemo_sk#34, ss_hdemo_sk#35, ss_addr_sk#36, ss_store_sk#37, ss_promo_sk#38, ss_ticket_number#39, ss_quantity#40, ss_wholesale_cost#41, ss_list_price#42, ss_sales_price#43, ss_ext_discount_amt#44, ss_ext_sales_price#45, ss_ext_wholesale_cost#46, ss_ext_list_price#47, ss_ext_tax#48, ss_coupon_amt#49, ss_net_paid#50, ss_net_paid_inc_tax#51, ss_net_profit#52, d_date_sk#53, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#29) = ss_customer_sk#33) AND (ss_sold_date_sk#30 = d_date_sk#53)) AND ((d_year#54 = 2002) AND ((d_moy#55 >= 1) AND (d_moy#55 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias spark_catalog.default.store_sales
            :  :        :  +- Relation[ss_sold_date_sk#30,ss_sold_time_sk#31,ss_item_sk#32,ss_customer_sk#33,ss_cdemo_sk#34,ss_hdemo_sk#35,ss_addr_sk#36,ss_store_sk#37,ss_promo_sk#38,ss_ticket_number#39,ss_quantity#40,ss_wholesale_cost#41,ss_list_price#42,ss_sales_price#43,ss_ext_discount_amt#44,ss_ext_sales_price#45,ss_ext_wholesale_cost#46,ss_ext_list_price#47,ss_ext_tax#48,ss_coupon_amt#49,ss_net_paid#50,ss_net_paid_inc_tax#51,ss_net_profit#52] parquet
            :  :        +- SubqueryAlias spark_catalog.default.date_dim
            :  :           +- Relation[d_date_sk#53,d_date_id#56,d_date#57,d_month_seq#58,d_week_seq#59,d_quarter_seq#60,d_year#54,d_dow#61,d_moy#55,d_dom#62,d_qoy#63,d_fy_year#64,d_fy_quarter_seq#65,d_fy_week_seq#66,d_day_name#67,d_quarter_name#68,d_holiday#69,d_weekend#70,d_following_holiday#71,d_first_dom#72,d_last_dom#73,d_same_day_ly#74,d_same_day_lq#75,d_current_day#76,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#77, ws_sold_time_sk#78, ws_ship_date_sk#79, ws_item_sk#80, ws_bill_customer_sk#81, ws_bill_cdemo_sk#82, ws_bill_hdemo_sk#83, ws_bill_addr_sk#84, ws_ship_customer_sk#85, ws_ship_cdemo_sk#86, ws_ship_hdemo_sk#87, ws_ship_addr_sk#88, ws_web_page_sk#89, ws_web_site_sk#90, ws_ship_mode_sk#91, ws_warehouse_sk#92, ws_promo_sk#93, ws_order_number#94, ws_quantity#95, ws_wholesale_cost#96, ws_list_price#97, ws_sales_price#98, ws_ext_discount_amt#99, ws_ext_sales_price#100, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#29) = ws_bill_customer_sk#81) AND (ws_sold_date_sk#77 = d_date_sk#53)) AND ((d_year#54 = 2002) AND ((d_moy#55 >= 1) AND (d_moy#55 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias spark_catalog.default.web_sales
            :  :        :  +- Relation[ws_sold_date_sk#77,ws_sold_time_sk#78,ws_ship_date_sk#79,ws_item_sk#80,ws_bill_customer_sk#81,ws_bill_cdemo_sk#82,ws_bill_hdemo_sk#83,ws_bill_addr_sk#84,ws_ship_customer_sk#85,ws_ship_cdemo_sk#86,ws_ship_hdemo_sk#87,ws_ship_addr_sk#88,ws_web_page_sk#89,ws_web_site_sk#90,ws_ship_mode_sk#91,ws_warehouse_sk#92,ws_promo_sk#93,ws_order_number#94,ws_quantity#95,ws_wholesale_cost#96,ws_list_price#97,ws_sales_price#98,ws_ext_discount_amt#99,ws_ext_sales_price#100,... 10 more fields] parquet
            :  :        +- SubqueryAlias spark_catalog.default.date_dim
            :  :           +- Relation[d_date_sk#53,d_date_id#56,d_date#57,d_month_seq#58,d_week_seq#59,d_quarter_seq#60,d_year#54,d_dow#61,d_moy#55,d_dom#62,d_qoy#63,d_fy_year#64,d_fy_quarter_seq#65,d_fy_week_seq#66,d_day_name#67,d_quarter_name#68,d_holiday#69,d_weekend#70,d_following_holiday#71,d_first_dom#72,d_last_dom#73,d_same_day_ly#74,d_same_day_lq#75,d_current_day#76,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#101, cs_sold_time_sk#102, cs_ship_date_sk#103, cs_bill_customer_sk#104, cs_bill_cdemo_sk#105, cs_bill_hdemo_sk#106, cs_bill_addr_sk#107, cs_ship_customer_sk#108, cs_ship_cdemo_sk#109, cs_ship_hdemo_sk#110, cs_ship_addr_sk#111, cs_call_center_sk#112, cs_catalog_page_sk#113, cs_ship_mode_sk#114, cs_warehouse_sk#115, cs_item_sk#116, cs_promo_sk#117, cs_order_number#118, cs_quantity#119, cs_wholesale_cost#120, cs_list_price#121, cs_sales_price#122, cs_ext_discount_amt#123, cs_ext_sales_price#124, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#29) = cs_ship_customer_sk#108) AND (cs_sold_date_sk#101 = d_date_sk#53)) AND ((d_year#54 = 2002) AND ((d_moy#55 >= 1) AND (d_moy#55 <= (1 + 3)))))
            :        +- Join Inner
            :           :- SubqueryAlias spark_catalog.default.catalog_sales
            :           :  +- Relation[cs_sold_date_sk#101,cs_sold_time_sk#102,cs_ship_date_sk#103,cs_bill_customer_sk#104,cs_bill_cdemo_sk#105,cs_bill_hdemo_sk#106,cs_bill_addr_sk#107,cs_ship_customer_sk#108,cs_ship_cdemo_sk#109,cs_ship_hdemo_sk#110,cs_ship_addr_sk#111,cs_call_center_sk#112,cs_catalog_page_sk#113,cs_ship_mode_sk#114,cs_warehouse_sk#115,cs_item_sk#116,cs_promo_sk#117,cs_order_number#118,cs_quantity#119,cs_wholesale_cost#120,cs_list_price#121,cs_sales_price#122,cs_ext_discount_amt#123,cs_ext_sales_price#124,... 10 more fields] parquet
            :           +- SubqueryAlias spark_catalog.default.date_dim
            :              +- Relation[d_date_sk#53,d_date_id#56,d_date#57,d_month_seq#58,d_week_seq#59,d_quarter_seq#60,d_year#54,d_dow#61,d_moy#55,d_dom#62,d_qoy#63,d_fy_year#64,d_fy_quarter_seq#65,d_fy_week_seq#66,d_day_name#67,d_quarter_name#68,d_holiday#69,d_weekend#70,d_following_holiday#71,d_first_dom#72,d_last_dom#73,d_same_day_ly#74,d_same_day_lq#75,d_current_day#76,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias c
               :  :  +- SubqueryAlias spark_catalog.default.customer
               :  :     +- Relation[c_customer_sk#29,c_customer_id#125,c_current_cdemo_sk#28,c_current_hdemo_sk#126,c_current_addr_sk#24,c_first_shipto_date_sk#127,c_first_sales_date_sk#128,c_salutation#129,c_first_name#130,c_last_name#131,c_preferred_cust_flag#132,c_birth_day#133,c_birth_month#134,c_birth_year#135,c_birth_country#136,c_login#137,c_email_address#138,c_last_review_date#139] parquet
               :  +- SubqueryAlias ca
               :     +- SubqueryAlias spark_catalog.default.customer_address
               :        +- Relation[ca_address_sk#25,ca_address_id#140,ca_street_number#141,ca_street_name#142,ca_street_type#143,ca_suite_number#144,ca_city#145,ca_county#26,ca_state#146,ca_zip#147,ca_country#148,ca_gmt_offset#149,ca_location_type#150] parquet
               +- SubqueryAlias spark_catalog.default.customer_demographics
                  +- Relation[cd_demo_sk#27,cd_gender#10,cd_marital_status#11,cd_education_status#12,cd_purchase_estimate#13,cd_credit_rating#14,cd_dep_count#15,cd_dep_employed_count#16,cd_dep_college_count#17] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#10 ASC NULLS FIRST, cd_marital_status#11 ASC NULLS FIRST, cd_education_status#12 ASC NULLS FIRST, cd_purchase_estimate#13 ASC NULLS FIRST, cd_credit_rating#14 ASC NULLS FIRST, cd_dep_count#15 ASC NULLS FIRST, cd_dep_employed_count#16 ASC NULLS FIRST, cd_dep_college_count#17 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], [cd_gender#10, cd_marital_status#11, cd_education_status#12, count(1) AS cnt1#18, cd_purchase_estimate#13, count(1) AS cnt2#19, cd_credit_rating#14, count(1) AS cnt3#20, cd_dep_count#15, count(1) AS cnt4#21, cd_dep_employed_count#16, count(1) AS cnt5#22, cd_dep_college_count#17, count(1) AS cnt6#23]
         +- Project [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17]
            +- Join Inner, (cd_demo_sk#27 = c_current_cdemo_sk#28)
               :- Project [c_current_cdemo_sk#28]
               :  +- Join Inner, (c_current_addr_sk#24 = ca_address_sk#25)
               :     :- Project [c_current_cdemo_sk#28, c_current_addr_sk#24]
               :     :  +- Filter (exists#151 OR exists#152)
               :     :     +- Join ExistenceJoin(exists#152), (c_customer_sk#29 = cs_ship_customer_sk#108)
               :     :        :- Join ExistenceJoin(exists#151), (c_customer_sk#29 = ws_bill_customer_sk#81)
               :     :        :  :- Join LeftSemi, (c_customer_sk#29 = ss_customer_sk#33)
               :     :        :  :  :- Project [c_customer_sk#29, c_current_cdemo_sk#28, c_current_addr_sk#24]
               :     :        :  :  :  +- Filter (isnotnull(c_current_addr_sk#24) AND isnotnull(c_current_cdemo_sk#28))
               :     :        :  :  :     +- Relation[c_customer_sk#29,c_customer_id#125,c_current_cdemo_sk#28,c_current_hdemo_sk#126,c_current_addr_sk#24,c_first_shipto_date_sk#127,c_first_sales_date_sk#128,c_salutation#129,c_first_name#130,c_last_name#131,c_preferred_cust_flag#132,c_birth_day#133,c_birth_month#134,c_birth_year#135,c_birth_country#136,c_login#137,c_email_address#138,c_last_review_date#139] parquet
               :     :        :  :  +- Project [ss_customer_sk#33]
               :     :        :  :     +- Join Inner, (ss_sold_date_sk#30 = d_date_sk#53)
               :     :        :  :        :- Project [ss_sold_date_sk#30, ss_customer_sk#33]
               :     :        :  :        :  +- Filter isnotnull(ss_sold_date_sk#30)
               :     :        :  :        :     +- Relation[ss_sold_date_sk#30,ss_sold_time_sk#31,ss_item_sk#32,ss_customer_sk#33,ss_cdemo_sk#34,ss_hdemo_sk#35,ss_addr_sk#36,ss_store_sk#37,ss_promo_sk#38,ss_ticket_number#39,ss_quantity#40,ss_wholesale_cost#41,ss_list_price#42,ss_sales_price#43,ss_ext_discount_amt#44,ss_ext_sales_price#45,ss_ext_wholesale_cost#46,ss_ext_list_price#47,ss_ext_tax#48,ss_coupon_amt#49,ss_net_paid#50,ss_net_paid_inc_tax#51,ss_net_profit#52] parquet
               :     :        :  :        +- Project [d_date_sk#53]
               :     :        :  :           +- Filter (((((isnotnull(d_year#54) AND isnotnull(d_moy#55)) AND (d_year#54 = 2002)) AND (d_moy#55 >= 1)) AND (d_moy#55 <= 4)) AND isnotnull(d_date_sk#53))
               :     :        :  :              +- Relation[d_date_sk#53,d_date_id#56,d_date#57,d_month_seq#58,d_week_seq#59,d_quarter_seq#60,d_year#54,d_dow#61,d_moy#55,d_dom#62,d_qoy#63,d_fy_year#64,d_fy_quarter_seq#65,d_fy_week_seq#66,d_day_name#67,d_quarter_name#68,d_holiday#69,d_weekend#70,d_following_holiday#71,d_first_dom#72,d_last_dom#73,d_same_day_ly#74,d_same_day_lq#75,d_current_day#76,... 4 more fields] parquet
               :     :        :  +- Project [ws_bill_customer_sk#81]
               :     :        :     +- Join Inner, (ws_sold_date_sk#77 = d_date_sk#53)
               :     :        :        :- Project [ws_sold_date_sk#77, ws_bill_customer_sk#81]
               :     :        :        :  +- Filter isnotnull(ws_sold_date_sk#77)
               :     :        :        :     +- Relation[ws_sold_date_sk#77,ws_sold_time_sk#78,ws_ship_date_sk#79,ws_item_sk#80,ws_bill_customer_sk#81,ws_bill_cdemo_sk#82,ws_bill_hdemo_sk#83,ws_bill_addr_sk#84,ws_ship_customer_sk#85,ws_ship_cdemo_sk#86,ws_ship_hdemo_sk#87,ws_ship_addr_sk#88,ws_web_page_sk#89,ws_web_site_sk#90,ws_ship_mode_sk#91,ws_warehouse_sk#92,ws_promo_sk#93,ws_order_number#94,ws_quantity#95,ws_wholesale_cost#96,ws_list_price#97,ws_sales_price#98,ws_ext_discount_amt#99,ws_ext_sales_price#100,... 10 more fields] parquet
               :     :        :        +- Project [d_date_sk#53]
               :     :        :           +- Filter (((((isnotnull(d_year#54) AND isnotnull(d_moy#55)) AND (d_year#54 = 2002)) AND (d_moy#55 >= 1)) AND (d_moy#55 <= 4)) AND isnotnull(d_date_sk#53))
               :     :        :              +- Relation[d_date_sk#53,d_date_id#56,d_date#57,d_month_seq#58,d_week_seq#59,d_quarter_seq#60,d_year#54,d_dow#61,d_moy#55,d_dom#62,d_qoy#63,d_fy_year#64,d_fy_quarter_seq#65,d_fy_week_seq#66,d_day_name#67,d_quarter_name#68,d_holiday#69,d_weekend#70,d_following_holiday#71,d_first_dom#72,d_last_dom#73,d_same_day_ly#74,d_same_day_lq#75,d_current_day#76,... 4 more fields] parquet
               :     :        +- Project [cs_ship_customer_sk#108]
               :     :           +- Join Inner, (cs_sold_date_sk#101 = d_date_sk#53)
               :     :              :- Project [cs_sold_date_sk#101, cs_ship_customer_sk#108]
               :     :              :  +- Filter isnotnull(cs_sold_date_sk#101)
               :     :              :     +- Relation[cs_sold_date_sk#101,cs_sold_time_sk#102,cs_ship_date_sk#103,cs_bill_customer_sk#104,cs_bill_cdemo_sk#105,cs_bill_hdemo_sk#106,cs_bill_addr_sk#107,cs_ship_customer_sk#108,cs_ship_cdemo_sk#109,cs_ship_hdemo_sk#110,cs_ship_addr_sk#111,cs_call_center_sk#112,cs_catalog_page_sk#113,cs_ship_mode_sk#114,cs_warehouse_sk#115,cs_item_sk#116,cs_promo_sk#117,cs_order_number#118,cs_quantity#119,cs_wholesale_cost#120,cs_list_price#121,cs_sales_price#122,cs_ext_discount_amt#123,cs_ext_sales_price#124,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#53]
               :     :                 +- Filter (((((isnotnull(d_year#54) AND isnotnull(d_moy#55)) AND (d_year#54 = 2002)) AND (d_moy#55 >= 1)) AND (d_moy#55 <= 4)) AND isnotnull(d_date_sk#53))
               :     :                    +- Relation[d_date_sk#53,d_date_id#56,d_date#57,d_month_seq#58,d_week_seq#59,d_quarter_seq#60,d_year#54,d_dow#61,d_moy#55,d_dom#62,d_qoy#63,d_fy_year#64,d_fy_quarter_seq#65,d_fy_week_seq#66,d_day_name#67,d_quarter_name#68,d_holiday#69,d_weekend#70,d_following_holiday#71,d_first_dom#72,d_last_dom#73,d_same_day_ly#74,d_same_day_lq#75,d_current_day#76,... 4 more fields] parquet
               :     +- Project [ca_address_sk#25]
               :        +- Filter (ca_county#26 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County) AND isnotnull(ca_address_sk#25))
               :           +- Relation[ca_address_sk#25,ca_address_id#140,ca_street_number#141,ca_street_name#142,ca_street_type#143,ca_suite_number#144,ca_city#145,ca_county#26,ca_state#146,ca_zip#147,ca_country#148,ca_gmt_offset#149,ca_location_type#150] parquet
               +- Filter isnotnull(cd_demo_sk#27)
                  +- Relation[cd_demo_sk#27,cd_gender#10,cd_marital_status#11,cd_education_status#12,cd_purchase_estimate#13,cd_credit_rating#14,cd_dep_count#15,cd_dep_employed_count#16,cd_dep_college_count#17] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[cd_gender#10 ASC NULLS FIRST,cd_marital_status#11 ASC NULLS FIRST,cd_education_status#12 ASC NULLS FIRST,cd_purchase_estimate#13 ASC NULLS FIRST,cd_credit_rating#14 ASC NULLS FIRST,cd_dep_count#15 ASC NULLS FIRST,cd_dep_employed_count#16 ASC NULLS FIRST,cd_dep_college_count#17 ASC NULLS FIRST], output=[cd_gender#10,cd_marital_status#11,cd_education_status#12,cnt1#18,cd_purchase_estimate#13,cnt2#19,cd_credit_rating#14,cnt3#20,cd_dep_count#15,cnt4#21,cd_dep_employed_count#16,cnt5#22,cd_dep_college_count#17,cnt6#23])
+- *(18) HashAggregate(keys=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], functions=[count(1)], output=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cnt1#18, cd_purchase_estimate#13, cnt2#19, cd_credit_rating#14, cnt3#20, cd_dep_count#15, cnt4#21, cd_dep_employed_count#16, cnt5#22, cd_dep_college_count#17, cnt6#23])
   +- Exchange hashpartitioning(cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17, 5), true, [id=#153]
      +- *(17) HashAggregate(keys=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], functions=[partial_count(1)], output=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17, count#154])
         +- *(17) Project [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17]
            +- *(17) SortMergeJoin [c_current_cdemo_sk#28], [cd_demo_sk#27], Inner
               :- *(14) Sort [c_current_cdemo_sk#28 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(c_current_cdemo_sk#28, 5), true, [id=#155]
               :     +- *(13) Project [c_current_cdemo_sk#28]
               :        +- *(13) BroadcastHashJoin [c_current_addr_sk#24], [ca_address_sk#25], Inner, BuildRight, false
               :           :- *(13) Project [c_current_cdemo_sk#28, c_current_addr_sk#24]
               :           :  +- *(13) Filter (exists#151 OR exists#152)
               :           :     +- SortMergeJoin [c_customer_sk#29], [cs_ship_customer_sk#108], ExistenceJoin(exists#152)
               :           :        :- SortMergeJoin [c_customer_sk#29], [ws_bill_customer_sk#81], ExistenceJoin(exists#151)
               :           :        :  :- SortMergeJoin [c_customer_sk#29], [ss_customer_sk#33], LeftSemi
               :           :        :  :  :- *(2) Sort [c_customer_sk#29 ASC NULLS FIRST], false, 0
               :           :        :  :  :  +- Exchange hashpartitioning(c_customer_sk#29, 5), true, [id=#156]
               :           :        :  :  :     +- *(1) Filter (isnotnull(c_current_addr_sk#24) AND isnotnull(c_current_cdemo_sk#28))
               :           :        :  :  :        +- *(1) ColumnarToRow
               :           :        :  :  :           +- FileScan parquet default.customer[c_customer_sk#29,c_current_cdemo_sk#28,c_current_addr_sk#24] Batched: true, DataFilters: [isnotnull(c_current_addr_sk#24), isnotnull(c_current_cdemo_sk#28)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(c_current_addr_sk), IsNotNull(c_current_cdemo_sk)], ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int>
               :           :        :  :  +- *(5) Sort [ss_customer_sk#33 ASC NULLS FIRST], false, 0
               :           :        :  :     +- Exchange hashpartitioning(ss_customer_sk#33, 5), true, [id=#157]
               :           :        :  :        +- *(4) Project [ss_customer_sk#33]
               :           :        :  :           +- *(4) BroadcastHashJoin [ss_sold_date_sk#30], [d_date_sk#53], Inner, BuildRight, false
               :           :        :  :              :- *(4) Filter isnotnull(ss_sold_date_sk#30)
               :           :        :  :              :  +- *(4) ColumnarToRow
               :           :        :  :              :     +- FileScan parquet default.store_sales[ss_sold_date_sk#30,ss_customer_sk#33] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#30)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int>
               :           :        :  :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#158]
               :           :        :  :                 +- *(3) Project [d_date_sk#53]
               :           :        :  :                    +- *(3) Filter (((((isnotnull(d_year#54) AND isnotnull(d_moy#55)) AND (d_year#54 = 2002)) AND (d_moy#55 >= 1)) AND (d_moy#55 <= 4)) AND isnotnull(d_date_sk#53))
               :           :        :  :                       +- *(3) ColumnarToRow
               :           :        :  :                          +- FileScan parquet default.date_dim[d_date_sk#53,d_year#54,d_moy#55] Batched: true, DataFilters: [isnotnull(d_year#54), isnotnull(d_moy#55), (d_year#54 = 2002), (d_moy#55 >= 1), (d_moy#159..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2002), GreaterThanOrEqual(d_moy,1), LessThan..., ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :           :        :  +- *(8) Sort [ws_bill_customer_sk#81 ASC NULLS FIRST], false, 0
               :           :        :     +- Exchange hashpartitioning(ws_bill_customer_sk#81, 5), true, [id=#160]
               :           :        :        +- *(7) Project [ws_bill_customer_sk#81]
               :           :        :           +- *(7) BroadcastHashJoin [ws_sold_date_sk#77], [d_date_sk#53], Inner, BuildRight, false
               :           :        :              :- *(7) Filter isnotnull(ws_sold_date_sk#77)
               :           :        :              :  +- *(7) ColumnarToRow
               :           :        :              :     +- FileScan parquet default.web_sales[ws_sold_date_sk#77,ws_bill_customer_sk#81] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#77)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int>
               :           :        :              +- ReusedExchange [d_date_sk#53], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#158]
               :           :        +- *(11) Sort [cs_ship_customer_sk#108 ASC NULLS FIRST], false, 0
               :           :           +- Exchange hashpartitioning(cs_ship_customer_sk#108, 5), true, [id=#161]
               :           :              +- *(10) Project [cs_ship_customer_sk#108]
               :           :                 +- *(10) BroadcastHashJoin [cs_sold_date_sk#101], [d_date_sk#53], Inner, BuildRight, false
               :           :                    :- *(10) Filter isnotnull(cs_sold_date_sk#101)
               :           :                    :  +- *(10) ColumnarToRow
               :           :                    :     +- FileScan parquet default.catalog_sales[cs_sold_date_sk#101,cs_ship_customer_sk#108] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#101)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ship_customer_sk:int>
               :           :                    +- ReusedExchange [d_date_sk#53], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#158]
               :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#162]
               :              +- *(12) Project [ca_address_sk#25]
               :                 +- *(12) Filter (ca_county#26 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County) AND isnotnull(ca_address_sk#25))
               :                    +- *(12) ColumnarToRow
               :                       +- FileScan parquet default.customer_address[ca_address_sk#25,ca_county#26] Batched: true, DataFilters: [ca_county#26 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County), i..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_county, [Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County]), IsNo..., ReadSchema: struct<ca_address_sk:int,ca_county:string>
               +- *(16) Sort [cd_demo_sk#27 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(cd_demo_sk#27, 5), true, [id=#163]
                     +- *(15) Filter isnotnull(cd_demo_sk#27)
                        +- *(15) ColumnarToRow
                           +- FileScan parquet default.customer_demographics[cd_demo_sk#27,cd_gender#10,cd_marital_status#11,cd_education_status#12,cd_purchase_estimate#13,cd_credit_rating#14,cd_dep_count#15,cd_dep_employed_count#16,cd_dep_college_count#17] Batched: true, DataFilters: [isnotnull(cd_demo_sk#27)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_marital_status:string,cd_education_status:string,cd_pur...
