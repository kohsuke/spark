== Parsed Logical Plan ==
CTE [web_v1, store_v1]
:  :- 'SubqueryAlias web_v1
:  :  +- 'Aggregate ['ws_item_sk, 'd_date], ['ws_item_sk AS item_sk#1, 'd_date, 'sum('sum('ws_sales_price)) windowspecdefinition('ws_item_sk, 'd_date ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#2]
:  :     +- 'Filter ((('ws_sold_date_sk = 'd_date_sk) AND (('d_month_seq >= 1200) AND ('d_month_seq <= (1200 + 11)))) AND isnotnull('ws_item_sk))
:  :        +- 'Join Inner
:  :           :- 'UnresolvedRelation [web_sales]
:  :           +- 'UnresolvedRelation [date_dim]
:  +- 'SubqueryAlias store_v1
:     +- 'Aggregate ['ss_item_sk, 'd_date], ['ss_item_sk AS item_sk#3, 'd_date, 'sum('sum('ss_sales_price)) windowspecdefinition('ss_item_sk, 'd_date ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#4]
:        +- 'Filter ((('ss_sold_date_sk = 'd_date_sk) AND (('d_month_seq >= 1200) AND ('d_month_seq <= (1200 + 11)))) AND isnotnull('ss_item_sk))
:           +- 'Join Inner
:              :- 'UnresolvedRelation [store_sales]
:              +- 'UnresolvedRelation [date_dim]
+- 'GlobalLimit 100
   +- 'LocalLimit 100
      +- 'Sort ['item_sk ASC NULLS FIRST, 'd_date ASC NULLS FIRST], true
         +- 'Project [*]
            +- 'Filter ('web_cumulative > 'store_cumulative)
               +- 'SubqueryAlias y
                  +- 'Project ['item_sk, 'd_date, 'web_sales, 'store_sales, 'max('web_sales) windowspecdefinition('item_sk, 'd_date ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#5, 'max('store_sales) windowspecdefinition('item_sk, 'd_date ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#6]
                     +- 'SubqueryAlias x
                        +- 'Project [CASE WHEN isnotnull('web.item_sk) THEN 'web.item_sk ELSE 'store.item_sk END AS item_sk#7, CASE WHEN isnotnull('web.d_date) THEN 'web.d_date ELSE 'store.d_date END AS d_date#8, 'web.cume_sales AS web_sales#9, 'store.cume_sales AS store_sales#10]
                           +- 'Join FullOuter, (('web.item_sk = 'store.item_sk) AND ('web.d_date = 'store.d_date))
                              :- 'SubqueryAlias web
                              :  +- 'UnresolvedRelation [web_v1]
                              +- 'SubqueryAlias store
                                 +- 'UnresolvedRelation [store_v1]

== Analyzed Logical Plan ==
item_sk: int, d_date: date, web_sales: decimal(27,2), store_sales: decimal(27,2), web_cumulative: decimal(27,2), store_cumulative: decimal(27,2)
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#7 ASC NULLS FIRST, d_date#8 ASC NULLS FIRST], true
      +- Project [item_sk#7, d_date#8, web_sales#9, store_sales#10, web_cumulative#5, store_cumulative#6]
         +- Filter (web_cumulative#5 > store_cumulative#6)
            +- SubqueryAlias y
               +- Project [item_sk#7, d_date#8, web_sales#9, store_sales#10, web_cumulative#5, store_cumulative#6]
                  +- Project [item_sk#7, d_date#8, web_sales#9, store_sales#10, web_cumulative#5, store_cumulative#6, web_cumulative#5, store_cumulative#6]
                     +- Window [max(web_sales#9) windowspecdefinition(item_sk#7, d_date#8 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#5, max(store_sales#10) windowspecdefinition(item_sk#7, d_date#8 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#6], [item_sk#7], [d_date#8 ASC NULLS FIRST]
                        +- Project [item_sk#7, d_date#8, web_sales#9, store_sales#10]
                           +- SubqueryAlias x
                              +- Project [CASE WHEN isnotnull(item_sk#1) THEN item_sk#1 ELSE item_sk#3 END AS item_sk#7, CASE WHEN isnotnull(d_date#11) THEN d_date#11 ELSE d_date#12 END AS d_date#8, cume_sales#2 AS web_sales#9, cume_sales#4 AS store_sales#10]
                                 +- Join FullOuter, ((item_sk#1 = item_sk#3) AND (d_date#11 = d_date#12))
                                    :- SubqueryAlias web
                                    :  +- SubqueryAlias web_v1
                                    :     +- Project [item_sk#1, d_date#11, cume_sales#2]
                                    :        +- Project [item_sk#1, d_date#11, _w0#13, ws_item_sk#14, cume_sales#2, cume_sales#2]
                                    :           +- Window [sum(_w0#13) windowspecdefinition(ws_item_sk#14, d_date#11 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#2], [ws_item_sk#14], [d_date#11 ASC NULLS FIRST]
                                    :              +- Aggregate [ws_item_sk#14, d_date#11], [ws_item_sk#14 AS item_sk#1, d_date#11, sum(ws_sales_price#15) AS _w0#13, ws_item_sk#14]
                                    :                 +- Filter (((ws_sold_date_sk#16 = d_date_sk#17) AND ((d_month_seq#18 >= 1200) AND (d_month_seq#18 <= (1200 + 11)))) AND isnotnull(ws_item_sk#14))
                                    :                    +- Join Inner
                                    :                       :- SubqueryAlias spark_catalog.default.web_sales
                                    :                       :  +- Relation[ws_sold_date_sk#16,ws_sold_time_sk#19,ws_ship_date_sk#20,ws_item_sk#14,ws_bill_customer_sk#21,ws_bill_cdemo_sk#22,ws_bill_hdemo_sk#23,ws_bill_addr_sk#24,ws_ship_customer_sk#25,ws_ship_cdemo_sk#26,ws_ship_hdemo_sk#27,ws_ship_addr_sk#28,ws_web_page_sk#29,ws_web_site_sk#30,ws_ship_mode_sk#31,ws_warehouse_sk#32,ws_promo_sk#33,ws_order_number#34,ws_quantity#35,ws_wholesale_cost#36,ws_list_price#37,ws_sales_price#15,ws_ext_discount_amt#38,ws_ext_sales_price#39,... 10 more fields] parquet
                                    :                       +- SubqueryAlias spark_catalog.default.date_dim
                                    :                          +- Relation[d_date_sk#17,d_date_id#40,d_date#11,d_month_seq#18,d_week_seq#41,d_quarter_seq#42,d_year#43,d_dow#44,d_moy#45,d_dom#46,d_qoy#47,d_fy_year#48,d_fy_quarter_seq#49,d_fy_week_seq#50,d_day_name#51,d_quarter_name#52,d_holiday#53,d_weekend#54,d_following_holiday#55,d_first_dom#56,d_last_dom#57,d_same_day_ly#58,d_same_day_lq#59,d_current_day#60,... 4 more fields] parquet
                                    +- SubqueryAlias store
                                       +- SubqueryAlias store_v1
                                          +- Project [item_sk#3, d_date#12, cume_sales#4]
                                             +- Project [item_sk#3, d_date#12, _w0#61, ss_item_sk#62, cume_sales#4, cume_sales#4]
                                                +- Window [sum(_w0#61) windowspecdefinition(ss_item_sk#62, d_date#12 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#4], [ss_item_sk#62], [d_date#12 ASC NULLS FIRST]
                                                   +- Aggregate [ss_item_sk#62, d_date#12], [ss_item_sk#62 AS item_sk#3, d_date#12, sum(ss_sales_price#63) AS _w0#61, ss_item_sk#62]
                                                      +- Filter (((ss_sold_date_sk#64 = d_date_sk#65) AND ((d_month_seq#66 >= 1200) AND (d_month_seq#66 <= (1200 + 11)))) AND isnotnull(ss_item_sk#62))
                                                         +- Join Inner
                                                            :- SubqueryAlias spark_catalog.default.store_sales
                                                            :  +- Relation[ss_sold_date_sk#64,ss_sold_time_sk#67,ss_item_sk#62,ss_customer_sk#68,ss_cdemo_sk#69,ss_hdemo_sk#70,ss_addr_sk#71,ss_store_sk#72,ss_promo_sk#73,ss_ticket_number#74,ss_quantity#75,ss_wholesale_cost#76,ss_list_price#77,ss_sales_price#63,ss_ext_discount_amt#78,ss_ext_sales_price#79,ss_ext_wholesale_cost#80,ss_ext_list_price#81,ss_ext_tax#82,ss_coupon_amt#83,ss_net_paid#84,ss_net_paid_inc_tax#85,ss_net_profit#86] parquet
                                                            +- SubqueryAlias spark_catalog.default.date_dim
                                                               +- Relation[d_date_sk#65,d_date_id#87,d_date#12,d_month_seq#66,d_week_seq#88,d_quarter_seq#89,d_year#90,d_dow#91,d_moy#92,d_dom#93,d_qoy#94,d_fy_year#95,d_fy_quarter_seq#96,d_fy_week_seq#97,d_day_name#98,d_quarter_name#99,d_holiday#100,d_weekend#101,d_following_holiday#102,d_first_dom#103,d_last_dom#104,d_same_day_ly#105,d_same_day_lq#106,d_current_day#107,... 4 more fields] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#7 ASC NULLS FIRST, d_date#8 ASC NULLS FIRST], true
      +- Filter ((isnotnull(web_cumulative#5) AND isnotnull(store_cumulative#6)) AND (web_cumulative#5 > store_cumulative#6))
         +- Window [max(web_sales#9) windowspecdefinition(item_sk#7, d_date#8 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#5, max(store_sales#10) windowspecdefinition(item_sk#7, d_date#8 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#6], [item_sk#7], [d_date#8 ASC NULLS FIRST]
            +- Project [CASE WHEN isnotnull(item_sk#1) THEN item_sk#1 ELSE item_sk#3 END AS item_sk#7, CASE WHEN isnotnull(d_date#11) THEN d_date#11 ELSE d_date#12 END AS d_date#8, cume_sales#2 AS web_sales#9, cume_sales#4 AS store_sales#10]
               +- Join FullOuter, ((item_sk#1 = item_sk#3) AND (d_date#11 = d_date#12))
                  :- Project [item_sk#1, d_date#11, cume_sales#2]
                  :  +- Window [sum(_w0#13) windowspecdefinition(ws_item_sk#14, d_date#11 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#2], [ws_item_sk#14], [d_date#11 ASC NULLS FIRST]
                  :     +- Aggregate [ws_item_sk#14, d_date#11], [ws_item_sk#14 AS item_sk#1, d_date#11, MakeDecimal(sum(UnscaledValue(ws_sales_price#15)),17,2) AS _w0#13, ws_item_sk#14]
                  :        +- Project [ws_item_sk#14, ws_sales_price#15, d_date#11]
                  :           +- Join Inner, (ws_sold_date_sk#16 = d_date_sk#17)
                  :              :- Project [ws_sold_date_sk#16, ws_item_sk#14, ws_sales_price#15]
                  :              :  +- Filter (isnotnull(ws_item_sk#14) AND isnotnull(ws_sold_date_sk#16))
                  :              :     +- Relation[ws_sold_date_sk#16,ws_sold_time_sk#19,ws_ship_date_sk#20,ws_item_sk#14,ws_bill_customer_sk#21,ws_bill_cdemo_sk#22,ws_bill_hdemo_sk#23,ws_bill_addr_sk#24,ws_ship_customer_sk#25,ws_ship_cdemo_sk#26,ws_ship_hdemo_sk#27,ws_ship_addr_sk#28,ws_web_page_sk#29,ws_web_site_sk#30,ws_ship_mode_sk#31,ws_warehouse_sk#32,ws_promo_sk#33,ws_order_number#34,ws_quantity#35,ws_wholesale_cost#36,ws_list_price#37,ws_sales_price#15,ws_ext_discount_amt#38,ws_ext_sales_price#39,... 10 more fields] parquet
                  :              +- Project [d_date_sk#17, d_date#11]
                  :                 +- Filter (((isnotnull(d_month_seq#18) AND (d_month_seq#18 >= 1200)) AND (d_month_seq#18 <= 1211)) AND isnotnull(d_date_sk#17))
                  :                    +- Relation[d_date_sk#17,d_date_id#40,d_date#11,d_month_seq#18,d_week_seq#41,d_quarter_seq#42,d_year#43,d_dow#44,d_moy#45,d_dom#46,d_qoy#47,d_fy_year#48,d_fy_quarter_seq#49,d_fy_week_seq#50,d_day_name#51,d_quarter_name#52,d_holiday#53,d_weekend#54,d_following_holiday#55,d_first_dom#56,d_last_dom#57,d_same_day_ly#58,d_same_day_lq#59,d_current_day#60,... 4 more fields] parquet
                  +- Project [item_sk#3, d_date#12, cume_sales#4]
                     +- Window [sum(_w0#61) windowspecdefinition(ss_item_sk#62, d_date#12 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#4], [ss_item_sk#62], [d_date#12 ASC NULLS FIRST]
                        +- Aggregate [ss_item_sk#62, d_date#12], [ss_item_sk#62 AS item_sk#3, d_date#12, MakeDecimal(sum(UnscaledValue(ss_sales_price#63)),17,2) AS _w0#61, ss_item_sk#62]
                           +- Project [ss_item_sk#62, ss_sales_price#63, d_date#12]
                              +- Join Inner, (ss_sold_date_sk#64 = d_date_sk#65)
                                 :- Project [ss_sold_date_sk#64, ss_item_sk#62, ss_sales_price#63]
                                 :  +- Filter (isnotnull(ss_item_sk#62) AND isnotnull(ss_sold_date_sk#64))
                                 :     +- Relation[ss_sold_date_sk#64,ss_sold_time_sk#67,ss_item_sk#62,ss_customer_sk#68,ss_cdemo_sk#69,ss_hdemo_sk#70,ss_addr_sk#71,ss_store_sk#72,ss_promo_sk#73,ss_ticket_number#74,ss_quantity#75,ss_wholesale_cost#76,ss_list_price#77,ss_sales_price#63,ss_ext_discount_amt#78,ss_ext_sales_price#79,ss_ext_wholesale_cost#80,ss_ext_list_price#81,ss_ext_tax#82,ss_coupon_amt#83,ss_net_paid#84,ss_net_paid_inc_tax#85,ss_net_profit#86] parquet
                                 +- Project [d_date_sk#65, d_date#12]
                                    +- Filter (((isnotnull(d_month_seq#66) AND (d_month_seq#66 >= 1200)) AND (d_month_seq#66 <= 1211)) AND isnotnull(d_date_sk#65))
                                       +- Relation[d_date_sk#65,d_date_id#87,d_date#12,d_month_seq#66,d_week_seq#88,d_quarter_seq#89,d_year#90,d_dow#91,d_moy#92,d_dom#93,d_qoy#94,d_fy_year#95,d_fy_quarter_seq#96,d_fy_week_seq#97,d_day_name#98,d_quarter_name#99,d_holiday#100,d_weekend#101,d_following_holiday#102,d_first_dom#103,d_last_dom#104,d_same_day_ly#105,d_same_day_lq#106,d_current_day#107,... 4 more fields] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[item_sk#7 ASC NULLS FIRST,d_date#8 ASC NULLS FIRST], output=[item_sk#7,d_date#8,web_sales#9,store_sales#10,web_cumulative#5,store_cumulative#6])
+- *(15) Filter ((isnotnull(web_cumulative#5) AND isnotnull(store_cumulative#6)) AND (web_cumulative#5 > store_cumulative#6))
   +- Window [max(web_sales#9) windowspecdefinition(item_sk#7, d_date#8 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#5, max(store_sales#10) windowspecdefinition(item_sk#7, d_date#8 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#6], [item_sk#7], [d_date#8 ASC NULLS FIRST]
      +- *(14) Sort [item_sk#7 ASC NULLS FIRST, d_date#8 ASC NULLS FIRST], false, 0
         +- Exchange hashpartitioning(item_sk#7, 5), true, [id=#108]
            +- *(13) Project [CASE WHEN isnotnull(item_sk#1) THEN item_sk#1 ELSE item_sk#3 END AS item_sk#7, CASE WHEN isnotnull(d_date#11) THEN d_date#11 ELSE d_date#12 END AS d_date#8, cume_sales#2 AS web_sales#9, cume_sales#4 AS store_sales#10]
               +- SortMergeJoin [item_sk#1, d_date#11], [item_sk#3, d_date#12], FullOuter
                  :- *(6) Sort [item_sk#1 ASC NULLS FIRST, d_date#11 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(item_sk#1, d_date#11, 5), true, [id=#109]
                  :     +- *(5) Project [item_sk#1, d_date#11, cume_sales#2]
                  :        +- Window [sum(_w0#13) windowspecdefinition(ws_item_sk#14, d_date#11 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#2], [ws_item_sk#14], [d_date#11 ASC NULLS FIRST]
                  :           +- *(4) Sort [ws_item_sk#14 ASC NULLS FIRST, d_date#11 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(ws_item_sk#14, 5), true, [id=#110]
                  :                 +- *(3) HashAggregate(keys=[ws_item_sk#14, d_date#11], functions=[sum(UnscaledValue(ws_sales_price#15))], output=[item_sk#1, d_date#11, _w0#13, ws_item_sk#14])
                  :                    +- Exchange hashpartitioning(ws_item_sk#14, d_date#11, 5), true, [id=#111]
                  :                       +- *(2) HashAggregate(keys=[ws_item_sk#14, d_date#11], functions=[partial_sum(UnscaledValue(ws_sales_price#15))], output=[ws_item_sk#14, d_date#11, sum#112])
                  :                          +- *(2) Project [ws_item_sk#14, ws_sales_price#15, d_date#11]
                  :                             +- *(2) BroadcastHashJoin [ws_sold_date_sk#16], [d_date_sk#17], Inner, BuildRight, false
                  :                                :- *(2) Project [ws_sold_date_sk#16, ws_item_sk#14, ws_sales_price#15]
                  :                                :  +- *(2) Filter (isnotnull(ws_item_sk#14) AND isnotnull(ws_sold_date_sk#16))
                  :                                :     +- *(2) ColumnarToRow
                  :                                :        +- FileScan parquet default.web_sales[ws_sold_date_sk#16,ws_item_sk#14,ws_sales_price#15] Batched: true, DataFilters: [isnotnull(ws_item_sk#14), isnotnull(ws_sold_date_sk#16)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_sales_price:decimal(7,2)>
                  :                                +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#113]
                  :                                   +- *(1) Project [d_date_sk#17, d_date#11]
                  :                                      +- *(1) Filter (((isnotnull(d_month_seq#18) AND (d_month_seq#18 >= 1200)) AND (d_month_seq#18 <= 1211)) AND isnotnull(d_date_sk#17))
                  :                                         +- *(1) ColumnarToRow
                  :                                            +- FileScan parquet default.date_dim[d_date_sk#17,d_date#11,d_month_seq#18] Batched: true, DataFilters: [isnotnull(d_month_seq#18), (d_month_seq#18 >= 1200), (d_month_seq#18 <= 1211), isnotnull(d_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_date:date,d_month_seq:int>
                  +- *(12) Sort [item_sk#3 ASC NULLS FIRST, d_date#12 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(item_sk#3, d_date#12, 5), true, [id=#114]
                        +- *(11) Project [item_sk#3, d_date#12, cume_sales#4]
                           +- Window [sum(_w0#61) windowspecdefinition(ss_item_sk#62, d_date#12 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#4], [ss_item_sk#62], [d_date#12 ASC NULLS FIRST]
                              +- *(10) Sort [ss_item_sk#62 ASC NULLS FIRST, d_date#12 ASC NULLS FIRST], false, 0
                                 +- Exchange hashpartitioning(ss_item_sk#62, 5), true, [id=#115]
                                    +- *(9) HashAggregate(keys=[ss_item_sk#62, d_date#12], functions=[sum(UnscaledValue(ss_sales_price#63))], output=[item_sk#3, d_date#12, _w0#61, ss_item_sk#62])
                                       +- Exchange hashpartitioning(ss_item_sk#62, d_date#12, 5), true, [id=#116]
                                          +- *(8) HashAggregate(keys=[ss_item_sk#62, d_date#12], functions=[partial_sum(UnscaledValue(ss_sales_price#63))], output=[ss_item_sk#62, d_date#12, sum#117])
                                             +- *(8) Project [ss_item_sk#62, ss_sales_price#63, d_date#12]
                                                +- *(8) BroadcastHashJoin [ss_sold_date_sk#64], [d_date_sk#65], Inner, BuildRight, false
                                                   :- *(8) Project [ss_sold_date_sk#64, ss_item_sk#62, ss_sales_price#63]
                                                   :  +- *(8) Filter (isnotnull(ss_item_sk#62) AND isnotnull(ss_sold_date_sk#64))
                                                   :     +- *(8) ColumnarToRow
                                                   :        +- FileScan parquet default.store_sales[ss_sold_date_sk#64,ss_item_sk#62,ss_sales_price#63] Batched: true, DataFilters: [isnotnull(ss_item_sk#62), isnotnull(ss_sold_date_sk#64)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_sales_price:decimal(7,2)>
                                                   +- ReusedExchange [d_date_sk#65, d_date#12], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#113]
