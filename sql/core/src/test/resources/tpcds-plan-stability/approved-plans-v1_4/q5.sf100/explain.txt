== Parsed Logical Plan ==
CTE [ssr, csr, wsr]
:  :- 'SubqueryAlias ssr
:  :  +- 'Aggregate ['s_store_id], ['s_store_id, 'sum('sales_price) AS sales#1, 'sum('profit) AS profit#2, 'sum('return_amt) AS RETURNS#3, 'sum('net_loss) AS profit_loss#4]
:  :     +- 'Filter ((('date_sk = 'd_date_sk) AND (('d_date >= cast(2000-08-23 as date)) AND ('d_date <= (cast(2000-08-23 as date) + 14 days)))) AND ('store_sk = 's_store_sk))
:  :        +- 'Join Inner
:  :           :- 'Join Inner
:  :           :  :- 'SubqueryAlias salesreturns
:  :           :  :  +- 'Union false, false
:  :           :  :     :- 'Project ['ss_store_sk AS store_sk#5, 'ss_sold_date_sk AS date_sk#6, 'ss_ext_sales_price AS sales_price#7, 'ss_net_profit AS profit#8, cast(0 as decimal(7,2)) AS return_amt#9, cast(0 as decimal(7,2)) AS net_loss#10]
:  :           :  :     :  +- 'UnresolvedRelation [store_sales]
:  :           :  :     +- 'Project ['sr_store_sk AS store_sk#11, 'sr_returned_date_sk AS date_sk#12, cast(0 as decimal(7,2)) AS sales_price#13, cast(0 as decimal(7,2)) AS profit#14, 'sr_return_amt AS return_amt#15, 'sr_net_loss AS net_loss#16]
:  :           :  :        +- 'UnresolvedRelation [store_returns]
:  :           :  +- 'UnresolvedRelation [date_dim]
:  :           +- 'UnresolvedRelation [store]
:  :- 'SubqueryAlias csr
:  :  +- 'Aggregate ['cp_catalog_page_id], ['cp_catalog_page_id, 'sum('sales_price) AS sales#17, 'sum('profit) AS profit#18, 'sum('return_amt) AS RETURNS#19, 'sum('net_loss) AS profit_loss#20]
:  :     +- 'Filter ((('date_sk = 'd_date_sk) AND (('d_date >= cast(2000-08-23 as date)) AND ('d_date <= (cast(2000-08-23 as date) + 14 days)))) AND ('page_sk = 'cp_catalog_page_sk))
:  :        +- 'Join Inner
:  :           :- 'Join Inner
:  :           :  :- 'SubqueryAlias salesreturns
:  :           :  :  +- 'Union false, false
:  :           :  :     :- 'Project ['cs_catalog_page_sk AS page_sk#21, 'cs_sold_date_sk AS date_sk#22, 'cs_ext_sales_price AS sales_price#23, 'cs_net_profit AS profit#24, cast(0 as decimal(7,2)) AS return_amt#25, cast(0 as decimal(7,2)) AS net_loss#26]
:  :           :  :     :  +- 'UnresolvedRelation [catalog_sales]
:  :           :  :     +- 'Project ['cr_catalog_page_sk AS page_sk#27, 'cr_returned_date_sk AS date_sk#28, cast(0 as decimal(7,2)) AS sales_price#29, cast(0 as decimal(7,2)) AS profit#30, 'cr_return_amount AS return_amt#31, 'cr_net_loss AS net_loss#32]
:  :           :  :        +- 'UnresolvedRelation [catalog_returns]
:  :           :  +- 'UnresolvedRelation [date_dim]
:  :           +- 'UnresolvedRelation [catalog_page]
:  +- 'SubqueryAlias wsr
:     +- 'Aggregate ['web_site_id], ['web_site_id, 'sum('sales_price) AS sales#33, 'sum('profit) AS profit#34, 'sum('return_amt) AS RETURNS#35, 'sum('net_loss) AS profit_loss#36]
:        +- 'Filter ((('date_sk = 'd_date_sk) AND (('d_date >= cast(2000-08-23 as date)) AND ('d_date <= (cast(2000-08-23 as date) + 14 days)))) AND ('wsr_web_site_sk = 'web_site_sk))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'SubqueryAlias salesreturns
:              :  :  +- 'Union false, false
:              :  :     :- 'Project ['ws_web_site_sk AS wsr_web_site_sk#37, 'ws_sold_date_sk AS date_sk#38, 'ws_ext_sales_price AS sales_price#39, 'ws_net_profit AS profit#40, cast(0 as decimal(7,2)) AS return_amt#41, cast(0 as decimal(7,2)) AS net_loss#42]
:              :  :     :  +- 'UnresolvedRelation [web_sales]
:              :  :     +- 'Project ['ws_web_site_sk AS wsr_web_site_sk#43, 'wr_returned_date_sk AS date_sk#44, cast(0 as decimal(7,2)) AS sales_price#45, cast(0 as decimal(7,2)) AS profit#46, 'wr_return_amt AS return_amt#47, 'wr_net_loss AS net_loss#48]
:              :  :        +- 'Join LeftOuter, (('wr_item_sk = 'ws_item_sk) AND ('wr_order_number = 'ws_order_number))
:              :  :           :- 'UnresolvedRelation [web_returns]
:              :  :           +- 'UnresolvedRelation [web_sales]
:              :  +- 'UnresolvedRelation [date_dim]
:              +- 'UnresolvedRelation [web_site]
+- 'GlobalLimit 100
   +- 'LocalLimit 100
      +- 'Sort ['channel ASC NULLS FIRST, 'id ASC NULLS FIRST], true
         +- 'Aggregate ['ROLLUP('channel, 'id)], ['channel, 'id, 'sum('sales) AS sales#49, 'sum('returns) AS returns#50, 'sum('profit) AS profit#51]
            +- 'SubqueryAlias x
               +- 'Union false, false
                  :- 'Union false, false
                  :  :- 'Project [store channel AS channel#52, 'concat(store, 's_store_id) AS id#53, 'sales, 'returns, ('profit - 'profit_loss) AS profit#54]
                  :  :  +- 'UnresolvedRelation [ssr]
                  :  +- 'Project [catalog channel AS channel#55, 'concat(catalog_page, 'cp_catalog_page_id) AS id#56, 'sales, 'returns, ('profit - 'profit_loss) AS profit#57]
                  :     +- 'UnresolvedRelation [csr]
                  +- 'Project [web channel AS channel#58, 'concat(web_site, 'web_site_id) AS id#59, 'sales, 'returns, ('profit - 'profit_loss) AS profit#60]
                     +- 'UnresolvedRelation [wsr]

== Analyzed Logical Plan ==
channel: string, id: string, sales: decimal(27,2), returns: decimal(27,2), profit: decimal(28,2)
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#61 ASC NULLS FIRST, id#62 ASC NULLS FIRST], true
      +- Aggregate [channel#61, id#62, spark_grouping_id#63], [channel#61, id#62, sum(sales#1) AS sales#49, sum(returns#3) AS returns#50, sum(profit#64) AS profit#51]
         +- Expand [List(channel#52, id#53, sales#1, returns#3, profit#64, channel#65, id#66, 0), List(channel#52, id#53, sales#1, returns#3, profit#64, channel#65, null, 1), List(channel#52, id#53, sales#1, returns#3, profit#64, null, null, 3)], [channel#52, id#53, sales#1, returns#3, profit#64, channel#61, id#62, spark_grouping_id#63]
            +- Project [channel#52, id#53, sales#1, returns#3, profit#64, channel#52 AS channel#65, id#53 AS id#66]
               +- SubqueryAlias x
                  +- Union false, false
                     :- Project [channel#52, id#53, sales#1, returns#3, profit#64]
                     :  +- Union false, false
                     :     :- Project [channel#52, id#53, sales#1, returns#3, cast(profit#54 as decimal(18,2)) AS profit#64]
                     :     :  +- Project [store channel AS channel#52, concat(store, s_store_id#67) AS id#53, sales#1, returns#3, CheckOverflow((promote_precision(cast(profit#2 as decimal(18,2))) - promote_precision(cast(profit_loss#4 as decimal(18,2)))), DecimalType(18,2), true) AS profit#54]
                     :     :     +- SubqueryAlias ssr
                     :     :        +- Aggregate [s_store_id#67], [s_store_id#67, sum(sales_price#7) AS sales#1, sum(profit#8) AS profit#2, sum(return_amt#9) AS RETURNS#3, sum(net_loss#10) AS profit_loss#4]
                     :     :           +- Filter (((date_sk#68 = cast(d_date_sk#69 as bigint)) AND ((d_date#70 >= cast(2000-08-23 as date)) AND (d_date#70 <= cast(2000-08-23 as date) + 14 days))) AND (store_sk#71 = cast(s_store_sk#72 as bigint)))
                     :     :              +- Join Inner
                     :     :                 :- Join Inner
                     :     :                 :  :- SubqueryAlias salesreturns
                     :     :                 :  :  +- Union false, false
                     :     :                 :  :     :- Project [cast(store_sk#5 as bigint) AS store_sk#71, cast(date_sk#6 as bigint) AS date_sk#68, sales_price#7, profit#8, return_amt#9, net_loss#10]
                     :     :                 :  :     :  +- Project [ss_store_sk#73 AS store_sk#5, ss_sold_date_sk#74 AS date_sk#6, ss_ext_sales_price#75 AS sales_price#7, ss_net_profit#76 AS profit#8, cast(0 as decimal(7,2)) AS return_amt#9, cast(0 as decimal(7,2)) AS net_loss#10]
                     :     :                 :  :     :     +- SubqueryAlias spark_catalog.default.store_sales
                     :     :                 :  :     :        +- Relation[ss_sold_date_sk#74,ss_sold_time_sk#77,ss_item_sk#78,ss_customer_sk#79,ss_cdemo_sk#80,ss_hdemo_sk#81,ss_addr_sk#82,ss_store_sk#73,ss_promo_sk#83,ss_ticket_number#84,ss_quantity#85,ss_wholesale_cost#86,ss_list_price#87,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#75,ss_ext_wholesale_cost#90,ss_ext_list_price#91,ss_ext_tax#92,ss_coupon_amt#93,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#76] parquet
                     :     :                 :  :     +- Project [store_sk#96, date_sk#97, sales_price#13, profit#14, return_amt#15, net_loss#16]
                     :     :                 :  :        +- Project [sr_store_sk#98 AS store_sk#96, sr_returned_date_sk#99 AS date_sk#97, cast(0 as decimal(7,2)) AS sales_price#13, cast(0 as decimal(7,2)) AS profit#14, sr_return_amt#100 AS return_amt#15, sr_net_loss#101 AS net_loss#16]
                     :     :                 :  :           +- SubqueryAlias spark_catalog.default.store_returns
                     :     :                 :  :              +- Relation[sr_returned_date_sk#99,sr_return_time_sk#102,sr_item_sk#103,sr_customer_sk#104,sr_cdemo_sk#105,sr_hdemo_sk#106,sr_addr_sk#107,sr_store_sk#98,sr_reason_sk#108,sr_ticket_number#109,sr_return_quantity#110,sr_return_amt#100,sr_return_tax#111,sr_return_amt_inc_tax#112,sr_fee#113,sr_return_ship_cost#114,sr_refunded_cash#115,sr_reversed_charge#116,sr_store_credit#117,sr_net_loss#101] parquet
                     :     :                 :  +- SubqueryAlias spark_catalog.default.date_dim
                     :     :                 :     +- Relation[d_date_sk#69,d_date_id#118,d_date#70,d_month_seq#119,d_week_seq#120,d_quarter_seq#121,d_year#122,d_dow#123,d_moy#124,d_dom#125,d_qoy#126,d_fy_year#127,d_fy_quarter_seq#128,d_fy_week_seq#129,d_day_name#130,d_quarter_name#131,d_holiday#132,d_weekend#133,d_following_holiday#134,d_first_dom#135,d_last_dom#136,d_same_day_ly#137,d_same_day_lq#138,d_current_day#139,... 4 more fields] parquet
                     :     :                 +- SubqueryAlias spark_catalog.default.store
                     :     :                    +- Relation[s_store_sk#72,s_store_id#67,s_rec_start_date#140,s_rec_end_date#141,s_closed_date_sk#142,s_store_name#143,s_number_employees#144,s_floor_space#145,s_hours#146,s_manager#147,s_market_id#148,s_geography_class#149,s_market_desc#150,s_market_manager#151,s_division_id#152,s_division_name#153,s_company_id#154,s_company_name#155,s_street_number#156,s_street_name#157,s_street_type#158,s_suite_number#159,s_city#160,s_county#161,... 5 more fields] parquet
                     :     +- Project [channel#55, id#56, sales#17, returns#19, profit#57]
                     :        +- Project [catalog channel AS channel#55, concat(catalog_page, cp_catalog_page_id#162) AS id#56, sales#17, returns#19, CheckOverflow((promote_precision(cast(profit#18 as decimal(18,2))) - promote_precision(cast(profit_loss#20 as decimal(18,2)))), DecimalType(18,2), true) AS profit#57]
                     :           +- SubqueryAlias csr
                     :              +- Aggregate [cp_catalog_page_id#162], [cp_catalog_page_id#162, sum(sales_price#23) AS sales#17, sum(profit#24) AS profit#18, sum(return_amt#25) AS RETURNS#19, sum(net_loss#26) AS profit_loss#20]
                     :                 +- Filter (((date_sk#22 = d_date_sk#69) AND ((d_date#70 >= cast(2000-08-23 as date)) AND (d_date#70 <= cast(2000-08-23 as date) + 14 days))) AND (page_sk#21 = cp_catalog_page_sk#163))
                     :                    +- Join Inner
                     :                       :- Join Inner
                     :                       :  :- SubqueryAlias salesreturns
                     :                       :  :  +- Union false, false
                     :                       :  :     :- Project [cs_catalog_page_sk#164 AS page_sk#21, cs_sold_date_sk#165 AS date_sk#22, cs_ext_sales_price#166 AS sales_price#23, cs_net_profit#167 AS profit#24, cast(0 as decimal(7,2)) AS return_amt#25, cast(0 as decimal(7,2)) AS net_loss#26]
                     :                       :  :     :  +- SubqueryAlias spark_catalog.default.catalog_sales
                     :                       :  :     :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#168,cs_ship_date_sk#169,cs_bill_customer_sk#170,cs_bill_cdemo_sk#171,cs_bill_hdemo_sk#172,cs_bill_addr_sk#173,cs_ship_customer_sk#174,cs_ship_cdemo_sk#175,cs_ship_hdemo_sk#176,cs_ship_addr_sk#177,cs_call_center_sk#178,cs_catalog_page_sk#164,cs_ship_mode_sk#179,cs_warehouse_sk#180,cs_item_sk#181,cs_promo_sk#182,cs_order_number#183,cs_quantity#184,cs_wholesale_cost#185,cs_list_price#186,cs_sales_price#187,cs_ext_discount_amt#188,cs_ext_sales_price#166,... 10 more fields] parquet
                     :                       :  :     +- Project [cr_catalog_page_sk#189 AS page_sk#27, cr_returned_date_sk#190 AS date_sk#28, cast(0 as decimal(7,2)) AS sales_price#29, cast(0 as decimal(7,2)) AS profit#30, cr_return_amount#191 AS return_amt#31, cr_net_loss#192 AS net_loss#32]
                     :                       :  :        +- SubqueryAlias spark_catalog.default.catalog_returns
                     :                       :  :           +- Relation[cr_returned_date_sk#190,cr_returned_time_sk#193,cr_item_sk#194,cr_refunded_customer_sk#195,cr_refunded_cdemo_sk#196,cr_refunded_hdemo_sk#197,cr_refunded_addr_sk#198,cr_returning_customer_sk#199,cr_returning_cdemo_sk#200,cr_returning_hdemo_sk#201,cr_returning_addr_sk#202,cr_call_center_sk#203,cr_catalog_page_sk#189,cr_ship_mode_sk#204,cr_warehouse_sk#205,cr_reason_sk#206,cr_order_number#207,cr_return_quantity#208,cr_return_amount#191,cr_return_tax#209,cr_return_amt_inc_tax#210,cr_fee#211,cr_return_ship_cost#212,cr_refunded_cash#213,... 3 more fields] parquet
                     :                       :  +- SubqueryAlias spark_catalog.default.date_dim
                     :                       :     +- Relation[d_date_sk#69,d_date_id#118,d_date#70,d_month_seq#119,d_week_seq#120,d_quarter_seq#121,d_year#122,d_dow#123,d_moy#124,d_dom#125,d_qoy#126,d_fy_year#127,d_fy_quarter_seq#128,d_fy_week_seq#129,d_day_name#130,d_quarter_name#131,d_holiday#132,d_weekend#133,d_following_holiday#134,d_first_dom#135,d_last_dom#136,d_same_day_ly#137,d_same_day_lq#138,d_current_day#139,... 4 more fields] parquet
                     :                       +- SubqueryAlias spark_catalog.default.catalog_page
                     :                          +- Relation[cp_catalog_page_sk#163,cp_catalog_page_id#162,cp_start_date_sk#214,cp_end_date_sk#215,cp_department#216,cp_catalog_number#217,cp_catalog_page_number#218,cp_description#219,cp_type#220] parquet
                     +- Project [channel#58, id#59, sales#33, returns#35, cast(profit#60 as decimal(18,2)) AS profit#221]
                        +- Project [web channel AS channel#58, concat(web_site, web_site_id#222) AS id#59, sales#33, returns#35, CheckOverflow((promote_precision(cast(profit#34 as decimal(18,2))) - promote_precision(cast(profit_loss#36 as decimal(18,2)))), DecimalType(18,2), true) AS profit#60]
                           +- SubqueryAlias wsr
                              +- Aggregate [web_site_id#222], [web_site_id#222, sum(sales_price#39) AS sales#33, sum(profit#40) AS profit#34, sum(return_amt#41) AS RETURNS#35, sum(net_loss#42) AS profit_loss#36]
                                 +- Filter (((date_sk#223 = cast(d_date_sk#69 as bigint)) AND ((d_date#70 >= cast(2000-08-23 as date)) AND (d_date#70 <= cast(2000-08-23 as date) + 14 days))) AND (wsr_web_site_sk#37 = web_site_sk#224))
                                    +- Join Inner
                                       :- Join Inner
                                       :  :- SubqueryAlias salesreturns
                                       :  :  +- Union false, false
                                       :  :     :- Project [wsr_web_site_sk#37, cast(date_sk#38 as bigint) AS date_sk#223, sales_price#39, profit#40, return_amt#41, net_loss#42]
                                       :  :     :  +- Project [ws_web_site_sk#225 AS wsr_web_site_sk#37, ws_sold_date_sk#226 AS date_sk#38, ws_ext_sales_price#227 AS sales_price#39, ws_net_profit#228 AS profit#40, cast(0 as decimal(7,2)) AS return_amt#41, cast(0 as decimal(7,2)) AS net_loss#42]
                                       :  :     :     +- SubqueryAlias spark_catalog.default.web_sales
                                       :  :     :        +- Relation[ws_sold_date_sk#226,ws_sold_time_sk#229,ws_ship_date_sk#230,ws_item_sk#231,ws_bill_customer_sk#232,ws_bill_cdemo_sk#233,ws_bill_hdemo_sk#234,ws_bill_addr_sk#235,ws_ship_customer_sk#236,ws_ship_cdemo_sk#237,ws_ship_hdemo_sk#238,ws_ship_addr_sk#239,ws_web_page_sk#240,ws_web_site_sk#225,ws_ship_mode_sk#241,ws_warehouse_sk#242,ws_promo_sk#243,ws_order_number#244,ws_quantity#245,ws_wholesale_cost#246,ws_list_price#247,ws_sales_price#248,ws_ext_discount_amt#249,ws_ext_sales_price#227,... 10 more fields] parquet
                                       :  :     +- Project [wsr_web_site_sk#43, date_sk#250, sales_price#45, profit#46, return_amt#47, net_loss#48]
                                       :  :        +- Project [ws_web_site_sk#225 AS wsr_web_site_sk#43, wr_returned_date_sk#251 AS date_sk#250, cast(0 as decimal(7,2)) AS sales_price#45, cast(0 as decimal(7,2)) AS profit#46, wr_return_amt#252 AS return_amt#47, wr_net_loss#253 AS net_loss#48]
                                       :  :           +- Join LeftOuter, ((wr_item_sk#254 = cast(ws_item_sk#231 as bigint)) AND (wr_order_number#255 = cast(ws_order_number#244 as bigint)))
                                       :  :              :- SubqueryAlias spark_catalog.default.web_returns
                                       :  :              :  +- Relation[wr_returned_date_sk#251,wr_returned_time_sk#256,wr_item_sk#254,wr_refunded_customer_sk#257,wr_refunded_cdemo_sk#258,wr_refunded_hdemo_sk#259,wr_refunded_addr_sk#260,wr_returning_customer_sk#261,wr_returning_cdemo_sk#262,wr_returning_hdemo_sk#263,wr_returning_addr_sk#264,wr_web_page_sk#265,wr_reason_sk#266,wr_order_number#255,wr_return_quantity#267,wr_return_amt#252,wr_return_tax#268,wr_return_amt_inc_tax#269,wr_fee#270,wr_return_ship_cost#271,wr_refunded_cash#272,wr_reversed_charge#273,wr_account_credit#274,wr_net_loss#253] parquet
                                       :  :              +- SubqueryAlias spark_catalog.default.web_sales
                                       :  :                 +- Relation[ws_sold_date_sk#226,ws_sold_time_sk#229,ws_ship_date_sk#230,ws_item_sk#231,ws_bill_customer_sk#232,ws_bill_cdemo_sk#233,ws_bill_hdemo_sk#234,ws_bill_addr_sk#235,ws_ship_customer_sk#236,ws_ship_cdemo_sk#237,ws_ship_hdemo_sk#238,ws_ship_addr_sk#239,ws_web_page_sk#240,ws_web_site_sk#225,ws_ship_mode_sk#241,ws_warehouse_sk#242,ws_promo_sk#243,ws_order_number#244,ws_quantity#245,ws_wholesale_cost#246,ws_list_price#247,ws_sales_price#248,ws_ext_discount_amt#249,ws_ext_sales_price#227,... 10 more fields] parquet
                                       :  +- SubqueryAlias spark_catalog.default.date_dim
                                       :     +- Relation[d_date_sk#69,d_date_id#118,d_date#70,d_month_seq#119,d_week_seq#120,d_quarter_seq#121,d_year#122,d_dow#123,d_moy#124,d_dom#125,d_qoy#126,d_fy_year#127,d_fy_quarter_seq#128,d_fy_week_seq#129,d_day_name#130,d_quarter_name#131,d_holiday#132,d_weekend#133,d_following_holiday#134,d_first_dom#135,d_last_dom#136,d_same_day_ly#137,d_same_day_lq#138,d_current_day#139,... 4 more fields] parquet
                                       +- SubqueryAlias spark_catalog.default.web_site
                                          +- Relation[web_site_sk#224,web_site_id#222,web_rec_start_date#275,web_rec_end_date#276,web_name#277,web_open_date_sk#278,web_close_date_sk#279,web_class#280,web_manager#281,web_mkt_id#282,web_mkt_class#283,web_mkt_desc#284,web_market_manager#285,web_company_id#286,web_company_name#287,web_street_number#288,web_street_name#289,web_street_type#290,web_suite_number#291,web_city#292,web_county#293,web_state#294,web_zip#295,web_country#296,... 2 more fields] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#61 ASC NULLS FIRST, id#62 ASC NULLS FIRST], true
      +- Aggregate [channel#61, id#62, spark_grouping_id#63], [channel#61, id#62, sum(sales#1) AS sales#49, sum(returns#3) AS returns#50, sum(profit#64) AS profit#51]
         +- Expand [List(sales#1, returns#3, profit#64, channel#52, id#53, 0), List(sales#1, returns#3, profit#64, channel#52, null, 1), List(sales#1, returns#3, profit#64, null, null, 3)], [sales#1, returns#3, profit#64, channel#61, id#62, spark_grouping_id#63]
            +- Union false, false
               :- Aggregate [s_store_id#67], [MakeDecimal(sum(UnscaledValue(sales_price#7)),17,2) AS sales#1, MakeDecimal(sum(UnscaledValue(return_amt#9)),17,2) AS RETURNS#3, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#8)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#10)),17,2) as decimal(18,2)))), DecimalType(18,2), true) AS profit#64, store channel AS channel#52, concat(store, s_store_id#67) AS id#53]
               :  +- Project [sales_price#7, profit#8, return_amt#9, net_loss#10, s_store_id#67]
               :     +- Join Inner, (store_sk#71 = cast(s_store_sk#72 as bigint))
               :        :- Project [store_sk#71, sales_price#7, profit#8, return_amt#9, net_loss#10]
               :        :  +- Join Inner, (date_sk#68 = cast(d_date_sk#69 as bigint))
               :        :     :- Union false, false
               :        :     :  :- Project [cast(ss_store_sk#73 as bigint) AS store_sk#71, cast(ss_sold_date_sk#74 as bigint) AS date_sk#68, ss_ext_sales_price#75 AS sales_price#7, ss_net_profit#76 AS profit#8, 0.00 AS return_amt#9, 0.00 AS net_loss#10]
               :        :     :  :  +- Filter (isnotnull(cast(ss_sold_date_sk#74 as bigint)) AND isnotnull(cast(ss_store_sk#73 as bigint)))
               :        :     :  :     +- Relation[ss_sold_date_sk#74,ss_sold_time_sk#77,ss_item_sk#78,ss_customer_sk#79,ss_cdemo_sk#80,ss_hdemo_sk#81,ss_addr_sk#82,ss_store_sk#73,ss_promo_sk#83,ss_ticket_number#84,ss_quantity#85,ss_wholesale_cost#86,ss_list_price#87,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#75,ss_ext_wholesale_cost#90,ss_ext_list_price#91,ss_ext_tax#92,ss_coupon_amt#93,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#76] parquet
               :        :     :  +- Project [sr_store_sk#98 AS store_sk#96, sr_returned_date_sk#99 AS date_sk#97, 0.00 AS sales_price#13, 0.00 AS profit#14, sr_return_amt#100 AS return_amt#15, sr_net_loss#101 AS net_loss#16]
               :        :     :     +- Filter (isnotnull(sr_returned_date_sk#99) AND isnotnull(sr_store_sk#98))
               :        :     :        +- Relation[sr_returned_date_sk#99,sr_return_time_sk#102,sr_item_sk#103,sr_customer_sk#104,sr_cdemo_sk#105,sr_hdemo_sk#106,sr_addr_sk#107,sr_store_sk#98,sr_reason_sk#108,sr_ticket_number#109,sr_return_quantity#110,sr_return_amt#100,sr_return_tax#111,sr_return_amt_inc_tax#112,sr_fee#113,sr_return_ship_cost#114,sr_refunded_cash#115,sr_reversed_charge#116,sr_store_credit#117,sr_net_loss#101] parquet
               :        :     +- Project [d_date_sk#69]
               :        :        +- Filter (((isnotnull(d_date#70) AND (d_date#70 >= 11192)) AND (d_date#70 <= 11206)) AND isnotnull(d_date_sk#69))
               :        :           +- Relation[d_date_sk#69,d_date_id#118,d_date#70,d_month_seq#119,d_week_seq#120,d_quarter_seq#121,d_year#122,d_dow#123,d_moy#124,d_dom#125,d_qoy#126,d_fy_year#127,d_fy_quarter_seq#128,d_fy_week_seq#129,d_day_name#130,d_quarter_name#131,d_holiday#132,d_weekend#133,d_following_holiday#134,d_first_dom#135,d_last_dom#136,d_same_day_ly#137,d_same_day_lq#138,d_current_day#139,... 4 more fields] parquet
               :        +- Project [s_store_sk#72, s_store_id#67]
               :           +- Filter isnotnull(s_store_sk#72)
               :              +- Relation[s_store_sk#72,s_store_id#67,s_rec_start_date#140,s_rec_end_date#141,s_closed_date_sk#142,s_store_name#143,s_number_employees#144,s_floor_space#145,s_hours#146,s_manager#147,s_market_id#148,s_geography_class#149,s_market_desc#150,s_market_manager#151,s_division_id#152,s_division_name#153,s_company_id#154,s_company_name#155,s_street_number#156,s_street_name#157,s_street_type#158,s_suite_number#159,s_city#160,s_county#161,... 5 more fields] parquet
               :- Aggregate [cp_catalog_page_id#162], [MakeDecimal(sum(UnscaledValue(sales_price#23)),17,2) AS sales#17, MakeDecimal(sum(UnscaledValue(return_amt#25)),17,2) AS RETURNS#19, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#24)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#26)),17,2) as decimal(18,2)))), DecimalType(18,2), true) AS profit#57, catalog channel AS channel#55, concat(catalog_page, cp_catalog_page_id#162) AS id#56]
               :  +- Project [sales_price#23, profit#24, return_amt#25, net_loss#26, cp_catalog_page_id#162]
               :     +- Join Inner, (page_sk#21 = cp_catalog_page_sk#163)
               :        :- Project [page_sk#21, sales_price#23, profit#24, return_amt#25, net_loss#26]
               :        :  +- Join Inner, (date_sk#22 = d_date_sk#69)
               :        :     :- Union false, false
               :        :     :  :- Project [cs_catalog_page_sk#164 AS page_sk#21, cs_sold_date_sk#165 AS date_sk#22, cs_ext_sales_price#166 AS sales_price#23, cs_net_profit#167 AS profit#24, 0.00 AS return_amt#25, 0.00 AS net_loss#26]
               :        :     :  :  +- Filter (isnotnull(cs_sold_date_sk#165) AND isnotnull(cs_catalog_page_sk#164))
               :        :     :  :     +- Relation[cs_sold_date_sk#165,cs_sold_time_sk#168,cs_ship_date_sk#169,cs_bill_customer_sk#170,cs_bill_cdemo_sk#171,cs_bill_hdemo_sk#172,cs_bill_addr_sk#173,cs_ship_customer_sk#174,cs_ship_cdemo_sk#175,cs_ship_hdemo_sk#176,cs_ship_addr_sk#177,cs_call_center_sk#178,cs_catalog_page_sk#164,cs_ship_mode_sk#179,cs_warehouse_sk#180,cs_item_sk#181,cs_promo_sk#182,cs_order_number#183,cs_quantity#184,cs_wholesale_cost#185,cs_list_price#186,cs_sales_price#187,cs_ext_discount_amt#188,cs_ext_sales_price#166,... 10 more fields] parquet
               :        :     :  +- Project [cr_catalog_page_sk#189 AS page_sk#27, cr_returned_date_sk#190 AS date_sk#28, 0.00 AS sales_price#29, 0.00 AS profit#30, cr_return_amount#191 AS return_amt#31, cr_net_loss#192 AS net_loss#32]
               :        :     :     +- Filter (isnotnull(cr_returned_date_sk#190) AND isnotnull(cr_catalog_page_sk#189))
               :        :     :        +- Relation[cr_returned_date_sk#190,cr_returned_time_sk#193,cr_item_sk#194,cr_refunded_customer_sk#195,cr_refunded_cdemo_sk#196,cr_refunded_hdemo_sk#197,cr_refunded_addr_sk#198,cr_returning_customer_sk#199,cr_returning_cdemo_sk#200,cr_returning_hdemo_sk#201,cr_returning_addr_sk#202,cr_call_center_sk#203,cr_catalog_page_sk#189,cr_ship_mode_sk#204,cr_warehouse_sk#205,cr_reason_sk#206,cr_order_number#207,cr_return_quantity#208,cr_return_amount#191,cr_return_tax#209,cr_return_amt_inc_tax#210,cr_fee#211,cr_return_ship_cost#212,cr_refunded_cash#213,... 3 more fields] parquet
               :        :     +- Project [d_date_sk#69]
               :        :        +- Filter (((isnotnull(d_date#70) AND (d_date#70 >= 11192)) AND (d_date#70 <= 11206)) AND isnotnull(d_date_sk#69))
               :        :           +- Relation[d_date_sk#69,d_date_id#118,d_date#70,d_month_seq#119,d_week_seq#120,d_quarter_seq#121,d_year#122,d_dow#123,d_moy#124,d_dom#125,d_qoy#126,d_fy_year#127,d_fy_quarter_seq#128,d_fy_week_seq#129,d_day_name#130,d_quarter_name#131,d_holiday#132,d_weekend#133,d_following_holiday#134,d_first_dom#135,d_last_dom#136,d_same_day_ly#137,d_same_day_lq#138,d_current_day#139,... 4 more fields] parquet
               :        +- Project [cp_catalog_page_sk#163, cp_catalog_page_id#162]
               :           +- Filter isnotnull(cp_catalog_page_sk#163)
               :              +- Relation[cp_catalog_page_sk#163,cp_catalog_page_id#162,cp_start_date_sk#214,cp_end_date_sk#215,cp_department#216,cp_catalog_number#217,cp_catalog_page_number#218,cp_description#219,cp_type#220] parquet
               +- Aggregate [web_site_id#222], [MakeDecimal(sum(UnscaledValue(sales_price#39)),17,2) AS sales#33, MakeDecimal(sum(UnscaledValue(return_amt#41)),17,2) AS RETURNS#35, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#40)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#42)),17,2) as decimal(18,2)))), DecimalType(18,2), true) AS profit#221, web channel AS channel#297, concat(web_site, web_site_id#222) AS id#298]
                  +- Project [sales_price#39, profit#40, return_amt#41, net_loss#42, web_site_id#222]
                     +- Join Inner, (wsr_web_site_sk#37 = web_site_sk#224)
                        :- Project [wsr_web_site_sk#37, sales_price#39, profit#40, return_amt#41, net_loss#42]
                        :  +- Join Inner, (date_sk#223 = cast(d_date_sk#69 as bigint))
                        :     :- Union false, false
                        :     :  :- Project [ws_web_site_sk#225 AS wsr_web_site_sk#37, cast(ws_sold_date_sk#226 as bigint) AS date_sk#223, ws_ext_sales_price#227 AS sales_price#39, ws_net_profit#228 AS profit#40, 0.00 AS return_amt#41, 0.00 AS net_loss#42]
                        :     :  :  +- Filter (isnotnull(cast(ws_sold_date_sk#226 as bigint)) AND isnotnull(ws_web_site_sk#225))
                        :     :  :     +- Relation[ws_sold_date_sk#226,ws_sold_time_sk#229,ws_ship_date_sk#230,ws_item_sk#231,ws_bill_customer_sk#232,ws_bill_cdemo_sk#233,ws_bill_hdemo_sk#234,ws_bill_addr_sk#235,ws_ship_customer_sk#236,ws_ship_cdemo_sk#237,ws_ship_hdemo_sk#238,ws_ship_addr_sk#239,ws_web_page_sk#240,ws_web_site_sk#225,ws_ship_mode_sk#241,ws_warehouse_sk#242,ws_promo_sk#243,ws_order_number#244,ws_quantity#245,ws_wholesale_cost#246,ws_list_price#247,ws_sales_price#248,ws_ext_discount_amt#249,ws_ext_sales_price#227,... 10 more fields] parquet
                        :     :  +- Project [ws_web_site_sk#225 AS wsr_web_site_sk#43, wr_returned_date_sk#251 AS date_sk#250, 0.00 AS sales_price#45, 0.00 AS profit#46, wr_return_amt#252 AS return_amt#47, wr_net_loss#253 AS net_loss#48]
                        :     :     +- Join Inner, ((wr_item_sk#254 = cast(ws_item_sk#231 as bigint)) AND (wr_order_number#255 = cast(ws_order_number#244 as bigint)))
                        :     :        :- Project [wr_returned_date_sk#251, wr_item_sk#254, wr_order_number#255, wr_return_amt#252, wr_net_loss#253]
                        :     :        :  +- Filter isnotnull(wr_returned_date_sk#251)
                        :     :        :     +- Relation[wr_returned_date_sk#251,wr_returned_time_sk#256,wr_item_sk#254,wr_refunded_customer_sk#257,wr_refunded_cdemo_sk#258,wr_refunded_hdemo_sk#259,wr_refunded_addr_sk#260,wr_returning_customer_sk#261,wr_returning_cdemo_sk#262,wr_returning_hdemo_sk#263,wr_returning_addr_sk#264,wr_web_page_sk#265,wr_reason_sk#266,wr_order_number#255,wr_return_quantity#267,wr_return_amt#252,wr_return_tax#268,wr_return_amt_inc_tax#269,wr_fee#270,wr_return_ship_cost#271,wr_refunded_cash#272,wr_reversed_charge#273,wr_account_credit#274,wr_net_loss#253] parquet
                        :     :        +- Project [ws_item_sk#231, ws_web_site_sk#225, ws_order_number#244]
                        :     :           +- Filter ((isnotnull(ws_item_sk#231) AND isnotnull(ws_order_number#244)) AND isnotnull(ws_web_site_sk#225))
                        :     :              +- Relation[ws_sold_date_sk#226,ws_sold_time_sk#229,ws_ship_date_sk#230,ws_item_sk#231,ws_bill_customer_sk#232,ws_bill_cdemo_sk#233,ws_bill_hdemo_sk#234,ws_bill_addr_sk#235,ws_ship_customer_sk#236,ws_ship_cdemo_sk#237,ws_ship_hdemo_sk#238,ws_ship_addr_sk#239,ws_web_page_sk#240,ws_web_site_sk#225,ws_ship_mode_sk#241,ws_warehouse_sk#242,ws_promo_sk#243,ws_order_number#244,ws_quantity#245,ws_wholesale_cost#246,ws_list_price#247,ws_sales_price#248,ws_ext_discount_amt#249,ws_ext_sales_price#227,... 10 more fields] parquet
                        :     +- Project [d_date_sk#69]
                        :        +- Filter (((isnotnull(d_date#70) AND (d_date#70 >= 11192)) AND (d_date#70 <= 11206)) AND isnotnull(d_date_sk#69))
                        :           +- Relation[d_date_sk#69,d_date_id#118,d_date#70,d_month_seq#119,d_week_seq#120,d_quarter_seq#121,d_year#122,d_dow#123,d_moy#124,d_dom#125,d_qoy#126,d_fy_year#127,d_fy_quarter_seq#128,d_fy_week_seq#129,d_day_name#130,d_quarter_name#131,d_holiday#132,d_weekend#133,d_following_holiday#134,d_first_dom#135,d_last_dom#136,d_same_day_ly#137,d_same_day_lq#138,d_current_day#139,... 4 more fields] parquet
                        +- Project [web_site_sk#224, web_site_id#222]
                           +- Filter isnotnull(web_site_sk#224)
                              +- Relation[web_site_sk#224,web_site_id#222,web_rec_start_date#275,web_rec_end_date#276,web_name#277,web_open_date_sk#278,web_close_date_sk#279,web_class#280,web_manager#281,web_mkt_id#282,web_mkt_class#283,web_mkt_desc#284,web_market_manager#285,web_company_id#286,web_company_name#287,web_street_number#288,web_street_name#289,web_street_type#290,web_suite_number#291,web_city#292,web_county#293,web_state#294,web_zip#295,web_country#296,... 2 more fields] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[channel#61 ASC NULLS FIRST,id#62 ASC NULLS FIRST], output=[channel#61,id#62,sales#49,returns#50,profit#51])
+- *(24) HashAggregate(keys=[channel#61, id#62, spark_grouping_id#63], functions=[sum(sales#1), sum(returns#3), sum(profit#64)], output=[channel#61, id#62, sales#49, returns#50, profit#51])
   +- Exchange hashpartitioning(channel#61, id#62, spark_grouping_id#63, 5), true, [id=#299]
      +- *(23) HashAggregate(keys=[channel#61, id#62, spark_grouping_id#63], functions=[partial_sum(sales#1), partial_sum(returns#3), partial_sum(profit#64)], output=[channel#61, id#62, spark_grouping_id#63, sum#300, isEmpty#301, sum#302, isEmpty#303, sum#304, isEmpty#305])
         +- *(23) Expand [List(sales#1, returns#3, profit#64, channel#52, id#53, 0), List(sales#1, returns#3, profit#64, channel#52, null, 1), List(sales#1, returns#3, profit#64, null, null, 3)], [sales#1, returns#3, profit#64, channel#61, id#62, spark_grouping_id#63]
            +- Union
               :- *(6) HashAggregate(keys=[s_store_id#67], functions=[sum(UnscaledValue(sales_price#7)), sum(UnscaledValue(return_amt#9)), sum(UnscaledValue(profit#8)), sum(UnscaledValue(net_loss#10))], output=[sales#1, RETURNS#3, profit#64, channel#52, id#53])
               :  +- Exchange hashpartitioning(s_store_id#67, 5), true, [id=#306]
               :     +- *(5) HashAggregate(keys=[s_store_id#67], functions=[partial_sum(UnscaledValue(sales_price#7)), partial_sum(UnscaledValue(return_amt#9)), partial_sum(UnscaledValue(profit#8)), partial_sum(UnscaledValue(net_loss#10))], output=[s_store_id#67, sum#307, sum#308, sum#309, sum#310])
               :        +- *(5) Project [sales_price#7, profit#8, return_amt#9, net_loss#10, s_store_id#67]
               :           +- *(5) BroadcastHashJoin [store_sk#71], [cast(s_store_sk#72 as bigint)], Inner, BuildRight, false
               :              :- *(5) Project [store_sk#71, sales_price#7, profit#8, return_amt#9, net_loss#10]
               :              :  +- *(5) BroadcastHashJoin [date_sk#68], [cast(d_date_sk#69 as bigint)], Inner, BuildRight, false
               :              :     :- Union
               :              :     :  :- *(1) Project [cast(ss_store_sk#73 as bigint) AS store_sk#71, cast(ss_sold_date_sk#74 as bigint) AS date_sk#68, ss_ext_sales_price#75 AS sales_price#7, ss_net_profit#76 AS profit#8, 0.00 AS return_amt#9, 0.00 AS net_loss#10]
               :              :     :  :  +- *(1) Filter (isnotnull(cast(ss_sold_date_sk#74 as bigint)) AND isnotnull(cast(ss_store_sk#73 as bigint)))
               :              :     :  :     +- *(1) ColumnarToRow
               :              :     :  :        +- FileScan parquet default.store_sales[ss_sold_date_sk#74,ss_store_sk#73,ss_ext_sales_price#75,ss_net_profit#76] Batched: true, DataFilters: [isnotnull(cast(ss_sold_date_sk#74 as bigint)), isnotnull(cast(ss_store_sk#73 as bigint))], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(...
               :              :     :  +- *(2) Project [sr_store_sk#98 AS store_sk#96, sr_returned_date_sk#99 AS date_sk#97, 0.00 AS sales_price#13, 0.00 AS profit#14, sr_return_amt#100 AS return_amt#15, sr_net_loss#101 AS net_loss#16]
               :              :     :     +- *(2) Filter (isnotnull(sr_returned_date_sk#99) AND isnotnull(sr_store_sk#98))
               :              :     :        +- *(2) ColumnarToRow
               :              :     :           +- FileScan parquet default.store_returns[sr_returned_date_sk#99,sr_store_sk#98,sr_return_amt#100,sr_net_loss#101] Batched: true, DataFilters: [isnotnull(sr_returned_date_sk#99), isnotnull(sr_store_sk#98)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(sr_returned_date_sk), IsNotNull(sr_store_sk)], ReadSchema: struct<sr_returned_date_sk:bigint,sr_store_sk:bigint,sr_return_amt:decimal(7,2),sr_net_loss:decim...
               :              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#311]
               :              :        +- *(3) Project [d_date_sk#69]
               :              :           +- *(3) Filter (((isnotnull(d_date#70) AND (d_date#70 >= 11192)) AND (d_date#70 <= 11206)) AND isnotnull(d_date_sk#69))
               :              :              +- *(3) ColumnarToRow
               :              :                 +- FileScan parquet default.date_dim[d_date_sk#69,d_date#70] Batched: true, DataFilters: [isnotnull(d_date#70), (d_date#70 >= 11192), (d_date#70 <= 11206), isnotnull(d_date_sk#69)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-23), LessThanOrEqual(d_date,2000-09-06), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
               :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#312]
               :                 +- *(4) Project [s_store_sk#72, s_store_id#67]
               :                    +- *(4) Filter isnotnull(s_store_sk#72)
               :                       +- *(4) ColumnarToRow
               :                          +- FileScan parquet default.store[s_store_sk#72,s_store_id#67] Batched: true, DataFilters: [isnotnull(s_store_sk#72)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
               :- *(12) HashAggregate(keys=[cp_catalog_page_id#162], functions=[sum(UnscaledValue(sales_price#23)), sum(UnscaledValue(return_amt#25)), sum(UnscaledValue(profit#24)), sum(UnscaledValue(net_loss#26))], output=[sales#17, RETURNS#19, profit#57, channel#55, id#56])
               :  +- Exchange hashpartitioning(cp_catalog_page_id#162, 5), true, [id=#313]
               :     +- *(11) HashAggregate(keys=[cp_catalog_page_id#162], functions=[partial_sum(UnscaledValue(sales_price#23)), partial_sum(UnscaledValue(return_amt#25)), partial_sum(UnscaledValue(profit#24)), partial_sum(UnscaledValue(net_loss#26))], output=[cp_catalog_page_id#162, sum#314, sum#315, sum#316, sum#317])
               :        +- *(11) Project [sales_price#23, profit#24, return_amt#25, net_loss#26, cp_catalog_page_id#162]
               :           +- *(11) BroadcastHashJoin [page_sk#21], [cp_catalog_page_sk#163], Inner, BuildRight, false
               :              :- *(11) Project [page_sk#21, sales_price#23, profit#24, return_amt#25, net_loss#26]
               :              :  +- *(11) BroadcastHashJoin [date_sk#22], [d_date_sk#69], Inner, BuildRight, false
               :              :     :- Union
               :              :     :  :- *(7) Project [cs_catalog_page_sk#164 AS page_sk#21, cs_sold_date_sk#165 AS date_sk#22, cs_ext_sales_price#166 AS sales_price#23, cs_net_profit#167 AS profit#24, 0.00 AS return_amt#25, 0.00 AS net_loss#26]
               :              :     :  :  +- *(7) Filter (isnotnull(cs_sold_date_sk#165) AND isnotnull(cs_catalog_page_sk#164))
               :              :     :  :     +- *(7) ColumnarToRow
               :              :     :  :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#165,cs_catalog_page_sk#164,cs_ext_sales_price#166,cs_net_profit#167] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#165), isnotnull(cs_catalog_page_sk#164)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_catalog_page_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_catalog_page_sk:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:d...
               :              :     :  +- *(8) Project [cr_catalog_page_sk#189 AS page_sk#27, cr_returned_date_sk#190 AS date_sk#28, 0.00 AS sales_price#29, 0.00 AS profit#30, cr_return_amount#191 AS return_amt#31, cr_net_loss#192 AS net_loss#32]
               :              :     :     +- *(8) Filter (isnotnull(cr_returned_date_sk#190) AND isnotnull(cr_catalog_page_sk#189))
               :              :     :        +- *(8) ColumnarToRow
               :              :     :           +- FileScan parquet default.catalog_returns[cr_returned_date_sk#190,cr_catalog_page_sk#189,cr_return_amount#191,cr_net_loss#192] Batched: true, DataFilters: [isnotnull(cr_returned_date_sk#190), isnotnull(cr_catalog_page_sk#189)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cr_returned_date_sk), IsNotNull(cr_catalog_page_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_catalog_page_sk:int,cr_return_amount:decimal(7,2),cr_net_loss:d...
               :              :     +- ReusedExchange [d_date_sk#69], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#311]
               :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#318]
               :                 +- *(10) Project [cp_catalog_page_sk#163, cp_catalog_page_id#162]
               :                    +- *(10) Filter isnotnull(cp_catalog_page_sk#163)
               :                       +- *(10) ColumnarToRow
               :                          +- FileScan parquet default.catalog_page[cp_catalog_page_sk#163,cp_catalog_page_id#162] Batched: true, DataFilters: [isnotnull(cp_catalog_page_sk#163)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cp_catalog_page_sk)], ReadSchema: struct<cp_catalog_page_sk:int,cp_catalog_page_id:string>
               +- *(22) HashAggregate(keys=[web_site_id#222], functions=[sum(UnscaledValue(sales_price#39)), sum(UnscaledValue(return_amt#41)), sum(UnscaledValue(profit#40)), sum(UnscaledValue(net_loss#42))], output=[sales#33, RETURNS#35, profit#221, channel#297, id#298])
                  +- Exchange hashpartitioning(web_site_id#222, 5), true, [id=#319]
                     +- *(21) HashAggregate(keys=[web_site_id#222], functions=[partial_sum(UnscaledValue(sales_price#39)), partial_sum(UnscaledValue(return_amt#41)), partial_sum(UnscaledValue(profit#40)), partial_sum(UnscaledValue(net_loss#42))], output=[web_site_id#222, sum#320, sum#321, sum#322, sum#323])
                        +- *(21) Project [sales_price#39, profit#40, return_amt#41, net_loss#42, web_site_id#222]
                           +- *(21) BroadcastHashJoin [wsr_web_site_sk#37], [web_site_sk#224], Inner, BuildRight, false
                              :- *(21) Project [wsr_web_site_sk#37, sales_price#39, profit#40, return_amt#41, net_loss#42]
                              :  +- *(21) BroadcastHashJoin [date_sk#223], [cast(d_date_sk#69 as bigint)], Inner, BuildRight, false
                              :     :- Union
                              :     :  :- *(13) Project [ws_web_site_sk#225 AS wsr_web_site_sk#37, cast(ws_sold_date_sk#226 as bigint) AS date_sk#223, ws_ext_sales_price#227 AS sales_price#39, ws_net_profit#228 AS profit#40, 0.00 AS return_amt#41, 0.00 AS net_loss#42]
                              :     :  :  +- *(13) Filter (isnotnull(cast(ws_sold_date_sk#226 as bigint)) AND isnotnull(ws_web_site_sk#225))
                              :     :  :     +- *(13) ColumnarToRow
                              :     :  :        +- FileScan parquet default.web_sales[ws_sold_date_sk#226,ws_web_site_sk#225,ws_ext_sales_price#227,ws_net_profit#228] Batched: true, DataFilters: [isnotnull(cast(ws_sold_date_sk#226 as bigint)), isnotnull(ws_web_site_sk#225)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_web_site_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_web_site_sk:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decim...
                              :     :  +- *(18) Project [ws_web_site_sk#225 AS wsr_web_site_sk#43, wr_returned_date_sk#251 AS date_sk#250, 0.00 AS sales_price#45, 0.00 AS profit#46, wr_return_amt#252 AS return_amt#47, wr_net_loss#253 AS net_loss#48]
                              :     :     +- *(18) SortMergeJoin [wr_item_sk#254, wr_order_number#255], [cast(ws_item_sk#231 as bigint), cast(ws_order_number#244 as bigint)], Inner
                              :     :        :- *(15) Sort [wr_item_sk#254 ASC NULLS FIRST, wr_order_number#255 ASC NULLS FIRST], false, 0
                              :     :        :  +- Exchange hashpartitioning(wr_item_sk#254, wr_order_number#255, 5), true, [id=#324]
                              :     :        :     +- *(14) Project [wr_returned_date_sk#251, wr_item_sk#254, wr_order_number#255, wr_return_amt#252, wr_net_loss#253]
                              :     :        :        +- *(14) Filter isnotnull(wr_returned_date_sk#251)
                              :     :        :           +- *(14) ColumnarToRow
                              :     :        :              +- FileScan parquet default.web_returns[wr_returned_date_sk#251,wr_item_sk#254,wr_order_number#255,wr_return_amt#252,wr_net_loss#253] Batched: true, DataFilters: [isnotnull(wr_returned_date_sk#251)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(wr_returned_date_sk)], ReadSchema: struct<wr_returned_date_sk:bigint,wr_item_sk:bigint,wr_order_number:bigint,wr_return_amt:decimal(...
                              :     :        +- *(17) Sort [cast(ws_item_sk#231 as bigint) ASC NULLS FIRST, cast(ws_order_number#244 as bigint) ASC NULLS FIRST], false, 0
                              :     :           +- Exchange hashpartitioning(cast(ws_item_sk#231 as bigint), cast(ws_order_number#244 as bigint), 5), true, [id=#325]
                              :     :              +- *(16) Project [ws_item_sk#231, ws_web_site_sk#225, ws_order_number#244]
                              :     :                 +- *(16) Filter ((isnotnull(ws_item_sk#231) AND isnotnull(ws_order_number#244)) AND isnotnull(ws_web_site_sk#225))
                              :     :                    +- *(16) ColumnarToRow
                              :     :                       +- FileScan parquet default.web_sales[ws_item_sk#231,ws_web_site_sk#225,ws_order_number#244] Batched: true, DataFilters: [isnotnull(ws_item_sk#231), isnotnull(ws_order_number#244), isnotnull(ws_web_site_sk#225)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_order_number), IsNotNull(ws_web_site_sk)], ReadSchema: struct<ws_item_sk:int,ws_web_site_sk:int,ws_order_number:int>
                              :     +- ReusedExchange [d_date_sk#69], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#311]
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#326]
                                 +- *(20) Project [web_site_sk#224, web_site_id#222]
                                    +- *(20) Filter isnotnull(web_site_sk#224)
                                       +- *(20) ColumnarToRow
                                          +- FileScan parquet default.web_site[web_site_sk#224,web_site_id#222] Batched: true, DataFilters: [isnotnull(web_site_sk#224)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(web_site_sk)], ReadSchema: struct<web_site_sk:int,web_site_id:string>
