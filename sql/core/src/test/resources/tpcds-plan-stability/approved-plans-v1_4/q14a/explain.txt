== Parsed Logical Plan ==
CTE [cross_items, avg_sales]
:  :- 'SubqueryAlias cross_items
:  :  +- 'Project ['i_item_sk AS ss_item_sk#1]
:  :     +- 'Filter ((('i_brand_id = 'brand_id) AND ('i_class_id = 'class_id)) AND ('i_category_id = 'category_id))
:  :        +- 'Join Inner
:  :           :- 'UnresolvedRelation [item]
:  :           +- 'SubqueryAlias x
:  :              +- 'Intersect false
:  :                 :- 'Intersect false
:  :                 :  :- 'Project ['iss.i_brand_id AS brand_id#2, 'iss.i_class_id AS class_id#3, 'iss.i_category_id AS category_id#4]
:  :                 :  :  +- 'Filter ((('ss_item_sk = 'iss.i_item_sk) AND ('ss_sold_date_sk = 'd1.d_date_sk)) AND (('d1.d_year >= 1999) AND ('d1.d_year <= (1999 + 2))))
:  :                 :  :     +- 'Join Inner
:  :                 :  :        :- 'Join Inner
:  :                 :  :        :  :- 'UnresolvedRelation [store_sales]
:  :                 :  :        :  +- 'SubqueryAlias iss
:  :                 :  :        :     +- 'UnresolvedRelation [item]
:  :                 :  :        +- 'SubqueryAlias d1
:  :                 :  :           +- 'UnresolvedRelation [date_dim]
:  :                 :  +- 'Project ['ics.i_brand_id, 'ics.i_class_id, 'ics.i_category_id]
:  :                 :     +- 'Filter ((('cs_item_sk = 'ics.i_item_sk) AND ('cs_sold_date_sk = 'd2.d_date_sk)) AND (('d2.d_year >= 1999) AND ('d2.d_year <= (1999 + 2))))
:  :                 :        +- 'Join Inner
:  :                 :           :- 'Join Inner
:  :                 :           :  :- 'UnresolvedRelation [catalog_sales]
:  :                 :           :  +- 'SubqueryAlias ics
:  :                 :           :     +- 'UnresolvedRelation [item]
:  :                 :           +- 'SubqueryAlias d2
:  :                 :              +- 'UnresolvedRelation [date_dim]
:  :                 +- 'Project ['iws.i_brand_id, 'iws.i_class_id, 'iws.i_category_id]
:  :                    +- 'Filter ((('ws_item_sk = 'iws.i_item_sk) AND ('ws_sold_date_sk = 'd3.d_date_sk)) AND (('d3.d_year >= 1999) AND ('d3.d_year <= (1999 + 2))))
:  :                       +- 'Join Inner
:  :                          :- 'Join Inner
:  :                          :  :- 'UnresolvedRelation [web_sales]
:  :                          :  +- 'SubqueryAlias iws
:  :                          :     +- 'UnresolvedRelation [item]
:  :                          +- 'SubqueryAlias d3
:  :                             +- 'UnresolvedRelation [date_dim]
:  +- 'SubqueryAlias avg_sales
:     +- 'Project ['avg(('quantity * 'list_price)) AS average_sales#5]
:        +- 'SubqueryAlias x
:           +- 'Union false, false
:              :- 'Union false, false
:              :  :- 'Project ['ss_quantity AS quantity#6, 'ss_list_price AS list_price#7]
:              :  :  +- 'Filter (('ss_sold_date_sk = 'd_date_sk) AND (('d_year >= 1999) AND ('d_year <= 2001)))
:              :  :     +- 'Join Inner
:              :  :        :- 'UnresolvedRelation [store_sales]
:              :  :        +- 'UnresolvedRelation [date_dim]
:              :  +- 'Project ['cs_quantity AS quantity#8, 'cs_list_price AS list_price#9]
:              :     +- 'Filter (('cs_sold_date_sk = 'd_date_sk) AND (('d_year >= 1999) AND ('d_year <= (1999 + 2))))
:              :        +- 'Join Inner
:              :           :- 'UnresolvedRelation [catalog_sales]
:              :           +- 'UnresolvedRelation [date_dim]
:              +- 'Project ['ws_quantity AS quantity#10, 'ws_list_price AS list_price#11]
:                 +- 'Filter (('ws_sold_date_sk = 'd_date_sk) AND (('d_year >= 1999) AND ('d_year <= (1999 + 2))))
:                    +- 'Join Inner
:                       :- 'UnresolvedRelation [web_sales]
:                       +- 'UnresolvedRelation [date_dim]
+- 'GlobalLimit 100
   +- 'LocalLimit 100
      +- 'Sort ['channel ASC NULLS FIRST, 'i_brand_id ASC NULLS FIRST, 'i_class_id ASC NULLS FIRST, 'i_category_id ASC NULLS FIRST], true
         +- 'Aggregate ['ROLLUP('channel, 'i_brand_id, 'i_class_id, 'i_category_id)], ['channel, 'i_brand_id, 'i_class_id, 'i_category_id, unresolvedalias('sum('sales), None), unresolvedalias('sum('number_sales), None)]
            +- 'SubqueryAlias y
               +- 'Union false, false
                  :- 'Union false, false
                  :  :- 'UnresolvedHaving ('sum(('ss_quantity * 'ss_list_price)) > scalar-subquery#12 [])
                  :  :  :  +- 'Project ['average_sales]
                  :  :  :     +- 'UnresolvedRelation [avg_sales]
                  :  :  +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [store AS channel#13, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('ss_quantity * 'ss_list_price)) AS sales#14, 'count(1) AS number_sales#15]
                  :  :     +- 'Filter ((('ss_item_sk IN (list#16 []) AND ('ss_item_sk = 'i_item_sk)) AND ('ss_sold_date_sk = 'd_date_sk)) AND (('d_year = (1999 + 2)) AND ('d_moy = 11)))
                  :  :        :  +- 'Project ['ss_item_sk]
                  :  :        :     +- 'UnresolvedRelation [cross_items]
                  :  :        +- 'Join Inner
                  :  :           :- 'Join Inner
                  :  :           :  :- 'UnresolvedRelation [store_sales]
                  :  :           :  +- 'UnresolvedRelation [item]
                  :  :           +- 'UnresolvedRelation [date_dim]
                  :  +- 'UnresolvedHaving ('sum(('cs_quantity * 'cs_list_price)) > scalar-subquery#17 [])
                  :     :  +- 'Project ['average_sales]
                  :     :     +- 'UnresolvedRelation [avg_sales]
                  :     +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [catalog AS channel#18, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('cs_quantity * 'cs_list_price)) AS sales#19, 'count(1) AS number_sales#20]
                  :        +- 'Filter ((('cs_item_sk IN (list#21 []) AND ('cs_item_sk = 'i_item_sk)) AND ('cs_sold_date_sk = 'd_date_sk)) AND (('d_year = (1999 + 2)) AND ('d_moy = 11)))
                  :           :  +- 'Project ['ss_item_sk]
                  :           :     +- 'UnresolvedRelation [cross_items]
                  :           +- 'Join Inner
                  :              :- 'Join Inner
                  :              :  :- 'UnresolvedRelation [catalog_sales]
                  :              :  +- 'UnresolvedRelation [item]
                  :              +- 'UnresolvedRelation [date_dim]
                  +- 'UnresolvedHaving ('sum(('ws_quantity * 'ws_list_price)) > scalar-subquery#22 [])
                     :  +- 'Project ['average_sales]
                     :     +- 'UnresolvedRelation [avg_sales]
                     +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [web AS channel#23, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('ws_quantity * 'ws_list_price)) AS sales#24, 'count(1) AS number_sales#25]
                        +- 'Filter ((('ws_item_sk IN (list#26 []) AND ('ws_item_sk = 'i_item_sk)) AND ('ws_sold_date_sk = 'd_date_sk)) AND (('d_year = (1999 + 2)) AND ('d_moy = 11)))
                           :  +- 'Project ['ss_item_sk]
                           :     +- 'UnresolvedRelation [cross_items]
                           +- 'Join Inner
                              :- 'Join Inner
                              :  :- 'UnresolvedRelation [web_sales]
                              :  +- 'UnresolvedRelation [item]
                              +- 'UnresolvedRelation [date_dim]

== Analyzed Logical Plan ==
channel: string, i_brand_id: int, i_class_id: int, i_category_id: int, sum(sales): decimal(38,2), sum(number_sales): bigint
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#27 ASC NULLS FIRST, i_brand_id#28 ASC NULLS FIRST, i_class_id#29 ASC NULLS FIRST, i_category_id#30 ASC NULLS FIRST], true
      +- Aggregate [channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31], [channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, sum(sales#14) AS sum(sales)#32, sum(number_sales#33) AS sum(number_sales)#34]
         +- Expand [List(channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, channel#38, i_brand_id#39, i_class_id#40, i_category_id#41, 0), List(channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, channel#38, i_brand_id#39, i_class_id#40, null, 1), List(channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, channel#38, i_brand_id#39, null, null, 3), List(channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, channel#38, null, null, null, 7), List(channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, null, null, null, null, 15)], [channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31]
            +- Project [channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, channel#13 AS channel#38, i_brand_id#35 AS i_brand_id#39, i_class_id#36 AS i_class_id#40, i_category_id#37 AS i_category_id#41]
               +- SubqueryAlias y
                  +- Union false, false
                     :- Union false, false
                     :  :- Project [channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33]
                     :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44 as decimal(32,6)) > cast(scalar-subquery#12 [] as decimal(32,6)))
                     :  :     :  +- Project [average_sales#5]
                     :  :     :     +- SubqueryAlias avg_sales
                     :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                     :  :     :           +- SubqueryAlias x
                     :  :     :              +- Union false, false
                     :  :     :                 :- Union false, false
                     :  :     :                 :  :- Project [ss_quantity#42 AS quantity#6, ss_list_price#43 AS list_price#7]
                     :  :     :                 :  :  +- Filter ((ss_sold_date_sk#45 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= 2001)))
                     :  :     :                 :  :     +- Join Inner
                     :  :     :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                     :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                     :  :     :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                     :  :     :                 :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :  :     :                 :  +- Project [cs_quantity#90 AS quantity#8, cs_list_price#91 AS list_price#9]
                     :  :     :                 :     +- Filter ((cs_sold_date_sk#92 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :  :     :                 :        +- Join Inner
                     :  :     :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                     :  :     :                 :           :  +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                     :  :     :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                     :  :     :                 :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :  :     :                 +- Project [ws_quantity#114 AS quantity#10, ws_list_price#115 AS list_price#11]
                     :  :     :                    +- Filter ((ws_sold_date_sk#116 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :  :     :                       +- Join Inner
                     :  :     :                          :- SubqueryAlias spark_catalog.default.web_sales
                     :  :     :                          :  +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                     :  :     :                          +- SubqueryAlias spark_catalog.default.date_dim
                     :  :     :                             +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :  :     +- Aggregate [i_brand_id#35, i_class_id#36, i_category_id#37], [store AS channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#14, count(1) AS number_sales#33, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44]
                     :  :        +- Filter (((ss_item_sk#49 IN (list#16 []) AND (ss_item_sk#49 = i_item_sk#138)) AND (ss_sold_date_sk#45 = d_date_sk#46)) AND ((d_year#47 = (1999 + 2)) AND (d_moy#74 = 11)))
                     :  :           :  +- Project [ss_item_sk#1]
                     :  :           :     +- SubqueryAlias cross_items
                     :  :           :        +- Project [i_item_sk#138 AS ss_item_sk#1]
                     :  :           :           +- Filter (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
                     :  :           :              +- Join Inner
                     :  :           :                 :- SubqueryAlias spark_catalog.default.item
                     :  :           :                 :  +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :  :           :                 +- SubqueryAlias x
                     :  :           :                    +- Intersect false
                     :  :           :                       :- Intersect false
                     :  :           :                       :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
                     :  :           :                       :  :  +- Filter (((ss_item_sk#49 = i_item_sk#138) AND (ss_sold_date_sk#45 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :  :           :                       :  :     +- Join Inner
                     :  :           :                       :  :        :- Join Inner
                     :  :           :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                     :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                     :  :           :                       :  :        :  +- SubqueryAlias iss
                     :  :           :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                     :  :           :                       :  :        :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :  :           :                       :  :        +- SubqueryAlias d1
                     :  :           :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                     :  :           :                       :  :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :  :           :                       :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                     :  :           :                       :     +- Filter (((cs_item_sk#107 = i_item_sk#138) AND (cs_sold_date_sk#92 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :  :           :                       :        +- Join Inner
                     :  :           :                       :           :- Join Inner
                     :  :           :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                     :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                     :  :           :                       :           :  +- SubqueryAlias ics
                     :  :           :                       :           :     +- SubqueryAlias spark_catalog.default.item
                     :  :           :                       :           :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :  :           :                       :           +- SubqueryAlias d2
                     :  :           :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                     :  :           :                       :                 +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :  :           :                       +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                     :  :           :                          +- Filter (((ws_item_sk#119 = i_item_sk#138) AND (ws_sold_date_sk#116 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :  :           :                             +- Join Inner
                     :  :           :                                :- Join Inner
                     :  :           :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                     :  :           :                                :  :  +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                     :  :           :                                :  +- SubqueryAlias iws
                     :  :           :                                :     +- SubqueryAlias spark_catalog.default.item
                     :  :           :                                :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :  :           :                                +- SubqueryAlias d3
                     :  :           :                                   +- SubqueryAlias spark_catalog.default.date_dim
                     :  :           :                                      +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias spark_catalog.default.store_sales
                     :  :              :  :  +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                     :  :              :  +- SubqueryAlias spark_catalog.default.item
                     :  :              :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :  :              +- SubqueryAlias spark_catalog.default.date_dim
                     :  :                 +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :  +- Project [channel#18 AS channel#157, i_brand_id#35 AS i_brand_id#158, i_class_id#36 AS i_class_id#159, i_category_id#37 AS i_category_id#160, sales#19 AS sales#161, number_sales#162 AS number_sales#163]
                     :     +- Project [channel#18, i_brand_id#35, i_class_id#36, i_category_id#37, sales#19, number_sales#162]
                     :        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164 as decimal(32,6)) > cast(scalar-subquery#17 [] as decimal(32,6)))
                     :           :  +- Project [average_sales#5]
                     :           :     +- SubqueryAlias avg_sales
                     :           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                     :           :           +- SubqueryAlias x
                     :           :              +- Union false, false
                     :           :                 :- Union false, false
                     :           :                 :  :- Project [ss_quantity#42 AS quantity#6, ss_list_price#43 AS list_price#7]
                     :           :                 :  :  +- Filter ((ss_sold_date_sk#45 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= 2001)))
                     :           :                 :  :     +- Join Inner
                     :           :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                     :           :                 :  :        :  +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                     :           :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                     :           :                 :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :           :                 :  +- Project [cs_quantity#90 AS quantity#8, cs_list_price#91 AS list_price#9]
                     :           :                 :     +- Filter ((cs_sold_date_sk#92 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :           :                 :        +- Join Inner
                     :           :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                     :           :                 :           :  +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                     :           :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                     :           :                 :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :           :                 +- Project [ws_quantity#114 AS quantity#10, ws_list_price#115 AS list_price#11]
                     :           :                    +- Filter ((ws_sold_date_sk#116 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :           :                       +- Join Inner
                     :           :                          :- SubqueryAlias spark_catalog.default.web_sales
                     :           :                          :  +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                     :           :                          +- SubqueryAlias spark_catalog.default.date_dim
                     :           :                             +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :           +- Aggregate [i_brand_id#35, i_class_id#36, i_category_id#37], [catalog AS channel#18, i_brand_id#35, i_class_id#36, i_category_id#37, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#19, count(1) AS number_sales#162, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164]
                     :              +- Filter (((cs_item_sk#107 IN (list#21 []) AND (cs_item_sk#107 = i_item_sk#138)) AND (cs_sold_date_sk#92 = d_date_sk#46)) AND ((d_year#47 = (1999 + 2)) AND (d_moy#74 = 11)))
                     :                 :  +- Project [ss_item_sk#1]
                     :                 :     +- SubqueryAlias cross_items
                     :                 :        +- Project [i_item_sk#138 AS ss_item_sk#1]
                     :                 :           +- Filter (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
                     :                 :              +- Join Inner
                     :                 :                 :- SubqueryAlias spark_catalog.default.item
                     :                 :                 :  +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :                 :                 +- SubqueryAlias x
                     :                 :                    +- Intersect false
                     :                 :                       :- Intersect false
                     :                 :                       :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
                     :                 :                       :  :  +- Filter (((ss_item_sk#49 = i_item_sk#138) AND (ss_sold_date_sk#45 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :                 :                       :  :     +- Join Inner
                     :                 :                       :  :        :- Join Inner
                     :                 :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                     :                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                     :                 :                       :  :        :  +- SubqueryAlias iss
                     :                 :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                     :                 :                       :  :        :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :                 :                       :  :        +- SubqueryAlias d1
                     :                 :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                     :                 :                       :  :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :                 :                       :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                     :                 :                       :     +- Filter (((cs_item_sk#107 = i_item_sk#138) AND (cs_sold_date_sk#92 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :                 :                       :        +- Join Inner
                     :                 :                       :           :- Join Inner
                     :                 :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                     :                 :                       :           :  :  +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                     :                 :                       :           :  +- SubqueryAlias ics
                     :                 :                       :           :     +- SubqueryAlias spark_catalog.default.item
                     :                 :                       :           :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :                 :                       :           +- SubqueryAlias d2
                     :                 :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                     :                 :                       :                 +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :                 :                       +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                     :                 :                          +- Filter (((ws_item_sk#119 = i_item_sk#138) AND (ws_sold_date_sk#116 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                     :                 :                             +- Join Inner
                     :                 :                                :- Join Inner
                     :                 :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                     :                 :                                :  :  +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                     :                 :                                :  +- SubqueryAlias iws
                     :                 :                                :     +- SubqueryAlias spark_catalog.default.item
                     :                 :                                :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :                 :                                +- SubqueryAlias d3
                     :                 :                                   +- SubqueryAlias spark_catalog.default.date_dim
                     :                 :                                      +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :                 +- Join Inner
                     :                    :- Join Inner
                     :                    :  :- SubqueryAlias spark_catalog.default.catalog_sales
                     :                    :  :  +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                     :                    :  +- SubqueryAlias spark_catalog.default.item
                     :                    :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                     :                    +- SubqueryAlias spark_catalog.default.date_dim
                     :                       +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     +- Project [channel#23 AS channel#165, i_brand_id#35 AS i_brand_id#166, i_class_id#36 AS i_class_id#167, i_category_id#37 AS i_category_id#168, sales#24 AS sales#169, number_sales#170 AS number_sales#171]
                        +- Project [channel#23, i_brand_id#35, i_class_id#36, i_category_id#37, sales#24, number_sales#170]
                           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172 as decimal(32,6)) > cast(scalar-subquery#22 [] as decimal(32,6)))
                              :  +- Project [average_sales#5]
                              :     +- SubqueryAlias avg_sales
                              :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                              :           +- SubqueryAlias x
                              :              +- Union false, false
                              :                 :- Union false, false
                              :                 :  :- Project [ss_quantity#42 AS quantity#6, ss_list_price#43 AS list_price#7]
                              :                 :  :  +- Filter ((ss_sold_date_sk#45 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= 2001)))
                              :                 :  :     +- Join Inner
                              :                 :  :        :- SubqueryAlias spark_catalog.default.store_sales
                              :                 :  :        :  +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                              :                 :  :        +- SubqueryAlias spark_catalog.default.date_dim
                              :                 :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              :                 :  +- Project [cs_quantity#90 AS quantity#8, cs_list_price#91 AS list_price#9]
                              :                 :     +- Filter ((cs_sold_date_sk#92 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                              :                 :        +- Join Inner
                              :                 :           :- SubqueryAlias spark_catalog.default.catalog_sales
                              :                 :           :  +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                              :                 :           +- SubqueryAlias spark_catalog.default.date_dim
                              :                 :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              :                 +- Project [ws_quantity#114 AS quantity#10, ws_list_price#115 AS list_price#11]
                              :                    +- Filter ((ws_sold_date_sk#116 = d_date_sk#46) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                              :                       +- Join Inner
                              :                          :- SubqueryAlias spark_catalog.default.web_sales
                              :                          :  +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                              :                          +- SubqueryAlias spark_catalog.default.date_dim
                              :                             +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              +- Aggregate [i_brand_id#35, i_class_id#36, i_category_id#37], [web AS channel#23, i_brand_id#35, i_class_id#36, i_category_id#37, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#24, count(1) AS number_sales#170, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172]
                                 +- Filter (((ws_item_sk#119 IN (list#26 []) AND (ws_item_sk#119 = i_item_sk#138)) AND (ws_sold_date_sk#116 = d_date_sk#46)) AND ((d_year#47 = (1999 + 2)) AND (d_moy#74 = 11)))
                                    :  +- Project [ss_item_sk#1]
                                    :     +- SubqueryAlias cross_items
                                    :        +- Project [i_item_sk#138 AS ss_item_sk#1]
                                    :           +- Filter (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
                                    :              +- Join Inner
                                    :                 :- SubqueryAlias spark_catalog.default.item
                                    :                 :  +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                                    :                 +- SubqueryAlias x
                                    :                    +- Intersect false
                                    :                       :- Intersect false
                                    :                       :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
                                    :                       :  :  +- Filter (((ss_item_sk#49 = i_item_sk#138) AND (ss_sold_date_sk#45 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                                    :                       :  :     +- Join Inner
                                    :                       :  :        :- Join Inner
                                    :                       :  :        :  :- SubqueryAlias spark_catalog.default.store_sales
                                    :                       :  :        :  :  +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                                    :                       :  :        :  +- SubqueryAlias iss
                                    :                       :  :        :     +- SubqueryAlias spark_catalog.default.item
                                    :                       :  :        :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                                    :                       :  :        +- SubqueryAlias d1
                                    :                       :  :           +- SubqueryAlias spark_catalog.default.date_dim
                                    :                       :  :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                                    :                       :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                                    :                       :     +- Filter (((cs_item_sk#107 = i_item_sk#138) AND (cs_sold_date_sk#92 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                                    :                       :        +- Join Inner
                                    :                       :           :- Join Inner
                                    :                       :           :  :- SubqueryAlias spark_catalog.default.catalog_sales
                                    :                       :           :  :  +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                                    :                       :           :  +- SubqueryAlias ics
                                    :                       :           :     +- SubqueryAlias spark_catalog.default.item
                                    :                       :           :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                                    :                       :           +- SubqueryAlias d2
                                    :                       :              +- SubqueryAlias spark_catalog.default.date_dim
                                    :                       :                 +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                                    :                       +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                                    :                          +- Filter (((ws_item_sk#119 = i_item_sk#138) AND (ws_sold_date_sk#116 = d_date_sk#46)) AND ((d_year#47 >= 1999) AND (d_year#47 <= (1999 + 2))))
                                    :                             +- Join Inner
                                    :                                :- Join Inner
                                    :                                :  :- SubqueryAlias spark_catalog.default.web_sales
                                    :                                :  :  +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                                    :                                :  +- SubqueryAlias iws
                                    :                                :     +- SubqueryAlias spark_catalog.default.item
                                    :                                :        +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                                    :                                +- SubqueryAlias d3
                                    :                                   +- SubqueryAlias spark_catalog.default.date_dim
                                    :                                      +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                                    +- Join Inner
                                       :- Join Inner
                                       :  :- SubqueryAlias spark_catalog.default.web_sales
                                       :  :  +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                                       :  +- SubqueryAlias spark_catalog.default.item
                                       :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                                       +- SubqueryAlias spark_catalog.default.date_dim
                                          +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#27 ASC NULLS FIRST, i_brand_id#28 ASC NULLS FIRST, i_class_id#29 ASC NULLS FIRST, i_category_id#30 ASC NULLS FIRST], true
      +- Aggregate [channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31], [channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, sum(sales#14) AS sum(sales)#32, sum(number_sales#33) AS sum(number_sales)#34]
         +- Expand [List(sales#14, number_sales#33, channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, 0), List(sales#14, number_sales#33, channel#13, i_brand_id#35, i_class_id#36, null, 1), List(sales#14, number_sales#33, channel#13, i_brand_id#35, null, null, 3), List(sales#14, number_sales#33, channel#13, null, null, null, 7), List(sales#14, number_sales#33, null, null, null, null, 15)], [sales#14, number_sales#33, channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31]
            +- Union false, false
               :- Project [sales#14, number_sales#33, channel#13, i_brand_id#35, i_class_id#36, i_category_id#37]
               :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44 as decimal(32,6)) > cast(scalar-subquery#12 [] as decimal(32,6))))
               :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
               :     :     +- Union false, false
               :     :        :- Project [ss_quantity#42 AS quantity#6, ss_list_price#43 AS list_price#7]
               :     :        :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
               :     :        :     :- Project [ss_sold_date_sk#45, ss_quantity#42, ss_list_price#43]
               :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#45)
               :     :        :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
               :     :        :     +- Project [d_date_sk#46]
               :     :        :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :     :        :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :     :        :- Project [cs_quantity#90 AS quantity#8, cs_list_price#91 AS list_price#9]
               :     :        :  +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
               :     :        :     :- Project [cs_sold_date_sk#92, cs_quantity#90, cs_list_price#91]
               :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#92)
               :     :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
               :     :        :     +- Project [d_date_sk#46]
               :     :        :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :     :        :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :     :        +- Project [ws_quantity#114 AS quantity#10, ws_list_price#115 AS list_price#11]
               :     :           +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
               :     :              :- Project [ws_sold_date_sk#116, ws_quantity#114, ws_list_price#115]
               :     :              :  +- Filter isnotnull(ws_sold_date_sk#116)
               :     :              :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#46]
               :     :                 +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :     :                    +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :     +- Aggregate [i_brand_id#35, i_class_id#36, i_category_id#37], [store AS channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#14, count(1) AS number_sales#33, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44]
               :        +- Project [ss_quantity#42, ss_list_price#43, i_brand_id#35, i_class_id#36, i_category_id#37]
               :           +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
               :              :- Project [ss_sold_date_sk#45, ss_quantity#42, ss_list_price#43, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :  +- Join Inner, (ss_item_sk#49 = i_item_sk#138)
               :              :     :- Join LeftSemi, (ss_item_sk#49 = ss_item_sk#1)
               :              :     :  :- Project [ss_sold_date_sk#45, ss_item_sk#49, ss_quantity#42, ss_list_price#43]
               :              :     :  :  +- Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
               :              :     :  :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
               :              :     :  +- Project [i_item_sk#138 AS ss_item_sk#1]
               :              :     :     +- Join Inner, (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
               :              :     :        :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :        :  +- Filter ((isnotnull(i_class_id#36) AND isnotnull(i_brand_id#35)) AND isnotnull(i_category_id#37))
               :              :     :        :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :     :                 :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
               :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
               :              :     :                 :  :     :- Project [ss_sold_date_sk#45, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#49 = i_item_sk#138)
               :              :     :                 :  :     :     :- Project [ss_sold_date_sk#45, ss_item_sk#49]
               :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
               :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
               :              :     :                 :  :     :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#138) AND isnotnull(i_category_id#37)) AND isnotnull(i_brand_id#35)) AND isnotnull(i_class_id#36))
               :              :     :                 :  :     :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :                 :  :     +- Project [d_date_sk#46]
               :              :     :                 :  :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :     :                 :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :     :                 :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :     +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
               :              :     :                 :        :- Project [cs_sold_date_sk#92, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :        :  +- Join Inner, (cs_item_sk#107 = i_item_sk#138)
               :              :     :                 :        :     :- Project [cs_sold_date_sk#92, cs_item_sk#107]
               :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
               :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
               :              :     :                 :        :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :        :        +- Filter isnotnull(i_item_sk#138)
               :              :     :                 :        :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :                 :        +- Project [d_date_sk#46]
               :              :     :                 :           +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :     :                 :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :     :                 +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                    +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
               :              :     :                       :- Project [ws_sold_date_sk#116, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                       :  +- Join Inner, (ws_item_sk#119 = i_item_sk#138)
               :              :     :                       :     :- Project [ws_sold_date_sk#116, ws_item_sk#119]
               :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
               :              :     :                       :     :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
               :              :     :                       :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                       :        +- Filter isnotnull(i_item_sk#138)
               :              :     :                       :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :                       +- Project [d_date_sk#46]
               :              :     :                          +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :     :                             +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :     +- Join LeftSemi, (i_item_sk#138 = ss_item_sk#1)
               :              :        :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :        :  +- Filter isnotnull(i_item_sk#138)
               :              :        :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :        +- Project [i_item_sk#138 AS ss_item_sk#1]
               :              :           +- Join Inner, (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
               :              :              :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :              :  +- Filter ((isnotnull(i_class_id#36) AND isnotnull(i_brand_id#35)) AND isnotnull(i_category_id#37))
               :              :              :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :                       :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
               :              :                       :  :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
               :              :                       :  :     :- Project [ss_sold_date_sk#45, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :  :     :  +- Join Inner, (ss_item_sk#49 = i_item_sk#138)
               :              :                       :  :     :     :- Project [ss_sold_date_sk#45, ss_item_sk#49]
               :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
               :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
               :              :                       :  :     :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#138) AND isnotnull(i_category_id#37)) AND isnotnull(i_brand_id#35)) AND isnotnull(i_class_id#36))
               :              :                       :  :     :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :                       :  :     +- Project [d_date_sk#46]
               :              :                       :  :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :                       :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :                       :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :     +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
               :              :                       :        :- Project [cs_sold_date_sk#92, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :        :  +- Join Inner, (cs_item_sk#107 = i_item_sk#138)
               :              :                       :        :     :- Project [cs_sold_date_sk#92, cs_item_sk#107]
               :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
               :              :                       :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
               :              :                       :        :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :        :        +- Filter isnotnull(i_item_sk#138)
               :              :                       :        :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :                       :        +- Project [d_date_sk#46]
               :              :                       :           +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :                       :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :                       +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                          +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
               :              :                             :- Project [ws_sold_date_sk#116, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                             :  +- Join Inner, (ws_item_sk#119 = i_item_sk#138)
               :              :                             :     :- Project [ws_sold_date_sk#116, ws_item_sk#119]
               :              :                             :     :  +- Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
               :              :                             :     :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
               :              :                             :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                             :        +- Filter isnotnull(i_item_sk#138)
               :              :                             :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :                             +- Project [d_date_sk#46]
               :              :                                +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :                                   +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              +- Project [d_date_sk#46]
               :                 +- Filter ((((isnotnull(d_year#47) AND isnotnull(d_moy#74)) AND (d_year#47 = 2001)) AND (d_moy#74 = 11)) AND isnotnull(d_date_sk#46))
               :                    +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :- Project [sales#19, number_sales#162, channel#18, i_brand_id#35, i_class_id#36, i_category_id#37]
               :  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164 as decimal(32,6)) > cast(scalar-subquery#17 [] as decimal(32,6))))
               :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
               :     :     +- Union false, false
               :     :        :- Project [ss_quantity#42 AS quantity#6, ss_list_price#43 AS list_price#7]
               :     :        :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
               :     :        :     :- Project [ss_sold_date_sk#45, ss_quantity#42, ss_list_price#43]
               :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#45)
               :     :        :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
               :     :        :     +- Project [d_date_sk#46]
               :     :        :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :     :        :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :     :        :- Project [cs_quantity#90 AS quantity#8, cs_list_price#91 AS list_price#9]
               :     :        :  +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
               :     :        :     :- Project [cs_sold_date_sk#92, cs_quantity#90, cs_list_price#91]
               :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#92)
               :     :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
               :     :        :     +- Project [d_date_sk#46]
               :     :        :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :     :        :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :     :        +- Project [ws_quantity#114 AS quantity#10, ws_list_price#115 AS list_price#11]
               :     :           +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
               :     :              :- Project [ws_sold_date_sk#116, ws_quantity#114, ws_list_price#115]
               :     :              :  +- Filter isnotnull(ws_sold_date_sk#116)
               :     :              :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
               :     :              +- Project [d_date_sk#46]
               :     :                 +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :     :                    +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :     +- Aggregate [i_brand_id#35, i_class_id#36, i_category_id#37], [catalog AS channel#18, i_brand_id#35, i_class_id#36, i_category_id#37, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#19, count(1) AS number_sales#162, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164]
               :        +- Project [cs_quantity#90, cs_list_price#91, i_brand_id#35, i_class_id#36, i_category_id#37]
               :           +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
               :              :- Project [cs_sold_date_sk#92, cs_quantity#90, cs_list_price#91, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :  +- Join Inner, (cs_item_sk#107 = i_item_sk#138)
               :              :     :- Join LeftSemi, (cs_item_sk#107 = ss_item_sk#1)
               :              :     :  :- Project [cs_sold_date_sk#92, cs_item_sk#107, cs_quantity#90, cs_list_price#91]
               :              :     :  :  +- Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
               :              :     :  :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
               :              :     :  +- Project [i_item_sk#138 AS ss_item_sk#1]
               :              :     :     +- Join Inner, (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
               :              :     :        :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :        :  +- Filter ((isnotnull(i_class_id#36) AND isnotnull(i_brand_id#35)) AND isnotnull(i_category_id#37))
               :              :     :        :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :     :                 :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
               :              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
               :              :     :                 :  :     :- Project [ss_sold_date_sk#45, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :  :     :  +- Join Inner, (ss_item_sk#49 = i_item_sk#138)
               :              :     :                 :  :     :     :- Project [ss_sold_date_sk#45, ss_item_sk#49]
               :              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
               :              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
               :              :     :                 :  :     :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#138) AND isnotnull(i_category_id#37)) AND isnotnull(i_brand_id#35)) AND isnotnull(i_class_id#36))
               :              :     :                 :  :     :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :                 :  :     +- Project [d_date_sk#46]
               :              :     :                 :  :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :     :                 :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :     :                 :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :     +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
               :              :     :                 :        :- Project [cs_sold_date_sk#92, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :        :  +- Join Inner, (cs_item_sk#107 = i_item_sk#138)
               :              :     :                 :        :     :- Project [cs_sold_date_sk#92, cs_item_sk#107]
               :              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
               :              :     :                 :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
               :              :     :                 :        :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                 :        :        +- Filter isnotnull(i_item_sk#138)
               :              :     :                 :        :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :                 :        +- Project [d_date_sk#46]
               :              :     :                 :           +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :     :                 :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :     :                 +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                    +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
               :              :     :                       :- Project [ws_sold_date_sk#116, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                       :  +- Join Inner, (ws_item_sk#119 = i_item_sk#138)
               :              :     :                       :     :- Project [ws_sold_date_sk#116, ws_item_sk#119]
               :              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
               :              :     :                       :     :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
               :              :     :                       :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :     :                       :        +- Filter isnotnull(i_item_sk#138)
               :              :     :                       :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :     :                       +- Project [d_date_sk#46]
               :              :     :                          +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :     :                             +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :     +- Join LeftSemi, (i_item_sk#138 = ss_item_sk#1)
               :              :        :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :        :  +- Filter isnotnull(i_item_sk#138)
               :              :        :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :        +- Project [i_item_sk#138 AS ss_item_sk#1]
               :              :           +- Join Inner, (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
               :              :              :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :              :  +- Filter ((isnotnull(i_class_id#36) AND isnotnull(i_brand_id#35)) AND isnotnull(i_category_id#37))
               :              :              :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
               :              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
               :              :                       :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
               :              :                       :  :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
               :              :                       :  :     :- Project [ss_sold_date_sk#45, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :  :     :  +- Join Inner, (ss_item_sk#49 = i_item_sk#138)
               :              :                       :  :     :     :- Project [ss_sold_date_sk#45, ss_item_sk#49]
               :              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
               :              :                       :  :     :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
               :              :                       :  :     :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#138) AND isnotnull(i_category_id#37)) AND isnotnull(i_brand_id#35)) AND isnotnull(i_class_id#36))
               :              :                       :  :     :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :                       :  :     +- Project [d_date_sk#46]
               :              :                       :  :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :                       :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :                       :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :     +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
               :              :                       :        :- Project [cs_sold_date_sk#92, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :        :  +- Join Inner, (cs_item_sk#107 = i_item_sk#138)
               :              :                       :        :     :- Project [cs_sold_date_sk#92, cs_item_sk#107]
               :              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
               :              :                       :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
               :              :                       :        :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                       :        :        +- Filter isnotnull(i_item_sk#138)
               :              :                       :        :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :                       :        +- Project [d_date_sk#46]
               :              :                       :           +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :                       :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              :                       +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                          +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
               :              :                             :- Project [ws_sold_date_sk#116, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                             :  +- Join Inner, (ws_item_sk#119 = i_item_sk#138)
               :              :                             :     :- Project [ws_sold_date_sk#116, ws_item_sk#119]
               :              :                             :     :  +- Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
               :              :                             :     :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
               :              :                             :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :              :                             :        +- Filter isnotnull(i_item_sk#138)
               :              :                             :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
               :              :                             +- Project [d_date_sk#46]
               :              :                                +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :              :                                   +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               :              +- Project [d_date_sk#46]
               :                 +- Filter ((((isnotnull(d_year#47) AND isnotnull(d_moy#74)) AND (d_year#47 = 2001)) AND (d_moy#74 = 11)) AND isnotnull(d_date_sk#46))
               :                    +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
               +- Project [sales#24, number_sales#170, channel#23, i_brand_id#35, i_class_id#36, i_category_id#37]
                  +- Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172 as decimal(32,6)) > cast(scalar-subquery#22 [] as decimal(32,6))))
                     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#5]
                     :     +- Union false, false
                     :        :- Project [ss_quantity#42 AS quantity#6, ss_list_price#43 AS list_price#7]
                     :        :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
                     :        :     :- Project [ss_sold_date_sk#45, ss_quantity#42, ss_list_price#43]
                     :        :     :  +- Filter isnotnull(ss_sold_date_sk#45)
                     :        :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                     :        :     +- Project [d_date_sk#46]
                     :        :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                     :        :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :        :- Project [cs_quantity#90 AS quantity#8, cs_list_price#91 AS list_price#9]
                     :        :  +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
                     :        :     :- Project [cs_sold_date_sk#92, cs_quantity#90, cs_list_price#91]
                     :        :     :  +- Filter isnotnull(cs_sold_date_sk#92)
                     :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                     :        :     +- Project [d_date_sk#46]
                     :        :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                     :        :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     :        +- Project [ws_quantity#114 AS quantity#10, ws_list_price#115 AS list_price#11]
                     :           +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
                     :              :- Project [ws_sold_date_sk#116, ws_quantity#114, ws_list_price#115]
                     :              :  +- Filter isnotnull(ws_sold_date_sk#116)
                     :              :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                     :              +- Project [d_date_sk#46]
                     :                 +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                     :                    +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                     +- Aggregate [i_brand_id#35, i_class_id#36, i_category_id#37], [web AS channel#23, i_brand_id#35, i_class_id#36, i_category_id#37, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#24, count(1) AS number_sales#170, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true)) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172]
                        +- Project [ws_quantity#114, ws_list_price#115, i_brand_id#35, i_class_id#36, i_category_id#37]
                           +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
                              :- Project [ws_sold_date_sk#116, ws_quantity#114, ws_list_price#115, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :  +- Join Inner, (ws_item_sk#119 = i_item_sk#138)
                              :     :- Join LeftSemi, (ws_item_sk#119 = ss_item_sk#1)
                              :     :  :- Project [ws_sold_date_sk#116, ws_item_sk#119, ws_quantity#114, ws_list_price#115]
                              :     :  :  +- Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
                              :     :  :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                              :     :  +- Project [i_item_sk#138 AS ss_item_sk#1]
                              :     :     +- Join Inner, (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
                              :     :        :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :        :  +- Filter ((isnotnull(i_class_id#36) AND isnotnull(i_brand_id#35)) AND isnotnull(i_category_id#37))
                              :     :        :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :     :        +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                              :     :           +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                              :     :              +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
                              :     :                 :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
                              :     :                 :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
                              :     :                 :  :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
                              :     :                 :  :     :- Project [ss_sold_date_sk#45, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                 :  :     :  +- Join Inner, (ss_item_sk#49 = i_item_sk#138)
                              :     :                 :  :     :     :- Project [ss_sold_date_sk#45, ss_item_sk#49]
                              :     :                 :  :     :     :  +- Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
                              :     :                 :  :     :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                              :     :                 :  :     :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                 :  :     :        +- Filter (((isnotnull(i_item_sk#138) AND isnotnull(i_category_id#37)) AND isnotnull(i_brand_id#35)) AND isnotnull(i_class_id#36))
                              :     :                 :  :     :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :     :                 :  :     +- Project [d_date_sk#46]
                              :     :                 :  :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                              :     :                 :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              :     :                 :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                 :     +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
                              :     :                 :        :- Project [cs_sold_date_sk#92, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                 :        :  +- Join Inner, (cs_item_sk#107 = i_item_sk#138)
                              :     :                 :        :     :- Project [cs_sold_date_sk#92, cs_item_sk#107]
                              :     :                 :        :     :  +- Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
                              :     :                 :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                              :     :                 :        :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                 :        :        +- Filter isnotnull(i_item_sk#138)
                              :     :                 :        :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :     :                 :        +- Project [d_date_sk#46]
                              :     :                 :           +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                              :     :                 :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              :     :                 +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                    +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
                              :     :                       :- Project [ws_sold_date_sk#116, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                       :  +- Join Inner, (ws_item_sk#119 = i_item_sk#138)
                              :     :                       :     :- Project [ws_sold_date_sk#116, ws_item_sk#119]
                              :     :                       :     :  +- Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
                              :     :                       :     :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                              :     :                       :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :     :                       :        +- Filter isnotnull(i_item_sk#138)
                              :     :                       :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :     :                       +- Project [d_date_sk#46]
                              :     :                          +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                              :     :                             +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              :     +- Join LeftSemi, (i_item_sk#138 = ss_item_sk#1)
                              :        :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :        :  +- Filter isnotnull(i_item_sk#138)
                              :        :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :        +- Project [i_item_sk#138 AS ss_item_sk#1]
                              :           +- Join Inner, (((i_brand_id#35 = brand_id#2) AND (i_class_id#36 = class_id#3)) AND (i_category_id#37 = category_id#4))
                              :              :- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :              :  +- Filter ((isnotnull(i_class_id#36) AND isnotnull(i_brand_id#35)) AND isnotnull(i_category_id#37))
                              :              :     +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :              +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                              :                 +- Aggregate [brand_id#2, class_id#3, category_id#4], [brand_id#2, class_id#3, category_id#4]
                              :                    +- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
                              :                       :- Join LeftSemi, (((brand_id#2 <=> i_brand_id#35) AND (class_id#3 <=> i_class_id#36)) AND (category_id#4 <=> i_category_id#37))
                              :                       :  :- Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
                              :                       :  :  +- Join Inner, (ss_sold_date_sk#45 = d_date_sk#46)
                              :                       :  :     :- Project [ss_sold_date_sk#45, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                       :  :     :  +- Join Inner, (ss_item_sk#49 = i_item_sk#138)
                              :                       :  :     :     :- Project [ss_sold_date_sk#45, ss_item_sk#49]
                              :                       :  :     :     :  +- Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
                              :                       :  :     :     :     +- Relation[ss_sold_date_sk#45,ss_sold_time_sk#48,ss_item_sk#49,ss_customer_sk#50,ss_cdemo_sk#51,ss_hdemo_sk#52,ss_addr_sk#53,ss_store_sk#54,ss_promo_sk#55,ss_ticket_number#56,ss_quantity#42,ss_wholesale_cost#57,ss_list_price#43,ss_sales_price#58,ss_ext_discount_amt#59,ss_ext_sales_price#60,ss_ext_wholesale_cost#61,ss_ext_list_price#62,ss_ext_tax#63,ss_coupon_amt#64,ss_net_paid#65,ss_net_paid_inc_tax#66,ss_net_profit#67] parquet
                              :                       :  :     :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                       :  :     :        +- Filter (((isnotnull(i_item_sk#138) AND isnotnull(i_category_id#37)) AND isnotnull(i_brand_id#35)) AND isnotnull(i_class_id#36))
                              :                       :  :     :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :                       :  :     +- Project [d_date_sk#46]
                              :                       :  :        +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                              :                       :  :           +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              :                       :  +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                       :     +- Join Inner, (cs_sold_date_sk#92 = d_date_sk#46)
                              :                       :        :- Project [cs_sold_date_sk#92, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                       :        :  +- Join Inner, (cs_item_sk#107 = i_item_sk#138)
                              :                       :        :     :- Project [cs_sold_date_sk#92, cs_item_sk#107]
                              :                       :        :     :  +- Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
                              :                       :        :     :     +- Relation[cs_sold_date_sk#92,cs_sold_time_sk#93,cs_ship_date_sk#94,cs_bill_customer_sk#95,cs_bill_cdemo_sk#96,cs_bill_hdemo_sk#97,cs_bill_addr_sk#98,cs_ship_customer_sk#99,cs_ship_cdemo_sk#100,cs_ship_hdemo_sk#101,cs_ship_addr_sk#102,cs_call_center_sk#103,cs_catalog_page_sk#104,cs_ship_mode_sk#105,cs_warehouse_sk#106,cs_item_sk#107,cs_promo_sk#108,cs_order_number#109,cs_quantity#90,cs_wholesale_cost#110,cs_list_price#91,cs_sales_price#111,cs_ext_discount_amt#112,cs_ext_sales_price#113,... 10 more fields] parquet
                              :                       :        :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                       :        :        +- Filter isnotnull(i_item_sk#138)
                              :                       :        :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :                       :        +- Project [d_date_sk#46]
                              :                       :           +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                              :                       :              +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              :                       +- Project [i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                          +- Join Inner, (ws_sold_date_sk#116 = d_date_sk#46)
                              :                             :- Project [ws_sold_date_sk#116, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                             :  +- Join Inner, (ws_item_sk#119 = i_item_sk#138)
                              :                             :     :- Project [ws_sold_date_sk#116, ws_item_sk#119]
                              :                             :     :  +- Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
                              :                             :     :     +- Relation[ws_sold_date_sk#116,ws_sold_time_sk#117,ws_ship_date_sk#118,ws_item_sk#119,ws_bill_customer_sk#120,ws_bill_cdemo_sk#121,ws_bill_hdemo_sk#122,ws_bill_addr_sk#123,ws_ship_customer_sk#124,ws_ship_cdemo_sk#125,ws_ship_hdemo_sk#126,ws_ship_addr_sk#127,ws_web_page_sk#128,ws_web_site_sk#129,ws_ship_mode_sk#130,ws_warehouse_sk#131,ws_promo_sk#132,ws_order_number#133,ws_quantity#114,ws_wholesale_cost#134,ws_list_price#115,ws_sales_price#135,ws_ext_discount_amt#136,ws_ext_sales_price#137,... 10 more fields] parquet
                              :                             :     +- Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
                              :                             :        +- Filter isnotnull(i_item_sk#138)
                              :                             :           +- Relation[i_item_sk#138,i_item_id#139,i_rec_start_date#140,i_rec_end_date#141,i_item_desc#142,i_current_price#143,i_wholesale_cost#144,i_brand_id#35,i_brand#145,i_class_id#36,i_class#146,i_category_id#37,i_category#147,i_manufact_id#148,i_manufact#149,i_size#150,i_formulation#151,i_color#152,i_units#153,i_container#154,i_manager_id#155,i_product_name#156] parquet
                              :                             +- Project [d_date_sk#46]
                              :                                +- Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
                              :                                   +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet
                              +- Project [d_date_sk#46]
                                 +- Filter ((((isnotnull(d_year#47) AND isnotnull(d_moy#74)) AND (d_year#47 = 2001)) AND (d_moy#74 = 11)) AND isnotnull(d_date_sk#46))
                                    +- Relation[d_date_sk#46,d_date_id#68,d_date#69,d_month_seq#70,d_week_seq#71,d_quarter_seq#72,d_year#47,d_dow#73,d_moy#74,d_dom#75,d_qoy#76,d_fy_year#77,d_fy_quarter_seq#78,d_fy_week_seq#79,d_day_name#80,d_quarter_name#81,d_holiday#82,d_weekend#83,d_following_holiday#84,d_first_dom#85,d_last_dom#86,d_same_day_ly#87,d_same_day_lq#88,d_current_day#89,... 4 more fields] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[channel#27 ASC NULLS FIRST,i_brand_id#28 ASC NULLS FIRST,i_class_id#29 ASC NULLS FIRST,i_category_id#30 ASC NULLS FIRST], output=[channel#27,i_brand_id#28,i_class_id#29,i_category_id#30,sum(sales)#32,sum(number_sales)#34])
+- *(80) HashAggregate(keys=[channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31], functions=[sum(sales#14), sum(number_sales#33)], output=[channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, sum(sales)#32, sum(number_sales)#34])
   +- Exchange hashpartitioning(channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31, 5), true, [id=#173]
      +- *(79) HashAggregate(keys=[channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31], functions=[partial_sum(sales#14), partial_sum(number_sales#33)], output=[channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31, sum#174, isEmpty#175, sum#176])
         +- *(79) Expand [List(sales#14, number_sales#33, channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, 0), List(sales#14, number_sales#33, channel#13, i_brand_id#35, i_class_id#36, null, 1), List(sales#14, number_sales#33, channel#13, i_brand_id#35, null, null, 3), List(sales#14, number_sales#33, channel#13, null, null, null, 7), List(sales#14, number_sales#33, null, null, null, null, 15)], [sales#14, number_sales#33, channel#27, i_brand_id#28, i_class_id#29, i_category_id#30, spark_grouping_id#31]
            +- Union
               :- *(26) Project [sales#14, number_sales#33, channel#13, i_brand_id#35, i_class_id#36, i_category_id#37]
               :  +- *(26) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44 as decimal(32,6)) > cast(Subquery scalar-subquery#12, [id=#177] as decimal(32,6))))
               :     :  +- Subquery scalar-subquery#12, [id=#177]
               :     :     +- *(8) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5])
               :     :        +- Exchange SinglePartition, true, [id=#178]
               :     :           +- *(7) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#6 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#7 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#179, count#180])
               :     :              +- Union
               :     :                 :- *(2) Project [ss_quantity#42 AS quantity#6, ss_list_price#43 AS list_price#7]
               :     :                 :  +- *(2) BroadcastHashJoin [ss_sold_date_sk#45], [d_date_sk#46], Inner, BuildRight, false
               :     :                 :     :- *(2) Project [ss_sold_date_sk#45, ss_quantity#42, ss_list_price#43]
               :     :                 :     :  +- *(2) Filter isnotnull(ss_sold_date_sk#45)
               :     :                 :     :     +- *(2) ColumnarToRow
               :     :                 :     :        +- FileScan parquet default.store_sales[ss_sold_date_sk#45,ss_quantity#42,ss_list_price#43] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#45)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
               :     :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#181]
               :     :                 :        +- *(1) Project [d_date_sk#46]
               :     :                 :           +- *(1) Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :     :                 :              +- *(1) ColumnarToRow
               :     :                 :                 +- FileScan parquet default.date_dim[d_date_sk#46,d_year#47] Batched: true, DataFilters: [isnotnull(d_year#47), (d_year#47 >= 1999), (d_year#47 <= 2001), isnotnull(d_date_sk#46)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :     :                 :- *(4) Project [cs_quantity#90 AS quantity#8, cs_list_price#91 AS list_price#9]
               :     :                 :  +- *(4) BroadcastHashJoin [cs_sold_date_sk#92], [d_date_sk#46], Inner, BuildRight, false
               :     :                 :     :- *(4) Project [cs_sold_date_sk#92, cs_quantity#90, cs_list_price#91]
               :     :                 :     :  +- *(4) Filter isnotnull(cs_sold_date_sk#92)
               :     :                 :     :     +- *(4) ColumnarToRow
               :     :                 :     :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#92,cs_quantity#90,cs_list_price#91] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#92)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
               :     :                 :     +- ReusedExchange [d_date_sk#46], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#181]
               :     :                 +- *(6) Project [ws_quantity#114 AS quantity#10, ws_list_price#115 AS list_price#11]
               :     :                    +- *(6) BroadcastHashJoin [ws_sold_date_sk#116], [d_date_sk#46], Inner, BuildRight, false
               :     :                       :- *(6) Project [ws_sold_date_sk#116, ws_quantity#114, ws_list_price#115]
               :     :                       :  +- *(6) Filter isnotnull(ws_sold_date_sk#116)
               :     :                       :     +- *(6) ColumnarToRow
               :     :                       :        +- FileScan parquet default.web_sales[ws_sold_date_sk#116,ws_quantity#114,ws_list_price#115] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#116)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
               :     :                       +- ReusedExchange [d_date_sk#46], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#181]
               :     +- *(26) HashAggregate(keys=[i_brand_id#35, i_class_id#36, i_category_id#37], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#13, i_brand_id#35, i_class_id#36, i_category_id#37, sales#14, number_sales#33, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true))#44])
               :        +- Exchange hashpartitioning(i_brand_id#35, i_class_id#36, i_category_id#37, 5), true, [id=#182]
               :           +- *(25) HashAggregate(keys=[i_brand_id#35, i_class_id#36, i_category_id#37], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#42 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#43 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#35, i_class_id#36, i_category_id#37, sum#183, isEmpty#184, count#185])
               :              +- *(25) Project [ss_quantity#42, ss_list_price#43, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                 +- *(25) BroadcastHashJoin [ss_sold_date_sk#45], [d_date_sk#46], Inner, BuildRight, false
               :                    :- *(25) Project [ss_sold_date_sk#45, ss_quantity#42, ss_list_price#43, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :  +- *(25) BroadcastHashJoin [ss_item_sk#49], [i_item_sk#138], Inner, BuildRight, false
               :                    :     :- *(25) BroadcastHashJoin [ss_item_sk#49], [ss_item_sk#1], LeftSemi, BuildRight, false
               :                    :     :  :- *(25) Project [ss_sold_date_sk#45, ss_item_sk#49, ss_quantity#42, ss_list_price#43]
               :                    :     :  :  +- *(25) Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
               :                    :     :  :     +- *(25) ColumnarToRow
               :                    :     :  :        +- FileScan parquet default.store_sales[ss_sold_date_sk#45,ss_item_sk#49,ss_quantity#42,ss_list_price#43] Batched: true, DataFilters: [isnotnull(ss_item_sk#49), isnotnull(ss_sold_date_sk#45)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
               :                    :     :  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#186]
               :                    :     :     +- *(11) Project [i_item_sk#138 AS ss_item_sk#1]
               :                    :     :        +- *(11) BroadcastHashJoin [i_brand_id#35, i_class_id#36, i_category_id#37], [brand_id#2, class_id#3, category_id#4], Inner, BuildRight, false
               :                    :     :           :- *(11) Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :           :  +- *(11) Filter ((isnotnull(i_class_id#36) AND isnotnull(i_brand_id#35)) AND isnotnull(i_category_id#37))
               :                    :     :           :     +- *(11) ColumnarToRow
               :                    :     :           :        +- FileScan parquet default.item[i_item_sk#138,i_brand_id#35,i_class_id#36,i_category_id#37] Batched: true, DataFilters: [isnotnull(i_class_id#36), isnotnull(i_brand_id#35), isnotnull(i_category_id#37)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_class_id), IsNotNull(i_brand_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
               :                    :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, int, true], input[1, int, true], input[2, int, true]),false), [id=#187]
               :                    :     :              +- *(10) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
               :                    :     :                 +- *(10) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
               :                    :     :                    +- *(10) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
               :                    :     :                       +- Exchange hashpartitioning(brand_id#2, class_id#3, category_id#4, 5), true, [id=#188]
               :                    :     :                          +- *(9) HashAggregate(keys=[brand_id#2, class_id#3, category_id#4], functions=[], output=[brand_id#2, class_id#3, category_id#4])
               :                    :     :                             +- *(9) BroadcastHashJoin [coalesce(brand_id#2, 0), isnull(brand_id#2), coalesce(class_id#3, 0), isnull(class_id#3), coalesce(category_id#4, 0), isnull(category_id#4)], [coalesce(i_brand_id#35, 0), isnull(i_brand_id#35), coalesce(i_class_id#36, 0), isnull(i_class_id#36), coalesce(i_category_id#37, 0), isnull(i_category_id#37)], LeftSemi, BuildRight, false
               :                    :     :                                :- *(9) BroadcastHashJoin [coalesce(brand_id#2, 0), isnull(brand_id#2), coalesce(class_id#3, 0), isnull(class_id#3), coalesce(category_id#4, 0), isnull(category_id#4)], [coalesce(i_brand_id#35, 0), isnull(i_brand_id#35), coalesce(i_class_id#36, 0), isnull(i_class_id#36), coalesce(i_category_id#37, 0), isnull(i_category_id#37)], LeftSemi, BuildRight, false
               :                    :     :                                :  :- *(9) Project [i_brand_id#35 AS brand_id#2, i_class_id#36 AS class_id#3, i_category_id#37 AS category_id#4]
               :                    :     :                                :  :  +- *(9) BroadcastHashJoin [ss_sold_date_sk#45], [d_date_sk#46], Inner, BuildRight, false
               :                    :     :                                :  :     :- *(9) Project [ss_sold_date_sk#45, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :                                :  :     :  +- *(9) BroadcastHashJoin [ss_item_sk#49], [i_item_sk#138], Inner, BuildRight, false
               :                    :     :                                :  :     :     :- *(9) Project [ss_sold_date_sk#45, ss_item_sk#49]
               :                    :     :                                :  :     :     :  +- *(9) Filter (isnotnull(ss_item_sk#49) AND isnotnull(ss_sold_date_sk#45))
               :                    :     :                                :  :     :     :     +- *(9) ColumnarToRow
               :                    :     :                                :  :     :     :        +- FileScan parquet default.store_sales[ss_sold_date_sk#45,ss_item_sk#49] Batched: true, DataFilters: [isnotnull(ss_item_sk#49), isnotnull(ss_sold_date_sk#45)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
               :                    :     :                                :  :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#189]
               :                    :     :                                :  :     :        +- *(1) Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :                                :  :     :           +- *(1) Filter (((isnotnull(i_item_sk#138) AND isnotnull(i_category_id#37)) AND isnotnull(i_brand_id#35)) AND isnotnull(i_class_id#36))
               :                    :     :                                :  :     :              +- *(1) ColumnarToRow
               :                    :     :                                :  :     :                 +- FileScan parquet default.item[i_item_sk#138,i_brand_id#35,i_class_id#36,i_category_id#37] Batched: true, DataFilters: [isnotnull(i_item_sk#138), isnotnull(i_category_id#37), isnotnull(i_brand_id#35), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_category_id), IsNotNull(i_brand_id), IsNotNull(i_class_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
               :                    :     :                                :  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#190]
               :                    :     :                                :  :        +- *(2) Project [d_date_sk#46]
               :                    :     :                                :  :           +- *(2) Filter (((isnotnull(d_year#47) AND (d_year#47 >= 1999)) AND (d_year#47 <= 2001)) AND isnotnull(d_date_sk#46))
               :                    :     :                                :  :              +- *(2) ColumnarToRow
               :                    :     :                                :  :                 +- FileScan parquet default.date_dim[d_date_sk#46,d_year#47] Batched: true, DataFilters: [isnotnull(d_year#47), (d_year#47 >= 1999), (d_year#47 <= 2001), isnotnull(d_date_sk#46)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :     :                                :  +- BroadcastExchange HashedRelationBroadcastMode(List(coalesce(input[0, int, true], 0), isnull(input[0, int, true]), coalesce(input[1, int, true], 0), isnull(input[1, int, true]), coalesce(input[2, int, true], 0), isnull(input[2, int, true])),false), [id=#191]
               :                    :     :                                :     +- *(5) Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :                                :        +- *(5) BroadcastHashJoin [cs_sold_date_sk#92], [d_date_sk#46], Inner, BuildRight, false
               :                    :     :                                :           :- *(5) Project [cs_sold_date_sk#92, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :                                :           :  +- *(5) BroadcastHashJoin [cs_item_sk#107], [i_item_sk#138], Inner, BuildRight, false
               :                    :     :                                :           :     :- *(5) Project [cs_sold_date_sk#92, cs_item_sk#107]
               :                    :     :                                :           :     :  +- *(5) Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
               :                    :     :                                :           :     :     +- *(5) ColumnarToRow
               :                    :     :                                :           :     :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#92,cs_item_sk#107] Batched: true, DataFilters: [isnotnull(cs_item_sk#107), isnotnull(cs_sold_date_sk#92)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
               :                    :     :                                :           :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#192]
               :                    :     :                                :           :        +- *(3) Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :                                :           :           +- *(3) Filter isnotnull(i_item_sk#138)
               :                    :     :                                :           :              +- *(3) ColumnarToRow
               :                    :     :                                :           :                 +- FileScan parquet default.item[i_item_sk#138,i_brand_id#35,i_class_id#36,i_category_id#37] Batched: true, DataFilters: [isnotnull(i_item_sk#138)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
               :                    :     :                                :           +- ReusedExchange [d_date_sk#46], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#190]
               :                    :     :                                +- BroadcastExchange HashedRelationBroadcastMode(List(coalesce(input[0, int, true], 0), isnull(input[0, int, true]), coalesce(input[1, int, true], 0), isnull(input[1, int, true]), coalesce(input[2, int, true], 0), isnull(input[2, int, true])),false), [id=#193]
               :                    :     :                                   +- *(8) Project [i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :                                      +- *(8) BroadcastHashJoin [ws_sold_date_sk#116], [d_date_sk#46], Inner, BuildRight, false
               :                    :     :                                         :- *(8) Project [ws_sold_date_sk#116, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :     :                                         :  +- *(8) BroadcastHashJoin [ws_item_sk#119], [i_item_sk#138], Inner, BuildRight, false
               :                    :     :                                         :     :- *(8) Project [ws_sold_date_sk#116, ws_item_sk#119]
               :                    :     :                                         :     :  +- *(8) Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
               :                    :     :                                         :     :     +- *(8) ColumnarToRow
               :                    :     :                                         :     :        +- FileScan parquet default.web_sales[ws_sold_date_sk#116,ws_item_sk#119] Batched: true, DataFilters: [isnotnull(ws_item_sk#119), isnotnull(ws_sold_date_sk#116)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
               :                    :     :                                         :     +- ReusedExchange [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#192]
               :                    :     :                                         +- ReusedExchange [d_date_sk#46], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#190]
               :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#194]
               :                    :        +- *(23) BroadcastHashJoin [i_item_sk#138], [ss_item_sk#1], LeftSemi, BuildRight, false
               :                    :           :- *(23) Project [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :           :  +- *(23) Filter isnotnull(i_item_sk#138)
               :                    :           :     +- *(23) ColumnarToRow
               :                    :           :        +- FileScan parquet default.item[i_item_sk#138,i_brand_id#35,i_class_id#36,i_category_id#37] Batched: true, DataFilters: [isnotnull(i_item_sk#138)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
               :                    :           +- ReusedExchange [ss_item_sk#1], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#186]
               :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#195]
               :                       +- *(24) Project [d_date_sk#46]
               :                          +- *(24) Filter ((((isnotnull(d_year#47) AND isnotnull(d_moy#74)) AND (d_year#47 = 2001)) AND (d_moy#74 = 11)) AND isnotnull(d_date_sk#46))
               :                             +- *(24) ColumnarToRow
               :                                +- FileScan parquet default.date_dim[d_date_sk#46,d_year#47,d_moy#74] Batched: true, DataFilters: [isnotnull(d_year#47), isnotnull(d_moy#74), (d_year#47 = 2001), (d_moy#74 = 11), isnotnull(d_date..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :- *(52) Project [sales#19, number_sales#162, channel#18, i_brand_id#35, i_class_id#36, i_category_id#37]
               :  +- *(52) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#12, [id=#177] as decimal(32,6))))
               :     :  +- ReusedSubquery Subquery scalar-subquery#12, [id=#177]
               :     +- *(52) HashAggregate(keys=[i_brand_id#35, i_class_id#36, i_category_id#37], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#18, i_brand_id#35, i_class_id#36, i_category_id#37, sales#19, number_sales#162, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true))#164])
               :        +- Exchange hashpartitioning(i_brand_id#35, i_class_id#36, i_category_id#37, 5), true, [id=#196]
               :           +- *(51) HashAggregate(keys=[i_brand_id#35, i_class_id#36, i_category_id#37], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#90 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#91 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#35, i_class_id#36, i_category_id#37, sum#197, isEmpty#198, count#199])
               :              +- *(51) Project [cs_quantity#90, cs_list_price#91, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                 +- *(51) BroadcastHashJoin [cs_sold_date_sk#92], [d_date_sk#46], Inner, BuildRight, false
               :                    :- *(51) Project [cs_sold_date_sk#92, cs_quantity#90, cs_list_price#91, i_brand_id#35, i_class_id#36, i_category_id#37]
               :                    :  +- *(51) BroadcastHashJoin [cs_item_sk#107], [i_item_sk#138], Inner, BuildRight, false
               :                    :     :- *(51) BroadcastHashJoin [cs_item_sk#107], [ss_item_sk#1], LeftSemi, BuildRight, false
               :                    :     :  :- *(51) Project [cs_sold_date_sk#92, cs_item_sk#107, cs_quantity#90, cs_list_price#91]
               :                    :     :  :  +- *(51) Filter (isnotnull(cs_item_sk#107) AND isnotnull(cs_sold_date_sk#92))
               :                    :     :  :     +- *(51) ColumnarToRow
               :                    :     :  :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#92,cs_item_sk#107,cs_quantity#90,cs_list_price#91] Batched: true, DataFilters: [isnotnull(cs_item_sk#107), isnotnull(cs_sold_date_sk#92)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
               :                    :     :  +- ReusedExchange [ss_item_sk#1], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#186]
               :                    :     +- ReusedExchange [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#194]
               :                    +- ReusedExchange [d_date_sk#46], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#195]
               +- *(78) Project [sales#24, number_sales#170, channel#23, i_brand_id#35, i_class_id#36, i_category_id#37]
                  +- *(78) Filter (isnotnull(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172) AND (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172 as decimal(32,6)) > cast(ReusedSubquery Subquery scalar-subquery#12, [id=#177] as decimal(32,6))))
                     :  +- ReusedSubquery Subquery scalar-subquery#12, [id=#177]
                     +- *(78) HashAggregate(keys=[i_brand_id#35, i_class_id#36, i_category_id#37], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[channel#23, i_brand_id#35, i_class_id#36, i_category_id#37, sales#24, number_sales#170, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true))#172])
                        +- Exchange hashpartitioning(i_brand_id#35, i_class_id#36, i_category_id#37, 5), true, [id=#200]
                           +- *(77) HashAggregate(keys=[i_brand_id#35, i_class_id#36, i_category_id#37], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#114 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#115 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#35, i_class_id#36, i_category_id#37, sum#201, isEmpty#202, count#203])
                              +- *(77) Project [ws_quantity#114, ws_list_price#115, i_brand_id#35, i_class_id#36, i_category_id#37]
                                 +- *(77) BroadcastHashJoin [ws_sold_date_sk#116], [d_date_sk#46], Inner, BuildRight, false
                                    :- *(77) Project [ws_sold_date_sk#116, ws_quantity#114, ws_list_price#115, i_brand_id#35, i_class_id#36, i_category_id#37]
                                    :  +- *(77) BroadcastHashJoin [ws_item_sk#119], [i_item_sk#138], Inner, BuildRight, false
                                    :     :- *(77) BroadcastHashJoin [ws_item_sk#119], [ss_item_sk#1], LeftSemi, BuildRight, false
                                    :     :  :- *(77) Project [ws_sold_date_sk#116, ws_item_sk#119, ws_quantity#114, ws_list_price#115]
                                    :     :  :  +- *(77) Filter (isnotnull(ws_item_sk#119) AND isnotnull(ws_sold_date_sk#116))
                                    :     :  :     +- *(77) ColumnarToRow
                                    :     :  :        +- FileScan parquet default.web_sales[ws_sold_date_sk#116,ws_item_sk#119,ws_quantity#114,ws_list_price#115] Batched: true, DataFilters: [isnotnull(ws_item_sk#119), isnotnull(ws_sold_date_sk#116)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                    :     :  +- ReusedExchange [ss_item_sk#1], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#186]
                                    :     +- ReusedExchange [i_item_sk#138, i_brand_id#35, i_class_id#36, i_category_id#37], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#194]
                                    +- ReusedExchange [d_date_sk#46], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#195]
