== Parsed Logical Plan ==
'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort ['ca_country ASC NULLS FIRST, 'ca_state ASC NULLS FIRST, 'ca_county ASC NULLS FIRST, 'i_item_id ASC NULLS FIRST], true
      +- 'Aggregate ['ROLLUP('i_item_id, 'ca_country, 'ca_state, 'ca_county)], ['i_item_id, 'ca_country, 'ca_state, 'ca_county, 'avg(cast('cs_quantity as decimal(12,2))) AS agg1#1, 'avg(cast('cs_list_price as decimal(12,2))) AS agg2#2, 'avg(cast('cs_coupon_amt as decimal(12,2))) AS agg3#3, 'avg(cast('cs_sales_price as decimal(12,2))) AS agg4#4, 'avg(cast('cs_net_profit as decimal(12,2))) AS agg5#5, 'avg(cast('c_birth_year as decimal(12,2))) AS agg6#6, 'avg(cast('cd1.cd_dep_count as decimal(12,2))) AS agg7#7]
         +- 'Filter ((((('cs_sold_date_sk = 'd_date_sk) AND ('cs_item_sk = 'i_item_sk)) AND ('cs_bill_cdemo_sk = 'cd1.cd_demo_sk)) AND ((('cs_bill_customer_sk = 'c_customer_sk) AND ('cd1.cd_gender = F)) AND ('cd1.cd_education_status = Unknown))) AND (((('c_current_cdemo_sk = 'cd2.cd_demo_sk) AND ('c_current_addr_sk = 'ca_address_sk)) AND 'c_birth_month IN (1,6,8,9,12,2)) AND (('d_year = 1998) AND 'ca_state IN (MS,IN,ND,OK,NM,VA,MS))))
            +- 'Join Inner
               :- 'Join Inner
               :  :- 'Join Inner
               :  :  :- 'Join Inner
               :  :  :  :- 'Join Inner
               :  :  :  :  :- 'Join Inner
               :  :  :  :  :  :- 'UnresolvedRelation [catalog_sales]
               :  :  :  :  :  +- 'SubqueryAlias cd1
               :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
               :  :  :  :  +- 'SubqueryAlias cd2
               :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
               :  :  :  +- 'UnresolvedRelation [customer]
               :  :  +- 'UnresolvedRelation [customer_address]
               :  +- 'UnresolvedRelation [date_dim]
               +- 'UnresolvedRelation [item]

== Analyzed Logical Plan ==
i_item_id: string, ca_country: string, ca_state: string, ca_county: string, agg1: decimal(16,6), agg2: decimal(16,6), agg3: decimal(16,6), agg4: decimal(16,6), agg5: decimal(16,6), agg6: decimal(16,6), agg7: decimal(16,6)
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#8 ASC NULLS FIRST, ca_state#9 ASC NULLS FIRST, ca_county#10 ASC NULLS FIRST, i_item_id#11 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12], [i_item_id#11, ca_country#8, ca_state#9, ca_county#10, avg(cast(cs_quantity#13 as decimal(12,2))) AS agg1#1, avg(cast(cs_list_price#14 as decimal(12,2))) AS agg2#2, avg(cast(cs_coupon_amt#15 as decimal(12,2))) AS agg3#3, avg(cast(cs_sales_price#16 as decimal(12,2))) AS agg4#4, avg(cast(cs_net_profit#17 as decimal(12,2))) AS agg5#5, avg(cast(c_birth_year#18 as decimal(12,2))) AS agg6#6, avg(cast(cd_dep_count#19 as decimal(12,2))) AS agg7#7]
         +- Expand [List(cs_sold_date_sk#20, cs_sold_time_sk#21, cs_ship_date_sk#22, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_bill_hdemo_sk#25, cs_bill_addr_sk#26, cs_ship_customer_sk#27, cs_ship_cdemo_sk#28, cs_ship_hdemo_sk#29, cs_ship_addr_sk#30, cs_call_center_sk#31, cs_catalog_page_sk#32, cs_ship_mode_sk#33, cs_warehouse_sk#34, cs_item_sk#35, cs_promo_sk#36, cs_order_number#37, cs_quantity#13, cs_wholesale_cost#38, cs_list_price#14, cs_sales_price#16, cs_ext_discount_amt#39, cs_ext_sales_price#40, cs_ext_wholesale_cost#41, cs_ext_list_price#42, cs_ext_tax#43, cs_coupon_amt#15, cs_ext_ship_cost#44, cs_net_paid#45, cs_net_paid_inc_tax#46, cs_net_paid_inc_ship#47, cs_net_paid_inc_ship_tax#48, cs_net_profit#17, cd_demo_sk#49, cd_gender#50, cd_marital_status#51, cd_education_status#52, cd_purchase_estimate#53, cd_credit_rating#54, cd_dep_count#19, cd_dep_employed_count#55, cd_dep_college_count#56, cd_demo_sk#57, cd_gender#58, cd_marital_status#59, cd_education_status#60, cd_purchase_estimate#61, cd_credit_rating#62, cd_dep_count#63, cd_dep_employed_count#64, cd_dep_college_count#65, c_customer_sk#66, c_customer_id#67, c_current_cdemo_sk#68, c_current_hdemo_sk#69, c_current_addr_sk#70, c_first_shipto_date_sk#71, c_first_sales_date_sk#72, c_salutation#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_day#77, c_birth_month#78, c_birth_year#18, c_birth_country#79, c_login#80, c_email_address#81, c_last_review_date#82, ca_address_sk#83, ca_address_id#84, ca_street_number#85, ca_street_name#86, ca_street_type#87, ca_suite_number#88, ca_city#89, ca_county#90, ca_state#91, ca_zip#92, ca_country#93, ca_gmt_offset#94, ca_location_type#95, d_date_sk#96, d_date_id#97, d_date#98, d_month_seq#99, d_week_seq#100, d_quarter_seq#101, d_year#102, d_dow#103, d_moy#104, d_dom#105, d_qoy#106, d_fy_year#107, d_fy_quarter_seq#108, d_fy_week_seq#109, d_day_name#110, d_quarter_name#111, d_holiday#112, d_weekend#113, d_following_holiday#114, d_first_dom#115, d_last_dom#116, d_same_day_ly#117, d_same_day_lq#118, d_current_day#119, d_current_week#120, d_current_month#121, d_current_quarter#122, d_current_year#123, i_item_sk#124, i_item_id#125, i_rec_start_date#126, i_rec_end_date#127, i_item_desc#128, i_current_price#129, i_wholesale_cost#130, i_brand_id#131, i_brand#132, i_class_id#133, i_class#134, i_category_id#135, i_category#136, i_manufact_id#137, i_manufact#138, i_size#139, i_formulation#140, i_color#141, i_units#142, i_container#143, i_manager_id#144, i_product_name#145, i_item_id#146, ca_country#147, ca_state#148, ca_county#149, 0), List(cs_sold_date_sk#20, cs_sold_time_sk#21, cs_ship_date_sk#22, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_bill_hdemo_sk#25, cs_bill_addr_sk#26, cs_ship_customer_sk#27, cs_ship_cdemo_sk#28, cs_ship_hdemo_sk#29, cs_ship_addr_sk#30, cs_call_center_sk#31, cs_catalog_page_sk#32, cs_ship_mode_sk#33, cs_warehouse_sk#34, cs_item_sk#35, cs_promo_sk#36, cs_order_number#37, cs_quantity#13, cs_wholesale_cost#38, cs_list_price#14, cs_sales_price#16, cs_ext_discount_amt#39, cs_ext_sales_price#40, cs_ext_wholesale_cost#41, cs_ext_list_price#42, cs_ext_tax#43, cs_coupon_amt#15, cs_ext_ship_cost#44, cs_net_paid#45, cs_net_paid_inc_tax#46, cs_net_paid_inc_ship#47, cs_net_paid_inc_ship_tax#48, cs_net_profit#17, cd_demo_sk#49, cd_gender#50, cd_marital_status#51, cd_education_status#52, cd_purchase_estimate#53, cd_credit_rating#54, cd_dep_count#19, cd_dep_employed_count#55, cd_dep_college_count#56, cd_demo_sk#57, cd_gender#58, cd_marital_status#59, cd_education_status#60, cd_purchase_estimate#61, cd_credit_rating#62, cd_dep_count#63, cd_dep_employed_count#64, cd_dep_college_count#65, c_customer_sk#66, c_customer_id#67, c_current_cdemo_sk#68, c_current_hdemo_sk#69, c_current_addr_sk#70, c_first_shipto_date_sk#71, c_first_sales_date_sk#72, c_salutation#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_day#77, c_birth_month#78, c_birth_year#18, c_birth_country#79, c_login#80, c_email_address#81, c_last_review_date#82, ca_address_sk#83, ca_address_id#84, ca_street_number#85, ca_street_name#86, ca_street_type#87, ca_suite_number#88, ca_city#89, ca_county#90, ca_state#91, ca_zip#92, ca_country#93, ca_gmt_offset#94, ca_location_type#95, d_date_sk#96, d_date_id#97, d_date#98, d_month_seq#99, d_week_seq#100, d_quarter_seq#101, d_year#102, d_dow#103, d_moy#104, d_dom#105, d_qoy#106, d_fy_year#107, d_fy_quarter_seq#108, d_fy_week_seq#109, d_day_name#110, d_quarter_name#111, d_holiday#112, d_weekend#113, d_following_holiday#114, d_first_dom#115, d_last_dom#116, d_same_day_ly#117, d_same_day_lq#118, d_current_day#119, d_current_week#120, d_current_month#121, d_current_quarter#122, d_current_year#123, i_item_sk#124, i_item_id#125, i_rec_start_date#126, i_rec_end_date#127, i_item_desc#128, i_current_price#129, i_wholesale_cost#130, i_brand_id#131, i_brand#132, i_class_id#133, i_class#134, i_category_id#135, i_category#136, i_manufact_id#137, i_manufact#138, i_size#139, i_formulation#140, i_color#141, i_units#142, i_container#143, i_manager_id#144, i_product_name#145, i_item_id#146, ca_country#147, ca_state#148, null, 1), List(cs_sold_date_sk#20, cs_sold_time_sk#21, cs_ship_date_sk#22, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_bill_hdemo_sk#25, cs_bill_addr_sk#26, cs_ship_customer_sk#27, cs_ship_cdemo_sk#28, cs_ship_hdemo_sk#29, cs_ship_addr_sk#30, cs_call_center_sk#31, cs_catalog_page_sk#32, cs_ship_mode_sk#33, cs_warehouse_sk#34, cs_item_sk#35, cs_promo_sk#36, cs_order_number#37, cs_quantity#13, cs_wholesale_cost#38, cs_list_price#14, cs_sales_price#16, cs_ext_discount_amt#39, cs_ext_sales_price#40, cs_ext_wholesale_cost#41, cs_ext_list_price#42, cs_ext_tax#43, cs_coupon_amt#15, cs_ext_ship_cost#44, cs_net_paid#45, cs_net_paid_inc_tax#46, cs_net_paid_inc_ship#47, cs_net_paid_inc_ship_tax#48, cs_net_profit#17, cd_demo_sk#49, cd_gender#50, cd_marital_status#51, cd_education_status#52, cd_purchase_estimate#53, cd_credit_rating#54, cd_dep_count#19, cd_dep_employed_count#55, cd_dep_college_count#56, cd_demo_sk#57, cd_gender#58, cd_marital_status#59, cd_education_status#60, cd_purchase_estimate#61, cd_credit_rating#62, cd_dep_count#63, cd_dep_employed_count#64, cd_dep_college_count#65, c_customer_sk#66, c_customer_id#67, c_current_cdemo_sk#68, c_current_hdemo_sk#69, c_current_addr_sk#70, c_first_shipto_date_sk#71, c_first_sales_date_sk#72, c_salutation#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_day#77, c_birth_month#78, c_birth_year#18, c_birth_country#79, c_login#80, c_email_address#81, c_last_review_date#82, ca_address_sk#83, ca_address_id#84, ca_street_number#85, ca_street_name#86, ca_street_type#87, ca_suite_number#88, ca_city#89, ca_county#90, ca_state#91, ca_zip#92, ca_country#93, ca_gmt_offset#94, ca_location_type#95, d_date_sk#96, d_date_id#97, d_date#98, d_month_seq#99, d_week_seq#100, d_quarter_seq#101, d_year#102, d_dow#103, d_moy#104, d_dom#105, d_qoy#106, d_fy_year#107, d_fy_quarter_seq#108, d_fy_week_seq#109, d_day_name#110, d_quarter_name#111, d_holiday#112, d_weekend#113, d_following_holiday#114, d_first_dom#115, d_last_dom#116, d_same_day_ly#117, d_same_day_lq#118, d_current_day#119, d_current_week#120, d_current_month#121, d_current_quarter#122, d_current_year#123, i_item_sk#124, i_item_id#125, i_rec_start_date#126, i_rec_end_date#127, i_item_desc#128, i_current_price#129, i_wholesale_cost#130, i_brand_id#131, i_brand#132, i_class_id#133, i_class#134, i_category_id#135, i_category#136, i_manufact_id#137, i_manufact#138, i_size#139, i_formulation#140, i_color#141, i_units#142, i_container#143, i_manager_id#144, i_product_name#145, i_item_id#146, ca_country#147, null, null, 3), List(cs_sold_date_sk#20, cs_sold_time_sk#21, cs_ship_date_sk#22, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_bill_hdemo_sk#25, cs_bill_addr_sk#26, cs_ship_customer_sk#27, cs_ship_cdemo_sk#28, cs_ship_hdemo_sk#29, cs_ship_addr_sk#30, cs_call_center_sk#31, cs_catalog_page_sk#32, cs_ship_mode_sk#33, cs_warehouse_sk#34, cs_item_sk#35, cs_promo_sk#36, cs_order_number#37, cs_quantity#13, cs_wholesale_cost#38, cs_list_price#14, cs_sales_price#16, cs_ext_discount_amt#39, cs_ext_sales_price#40, cs_ext_wholesale_cost#41, cs_ext_list_price#42, cs_ext_tax#43, cs_coupon_amt#15, cs_ext_ship_cost#44, cs_net_paid#45, cs_net_paid_inc_tax#46, cs_net_paid_inc_ship#47, cs_net_paid_inc_ship_tax#48, cs_net_profit#17, cd_demo_sk#49, cd_gender#50, cd_marital_status#51, cd_education_status#52, cd_purchase_estimate#53, cd_credit_rating#54, cd_dep_count#19, cd_dep_employed_count#55, cd_dep_college_count#56, cd_demo_sk#57, cd_gender#58, cd_marital_status#59, cd_education_status#60, cd_purchase_estimate#61, cd_credit_rating#62, cd_dep_count#63, cd_dep_employed_count#64, cd_dep_college_count#65, c_customer_sk#66, c_customer_id#67, c_current_cdemo_sk#68, c_current_hdemo_sk#69, c_current_addr_sk#70, c_first_shipto_date_sk#71, c_first_sales_date_sk#72, c_salutation#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_day#77, c_birth_month#78, c_birth_year#18, c_birth_country#79, c_login#80, c_email_address#81, c_last_review_date#82, ca_address_sk#83, ca_address_id#84, ca_street_number#85, ca_street_name#86, ca_street_type#87, ca_suite_number#88, ca_city#89, ca_county#90, ca_state#91, ca_zip#92, ca_country#93, ca_gmt_offset#94, ca_location_type#95, d_date_sk#96, d_date_id#97, d_date#98, d_month_seq#99, d_week_seq#100, d_quarter_seq#101, d_year#102, d_dow#103, d_moy#104, d_dom#105, d_qoy#106, d_fy_year#107, d_fy_quarter_seq#108, d_fy_week_seq#109, d_day_name#110, d_quarter_name#111, d_holiday#112, d_weekend#113, d_following_holiday#114, d_first_dom#115, d_last_dom#116, d_same_day_ly#117, d_same_day_lq#118, d_current_day#119, d_current_week#120, d_current_month#121, d_current_quarter#122, d_current_year#123, i_item_sk#124, i_item_id#125, i_rec_start_date#126, i_rec_end_date#127, i_item_desc#128, i_current_price#129, i_wholesale_cost#130, i_brand_id#131, i_brand#132, i_class_id#133, i_class#134, i_category_id#135, i_category#136, i_manufact_id#137, i_manufact#138, i_size#139, i_formulation#140, i_color#141, i_units#142, i_container#143, i_manager_id#144, i_product_name#145, i_item_id#146, null, null, null, 7), List(cs_sold_date_sk#20, cs_sold_time_sk#21, cs_ship_date_sk#22, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_bill_hdemo_sk#25, cs_bill_addr_sk#26, cs_ship_customer_sk#27, cs_ship_cdemo_sk#28, cs_ship_hdemo_sk#29, cs_ship_addr_sk#30, cs_call_center_sk#31, cs_catalog_page_sk#32, cs_ship_mode_sk#33, cs_warehouse_sk#34, cs_item_sk#35, cs_promo_sk#36, cs_order_number#37, cs_quantity#13, cs_wholesale_cost#38, cs_list_price#14, cs_sales_price#16, cs_ext_discount_amt#39, cs_ext_sales_price#40, cs_ext_wholesale_cost#41, cs_ext_list_price#42, cs_ext_tax#43, cs_coupon_amt#15, cs_ext_ship_cost#44, cs_net_paid#45, cs_net_paid_inc_tax#46, cs_net_paid_inc_ship#47, cs_net_paid_inc_ship_tax#48, cs_net_profit#17, cd_demo_sk#49, cd_gender#50, cd_marital_status#51, cd_education_status#52, cd_purchase_estimate#53, cd_credit_rating#54, cd_dep_count#19, cd_dep_employed_count#55, cd_dep_college_count#56, cd_demo_sk#57, cd_gender#58, cd_marital_status#59, cd_education_status#60, cd_purchase_estimate#61, cd_credit_rating#62, cd_dep_count#63, cd_dep_employed_count#64, cd_dep_college_count#65, c_customer_sk#66, c_customer_id#67, c_current_cdemo_sk#68, c_current_hdemo_sk#69, c_current_addr_sk#70, c_first_shipto_date_sk#71, c_first_sales_date_sk#72, c_salutation#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_day#77, c_birth_month#78, c_birth_year#18, c_birth_country#79, c_login#80, c_email_address#81, c_last_review_date#82, ca_address_sk#83, ca_address_id#84, ca_street_number#85, ca_street_name#86, ca_street_type#87, ca_suite_number#88, ca_city#89, ca_county#90, ca_state#91, ca_zip#92, ca_country#93, ca_gmt_offset#94, ca_location_type#95, d_date_sk#96, d_date_id#97, d_date#98, d_month_seq#99, d_week_seq#100, d_quarter_seq#101, d_year#102, d_dow#103, d_moy#104, d_dom#105, d_qoy#106, d_fy_year#107, d_fy_quarter_seq#108, d_fy_week_seq#109, d_day_name#110, d_quarter_name#111, d_holiday#112, d_weekend#113, d_following_holiday#114, d_first_dom#115, d_last_dom#116, d_same_day_ly#117, d_same_day_lq#118, d_current_day#119, d_current_week#120, d_current_month#121, d_current_quarter#122, d_current_year#123, i_item_sk#124, i_item_id#125, i_rec_start_date#126, i_rec_end_date#127, i_item_desc#128, i_current_price#129, i_wholesale_cost#130, i_brand_id#131, i_brand#132, i_class_id#133, i_class#134, i_category_id#135, i_category#136, i_manufact_id#137, i_manufact#138, i_size#139, i_formulation#140, i_color#141, i_units#142, i_container#143, i_manager_id#144, i_product_name#145, null, null, null, null, 15)], [cs_sold_date_sk#20, cs_sold_time_sk#21, cs_ship_date_sk#22, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_bill_hdemo_sk#25, cs_bill_addr_sk#26, cs_ship_customer_sk#27, cs_ship_cdemo_sk#28, cs_ship_hdemo_sk#29, cs_ship_addr_sk#30, cs_call_center_sk#31, cs_catalog_page_sk#32, cs_ship_mode_sk#33, cs_warehouse_sk#34, cs_item_sk#35, cs_promo_sk#36, cs_order_number#37, cs_quantity#13, cs_wholesale_cost#38, cs_list_price#14, cs_sales_price#16, cs_ext_discount_amt#39, cs_ext_sales_price#40, cs_ext_wholesale_cost#41, cs_ext_list_price#42, cs_ext_tax#43, cs_coupon_amt#15, cs_ext_ship_cost#44, cs_net_paid#45, cs_net_paid_inc_tax#46, cs_net_paid_inc_ship#47, cs_net_paid_inc_ship_tax#48, cs_net_profit#17, cd_demo_sk#49, cd_gender#50, cd_marital_status#51, cd_education_status#52, cd_purchase_estimate#53, cd_credit_rating#54, cd_dep_count#19, cd_dep_employed_count#55, cd_dep_college_count#56, cd_demo_sk#57, cd_gender#58, cd_marital_status#59, cd_education_status#60, cd_purchase_estimate#61, cd_credit_rating#62, cd_dep_count#63, cd_dep_employed_count#64, cd_dep_college_count#65, c_customer_sk#66, c_customer_id#67, c_current_cdemo_sk#68, c_current_hdemo_sk#69, c_current_addr_sk#70, c_first_shipto_date_sk#71, c_first_sales_date_sk#72, c_salutation#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_day#77, c_birth_month#78, c_birth_year#18, c_birth_country#79, c_login#80, c_email_address#81, c_last_review_date#82, ca_address_sk#83, ca_address_id#84, ca_street_number#85, ca_street_name#86, ca_street_type#87, ca_suite_number#88, ca_city#89, ca_county#90, ca_state#91, ca_zip#92, ca_country#93, ca_gmt_offset#94, ca_location_type#95, d_date_sk#96, d_date_id#97, d_date#98, d_month_seq#99, d_week_seq#100, d_quarter_seq#101, d_year#102, d_dow#103, d_moy#104, d_dom#105, d_qoy#106, d_fy_year#107, d_fy_quarter_seq#108, d_fy_week_seq#109, d_day_name#110, d_quarter_name#111, ... 39 more fields]
            +- Project [cs_sold_date_sk#20, cs_sold_time_sk#21, cs_ship_date_sk#22, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_bill_hdemo_sk#25, cs_bill_addr_sk#26, cs_ship_customer_sk#27, cs_ship_cdemo_sk#28, cs_ship_hdemo_sk#29, cs_ship_addr_sk#30, cs_call_center_sk#31, cs_catalog_page_sk#32, cs_ship_mode_sk#33, cs_warehouse_sk#34, cs_item_sk#35, cs_promo_sk#36, cs_order_number#37, cs_quantity#13, cs_wholesale_cost#38, cs_list_price#14, cs_sales_price#16, cs_ext_discount_amt#39, cs_ext_sales_price#40, cs_ext_wholesale_cost#41, cs_ext_list_price#42, cs_ext_tax#43, cs_coupon_amt#15, cs_ext_ship_cost#44, cs_net_paid#45, cs_net_paid_inc_tax#46, cs_net_paid_inc_ship#47, cs_net_paid_inc_ship_tax#48, cs_net_profit#17, cd_demo_sk#49, cd_gender#50, cd_marital_status#51, cd_education_status#52, cd_purchase_estimate#53, cd_credit_rating#54, cd_dep_count#19, cd_dep_employed_count#55, cd_dep_college_count#56, cd_demo_sk#57, cd_gender#58, cd_marital_status#59, cd_education_status#60, cd_purchase_estimate#61, cd_credit_rating#62, cd_dep_count#63, cd_dep_employed_count#64, cd_dep_college_count#65, c_customer_sk#66, c_customer_id#67, c_current_cdemo_sk#68, c_current_hdemo_sk#69, c_current_addr_sk#70, c_first_shipto_date_sk#71, c_first_sales_date_sk#72, c_salutation#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_day#77, c_birth_month#78, c_birth_year#18, c_birth_country#79, c_login#80, c_email_address#81, c_last_review_date#82, ca_address_sk#83, ca_address_id#84, ca_street_number#85, ca_street_name#86, ca_street_type#87, ca_suite_number#88, ca_city#89, ca_county#90, ca_state#91, ca_zip#92, ca_country#93, ca_gmt_offset#94, ca_location_type#95, d_date_sk#96, d_date_id#97, d_date#98, d_month_seq#99, d_week_seq#100, d_quarter_seq#101, d_year#102, d_dow#103, d_moy#104, d_dom#105, d_qoy#106, d_fy_year#107, d_fy_quarter_seq#108, d_fy_week_seq#109, d_day_name#110, d_quarter_name#111, ... 38 more fields]
               +- Filter (((((cs_sold_date_sk#20 = d_date_sk#96) AND (cs_item_sk#35 = i_item_sk#124)) AND (cs_bill_cdemo_sk#24 = cd_demo_sk#49)) AND (((cs_bill_customer_sk#23 = c_customer_sk#66) AND (cd_gender#50 = F)) AND (cd_education_status#52 = Unknown))) AND ((((c_current_cdemo_sk#68 = cd_demo_sk#57) AND (c_current_addr_sk#70 = ca_address_sk#83)) AND c_birth_month#78 IN (1,6,8,9,12,2)) AND ((d_year#102 = 1998) AND ca_state#91 IN (MS,IN,ND,OK,NM,VA,MS))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- Join Inner
                     :  :  :  :  :  :- SubqueryAlias spark_catalog.default.catalog_sales
                     :  :  :  :  :  :  +- Relation[cs_sold_date_sk#20,cs_sold_time_sk#21,cs_ship_date_sk#22,cs_bill_customer_sk#23,cs_bill_cdemo_sk#24,cs_bill_hdemo_sk#25,cs_bill_addr_sk#26,cs_ship_customer_sk#27,cs_ship_cdemo_sk#28,cs_ship_hdemo_sk#29,cs_ship_addr_sk#30,cs_call_center_sk#31,cs_catalog_page_sk#32,cs_ship_mode_sk#33,cs_warehouse_sk#34,cs_item_sk#35,cs_promo_sk#36,cs_order_number#37,cs_quantity#13,cs_wholesale_cost#38,cs_list_price#14,cs_sales_price#16,cs_ext_discount_amt#39,cs_ext_sales_price#40,cs_ext_wholesale_cost#41,cs_ext_list_price#42,cs_ext_tax#43,cs_coupon_amt#15,cs_ext_ship_cost#44,cs_net_paid#45,cs_net_paid_inc_tax#46,cs_net_paid_inc_ship#47,cs_net_paid_inc_ship_tax#48,cs_net_profit#17] parquet
                     :  :  :  :  :  +- SubqueryAlias cd1
                     :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                     :  :  :  :  :        +- Relation[cd_demo_sk#49,cd_gender#50,cd_marital_status#51,cd_education_status#52,cd_purchase_estimate#53,cd_credit_rating#54,cd_dep_count#19,cd_dep_employed_count#55,cd_dep_college_count#56] parquet
                     :  :  :  :  +- SubqueryAlias cd2
                     :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                     :  :  :  :        +- Relation[cd_demo_sk#57,cd_gender#58,cd_marital_status#59,cd_education_status#60,cd_purchase_estimate#61,cd_credit_rating#62,cd_dep_count#63,cd_dep_employed_count#64,cd_dep_college_count#65] parquet
                     :  :  :  +- SubqueryAlias spark_catalog.default.customer
                     :  :  :     +- Relation[c_customer_sk#66,c_customer_id#67,c_current_cdemo_sk#68,c_current_hdemo_sk#69,c_current_addr_sk#70,c_first_shipto_date_sk#71,c_first_sales_date_sk#72,c_salutation#73,c_first_name#74,c_last_name#75,c_preferred_cust_flag#76,c_birth_day#77,c_birth_month#78,c_birth_year#18,c_birth_country#79,c_login#80,c_email_address#81,c_last_review_date#82] parquet
                     :  :  +- SubqueryAlias spark_catalog.default.customer_address
                     :  :     +- Relation[ca_address_sk#83,ca_address_id#84,ca_street_number#85,ca_street_name#86,ca_street_type#87,ca_suite_number#88,ca_city#89,ca_county#90,ca_state#91,ca_zip#92,ca_country#93,ca_gmt_offset#94,ca_location_type#95] parquet
                     :  +- SubqueryAlias spark_catalog.default.date_dim
                     :     +- Relation[d_date_sk#96,d_date_id#97,d_date#98,d_month_seq#99,d_week_seq#100,d_quarter_seq#101,d_year#102,d_dow#103,d_moy#104,d_dom#105,d_qoy#106,d_fy_year#107,d_fy_quarter_seq#108,d_fy_week_seq#109,d_day_name#110,d_quarter_name#111,d_holiday#112,d_weekend#113,d_following_holiday#114,d_first_dom#115,d_last_dom#116,d_same_day_ly#117,d_same_day_lq#118,d_current_day#119,d_current_week#120,d_current_month#121,d_current_quarter#122,d_current_year#123] parquet
                     +- SubqueryAlias spark_catalog.default.item
                        +- Relation[i_item_sk#124,i_item_id#125,i_rec_start_date#126,i_rec_end_date#127,i_item_desc#128,i_current_price#129,i_wholesale_cost#130,i_brand_id#131,i_brand#132,i_class_id#133,i_class#134,i_category_id#135,i_category#136,i_manufact_id#137,i_manufact#138,i_size#139,i_formulation#140,i_color#141,i_units#142,i_container#143,i_manager_id#144,i_product_name#145] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#8 ASC NULLS FIRST, ca_state#9 ASC NULLS FIRST, ca_county#10 ASC NULLS FIRST, i_item_id#11 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12], [i_item_id#11, ca_country#8, ca_state#9, ca_county#10, avg(cast(cs_quantity#13 as decimal(12,2))) AS agg1#1, avg(cast(cs_list_price#14 as decimal(12,2))) AS agg2#2, avg(cast(cs_coupon_amt#15 as decimal(12,2))) AS agg3#3, avg(cast(cs_sales_price#16 as decimal(12,2))) AS agg4#4, avg(cast(cs_net_profit#17 as decimal(12,2))) AS agg5#5, avg(cast(c_birth_year#18 as decimal(12,2))) AS agg6#6, avg(cast(cd_dep_count#19 as decimal(12,2))) AS agg7#7]
         +- Expand [List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, ca_state#91, ca_county#90, 0), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, ca_state#91, null, 1), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, null, null, 3), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, null, null, null, 7), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, null, null, null, null, 15)], [cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12]
            +- Project [cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, ca_state#91, ca_county#90]
               +- Join Inner, (cs_item_sk#35 = i_item_sk#124)
                  :- Project [cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, ca_county#90, ca_state#91, ca_country#93]
                  :  +- Join Inner, (cs_sold_date_sk#20 = d_date_sk#96)
                  :     :- Project [cs_sold_date_sk#20, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, ca_county#90, ca_state#91, ca_country#93]
                  :     :  +- Join Inner, (c_current_addr_sk#70 = ca_address_sk#83)
                  :     :     :- Project [cs_sold_date_sk#20, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_current_addr_sk#70, c_birth_year#18]
                  :     :     :  +- Join Inner, (c_current_cdemo_sk#68 = cd_demo_sk#57)
                  :     :     :     :- Project [cs_sold_date_sk#20, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_current_cdemo_sk#68, c_current_addr_sk#70, c_birth_year#18]
                  :     :     :     :  +- Join Inner, (cs_bill_customer_sk#23 = c_customer_sk#66)
                  :     :     :     :     :- Project [cs_sold_date_sk#20, cs_bill_customer_sk#23, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19]
                  :     :     :     :     :  +- Join Inner, (cs_bill_cdemo_sk#24 = cd_demo_sk#49)
                  :     :     :     :     :     :- Project [cs_sold_date_sk#20, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17]
                  :     :     :     :     :     :  +- Filter (((isnotnull(cs_bill_cdemo_sk#24) AND isnotnull(cs_bill_customer_sk#23)) AND isnotnull(cs_sold_date_sk#20)) AND isnotnull(cs_item_sk#35))
                  :     :     :     :     :     :     +- Relation[cs_sold_date_sk#20,cs_sold_time_sk#21,cs_ship_date_sk#22,cs_bill_customer_sk#23,cs_bill_cdemo_sk#24,cs_bill_hdemo_sk#25,cs_bill_addr_sk#26,cs_ship_customer_sk#27,cs_ship_cdemo_sk#28,cs_ship_hdemo_sk#29,cs_ship_addr_sk#30,cs_call_center_sk#31,cs_catalog_page_sk#32,cs_ship_mode_sk#33,cs_warehouse_sk#34,cs_item_sk#35,cs_promo_sk#36,cs_order_number#37,cs_quantity#13,cs_wholesale_cost#38,cs_list_price#14,cs_sales_price#16,cs_ext_discount_amt#39,cs_ext_sales_price#40,cs_ext_wholesale_cost#41,cs_ext_list_price#42,cs_ext_tax#43,cs_coupon_amt#15,cs_ext_ship_cost#44,cs_net_paid#45,cs_net_paid_inc_tax#46,cs_net_paid_inc_ship#47,cs_net_paid_inc_ship_tax#48,cs_net_profit#17] parquet
                  :     :     :     :     :     +- Project [cd_demo_sk#49, cd_dep_count#19]
                  :     :     :     :     :        +- Filter ((((isnotnull(cd_gender#50) AND isnotnull(cd_education_status#52)) AND (cd_gender#50 = F)) AND (cd_education_status#52 = Unknown)) AND isnotnull(cd_demo_sk#49))
                  :     :     :     :     :           +- Relation[cd_demo_sk#49,cd_gender#50,cd_marital_status#51,cd_education_status#52,cd_purchase_estimate#53,cd_credit_rating#54,cd_dep_count#19,cd_dep_employed_count#55,cd_dep_college_count#56] parquet
                  :     :     :     :     +- Project [c_customer_sk#66, c_current_cdemo_sk#68, c_current_addr_sk#70, c_birth_year#18]
                  :     :     :     :        +- Filter (((c_birth_month#78 IN (1,6,8,9,12,2) AND isnotnull(c_customer_sk#66)) AND isnotnull(c_current_cdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
                  :     :     :     :           +- Relation[c_customer_sk#66,c_customer_id#67,c_current_cdemo_sk#68,c_current_hdemo_sk#69,c_current_addr_sk#70,c_first_shipto_date_sk#71,c_first_sales_date_sk#72,c_salutation#73,c_first_name#74,c_last_name#75,c_preferred_cust_flag#76,c_birth_day#77,c_birth_month#78,c_birth_year#18,c_birth_country#79,c_login#80,c_email_address#81,c_last_review_date#82] parquet
                  :     :     :     +- Project [cd_demo_sk#57]
                  :     :     :        +- Filter isnotnull(cd_demo_sk#57)
                  :     :     :           +- Relation[cd_demo_sk#57,cd_gender#58,cd_marital_status#59,cd_education_status#60,cd_purchase_estimate#61,cd_credit_rating#62,cd_dep_count#63,cd_dep_employed_count#64,cd_dep_college_count#65] parquet
                  :     :     +- Project [ca_address_sk#83, ca_county#90, ca_state#91, ca_country#93]
                  :     :        +- Filter (ca_state#91 IN (MS,IN,ND,OK,NM,VA) AND isnotnull(ca_address_sk#83))
                  :     :           +- Relation[ca_address_sk#83,ca_address_id#84,ca_street_number#85,ca_street_name#86,ca_street_type#87,ca_suite_number#88,ca_city#89,ca_county#90,ca_state#91,ca_zip#92,ca_country#93,ca_gmt_offset#94,ca_location_type#95] parquet
                  :     +- Project [d_date_sk#96]
                  :        +- Filter ((isnotnull(d_year#102) AND (d_year#102 = 1998)) AND isnotnull(d_date_sk#96))
                  :           +- Relation[d_date_sk#96,d_date_id#97,d_date#98,d_month_seq#99,d_week_seq#100,d_quarter_seq#101,d_year#102,d_dow#103,d_moy#104,d_dom#105,d_qoy#106,d_fy_year#107,d_fy_quarter_seq#108,d_fy_week_seq#109,d_day_name#110,d_quarter_name#111,d_holiday#112,d_weekend#113,d_following_holiday#114,d_first_dom#115,d_last_dom#116,d_same_day_ly#117,d_same_day_lq#118,d_current_day#119,d_current_week#120,d_current_month#121,d_current_quarter#122,d_current_year#123] parquet
                  +- Project [i_item_sk#124, i_item_id#125]
                     +- Filter isnotnull(i_item_sk#124)
                        +- Relation[i_item_sk#124,i_item_id#125,i_rec_start_date#126,i_rec_end_date#127,i_item_desc#128,i_current_price#129,i_wholesale_cost#130,i_brand_id#131,i_brand#132,i_class_id#133,i_class#134,i_category_id#135,i_category#136,i_manufact_id#137,i_manufact#138,i_size#139,i_formulation#140,i_color#141,i_units#142,i_container#143,i_manager_id#144,i_product_name#145] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[ca_country#8 ASC NULLS FIRST,ca_state#9 ASC NULLS FIRST,ca_county#10 ASC NULLS FIRST,i_item_id#11 ASC NULLS FIRST], output=[i_item_id#11,ca_country#8,ca_state#9,ca_county#10,agg1#1,agg2#2,agg3#3,agg4#4,agg5#5,agg6#6,agg7#7])
+- *(8) HashAggregate(keys=[i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12], functions=[avg(cast(cs_quantity#13 as decimal(12,2))), avg(cast(cs_list_price#14 as decimal(12,2))), avg(cast(cs_coupon_amt#15 as decimal(12,2))), avg(cast(cs_sales_price#16 as decimal(12,2))), avg(cast(cs_net_profit#17 as decimal(12,2))), avg(cast(c_birth_year#18 as decimal(12,2))), avg(cast(cd_dep_count#19 as decimal(12,2)))], output=[i_item_id#11, ca_country#8, ca_state#9, ca_county#10, agg1#1, agg2#2, agg3#3, agg4#4, agg5#5, agg6#6, agg7#7])
   +- Exchange hashpartitioning(i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12, 5), true, [id=#150]
      +- *(7) HashAggregate(keys=[i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12], functions=[partial_avg(cast(cs_quantity#13 as decimal(12,2))), partial_avg(cast(cs_list_price#14 as decimal(12,2))), partial_avg(cast(cs_coupon_amt#15 as decimal(12,2))), partial_avg(cast(cs_sales_price#16 as decimal(12,2))), partial_avg(cast(cs_net_profit#17 as decimal(12,2))), partial_avg(cast(c_birth_year#18 as decimal(12,2))), partial_avg(cast(cd_dep_count#19 as decimal(12,2)))], output=[i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12, sum#151, count#152, sum#153, count#154, sum#155, count#156, sum#157, count#158, sum#159, count#160, sum#161, count#162, sum#163, count#164])
         +- *(7) Expand [List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, ca_state#91, ca_county#90, 0), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, ca_state#91, null, 1), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, null, null, 3), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, null, null, null, 7), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, null, null, null, null, 15)], [cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#11, ca_country#8, ca_state#9, ca_county#10, spark_grouping_id#12]
            +- *(7) Project [cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#125, ca_country#93, ca_state#91, ca_county#90]
               +- *(7) BroadcastHashJoin [cs_item_sk#35], [i_item_sk#124], Inner, BuildRight
                  :- *(7) Project [cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, ca_county#90, ca_state#91, ca_country#93]
                  :  +- *(7) BroadcastHashJoin [cs_sold_date_sk#20], [d_date_sk#96], Inner, BuildRight
                  :     :- *(7) Project [cs_sold_date_sk#20, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, ca_county#90, ca_state#91, ca_country#93]
                  :     :  +- *(7) BroadcastHashJoin [c_current_addr_sk#70], [ca_address_sk#83], Inner, BuildRight
                  :     :     :- *(7) Project [cs_sold_date_sk#20, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_current_addr_sk#70, c_birth_year#18]
                  :     :     :  +- *(7) BroadcastHashJoin [c_current_cdemo_sk#68], [cd_demo_sk#57], Inner, BuildRight
                  :     :     :     :- *(7) Project [cs_sold_date_sk#20, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_current_cdemo_sk#68, c_current_addr_sk#70, c_birth_year#18]
                  :     :     :     :  +- *(7) BroadcastHashJoin [cs_bill_customer_sk#23], [c_customer_sk#66], Inner, BuildRight
                  :     :     :     :     :- *(7) Project [cs_sold_date_sk#20, cs_bill_customer_sk#23, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19]
                  :     :     :     :     :  +- *(7) BroadcastHashJoin [cs_bill_cdemo_sk#24], [cd_demo_sk#49], Inner, BuildRight
                  :     :     :     :     :     :- *(7) Project [cs_sold_date_sk#20, cs_bill_customer_sk#23, cs_bill_cdemo_sk#24, cs_item_sk#35, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17]
                  :     :     :     :     :     :  +- *(7) Filter (((isnotnull(cs_bill_cdemo_sk#24) AND isnotnull(cs_bill_customer_sk#23)) AND isnotnull(cs_sold_date_sk#20)) AND isnotnull(cs_item_sk#35))
                  :     :     :     :     :     :     +- *(7) ColumnarToRow
                  :     :     :     :     :     :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#20,cs_bill_customer_sk#23,cs_bill_cdemo_sk#24,cs_item_sk#35,cs_quantity#13,cs_list_price#14,cs_sales_price#16,cs_coupon_amt#15,cs_net_profit#17] Batched: true, DataFilters: [isnotnull(cs_bill_cdemo_sk#24), isnotnull(cs_bill_customer_sk#23), isnotnull(cs_sold_date_sk#165..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk), IsNotNu..., ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantit...
                  :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#166]
                  :     :     :     :     :        +- *(1) Project [cd_demo_sk#49, cd_dep_count#19]
                  :     :     :     :     :           +- *(1) Filter ((((isnotnull(cd_gender#50) AND isnotnull(cd_education_status#52)) AND (cd_gender#50 = F)) AND (cd_education_status#52 = Unknown)) AND isnotnull(cd_demo_sk#49))
                  :     :     :     :     :              +- *(1) ColumnarToRow
                  :     :     :     :     :                 +- FileScan parquet default.customer_demographics[cd_demo_sk#49,cd_gender#50,cd_education_status#52,cd_dep_count#19] Batched: true, DataFilters: [isnotnull(cd_gender#50), isnotnull(cd_education_status#52), (cd_gender#50 = F), (cd_education..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_gender), IsNotNull(cd_education_status), EqualTo(cd_gender,F), EqualTo(cd_education..., ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_education_status:string,cd_dep_count:int>
                  :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#167]
                  :     :     :     :        +- *(2) Project [c_customer_sk#66, c_current_cdemo_sk#68, c_current_addr_sk#70, c_birth_year#18]
                  :     :     :     :           +- *(2) Filter (((c_birth_month#78 IN (1,6,8,9,12,2) AND isnotnull(c_customer_sk#66)) AND isnotnull(c_current_cdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
                  :     :     :     :              +- *(2) ColumnarToRow
                  :     :     :     :                 +- FileScan parquet default.customer[c_customer_sk#66,c_current_cdemo_sk#68,c_current_addr_sk#70,c_birth_month#78,c_birth_year#18] Batched: true, DataFilters: [c_birth_month#78 IN (1,6,8,9,12,2), isnotnull(c_customer_sk#66), isnotnull(c_current_cdemo_sk#68..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(c_birth_month, [1,6,8,9,12,2]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsNo..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_y...
                  :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#168]
                  :     :     :        +- *(3) Project [cd_demo_sk#57]
                  :     :     :           +- *(3) Filter isnotnull(cd_demo_sk#57)
                  :     :     :              +- *(3) ColumnarToRow
                  :     :     :                 +- FileScan parquet default.customer_demographics[cd_demo_sk#57] Batched: true, DataFilters: [isnotnull(cd_demo_sk#57)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int>
                  :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#169]
                  :     :        +- *(4) Project [ca_address_sk#83, ca_county#90, ca_state#91, ca_country#93]
                  :     :           +- *(4) Filter (ca_state#91 IN (MS,IN,ND,OK,NM,VA) AND isnotnull(ca_address_sk#83))
                  :     :              +- *(4) ColumnarToRow
                  :     :                 +- FileScan parquet default.customer_address[ca_address_sk#83,ca_county#90,ca_state#91,ca_country#93] Batched: true, DataFilters: [ca_state#91 IN (MS,IN,ND,OK,NM,VA), isnotnull(ca_address_sk#83)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_state, [MS,IN,ND,OK,NM,VA]), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_county:string,ca_state:string,ca_country:string>
                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#170]
                  :        +- *(5) Project [d_date_sk#96]
                  :           +- *(5) Filter ((isnotnull(d_year#102) AND (d_year#102 = 1998)) AND isnotnull(d_date_sk#96))
                  :              +- *(5) ColumnarToRow
                  :                 +- FileScan parquet default.date_dim[d_date_sk#96,d_year#102] Batched: true, DataFilters: [isnotnull(d_year#102), (d_year#102 = 1998), isnotnull(d_date_sk#96)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1998), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#171]
                     +- *(6) Project [i_item_sk#124, i_item_id#125]
                        +- *(6) Filter isnotnull(i_item_sk#124)
                           +- *(6) ColumnarToRow
                              +- FileScan parquet default.item[i_item_sk#124,i_item_id#125] Batched: true, DataFilters: [isnotnull(i_item_sk#124)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
