== Parsed Logical Plan ==
CTE [cs_ui, cross_sales]
:  :- 'SubqueryAlias cs_ui
:  :  +- 'UnresolvedHaving ('sum('cs_ext_list_price) > (2 * 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit))))
:  :     +- 'Aggregate ['cs_item_sk], ['cs_item_sk, 'sum('cs_ext_list_price) AS sale#1, 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit)) AS refund#2]
:  :        +- 'Filter (('cs_item_sk = 'cr_item_sk) AND ('cs_order_number = 'cr_order_number))
:  :           +- 'Join Inner
:  :              :- 'UnresolvedRelation [catalog_sales]
:  :              +- 'UnresolvedRelation [catalog_returns]
:  +- 'SubqueryAlias cross_sales
:     +- 'Aggregate ['i_product_name, 'i_item_sk, 's_store_name, 's_zip, 'ad1.ca_street_number, 'ad1.ca_street_name, 'ad1.ca_city, 'ad1.ca_zip, 'ad2.ca_street_number, 'ad2.ca_street_name, 'ad2.ca_city, 'ad2.ca_zip, 'd1.d_year, 'd2.d_year, 'd3.d_year], ['i_product_name AS product_name#3, 'i_item_sk AS item_sk#4, 's_store_name AS store_name#5, 's_zip AS store_zip#6, 'ad1.ca_street_number AS b_street_number#7, 'ad1.ca_street_name AS b_streen_name#8, 'ad1.ca_city AS b_city#9, 'ad1.ca_zip AS b_zip#10, 'ad2.ca_street_number AS c_street_number#11, 'ad2.ca_street_name AS c_street_name#12, 'ad2.ca_city AS c_city#13, 'ad2.ca_zip AS c_zip#14, 'd1.d_year AS syear#15, 'd2.d_year AS fsyear#16, 'd3.d_year AS s2year#17, 'count(1) AS cnt#18, 'sum('ss_wholesale_cost) AS s1#19, 'sum('ss_list_price) AS s2#20, 'sum('ss_coupon_amt) AS s3#21]
:        +- 'Filter (((((('ss_store_sk = 's_store_sk) AND ('ss_sold_date_sk = 'd1.d_date_sk)) AND ('ss_customer_sk = 'c_customer_sk)) AND ((('ss_cdemo_sk = 'cd1.cd_demo_sk) AND ('ss_hdemo_sk = 'hd1.hd_demo_sk)) AND ('ss_addr_sk = 'ad1.ca_address_sk))) AND (((('ss_item_sk = 'i_item_sk) AND ('ss_item_sk = 'sr_item_sk)) AND ('ss_ticket_number = 'sr_ticket_number)) AND (('ss_item_sk = 'cs_ui.cs_item_sk) AND ('c_current_cdemo_sk = 'cd2.cd_demo_sk)))) AND ((((('c_current_hdemo_sk = 'hd2.hd_demo_sk) AND ('c_current_addr_sk = 'ad2.ca_address_sk)) AND ('c_first_sales_date_sk = 'd2.d_date_sk)) AND ((('c_first_shipto_date_sk = 'd3.d_date_sk) AND ('ss_promo_sk = 'p_promo_sk)) AND ('hd1.hd_income_band_sk = 'ib1.ib_income_band_sk))) AND (((('hd2.hd_income_band_sk = 'ib2.ib_income_band_sk) AND NOT ('cd1.cd_marital_status = 'cd2.cd_marital_status)) AND 'i_color IN (purple,burlywood,indian,spring,floral,medium)) AND ((('i_current_price >= 64) AND ('i_current_price <= (64 + 10))) AND (('i_current_price >= (64 + 1)) AND ('i_current_price <= (64 + 15)))))))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'Join Inner
:              :  :  :- 'Join Inner
:              :  :  :  :- 'Join Inner
:              :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'UnresolvedRelation [store_sales]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store_returns]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [cs_ui]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d1
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim]
:              :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d2
:              :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim]
:              :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d3
:              :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim]
:              :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store]
:              :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [customer]
:              :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd1
:              :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
:              :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd2
:              :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics]
:              :  :  :  :  :  :  :  +- 'UnresolvedRelation [promotion]
:              :  :  :  :  :  :  +- 'SubqueryAlias hd1
:              :  :  :  :  :  :     +- 'UnresolvedRelation [household_demographics]
:              :  :  :  :  :  +- 'SubqueryAlias hd2
:              :  :  :  :  :     +- 'UnresolvedRelation [household_demographics]
:              :  :  :  :  +- 'SubqueryAlias ad1
:              :  :  :  :     +- 'UnresolvedRelation [customer_address]
:              :  :  :  +- 'SubqueryAlias ad2
:              :  :  :     +- 'UnresolvedRelation [customer_address]
:              :  :  +- 'SubqueryAlias ib1
:              :  :     +- 'UnresolvedRelation [income_band]
:              :  +- 'SubqueryAlias ib2
:              :     +- 'UnresolvedRelation [income_band]
:              +- 'UnresolvedRelation [item]
+- 'Sort ['cs1.product_name ASC NULLS FIRST, 'cs1.store_name ASC NULLS FIRST, 'cs2.cnt ASC NULLS FIRST], true
   +- 'Project ['cs1.product_name, 'cs1.store_name, 'cs1.store_zip, 'cs1.b_street_number, 'cs1.b_streen_name, 'cs1.b_city, 'cs1.b_zip, 'cs1.c_street_number, 'cs1.c_street_name, 'cs1.c_city, 'cs1.c_zip, 'cs1.syear, 'cs1.cnt, 'cs1.s1, 'cs1.s2, 'cs1.s3, 'cs2.s1, 'cs2.s2, 'cs2.s3, 'cs2.syear, 'cs2.cnt]
      +- 'Filter (((('cs1.item_sk = 'cs2.item_sk) AND ('cs1.syear = 1999)) AND ('cs2.syear = (1999 + 1))) AND ((('cs2.cnt <= 'cs1.cnt) AND ('cs1.store_name = 'cs2.store_name)) AND ('cs1.store_zip = 'cs2.store_zip)))
         +- 'Join Inner
            :- 'SubqueryAlias cs1
            :  +- 'UnresolvedRelation [cross_sales]
            +- 'SubqueryAlias cs2
               +- 'UnresolvedRelation [cross_sales]

== Analyzed Logical Plan ==
product_name: string, store_name: string, store_zip: string, b_street_number: string, b_streen_name: string, b_city: string, b_zip: string, c_street_number: string, c_street_name: string, c_city: string, c_zip: string, syear: int, cnt: bigint, s1: decimal(17,2), s2: decimal(17,2), s3: decimal(17,2), s1: decimal(17,2), s2: decimal(17,2), s3: decimal(17,2), syear: int, cnt: bigint
Sort [product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST], true
+- Project [product_name#3, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#23, s1#19, s2#20, s3#21, s1#24, s2#25, s3#26, syear#27, cnt#22]
   +- Filter ((((item_sk#4 = item_sk#28) AND (syear#15 = 1999)) AND (syear#27 = (1999 + 1))) AND (((cnt#22 <= cnt#23) AND (store_name#5 = store_name#29)) AND (store_zip#6 = store_zip#30)))
      +- Join Inner
         :- SubqueryAlias cs1
         :  +- SubqueryAlias cross_sales
         :     +- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], [i_product_name#31 AS product_name#3, i_item_sk#32 AS item_sk#4, s_store_name#33 AS store_name#5, s_zip#34 AS store_zip#6, ca_street_number#35 AS b_street_number#7, ca_street_name#36 AS b_streen_name#8, ca_city#37 AS b_city#9, ca_zip#38 AS b_zip#10, ca_street_number#39 AS c_street_number#11, ca_street_name#40 AS c_street_name#12, ca_city#41 AS c_city#13, ca_zip#42 AS c_zip#14, d_year#43 AS syear#15, d_year#44 AS fsyear#16, d_year#45 AS s2year#17, count(1) AS cnt#23, sum(ss_wholesale_cost#46) AS s1#19, sum(ss_list_price#47) AS s2#20, sum(ss_coupon_amt#48) AS s3#21]
         :        +- Filter ((((((ss_store_sk#49 = s_store_sk#50) AND (ss_sold_date_sk#51 = d_date_sk#52)) AND (ss_customer_sk#53 = c_customer_sk#54)) AND (((ss_cdemo_sk#55 = cd_demo_sk#56) AND (ss_hdemo_sk#57 = hd_demo_sk#58)) AND (ss_addr_sk#59 = ca_address_sk#60))) AND ((((ss_item_sk#61 = i_item_sk#32) AND (cast(ss_item_sk#61 as bigint) = sr_item_sk#62)) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64)) AND ((ss_item_sk#61 = cs_item_sk#65) AND (c_current_cdemo_sk#66 = cd_demo_sk#67)))) AND (((((c_current_hdemo_sk#68 = hd_demo_sk#69) AND (c_current_addr_sk#70 = ca_address_sk#71)) AND (c_first_sales_date_sk#72 = d_date_sk#73)) AND (((c_first_shipto_date_sk#74 = d_date_sk#75) AND (ss_promo_sk#76 = p_promo_sk#77)) AND (hd_income_band_sk#78 = ib_income_band_sk#79))) AND ((((hd_income_band_sk#80 = ib_income_band_sk#81) AND NOT (cd_marital_status#82 = cd_marital_status#83)) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#85 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#85 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias spark_catalog.default.store_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#65, sale#1, refund#2]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#115)#116 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, sum(cs_ext_list_price#115) AS sale#1, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#2, sum(cs_ext_list_price#115) AS sum(cs_ext_list_price#115)#116, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias spark_catalog.default.catalog_sales
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias spark_catalog.default.catalog_returns
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#146,cr_returned_time_sk#147,cr_item_sk#121,cr_refunded_customer_sk#148,cr_refunded_cdemo_sk#149,cr_refunded_hdemo_sk#150,cr_refunded_addr_sk#151,cr_returning_customer_sk#152,cr_returning_cdemo_sk#153,cr_returning_hdemo_sk#154,cr_returning_addr_sk#155,cr_call_center_sk#156,cr_catalog_page_sk#157,cr_ship_mode_sk#158,cr_warehouse_sk#159,cr_reason_sk#160,cr_order_number#123,cr_return_quantity#161,cr_return_amount#162,cr_return_tax#163,cr_return_amt_inc_tax#164,cr_fee#165,cr_return_ship_cost#166,cr_refunded_cash#117,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#52,d_date_id#167,d_date#168,d_month_seq#169,d_week_seq#170,d_quarter_seq#171,d_year#43,d_dow#172,d_moy#173,d_dom#174,d_qoy#175,d_fy_year#176,d_fy_quarter_seq#177,d_fy_week_seq#178,d_day_name#179,d_quarter_name#180,d_holiday#181,d_weekend#182,d_following_holiday#183,d_first_dom#184,d_last_dom#185,d_same_day_ly#186,d_same_day_lq#187,d_current_day#188,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#73,d_date_id#189,d_date#190,d_month_seq#191,d_week_seq#192,d_quarter_seq#193,d_year#44,d_dow#194,d_moy#195,d_dom#196,d_qoy#197,d_fy_year#198,d_fy_quarter_seq#199,d_fy_week_seq#200,d_day_name#201,d_quarter_name#202,d_holiday#203,d_weekend#204,d_following_holiday#205,d_first_dom#206,d_last_dom#207,d_same_day_ly#208,d_same_day_lq#209,d_current_day#210,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#75,d_date_id#211,d_date#212,d_month_seq#213,d_week_seq#214,d_quarter_seq#215,d_year#45,d_dow#216,d_moy#217,d_dom#218,d_qoy#219,d_fy_year#220,d_fy_quarter_seq#221,d_fy_week_seq#222,d_day_name#223,d_quarter_name#224,d_holiday#225,d_weekend#226,d_following_holiday#227,d_first_dom#228,d_last_dom#229,d_same_day_ly#230,d_same_day_lq#231,d_current_day#232,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#50,s_store_id#233,s_rec_start_date#234,s_rec_end_date#235,s_closed_date_sk#236,s_store_name#33,s_number_employees#237,s_floor_space#238,s_hours#239,s_manager#240,s_market_id#241,s_geography_class#242,s_market_desc#243,s_market_manager#244,s_division_id#245,s_division_name#246,s_company_id#247,s_company_name#248,s_street_number#249,s_street_name#250,s_street_type#251,s_suite_number#252,s_city#253,s_county#254,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.customer
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#54,c_customer_id#255,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#256,c_first_name#257,c_last_name#258,c_preferred_cust_flag#259,c_birth_day#260,c_birth_month#261,c_birth_year#262,c_birth_country#263,c_login#264,c_email_address#265,c_last_review_date#266] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#56,cd_gender#267,cd_marital_status#82,cd_education_status#268,cd_purchase_estimate#269,cd_credit_rating#270,cd_dep_count#271,cd_dep_employed_count#272,cd_dep_college_count#273] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#67,cd_gender#274,cd_marital_status#83,cd_education_status#275,cd_purchase_estimate#276,cd_credit_rating#277,cd_dep_count#278,cd_dep_employed_count#279,cd_dep_college_count#280] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.promotion
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#77,p_promo_id#281,p_start_date_sk#282,p_end_date_sk#283,p_item_sk#284,p_cost#285,p_response_target#286,p_promo_name#287,p_channel_dmail#288,p_channel_email#289,p_channel_catalog#290,p_channel_tv#291,p_channel_radio#292,p_channel_press#293,p_channel_event#294,p_channel_demo#295,p_channel_details#296,p_purpose#297,p_discount_active#298] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias hd1
         :              :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#299,hd_dep_count#300,hd_vehicle_count#301] parquet
         :              :  :  :  :  :  +- SubqueryAlias hd2
         :              :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
         :              :  :  :  :  :        +- Relation[hd_demo_sk#69,hd_income_band_sk#80,hd_buy_potential#302,hd_dep_count#303,hd_vehicle_count#304] parquet
         :              :  :  :  :  +- SubqueryAlias ad1
         :              :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
         :              :  :  :  :        +- Relation[ca_address_sk#60,ca_address_id#305,ca_street_number#35,ca_street_name#36,ca_street_type#306,ca_suite_number#307,ca_city#37,ca_county#308,ca_state#309,ca_zip#38,ca_country#310,ca_gmt_offset#311,ca_location_type#312] parquet
         :              :  :  :  +- SubqueryAlias ad2
         :              :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
         :              :  :  :        +- Relation[ca_address_sk#71,ca_address_id#313,ca_street_number#39,ca_street_name#40,ca_street_type#314,ca_suite_number#315,ca_city#41,ca_county#316,ca_state#317,ca_zip#42,ca_country#318,ca_gmt_offset#319,ca_location_type#320] parquet
         :              :  :  +- SubqueryAlias ib1
         :              :  :     +- SubqueryAlias spark_catalog.default.income_band
         :              :  :        +- Relation[ib_income_band_sk#79,ib_lower_bound#321,ib_upper_bound#322] parquet
         :              :  +- SubqueryAlias ib2
         :              :     +- SubqueryAlias spark_catalog.default.income_band
         :              :        +- Relation[ib_income_band_sk#81,ib_lower_bound#323,ib_upper_bound#324] parquet
         :              +- SubqueryAlias spark_catalog.default.item
         :                 +- Relation[i_item_sk#32,i_item_id#325,i_rec_start_date#326,i_rec_end_date#327,i_item_desc#328,i_current_price#85,i_wholesale_cost#329,i_brand_id#330,i_brand#331,i_class_id#332,i_class#333,i_category_id#334,i_category#335,i_manufact_id#336,i_manufact#337,i_size#338,i_formulation#339,i_color#84,i_units#340,i_container#341,i_manager_id#342,i_product_name#31] parquet
         +- SubqueryAlias cs2
            +- SubqueryAlias cross_sales
               +- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, d_year#43, d_year#347, d_year#348], [i_product_name#31 AS product_name#349, i_item_sk#32 AS item_sk#28, s_store_name#33 AS store_name#29, s_zip#34 AS store_zip#30, ca_street_number#35 AS b_street_number#350, ca_street_name#36 AS b_streen_name#351, ca_city#37 AS b_city#352, ca_zip#38 AS b_zip#353, ca_street_number#343 AS c_street_number#354, ca_street_name#344 AS c_street_name#355, ca_city#345 AS c_city#356, ca_zip#346 AS c_zip#357, d_year#43 AS syear#27, d_year#347 AS fsyear#358, d_year#348 AS s2year#359, count(1) AS cnt#22, sum(ss_wholesale_cost#46) AS s1#24, sum(ss_list_price#47) AS s2#25, sum(ss_coupon_amt#48) AS s3#26]
                  +- Filter ((((((ss_store_sk#49 = s_store_sk#50) AND (ss_sold_date_sk#51 = d_date_sk#52)) AND (ss_customer_sk#53 = c_customer_sk#54)) AND (((ss_cdemo_sk#55 = cd_demo_sk#56) AND (ss_hdemo_sk#57 = hd_demo_sk#58)) AND (ss_addr_sk#59 = ca_address_sk#60))) AND ((((ss_item_sk#61 = i_item_sk#32) AND (cast(ss_item_sk#61 as bigint) = sr_item_sk#62)) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64)) AND ((ss_item_sk#61 = cs_item_sk#65) AND (c_current_cdemo_sk#66 = cd_demo_sk#360)))) AND (((((c_current_hdemo_sk#68 = hd_demo_sk#361) AND (c_current_addr_sk#70 = ca_address_sk#362)) AND (c_first_sales_date_sk#72 = d_date_sk#363)) AND (((c_first_shipto_date_sk#74 = d_date_sk#364) AND (ss_promo_sk#76 = p_promo_sk#77)) AND (hd_income_band_sk#78 = ib_income_band_sk#79))) AND ((((hd_income_band_sk#365 = ib_income_band_sk#366) AND NOT (cd_marital_status#82 = cd_marital_status#367)) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (((cast(i_current_price#85 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) AND ((cast(i_current_price#85 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) AND (cast(i_current_price#85 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias spark_catalog.default.store_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#65, sale#1, refund#2]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#115)#368 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#369 as decimal(19,2)))), DecimalType(21,2), true) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, sum(cs_ext_list_price#115) AS sale#1, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS refund#2, sum(cs_ext_list_price#115) AS sum(cs_ext_list_price#115)#368, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#369]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias spark_catalog.default.catalog_sales
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias spark_catalog.default.catalog_returns
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#146,cr_returned_time_sk#147,cr_item_sk#121,cr_refunded_customer_sk#148,cr_refunded_cdemo_sk#149,cr_refunded_hdemo_sk#150,cr_refunded_addr_sk#151,cr_returning_customer_sk#152,cr_returning_cdemo_sk#153,cr_returning_hdemo_sk#154,cr_returning_addr_sk#155,cr_call_center_sk#156,cr_catalog_page_sk#157,cr_ship_mode_sk#158,cr_warehouse_sk#159,cr_reason_sk#160,cr_order_number#123,cr_return_quantity#161,cr_return_amount#162,cr_return_tax#163,cr_return_amt_inc_tax#164,cr_fee#165,cr_return_ship_cost#166,cr_refunded_cash#117,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#52,d_date_id#167,d_date#168,d_month_seq#169,d_week_seq#170,d_quarter_seq#171,d_year#43,d_dow#172,d_moy#173,d_dom#174,d_qoy#175,d_fy_year#176,d_fy_quarter_seq#177,d_fy_week_seq#178,d_day_name#179,d_quarter_name#180,d_holiday#181,d_weekend#182,d_following_holiday#183,d_first_dom#184,d_last_dom#185,d_same_day_ly#186,d_same_day_lq#187,d_current_day#188,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#363,d_date_id#370,d_date#371,d_month_seq#372,d_week_seq#373,d_quarter_seq#374,d_year#347,d_dow#375,d_moy#376,d_dom#377,d_qoy#378,d_fy_year#379,d_fy_quarter_seq#380,d_fy_week_seq#381,d_day_name#382,d_quarter_name#383,d_holiday#384,d_weekend#385,d_following_holiday#386,d_first_dom#387,d_last_dom#388,d_same_day_ly#389,d_same_day_lq#390,d_current_day#391,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.date_dim
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#364,d_date_id#392,d_date#393,d_month_seq#394,d_week_seq#395,d_quarter_seq#396,d_year#348,d_dow#397,d_moy#398,d_dom#399,d_qoy#400,d_fy_year#401,d_fy_quarter_seq#402,d_fy_week_seq#403,d_day_name#404,d_quarter_name#405,d_holiday#406,d_weekend#407,d_following_holiday#408,d_first_dom#409,d_last_dom#410,d_same_day_ly#411,d_same_day_lq#412,d_current_day#413,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.store
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#50,s_store_id#233,s_rec_start_date#234,s_rec_end_date#235,s_closed_date_sk#236,s_store_name#33,s_number_employees#237,s_floor_space#238,s_hours#239,s_manager#240,s_market_id#241,s_geography_class#242,s_market_desc#243,s_market_manager#244,s_division_id#245,s_division_name#246,s_company_id#247,s_company_name#248,s_street_number#249,s_street_name#250,s_street_type#251,s_suite_number#252,s_city#253,s_county#254,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.customer
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#54,c_customer_id#255,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#256,c_first_name#257,c_last_name#258,c_preferred_cust_flag#259,c_birth_day#260,c_birth_month#261,c_birth_year#262,c_birth_country#263,c_login#264,c_email_address#265,c_last_review_date#266] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#56,cd_gender#267,cd_marital_status#82,cd_education_status#268,cd_purchase_estimate#269,cd_credit_rating#270,cd_dep_count#271,cd_dep_employed_count#272,cd_dep_college_count#273] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
                        :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_demographics
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#360,cd_gender#414,cd_marital_status#367,cd_education_status#415,cd_purchase_estimate#416,cd_credit_rating#417,cd_dep_count#418,cd_dep_employed_count#419,cd_dep_college_count#420] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.default.promotion
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#77,p_promo_id#281,p_start_date_sk#282,p_end_date_sk#283,p_item_sk#284,p_cost#285,p_response_target#286,p_promo_name#287,p_channel_dmail#288,p_channel_email#289,p_channel_catalog#290,p_channel_tv#291,p_channel_radio#292,p_channel_press#293,p_channel_event#294,p_channel_demo#295,p_channel_details#296,p_purpose#297,p_discount_active#298] parquet
                        :  :  :  :  :  :  +- SubqueryAlias hd1
                        :  :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#299,hd_dep_count#300,hd_vehicle_count#301] parquet
                        :  :  :  :  :  +- SubqueryAlias hd2
                        :  :  :  :  :     +- SubqueryAlias spark_catalog.default.household_demographics
                        :  :  :  :  :        +- Relation[hd_demo_sk#361,hd_income_band_sk#365,hd_buy_potential#421,hd_dep_count#422,hd_vehicle_count#423] parquet
                        :  :  :  :  +- SubqueryAlias ad1
                        :  :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
                        :  :  :  :        +- Relation[ca_address_sk#60,ca_address_id#305,ca_street_number#35,ca_street_name#36,ca_street_type#306,ca_suite_number#307,ca_city#37,ca_county#308,ca_state#309,ca_zip#38,ca_country#310,ca_gmt_offset#311,ca_location_type#312] parquet
                        :  :  :  +- SubqueryAlias ad2
                        :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
                        :  :  :        +- Relation[ca_address_sk#362,ca_address_id#424,ca_street_number#343,ca_street_name#344,ca_street_type#425,ca_suite_number#426,ca_city#345,ca_county#427,ca_state#428,ca_zip#346,ca_country#429,ca_gmt_offset#430,ca_location_type#431] parquet
                        :  :  +- SubqueryAlias ib1
                        :  :     +- SubqueryAlias spark_catalog.default.income_band
                        :  :        +- Relation[ib_income_band_sk#79,ib_lower_bound#321,ib_upper_bound#322] parquet
                        :  +- SubqueryAlias ib2
                        :     +- SubqueryAlias spark_catalog.default.income_band
                        :        +- Relation[ib_income_band_sk#366,ib_lower_bound#432,ib_upper_bound#433] parquet
                        +- SubqueryAlias spark_catalog.default.item
                           +- Relation[i_item_sk#32,i_item_id#325,i_rec_start_date#326,i_rec_end_date#327,i_item_desc#328,i_current_price#85,i_wholesale_cost#329,i_brand_id#330,i_brand#331,i_class_id#332,i_class#333,i_category_id#334,i_category#335,i_manufact_id#336,i_manufact#337,i_size#338,i_formulation#339,i_color#84,i_units#340,i_container#341,i_manager_id#342,i_product_name#31] parquet

== Optimized Logical Plan ==
Sort [product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST], true
+- Project [product_name#3, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#23, s1#19, s2#20, s3#21, s1#24, s2#25, s3#26, syear#27, cnt#22]
   +- Join Inner, ((((item_sk#4 = item_sk#28) AND (cnt#22 <= cnt#23)) AND (store_name#5 = store_name#29)) AND (store_zip#6 = store_zip#30))
      :- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], [i_product_name#31 AS product_name#3, i_item_sk#32 AS item_sk#4, s_store_name#33 AS store_name#5, s_zip#34 AS store_zip#6, ca_street_number#35 AS b_street_number#7, ca_street_name#36 AS b_streen_name#8, ca_city#37 AS b_city#9, ca_zip#38 AS b_zip#10, ca_street_number#39 AS c_street_number#11, ca_street_name#40 AS c_street_name#12, ca_city#41 AS c_city#13, ca_zip#42 AS c_zip#14, d_year#43 AS syear#15, count(1) AS cnt#23, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#46)),17,2) AS s1#19, MakeDecimal(sum(UnscaledValue(ss_list_price#47)),17,2) AS s2#20, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#48)),17,2) AS s3#21]
      :  +- Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#44, d_year#45, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, i_item_sk#32, i_product_name#31]
      :     +- Join Inner, (ss_item_sk#61 = i_item_sk#32)
      :        :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :  +- Join Inner, (hd_income_band_sk#80 = ib_income_band_sk#81)
      :        :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :     :  +- Join Inner, (hd_income_band_sk#78 = ib_income_band_sk#79)
      :        :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :     :     :  +- Join Inner, (c_current_addr_sk#70 = ca_address_sk#71)
      :        :     :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
      :        :     :     :     :  +- Join Inner, (ss_addr_sk#59 = ca_address_sk#60)
      :        :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80]
      :        :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#68 = hd_demo_sk#69)
      :        :     :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78]
      :        :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#57 = hd_demo_sk#58)
      :        :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
      :        :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#76 = p_promo_sk#77)
      :        :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
      :        :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#66 = cd_demo_sk#67) AND NOT (cd_marital_status#82 = cd_marital_status#83))
      :        :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, cd_marital_status#82]
      :        :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#55 = cd_demo_sk#56)
      :        :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
      :        :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#74 = d_date_sk#75)
      :        :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#44]
      :        :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#72 = d_date_sk#73)
      :        :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
      :        :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#53 = c_customer_sk#54)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#49 = s_store_sk#50)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#51 = d_date_sk#52)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#61 = cs_item_sk#65)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((cast(ss_item_sk#61 as bigint) = sr_item_sk#62) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_ticket_number#63, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#62, sr_ticket_number#64]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#62) AND isnotnull(sr_ticket_number#64))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#65]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#115)#116) AND (cast(sum(cs_ext_list_price#115)#116 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120)), DecimalType(21,2), true)))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#115)),17,2) AS sum(cs_ext_list_price#115)#116, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#65, cs_ext_list_price#115, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#65, cs_order_number#122, cs_ext_list_price#115]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#65) AND isnotnull(cs_order_number#122))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,... 10 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#121, cr_order_number#123, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#121) AND isnotnull(cr_order_number#123))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#146,cr_returned_time_sk#147,cr_item_sk#121,cr_refunded_customer_sk#148,cr_refunded_cdemo_sk#149,cr_refunded_hdemo_sk#150,cr_refunded_addr_sk#151,cr_returning_customer_sk#152,cr_returning_cdemo_sk#153,cr_returning_hdemo_sk#154,cr_returning_addr_sk#155,cr_call_center_sk#156,cr_catalog_page_sk#157,cr_ship_mode_sk#158,cr_warehouse_sk#159,cr_reason_sk#160,cr_order_number#123,cr_return_quantity#161,cr_return_amount#162,cr_return_tax#163,cr_return_amt_inc_tax#164,cr_fee#165,cr_return_ship_cost#166,cr_refunded_cash#117,... 3 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#52, d_year#43]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#43) AND (d_year#43 = 1999)) AND isnotnull(d_date_sk#52))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#52,d_date_id#167,d_date#168,d_month_seq#169,d_week_seq#170,d_quarter_seq#171,d_year#43,d_dow#172,d_moy#173,d_dom#174,d_qoy#175,d_fy_year#176,d_fy_quarter_seq#177,d_fy_week_seq#178,d_day_name#179,d_quarter_name#180,d_holiday#181,d_weekend#182,d_following_holiday#183,d_first_dom#184,d_last_dom#185,d_same_day_ly#186,d_same_day_lq#187,d_current_day#188,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#50, s_store_name#33, s_zip#34]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#50) AND isnotnull(s_zip#34)) AND isnotnull(s_store_name#33))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#50,s_store_id#233,s_rec_start_date#234,s_rec_end_date#235,s_closed_date_sk#236,s_store_name#33,s_number_employees#237,s_floor_space#238,s_hours#239,s_manager#240,s_market_id#241,s_geography_class#242,s_market_desc#243,s_market_manager#244,s_division_id#245,s_division_name#246,s_company_id#247,s_company_name#248,s_street_number#249,s_street_name#250,s_street_type#251,s_suite_number#252,s_city#253,s_county#254,... 5 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#54, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
      :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#54) AND isnotnull(c_first_sales_date_sk#72)) AND isnotnull(c_first_shipto_date_sk#74)) AND isnotnull(c_current_cdemo_sk#66)) AND isnotnull(c_current_hdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
      :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#54,c_customer_id#255,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#256,c_first_name#257,c_last_name#258,c_preferred_cust_flag#259,c_birth_day#260,c_birth_month#261,c_birth_year#262,c_birth_country#263,c_login#264,c_email_address#265,c_last_review_date#266] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#73, d_year#44]
      :        :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#73)
      :        :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#73,d_date_id#189,d_date#190,d_month_seq#191,d_week_seq#192,d_quarter_seq#193,d_year#44,d_dow#194,d_moy#195,d_dom#196,d_qoy#197,d_fy_year#198,d_fy_quarter_seq#199,d_fy_week_seq#200,d_day_name#201,d_quarter_name#202,d_holiday#203,d_weekend#204,d_following_holiday#205,d_first_dom#206,d_last_dom#207,d_same_day_ly#208,d_same_day_lq#209,d_current_day#210,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#75, d_year#45]
      :        :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#75)
      :        :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#75,d_date_id#211,d_date#212,d_month_seq#213,d_week_seq#214,d_quarter_seq#215,d_year#45,d_dow#216,d_moy#217,d_dom#218,d_qoy#219,d_fy_year#220,d_fy_quarter_seq#221,d_fy_week_seq#222,d_day_name#223,d_quarter_name#224,d_holiday#225,d_weekend#226,d_following_holiday#227,d_first_dom#228,d_last_dom#229,d_same_day_ly#230,d_same_day_lq#231,d_current_day#232,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#56, cd_marital_status#82]
      :        :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#56) AND isnotnull(cd_marital_status#82))
      :        :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#56,cd_gender#267,cd_marital_status#82,cd_education_status#268,cd_purchase_estimate#269,cd_credit_rating#270,cd_dep_count#271,cd_dep_employed_count#272,cd_dep_college_count#273] parquet
      :        :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#67, cd_marital_status#83]
      :        :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#67) AND isnotnull(cd_marital_status#83))
      :        :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#67,cd_gender#274,cd_marital_status#83,cd_education_status#275,cd_purchase_estimate#276,cd_credit_rating#277,cd_dep_count#278,cd_dep_employed_count#279,cd_dep_college_count#280] parquet
      :        :     :     :     :     :     :     :     +- Project [p_promo_sk#77]
      :        :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#77)
      :        :     :     :     :     :     :     :           +- Relation[p_promo_sk#77,p_promo_id#281,p_start_date_sk#282,p_end_date_sk#283,p_item_sk#284,p_cost#285,p_response_target#286,p_promo_name#287,p_channel_dmail#288,p_channel_email#289,p_channel_catalog#290,p_channel_tv#291,p_channel_radio#292,p_channel_press#293,p_channel_event#294,p_channel_demo#295,p_channel_details#296,p_purpose#297,p_discount_active#298] parquet
      :        :     :     :     :     :     :     +- Project [hd_demo_sk#58, hd_income_band_sk#78]
      :        :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#58) AND isnotnull(hd_income_band_sk#78))
      :        :     :     :     :     :     :           +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#299,hd_dep_count#300,hd_vehicle_count#301] parquet
      :        :     :     :     :     :     +- Project [hd_demo_sk#69, hd_income_band_sk#80]
      :        :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#69) AND isnotnull(hd_income_band_sk#80))
      :        :     :     :     :     :           +- Relation[hd_demo_sk#69,hd_income_band_sk#80,hd_buy_potential#302,hd_dep_count#303,hd_vehicle_count#304] parquet
      :        :     :     :     :     +- Project [ca_address_sk#60, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
      :        :     :     :     :        +- Filter isnotnull(ca_address_sk#60)
      :        :     :     :     :           +- Relation[ca_address_sk#60,ca_address_id#305,ca_street_number#35,ca_street_name#36,ca_street_type#306,ca_suite_number#307,ca_city#37,ca_county#308,ca_state#309,ca_zip#38,ca_country#310,ca_gmt_offset#311,ca_location_type#312] parquet
      :        :     :     :     +- Project [ca_address_sk#71, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
      :        :     :     :        +- Filter isnotnull(ca_address_sk#71)
      :        :     :     :           +- Relation[ca_address_sk#71,ca_address_id#313,ca_street_number#39,ca_street_name#40,ca_street_type#314,ca_suite_number#315,ca_city#41,ca_county#316,ca_state#317,ca_zip#42,ca_country#318,ca_gmt_offset#319,ca_location_type#320] parquet
      :        :     :     +- Project [ib_income_band_sk#79]
      :        :     :        +- Filter isnotnull(ib_income_band_sk#79)
      :        :     :           +- Relation[ib_income_band_sk#79,ib_lower_bound#321,ib_upper_bound#322] parquet
      :        :     +- Project [ib_income_band_sk#81]
      :        :        +- Filter isnotnull(ib_income_band_sk#81)
      :        :           +- Relation[ib_income_band_sk#81,ib_lower_bound#323,ib_upper_bound#324] parquet
      :        +- Project [i_item_sk#32, i_product_name#31]
      :           +- Filter ((((((isnotnull(i_current_price#85) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#85 >= 64.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 74.00)) AND (cast(i_current_price#85 as decimal(12,2)) >= 65.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 79.00)) AND isnotnull(i_item_sk#32))
      :              +- Relation[i_item_sk#32,i_item_id#325,i_rec_start_date#326,i_rec_end_date#327,i_item_desc#328,i_current_price#85,i_wholesale_cost#329,i_brand_id#330,i_brand#331,i_class_id#332,i_class#333,i_category_id#334,i_category#335,i_manufact_id#336,i_manufact#337,i_size#338,i_formulation#339,i_color#84,i_units#340,i_container#341,i_manager_id#342,i_product_name#31] parquet
      +- Aggregate [i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, d_year#43, d_year#347, d_year#348], [i_item_sk#32 AS item_sk#28, s_store_name#33 AS store_name#29, s_zip#34 AS store_zip#30, d_year#43 AS syear#27, count(1) AS cnt#22, MakeDecimal(sum(UnscaledValue(ss_wholesale_cost#46)),17,2) AS s1#24, MakeDecimal(sum(UnscaledValue(ss_list_price#47)),17,2) AS s2#25, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#48)),17,2) AS s3#26]
         +- Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#347, d_year#348, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, i_item_sk#32, i_product_name#31]
            +- Join Inner, (ss_item_sk#61 = i_item_sk#32)
               :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#347, d_year#348, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346]
               :  +- Join Inner, (hd_income_band_sk#365 = ib_income_band_sk#366)
               :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#347, d_year#348, hd_income_band_sk#365, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346]
               :     :  +- Join Inner, (hd_income_band_sk#78 = ib_income_band_sk#79)
               :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#347, d_year#348, hd_income_band_sk#78, hd_income_band_sk#365, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346]
               :     :     :  +- Join Inner, (c_current_addr_sk#70 = ca_address_sk#362)
               :     :     :     :- Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#347, d_year#348, hd_income_band_sk#78, hd_income_band_sk#365, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
               :     :     :     :  +- Join Inner, (ss_addr_sk#59 = ca_address_sk#60)
               :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#347, d_year#348, hd_income_band_sk#78, hd_income_band_sk#365]
               :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#68 = hd_demo_sk#361)
               :     :     :     :     :     :- Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348, hd_income_band_sk#78]
               :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#57 = hd_demo_sk#58)
               :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348]
               :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#76 = p_promo_sk#77)
               :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348]
               :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#66 = cd_demo_sk#360) AND NOT (cd_marital_status#82 = cd_marital_status#367))
               :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348, cd_marital_status#82]
               :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#55 = cd_demo_sk#56)
               :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348]
               :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#74 = d_date_sk#364)
               :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#347]
               :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#72 = d_date_sk#363)
               :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
               :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#53 = c_customer_sk#54)
               :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
               :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#49 = s_store_sk#50)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#51 = d_date_sk#52)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#61 = cs_item_sk#65)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((cast(ss_item_sk#61 as bigint) = sr_item_sk#62) AND (cast(ss_ticket_number#63 as bigint) = sr_ticket_number#64))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_ticket_number#63, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#51,ss_sold_time_sk#86,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_quantity#87,ss_wholesale_cost#46,ss_list_price#47,ss_sales_price#88,ss_ext_discount_amt#89,ss_ext_sales_price#90,ss_ext_wholesale_cost#91,ss_ext_list_price#92,ss_ext_tax#93,ss_coupon_amt#48,ss_net_paid#94,ss_net_paid_inc_tax#95,ss_net_profit#96] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#62, sr_ticket_number#64]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#62) AND isnotnull(sr_ticket_number#64))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#97,sr_return_time_sk#98,sr_item_sk#62,sr_customer_sk#99,sr_cdemo_sk#100,sr_hdemo_sk#101,sr_addr_sk#102,sr_store_sk#103,sr_reason_sk#104,sr_ticket_number#64,sr_return_quantity#105,sr_return_amt#106,sr_return_tax#107,sr_return_amt_inc_tax#108,sr_fee#109,sr_return_ship_cost#110,sr_refunded_cash#111,sr_reversed_charge#112,sr_store_credit#113,sr_net_loss#114] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#65]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sum(cs_ext_list_price#115)#368) AND (cast(sum(cs_ext_list_price#115)#368 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#369)), DecimalType(21,2), true)))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#65], [cs_item_sk#65, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#115)),17,2) AS sum(cs_ext_list_price#115)#368, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true)) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#369]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#65, cs_ext_list_price#115, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#65 = cr_item_sk#121) AND (cs_order_number#122 = cr_order_number#123))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#65, cs_order_number#122, cs_ext_list_price#115]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#65) AND isnotnull(cs_order_number#122))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#124,cs_sold_time_sk#125,cs_ship_date_sk#126,cs_bill_customer_sk#127,cs_bill_cdemo_sk#128,cs_bill_hdemo_sk#129,cs_bill_addr_sk#130,cs_ship_customer_sk#131,cs_ship_cdemo_sk#132,cs_ship_hdemo_sk#133,cs_ship_addr_sk#134,cs_call_center_sk#135,cs_catalog_page_sk#136,cs_ship_mode_sk#137,cs_warehouse_sk#138,cs_item_sk#65,cs_promo_sk#139,cs_order_number#122,cs_quantity#140,cs_wholesale_cost#141,cs_list_price#142,cs_sales_price#143,cs_ext_discount_amt#144,cs_ext_sales_price#145,... 10 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#121, cr_order_number#123, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#121) AND isnotnull(cr_order_number#123))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#146,cr_returned_time_sk#147,cr_item_sk#121,cr_refunded_customer_sk#148,cr_refunded_cdemo_sk#149,cr_refunded_hdemo_sk#150,cr_refunded_addr_sk#151,cr_returning_customer_sk#152,cr_returning_cdemo_sk#153,cr_returning_hdemo_sk#154,cr_returning_addr_sk#155,cr_call_center_sk#156,cr_catalog_page_sk#157,cr_ship_mode_sk#158,cr_warehouse_sk#159,cr_reason_sk#160,cr_order_number#123,cr_return_quantity#161,cr_return_amount#162,cr_return_tax#163,cr_return_amt_inc_tax#164,cr_fee#165,cr_return_ship_cost#166,cr_refunded_cash#117,... 3 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#52, d_year#43]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#43) AND (d_year#43 = 2000)) AND isnotnull(d_date_sk#52))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#52,d_date_id#167,d_date#168,d_month_seq#169,d_week_seq#170,d_quarter_seq#171,d_year#43,d_dow#172,d_moy#173,d_dom#174,d_qoy#175,d_fy_year#176,d_fy_quarter_seq#177,d_fy_week_seq#178,d_day_name#179,d_quarter_name#180,d_holiday#181,d_weekend#182,d_following_holiday#183,d_first_dom#184,d_last_dom#185,d_same_day_ly#186,d_same_day_lq#187,d_current_day#188,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#50, s_store_name#33, s_zip#34]
               :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#50) AND isnotnull(s_store_name#33)) AND isnotnull(s_zip#34))
               :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#50,s_store_id#233,s_rec_start_date#234,s_rec_end_date#235,s_closed_date_sk#236,s_store_name#33,s_number_employees#237,s_floor_space#238,s_hours#239,s_manager#240,s_market_id#241,s_geography_class#242,s_market_desc#243,s_market_manager#244,s_division_id#245,s_division_name#246,s_company_id#247,s_company_name#248,s_street_number#249,s_street_name#250,s_street_type#251,s_suite_number#252,s_city#253,s_county#254,... 5 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#54, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
               :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#54) AND isnotnull(c_first_sales_date_sk#72)) AND isnotnull(c_first_shipto_date_sk#74)) AND isnotnull(c_current_cdemo_sk#66)) AND isnotnull(c_current_hdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
               :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#54,c_customer_id#255,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72,c_salutation#256,c_first_name#257,c_last_name#258,c_preferred_cust_flag#259,c_birth_day#260,c_birth_month#261,c_birth_year#262,c_birth_country#263,c_login#264,c_email_address#265,c_last_review_date#266] parquet
               :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#363, d_year#347]
               :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#363)
               :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#363,d_date_id#370,d_date#371,d_month_seq#372,d_week_seq#373,d_quarter_seq#374,d_year#347,d_dow#375,d_moy#376,d_dom#377,d_qoy#378,d_fy_year#379,d_fy_quarter_seq#380,d_fy_week_seq#381,d_day_name#382,d_quarter_name#383,d_holiday#384,d_weekend#385,d_following_holiday#386,d_first_dom#387,d_last_dom#388,d_same_day_ly#389,d_same_day_lq#390,d_current_day#391,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#364, d_year#348]
               :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#364)
               :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#364,d_date_id#392,d_date#393,d_month_seq#394,d_week_seq#395,d_quarter_seq#396,d_year#348,d_dow#397,d_moy#398,d_dom#399,d_qoy#400,d_fy_year#401,d_fy_quarter_seq#402,d_fy_week_seq#403,d_day_name#404,d_quarter_name#405,d_holiday#406,d_weekend#407,d_following_holiday#408,d_first_dom#409,d_last_dom#410,d_same_day_ly#411,d_same_day_lq#412,d_current_day#413,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#56, cd_marital_status#82]
               :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#56) AND isnotnull(cd_marital_status#82))
               :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#56,cd_gender#267,cd_marital_status#82,cd_education_status#268,cd_purchase_estimate#269,cd_credit_rating#270,cd_dep_count#271,cd_dep_employed_count#272,cd_dep_college_count#273] parquet
               :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#360, cd_marital_status#367]
               :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#360) AND isnotnull(cd_marital_status#367))
               :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#360,cd_gender#414,cd_marital_status#367,cd_education_status#415,cd_purchase_estimate#416,cd_credit_rating#417,cd_dep_count#418,cd_dep_employed_count#419,cd_dep_college_count#420] parquet
               :     :     :     :     :     :     :     +- Project [p_promo_sk#77]
               :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#77)
               :     :     :     :     :     :     :           +- Relation[p_promo_sk#77,p_promo_id#281,p_start_date_sk#282,p_end_date_sk#283,p_item_sk#284,p_cost#285,p_response_target#286,p_promo_name#287,p_channel_dmail#288,p_channel_email#289,p_channel_catalog#290,p_channel_tv#291,p_channel_radio#292,p_channel_press#293,p_channel_event#294,p_channel_demo#295,p_channel_details#296,p_purpose#297,p_discount_active#298] parquet
               :     :     :     :     :     :     +- Project [hd_demo_sk#58, hd_income_band_sk#78]
               :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#58) AND isnotnull(hd_income_band_sk#78))
               :     :     :     :     :     :           +- Relation[hd_demo_sk#58,hd_income_band_sk#78,hd_buy_potential#299,hd_dep_count#300,hd_vehicle_count#301] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#361, hd_income_band_sk#365]
               :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#361) AND isnotnull(hd_income_band_sk#365))
               :     :     :     :     :           +- Relation[hd_demo_sk#361,hd_income_band_sk#365,hd_buy_potential#421,hd_dep_count#422,hd_vehicle_count#423] parquet
               :     :     :     :     +- Project [ca_address_sk#60, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
               :     :     :     :        +- Filter isnotnull(ca_address_sk#60)
               :     :     :     :           +- Relation[ca_address_sk#60,ca_address_id#305,ca_street_number#35,ca_street_name#36,ca_street_type#306,ca_suite_number#307,ca_city#37,ca_county#308,ca_state#309,ca_zip#38,ca_country#310,ca_gmt_offset#311,ca_location_type#312] parquet
               :     :     :     +- Project [ca_address_sk#362, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346]
               :     :     :        +- Filter isnotnull(ca_address_sk#362)
               :     :     :           +- Relation[ca_address_sk#362,ca_address_id#424,ca_street_number#343,ca_street_name#344,ca_street_type#425,ca_suite_number#426,ca_city#345,ca_county#427,ca_state#428,ca_zip#346,ca_country#429,ca_gmt_offset#430,ca_location_type#431] parquet
               :     :     +- Project [ib_income_band_sk#79]
               :     :        +- Filter isnotnull(ib_income_band_sk#79)
               :     :           +- Relation[ib_income_band_sk#79,ib_lower_bound#321,ib_upper_bound#322] parquet
               :     +- Project [ib_income_band_sk#366]
               :        +- Filter isnotnull(ib_income_band_sk#366)
               :           +- Relation[ib_income_band_sk#366,ib_lower_bound#432,ib_upper_bound#433] parquet
               +- Project [i_item_sk#32, i_product_name#31]
                  +- Filter ((((((isnotnull(i_current_price#85) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#85 >= 64.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 74.00)) AND (cast(i_current_price#85 as decimal(12,2)) >= 65.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 79.00)) AND isnotnull(i_item_sk#32))
                     +- Relation[i_item_sk#32,i_item_id#325,i_rec_start_date#326,i_rec_end_date#327,i_item_desc#328,i_current_price#85,i_wholesale_cost#329,i_brand_id#330,i_brand#331,i_class_id#332,i_class#333,i_category_id#334,i_category#335,i_manufact_id#336,i_manufact#337,i_size#338,i_formulation#339,i_color#84,i_units#340,i_container#341,i_manager_id#342,i_product_name#31] parquet

== Physical Plan ==
*(43) Sort [product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST], true, 0
+- Exchange rangepartitioning(product_name#3 ASC NULLS FIRST, store_name#5 ASC NULLS FIRST, cnt#22 ASC NULLS FIRST, 5), true, [id=#434]
   +- *(42) Project [product_name#3, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#23, s1#19, s2#20, s3#21, s1#24, s2#25, s3#26, syear#27, cnt#22]
      +- *(42) BroadcastHashJoin [item_sk#4, store_name#5, store_zip#6], [item_sk#28, store_name#29, store_zip#30], Inner, BuildRight, (cnt#22 <= cnt#23), false
         :- *(42) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#46)), sum(UnscaledValue(ss_list_price#47)), sum(UnscaledValue(ss_coupon_amt#48))], output=[product_name#3, item_sk#4, store_name#5, store_zip#6, b_street_number#7, b_streen_name#8, b_city#9, b_zip#10, c_street_number#11, c_street_name#12, c_city#13, c_zip#14, syear#15, cnt#23, s1#19, s2#20, s3#21])
         :  +- Exchange hashpartitioning(i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45, 5), true, [id=#435]
         :     +- *(20) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#46)), partial_sum(UnscaledValue(ss_list_price#47)), partial_sum(UnscaledValue(ss_coupon_amt#48))], output=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, d_year#43, d_year#44, d_year#45, count#436, sum#437, sum#438, sum#439])
         :        +- *(20) Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#44, d_year#45, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42, i_item_sk#32, i_product_name#31]
         :           +- *(20) BroadcastHashJoin [ss_item_sk#61], [i_item_sk#32], Inner, BuildRight, false
         :              :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
         :              :  +- *(20) BroadcastHashJoin [hd_income_band_sk#80], [ib_income_band_sk#81], Inner, BuildRight, false
         :              :     :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
         :              :     :  +- *(20) BroadcastHashJoin [hd_income_band_sk#78], [ib_income_band_sk#79], Inner, BuildRight, false
         :              :     :     :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42]
         :              :     :     :  +- *(20) BroadcastHashJoin [c_current_addr_sk#70], [ca_address_sk#71], Inner, BuildRight, false
         :              :     :     :     :- *(20) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
         :              :     :     :     :  +- *(20) BroadcastHashJoin [ss_addr_sk#59], [ca_address_sk#60], Inner, BuildRight, false
         :              :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78, hd_income_band_sk#80]
         :              :     :     :     :     :  +- *(20) BroadcastHashJoin [c_current_hdemo_sk#68], [hd_demo_sk#69], Inner, BuildRight, false
         :              :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, hd_income_band_sk#78]
         :              :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_hdemo_sk#57], [hd_demo_sk#58], Inner, BuildRight, false
         :              :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
         :              :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_promo_sk#76], [p_promo_sk#77], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
         :              :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [c_current_cdemo_sk#66], [cd_demo_sk#67], Inner, BuildRight, NOT (cd_marital_status#82 = cd_marital_status#83), false
         :              :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45, cd_marital_status#82]
         :              :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_cdemo_sk#55], [cd_demo_sk#56], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#44, d_year#45]
         :              :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [c_first_shipto_date_sk#74], [d_date_sk#75], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#44]
         :              :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [c_first_sales_date_sk#72], [d_date_sk#73], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
         :              :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_customer_sk#53], [c_customer_sk#54], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_store_sk#49], [s_store_sk#50], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_sold_date_sk#51], [d_date_sk#52], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [ss_item_sk#61], [cs_item_sk#65], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) BroadcastHashJoin [cast(ss_item_sk#61 as bigint), cast(ss_ticket_number#63 as bigint)], [sr_item_sk#62, sr_ticket_number#64], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(20) Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(20) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet default.store_sales[ss_sold_date_sk#51,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_wholesale_cost#46,ss_list_price#47,ss_coupon_amt#48] Batched: true, DataFilters: [isnotnull(ss_item_sk#61), isnotnull(ss_ticket_number#63), isnotnull(ss_sold_date_sk#51), isno..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false], input[1, bigint, false]),false), [id=#440]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(1) Filter (isnotnull(sr_item_sk#62) AND isnotnull(sr_ticket_number#64))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(1) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet default.store_returns[sr_item_sk#62,sr_ticket_number#64] Batched: true, DataFilters: [isnotnull(sr_item_sk#62), isnotnull(sr_ticket_number#64)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:bigint,sr_ticket_number:bigint>
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#441]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(4) Project [cs_item_sk#65]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(4) Filter (isnotnull(sum(cs_ext_list_price#115)#116) AND (cast(sum(cs_ext_list_price#115)#116 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120)), DecimalType(21,2), true)))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(4) HashAggregate(keys=[cs_item_sk#65], functions=[sum(UnscaledValue(cs_ext_list_price#115)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#65, sum(cs_ext_list_price#115)#116, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))#120])
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Exchange hashpartitioning(cs_item_sk#65, 5), true, [id=#442]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- *(3) HashAggregate(keys=[cs_item_sk#65], functions=[partial_sum(UnscaledValue(cs_ext_list_price#115)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#117 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#118 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#119 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#65, sum#443, sum#444, isEmpty#445])
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- *(3) Project [cs_item_sk#65, cs_ext_list_price#115, cr_refunded_cash#117, cr_reversed_charge#118, cr_store_credit#119]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- *(3) BroadcastHashJoin [cs_item_sk#65, cs_order_number#122], [cr_item_sk#121, cr_order_number#123], Inner, BuildRight, false
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :- *(3) Filter (isnotnull(cs_item_sk#65) AND isnotnull(cs_order_number#122))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :  +- *(3) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :     +- FileScan parquet default.catalog_sales[cs_item_sk#65,cs_order_number#122,cs_ext_list_price#115] Batched: true, DataFilters: [isnotnull(cs_item_sk#65), isnotnull(cs_order_number#122)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:decimal(7,2)>
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [id=#446]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- *(2) Filter (isnotnull(cr_item_sk#121) AND isnotnull(cr_order_number#123))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- *(2) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                      +- FileScan parquet default.catalog_returns[cr_item_sk#121,cr_order_number#123,cr_refunded_cash#117,cr_reversed_charge#118,cr_store_credit#119] Batched: true, DataFilters: [isnotnull(cr_item_sk#121), isnotnull(cr_order_number#123)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:decimal(7,2),cr_reversed_charge:decima...
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#447]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(5) Filter ((isnotnull(d_year#43) AND (d_year#43 = 1999)) AND isnotnull(d_date_sk#52))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(5) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet default.date_dim[d_date_sk#52,d_year#43] Batched: true, DataFilters: [isnotnull(d_year#43), (d_year#43 = 1999), isnotnull(d_date_sk#52)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :              :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#448]
         :              :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(6) Filter ((isnotnull(s_store_sk#50) AND isnotnull(s_zip#34)) AND isnotnull(s_store_name#33))
         :              :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(6) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet default.store[s_store_sk#50,s_store_name#33,s_zip#34] Batched: true, DataFilters: [isnotnull(s_store_sk#50), isnotnull(s_zip#34), isnotnull(s_store_name#33)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_zip), IsNotNull(s_store_name)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
         :              :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#449]
         :              :     :     :     :     :     :     :     :     :     :     :     :        +- *(7) Filter (((((isnotnull(c_customer_sk#54) AND isnotnull(c_first_sales_date_sk#72)) AND isnotnull(c_first_shipto_date_sk#74)) AND isnotnull(c_current_cdemo_sk#66)) AND isnotnull(c_current_hdemo_sk#68)) AND isnotnull(c_current_addr_sk#70))
         :              :     :     :     :     :     :     :     :     :     :     :     :           +- *(7) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet default.customer[c_customer_sk#54,c_current_cdemo_sk#66,c_current_hdemo_sk#68,c_current_addr_sk#70,c_first_shipto_date_sk#74,c_first_sales_date_sk#72] Batched: true, DataFilters: [isnotnull(c_customer_sk#54), isnotnull(c_first_sales_date_sk#72), isnotnull(c_first_shipto_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
         :              :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#450]
         :              :     :     :     :     :     :     :     :     :     :     :        +- *(8) Filter isnotnull(d_date_sk#73)
         :              :     :     :     :     :     :     :     :     :     :     :           +- *(8) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet default.date_dim[d_date_sk#73,d_year#44] Batched: true, DataFilters: [isnotnull(d_date_sk#73)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :              :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#75, d_year#45], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#450]
         :              :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#451]
         :              :     :     :     :     :     :     :     :     :        +- *(10) Filter (isnotnull(cd_demo_sk#56) AND isnotnull(cd_marital_status#82))
         :              :     :     :     :     :     :     :     :     :           +- *(10) ColumnarToRow
         :              :     :     :     :     :     :     :     :     :              +- FileScan parquet default.customer_demographics[cd_demo_sk#56,cd_marital_status#82] Batched: true, DataFilters: [isnotnull(cd_demo_sk#56), isnotnull(cd_marital_status#82)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
         :              :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#67, cd_marital_status#83], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#451]
         :              :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#452]
         :              :     :     :     :     :     :     :        +- *(12) Filter isnotnull(p_promo_sk#77)
         :              :     :     :     :     :     :     :           +- *(12) ColumnarToRow
         :              :     :     :     :     :     :     :              +- FileScan parquet default.promotion[p_promo_sk#77] Batched: true, DataFilters: [isnotnull(p_promo_sk#77)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
         :              :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#453]
         :              :     :     :     :     :     :        +- *(13) Filter (isnotnull(hd_demo_sk#58) AND isnotnull(hd_income_band_sk#78))
         :              :     :     :     :     :     :           +- *(13) ColumnarToRow
         :              :     :     :     :     :     :              +- FileScan parquet default.household_demographics[hd_demo_sk#58,hd_income_band_sk#78] Batched: true, DataFilters: [isnotnull(hd_demo_sk#58), isnotnull(hd_income_band_sk#78)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
         :              :     :     :     :     :     +- ReusedExchange [hd_demo_sk#69, hd_income_band_sk#80], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#453]
         :              :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#454]
         :              :     :     :     :        +- *(15) Filter isnotnull(ca_address_sk#60)
         :              :     :     :     :           +- *(15) ColumnarToRow
         :              :     :     :     :              +- FileScan parquet default.customer_address[ca_address_sk#60,ca_street_number#35,ca_street_name#36,ca_city#37,ca_zip#38] Batched: true, DataFilters: [isnotnull(ca_address_sk#60)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
         :              :     :     :     +- ReusedExchange [ca_address_sk#71, ca_street_number#39, ca_street_name#40, ca_city#41, ca_zip#42], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#454]
         :              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#455]
         :              :     :        +- *(17) Filter isnotnull(ib_income_band_sk#79)
         :              :     :           +- *(17) ColumnarToRow
         :              :     :              +- FileScan parquet default.income_band[ib_income_band_sk#79] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#79)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
         :              :     +- ReusedExchange [ib_income_band_sk#81], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#455]
         :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#456]
         :                 +- *(19) Project [i_item_sk#32, i_product_name#31]
         :                    +- *(19) Filter ((((((isnotnull(i_current_price#85) AND i_color#84 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#85 >= 64.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 74.00)) AND (cast(i_current_price#85 as decimal(12,2)) >= 65.00)) AND (cast(i_current_price#85 as decimal(12,2)) <= 79.00)) AND isnotnull(i_item_sk#32))
         :                       +- *(19) ColumnarToRow
         :                          +- FileScan parquet default.item[i_item_sk#32,i_current_price#85,i_color#84,i_product_name#31] Batched: true, DataFilters: [isnotnull(i_current_price#85), i_color#84 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
         +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, int, true], input[1, string, true], input[2, string, true]),false), [id=#457]
            +- *(41) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, d_year#43, d_year#347, d_year#348], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#46)), sum(UnscaledValue(ss_list_price#47)), sum(UnscaledValue(ss_coupon_amt#48))], output=[item_sk#28, store_name#29, store_zip#30, syear#27, cnt#22, s1#24, s2#25, s3#26])
               +- Exchange hashpartitioning(i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, d_year#43, d_year#347, d_year#348, 5), true, [id=#458]
                  +- *(40) HashAggregate(keys=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, d_year#43, d_year#347, d_year#348], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#46)), partial_sum(UnscaledValue(ss_list_price#47)), partial_sum(UnscaledValue(ss_coupon_amt#48))], output=[i_product_name#31, i_item_sk#32, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, d_year#43, d_year#347, d_year#348, count#459, sum#460, sum#461, sum#462])
                     +- *(40) Project [ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, d_year#347, d_year#348, s_store_name#33, s_zip#34, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346, i_item_sk#32, i_product_name#31]
                        +- *(40) BroadcastHashJoin [ss_item_sk#61], [i_item_sk#32], Inner, BuildRight, false
                           :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#347, d_year#348, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346]
                           :  +- *(40) BroadcastHashJoin [hd_income_band_sk#365], [ib_income_band_sk#366], Inner, BuildRight, false
                           :     :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#347, d_year#348, hd_income_band_sk#365, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346]
                           :     :  +- *(40) BroadcastHashJoin [hd_income_band_sk#78], [ib_income_band_sk#79], Inner, BuildRight, false
                           :     :     :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, d_year#347, d_year#348, hd_income_band_sk#78, hd_income_band_sk#365, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346]
                           :     :     :  +- *(40) BroadcastHashJoin [c_current_addr_sk#70], [ca_address_sk#362], Inner, BuildRight, false
                           :     :     :     :- *(40) Project [ss_item_sk#61, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#347, d_year#348, hd_income_band_sk#78, hd_income_band_sk#365, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38]
                           :     :     :     :  +- *(40) BroadcastHashJoin [ss_addr_sk#59], [ca_address_sk#60], Inner, BuildRight, false
                           :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_addr_sk#70, d_year#347, d_year#348, hd_income_band_sk#78, hd_income_band_sk#365]
                           :     :     :     :     :  +- *(40) BroadcastHashJoin [c_current_hdemo_sk#68], [hd_demo_sk#361], Inner, BuildRight, false
                           :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348, hd_income_band_sk#78]
                           :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_hdemo_sk#57], [hd_demo_sk#58], Inner, BuildRight, false
                           :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348]
                           :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_promo_sk#76], [p_promo_sk#77], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348]
                           :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [c_current_cdemo_sk#66], [cd_demo_sk#360], Inner, BuildRight, NOT (cd_marital_status#82 = cd_marital_status#367), false
                           :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348, cd_marital_status#82]
                           :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_cdemo_sk#55], [cd_demo_sk#56], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, d_year#347, d_year#348]
                           :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [c_first_shipto_date_sk#74], [d_date_sk#364], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, d_year#347]
                           :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [c_first_sales_date_sk#72], [d_date_sk#363], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72]
                           :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_customer_sk#53], [c_customer_sk#54], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43, s_store_name#33, s_zip#34]
                           :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_store_sk#49], [s_store_sk#50], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48, d_year#43]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_sold_date_sk#51], [d_date_sk#52], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [ss_item_sk#61], [cs_item_sk#65], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Project [ss_sold_date_sk#51, ss_item_sk#61, ss_customer_sk#53, ss_cdemo_sk#55, ss_hdemo_sk#57, ss_addr_sk#59, ss_store_sk#49, ss_promo_sk#76, ss_wholesale_cost#46, ss_list_price#47, ss_coupon_amt#48]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) BroadcastHashJoin [cast(ss_item_sk#61 as bigint), cast(ss_ticket_number#63 as bigint)], [sr_item_sk#62, sr_ticket_number#64], Inner, BuildRight, false
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(40) Filter ((((((((isnotnull(ss_item_sk#61) AND isnotnull(ss_ticket_number#63)) AND isnotnull(ss_sold_date_sk#51)) AND isnotnull(ss_store_sk#49)) AND isnotnull(ss_customer_sk#53)) AND isnotnull(ss_cdemo_sk#55)) AND isnotnull(ss_promo_sk#76)) AND isnotnull(ss_hdemo_sk#57)) AND isnotnull(ss_addr_sk#59))
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(40) ColumnarToRow
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- FileScan parquet default.store_sales[ss_sold_date_sk#51,ss_item_sk#61,ss_customer_sk#53,ss_cdemo_sk#55,ss_hdemo_sk#57,ss_addr_sk#59,ss_store_sk#49,ss_promo_sk#76,ss_ticket_number#63,ss_wholesale_cost#46,ss_list_price#47,ss_coupon_amt#48] Batched: true, DataFilters: [isnotnull(ss_item_sk#61), isnotnull(ss_ticket_number#63), isnotnull(ss_sold_date_sk#51), isno..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [sr_item_sk#62, sr_ticket_number#64], BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false], input[1, bigint, false]),false), [id=#440]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [cs_item_sk#65], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#441]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#463]
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(25) Filter ((isnotnull(d_year#43) AND (d_year#43 = 2000)) AND isnotnull(d_date_sk#52))
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(25) ColumnarToRow
                           :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet default.date_dim[d_date_sk#52,d_year#43] Batched: true, DataFilters: [isnotnull(d_year#43), (d_year#43 = 2000), isnotnull(d_date_sk#52)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                           :     :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [s_store_sk#50, s_store_name#33, s_zip#34], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#448]
                           :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [c_customer_sk#54, c_current_cdemo_sk#66, c_current_hdemo_sk#68, c_current_addr_sk#70, c_first_shipto_date_sk#74, c_first_sales_date_sk#72], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#449]
                           :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#363, d_year#347], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#450]
                           :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#364, d_year#348], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#450]
                           :     :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#56, cd_marital_status#82], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#451]
                           :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#360, cd_marital_status#367], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#451]
                           :     :     :     :     :     :     :     +- ReusedExchange [p_promo_sk#77], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#452]
                           :     :     :     :     :     :     +- ReusedExchange [hd_demo_sk#58, hd_income_band_sk#78], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#453]
                           :     :     :     :     :     +- ReusedExchange [hd_demo_sk#361, hd_income_band_sk#365], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#453]
                           :     :     :     :     +- ReusedExchange [ca_address_sk#60, ca_street_number#35, ca_street_name#36, ca_city#37, ca_zip#38], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#454]
                           :     :     :     +- ReusedExchange [ca_address_sk#362, ca_street_number#343, ca_street_name#344, ca_city#345, ca_zip#346], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#454]
                           :     :     +- ReusedExchange [ib_income_band_sk#79], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#455]
                           :     +- ReusedExchange [ib_income_band_sk#366], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#455]
                           +- ReusedExchange [i_item_sk#32, i_product_name#31], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#456]
