== Parsed Logical Plan ==
'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Sort ['i_category ASC NULLS FIRST, 'i_class ASC NULLS FIRST, 'i_brand ASC NULLS FIRST, 'i_product_name ASC NULLS FIRST, 'd_year ASC NULLS FIRST, 'd_qoy ASC NULLS FIRST, 'd_moy ASC NULLS FIRST, 's_store_id ASC NULLS FIRST, 'sumsales ASC NULLS FIRST, 'rk ASC NULLS FIRST], true
      +- 'Project [*]
         +- 'Filter ('rk <= 100)
            +- 'SubqueryAlias dw2
               +- 'Project ['i_category, 'i_class, 'i_brand, 'i_product_name, 'd_year, 'd_qoy, 'd_moy, 's_store_id, 'sumsales, 'rank() windowspecdefinition('i_category, 'sumsales DESC NULLS LAST, unspecifiedframe$()) AS rk#1]
                  +- 'SubqueryAlias dw1
                     +- 'Aggregate ['ROLLUP('i_category, 'i_class, 'i_brand, 'i_product_name, 'd_year, 'd_qoy, 'd_moy, 's_store_id)], ['i_category, 'i_class, 'i_brand, 'i_product_name, 'd_year, 'd_qoy, 'd_moy, 's_store_id, 'sum('coalesce(('ss_sales_price * 'ss_quantity), 0)) AS sumsales#2]
                        +- 'Filter ((('ss_sold_date_sk = 'd_date_sk) AND ('ss_item_sk = 'i_item_sk)) AND (('ss_store_sk = 's_store_sk) AND (('d_month_seq >= 1200) AND ('d_month_seq <= (1200 + 11)))))
                           +- 'Join Inner
                              :- 'Join Inner
                              :  :- 'Join Inner
                              :  :  :- 'UnresolvedRelation [store_sales]
                              :  :  +- 'UnresolvedRelation [date_dim]
                              :  +- 'UnresolvedRelation [store]
                              +- 'UnresolvedRelation [item]

== Analyzed Logical Plan ==
i_category: string, i_class: string, i_brand: string, i_product_name: string, d_year: int, d_qoy: int, d_moy: int, s_store_id: string, sumsales: decimal(28,2), rk: int
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#3 ASC NULLS FIRST, i_class#4 ASC NULLS FIRST, i_brand#5 ASC NULLS FIRST, i_product_name#6 ASC NULLS FIRST, d_year#7 ASC NULLS FIRST, d_qoy#8 ASC NULLS FIRST, d_moy#9 ASC NULLS FIRST, s_store_id#10 ASC NULLS FIRST, sumsales#2 ASC NULLS FIRST, rk#1 ASC NULLS FIRST], true
      +- Project [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, sumsales#2, rk#1]
         +- Filter (rk#1 <= 100)
            +- SubqueryAlias dw2
               +- Project [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, sumsales#2, rk#1]
                  +- Project [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, sumsales#2, rk#1, rk#1]
                     +- Window [rank(sumsales#2) windowspecdefinition(i_category#3, sumsales#2 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#1], [i_category#3], [sumsales#2 DESC NULLS LAST]
                        +- Project [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, sumsales#2]
                           +- SubqueryAlias dw1
                              +- Aggregate [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11], [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#12 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#13 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true), cast(0 as decimal(18,2)))) AS sumsales#2]
                                 +- Expand [List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, i_class#115, i_brand#116, i_product_name#117, d_year#118, d_qoy#119, d_moy#120, s_store_id#121, 0), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, i_class#115, i_brand#116, i_product_name#117, d_year#118, d_qoy#119, d_moy#120, null, 1), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, i_class#115, i_brand#116, i_product_name#117, d_year#118, d_qoy#119, null, null, 3), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, i_class#115, i_brand#116, i_product_name#117, d_year#118, null, null, null, 7), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, i_class#115, i_brand#116, i_product_name#117, null, null, null, null, 15), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, i_class#115, i_brand#116, null, null, null, null, null, 31), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, i_class#115, null, null, null, null, null, null, 63), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, i_category#114, null, null, null, null, null, null, null, 127), List(ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, i_container#111, i_manager_id#112, i_product_name#113, null, null, null, null, null, null, null, null, 255)], [ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, ... 12 more fields]
                                    +- Project [ss_sold_date_sk#14, ss_sold_time_sk#15, ss_item_sk#16, ss_customer_sk#17, ss_cdemo_sk#18, ss_hdemo_sk#19, ss_addr_sk#20, ss_store_sk#21, ss_promo_sk#22, ss_ticket_number#23, ss_quantity#13, ss_wholesale_cost#24, ss_list_price#25, ss_sales_price#12, ss_ext_discount_amt#26, ss_ext_sales_price#27, ss_ext_wholesale_cost#28, ss_ext_list_price#29, ss_ext_tax#30, ss_coupon_amt#31, ss_net_paid#32, ss_net_paid_inc_tax#33, ss_net_profit#34, d_date_sk#35, d_date_id#36, d_date#37, d_month_seq#38, d_week_seq#39, d_quarter_seq#40, d_year#41, d_dow#42, d_moy#43, d_dom#44, d_qoy#45, d_fy_year#46, d_fy_quarter_seq#47, d_fy_week_seq#48, d_day_name#49, d_quarter_name#50, d_holiday#51, d_weekend#52, d_following_holiday#53, d_first_dom#54, d_last_dom#55, d_same_day_ly#56, d_same_day_lq#57, d_current_day#58, d_current_week#59, d_current_month#60, d_current_quarter#61, d_current_year#62, s_store_sk#63, s_store_id#64, s_rec_start_date#65, s_rec_end_date#66, s_closed_date_sk#67, s_store_name#68, s_number_employees#69, s_floor_space#70, s_hours#71, s_manager#72, s_market_id#73, s_geography_class#74, s_market_desc#75, s_market_manager#76, s_division_id#77, s_division_name#78, s_company_id#79, s_company_name#80, s_street_number#81, s_street_name#82, s_street_type#83, s_suite_number#84, s_city#85, s_county#86, s_state#87, s_zip#88, s_country#89, s_gmt_offset#90, s_tax_percentage#91, i_item_sk#92, i_item_id#93, i_rec_start_date#94, i_rec_end_date#95, i_item_desc#96, i_current_price#97, i_wholesale_cost#98, i_brand_id#99, i_brand#100, i_class_id#101, i_class#102, i_category_id#103, i_category#104, i_manufact_id#105, i_manufact#106, i_size#107, i_formulation#108, i_color#109, i_units#110, ... 11 more fields]
                                       +- Filter (((ss_sold_date_sk#14 = d_date_sk#35) AND (ss_item_sk#16 = i_item_sk#92)) AND ((ss_store_sk#21 = s_store_sk#63) AND ((d_month_seq#38 >= 1200) AND (d_month_seq#38 <= (1200 + 11)))))
                                          +- Join Inner
                                             :- Join Inner
                                             :  :- Join Inner
                                             :  :  :- SubqueryAlias spark_catalog.default.store_sales
                                             :  :  :  +- Relation[ss_sold_date_sk#14,ss_sold_time_sk#15,ss_item_sk#16,ss_customer_sk#17,ss_cdemo_sk#18,ss_hdemo_sk#19,ss_addr_sk#20,ss_store_sk#21,ss_promo_sk#22,ss_ticket_number#23,ss_quantity#13,ss_wholesale_cost#24,ss_list_price#25,ss_sales_price#12,ss_ext_discount_amt#26,ss_ext_sales_price#27,ss_ext_wholesale_cost#28,ss_ext_list_price#29,ss_ext_tax#30,ss_coupon_amt#31,ss_net_paid#32,ss_net_paid_inc_tax#33,ss_net_profit#34] parquet
                                             :  :  +- SubqueryAlias spark_catalog.default.date_dim
                                             :  :     +- Relation[d_date_sk#35,d_date_id#36,d_date#37,d_month_seq#38,d_week_seq#39,d_quarter_seq#40,d_year#41,d_dow#42,d_moy#43,d_dom#44,d_qoy#45,d_fy_year#46,d_fy_quarter_seq#47,d_fy_week_seq#48,d_day_name#49,d_quarter_name#50,d_holiday#51,d_weekend#52,d_following_holiday#53,d_first_dom#54,d_last_dom#55,d_same_day_ly#56,d_same_day_lq#57,d_current_day#58,d_current_week#59,d_current_month#60,d_current_quarter#61,d_current_year#62] parquet
                                             :  +- SubqueryAlias spark_catalog.default.store
                                             :     +- Relation[s_store_sk#63,s_store_id#64,s_rec_start_date#65,s_rec_end_date#66,s_closed_date_sk#67,s_store_name#68,s_number_employees#69,s_floor_space#70,s_hours#71,s_manager#72,s_market_id#73,s_geography_class#74,s_market_desc#75,s_market_manager#76,s_division_id#77,s_division_name#78,s_company_id#79,s_company_name#80,s_street_number#81,s_street_name#82,s_street_type#83,s_suite_number#84,s_city#85,s_county#86,s_state#87,s_zip#88,s_country#89,s_gmt_offset#90,s_tax_percentage#91] parquet
                                             +- SubqueryAlias spark_catalog.default.item
                                                +- Relation[i_item_sk#92,i_item_id#93,i_rec_start_date#94,i_rec_end_date#95,i_item_desc#96,i_current_price#97,i_wholesale_cost#98,i_brand_id#99,i_brand#100,i_class_id#101,i_class#102,i_category_id#103,i_category#104,i_manufact_id#105,i_manufact#106,i_size#107,i_formulation#108,i_color#109,i_units#110,i_container#111,i_manager_id#112,i_product_name#113] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#3 ASC NULLS FIRST, i_class#4 ASC NULLS FIRST, i_brand#5 ASC NULLS FIRST, i_product_name#6 ASC NULLS FIRST, d_year#7 ASC NULLS FIRST, d_qoy#8 ASC NULLS FIRST, d_moy#9 ASC NULLS FIRST, s_store_id#10 ASC NULLS FIRST, sumsales#2 ASC NULLS FIRST, rk#1 ASC NULLS FIRST], true
      +- Filter (isnotnull(rk#1) AND (rk#1 <= 100))
         +- Window [rank(sumsales#2) windowspecdefinition(i_category#3, sumsales#2 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#1], [i_category#3], [sumsales#2 DESC NULLS LAST]
            +- Aggregate [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11], [i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#12 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#13 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true), 0.00)) AS sumsales#2]
               +- Expand [List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, d_moy#43, s_store_id#64, 0), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, d_moy#43, null, 1), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, null, null, 3), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, null, null, null, 7), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, null, null, null, null, 15), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, null, null, null, null, null, 31), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, null, null, null, null, null, null, 63), List(ss_quantity#13, ss_sales_price#12, i_category#104, null, null, null, null, null, null, null, 127), List(ss_quantity#13, ss_sales_price#12, null, null, null, null, null, null, null, null, 255)], [ss_quantity#13, ss_sales_price#12, i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11]
                  +- Project [ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, d_moy#43, s_store_id#64]
                     +- Join Inner, (ss_item_sk#16 = i_item_sk#92)
                        :- Project [ss_item_sk#16, ss_quantity#13, ss_sales_price#12, d_year#41, d_moy#43, d_qoy#45, s_store_id#64]
                        :  +- Join Inner, (ss_store_sk#21 = s_store_sk#63)
                        :     :- Project [ss_item_sk#16, ss_store_sk#21, ss_quantity#13, ss_sales_price#12, d_year#41, d_moy#43, d_qoy#45]
                        :     :  +- Join Inner, (ss_sold_date_sk#14 = d_date_sk#35)
                        :     :     :- Project [ss_sold_date_sk#14, ss_item_sk#16, ss_store_sk#21, ss_quantity#13, ss_sales_price#12]
                        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#14) AND isnotnull(ss_store_sk#21)) AND isnotnull(ss_item_sk#16))
                        :     :     :     +- Relation[ss_sold_date_sk#14,ss_sold_time_sk#15,ss_item_sk#16,ss_customer_sk#17,ss_cdemo_sk#18,ss_hdemo_sk#19,ss_addr_sk#20,ss_store_sk#21,ss_promo_sk#22,ss_ticket_number#23,ss_quantity#13,ss_wholesale_cost#24,ss_list_price#25,ss_sales_price#12,ss_ext_discount_amt#26,ss_ext_sales_price#27,ss_ext_wholesale_cost#28,ss_ext_list_price#29,ss_ext_tax#30,ss_coupon_amt#31,ss_net_paid#32,ss_net_paid_inc_tax#33,ss_net_profit#34] parquet
                        :     :     +- Project [d_date_sk#35, d_year#41, d_moy#43, d_qoy#45]
                        :     :        +- Filter (((isnotnull(d_month_seq#38) AND (d_month_seq#38 >= 1200)) AND (d_month_seq#38 <= 1211)) AND isnotnull(d_date_sk#35))
                        :     :           +- Relation[d_date_sk#35,d_date_id#36,d_date#37,d_month_seq#38,d_week_seq#39,d_quarter_seq#40,d_year#41,d_dow#42,d_moy#43,d_dom#44,d_qoy#45,d_fy_year#46,d_fy_quarter_seq#47,d_fy_week_seq#48,d_day_name#49,d_quarter_name#50,d_holiday#51,d_weekend#52,d_following_holiday#53,d_first_dom#54,d_last_dom#55,d_same_day_ly#56,d_same_day_lq#57,d_current_day#58,d_current_week#59,d_current_month#60,d_current_quarter#61,d_current_year#62] parquet
                        :     +- Project [s_store_sk#63, s_store_id#64]
                        :        +- Filter isnotnull(s_store_sk#63)
                        :           +- Relation[s_store_sk#63,s_store_id#64,s_rec_start_date#65,s_rec_end_date#66,s_closed_date_sk#67,s_store_name#68,s_number_employees#69,s_floor_space#70,s_hours#71,s_manager#72,s_market_id#73,s_geography_class#74,s_market_desc#75,s_market_manager#76,s_division_id#77,s_division_name#78,s_company_id#79,s_company_name#80,s_street_number#81,s_street_name#82,s_street_type#83,s_suite_number#84,s_city#85,s_county#86,s_state#87,s_zip#88,s_country#89,s_gmt_offset#90,s_tax_percentage#91] parquet
                        +- Project [i_item_sk#92, i_brand#100, i_class#102, i_category#104, i_product_name#113]
                           +- Filter isnotnull(i_item_sk#92)
                              +- Relation[i_item_sk#92,i_item_id#93,i_rec_start_date#94,i_rec_end_date#95,i_item_desc#96,i_current_price#97,i_wholesale_cost#98,i_brand_id#99,i_brand#100,i_class_id#101,i_class#102,i_category_id#103,i_category#104,i_manufact_id#105,i_manufact#106,i_size#107,i_formulation#108,i_color#109,i_units#110,i_container#111,i_manager_id#112,i_product_name#113] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[i_category#3 ASC NULLS FIRST,i_class#4 ASC NULLS FIRST,i_brand#5 ASC NULLS FIRST,i_product_name#6 ASC NULLS FIRST,d_year#7 ASC NULLS FIRST,d_qoy#8 ASC NULLS FIRST,d_moy#9 ASC NULLS FIRST,s_store_id#10 ASC NULLS FIRST,sumsales#2 ASC NULLS FIRST,rk#1 ASC NULLS FIRST], output=[i_category#3,i_class#4,i_brand#5,i_product_name#6,d_year#7,d_qoy#8,d_moy#9,s_store_id#10,sumsales#2,rk#1])
+- *(7) Filter (isnotnull(rk#1) AND (rk#1 <= 100))
   +- Window [rank(sumsales#2) windowspecdefinition(i_category#3, sumsales#2 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#1], [i_category#3], [sumsales#2 DESC NULLS LAST]
      +- *(6) Sort [i_category#3 ASC NULLS FIRST, sumsales#2 DESC NULLS LAST], false, 0
         +- Exchange hashpartitioning(i_category#3, 5), true, [id=#122]
            +- *(5) HashAggregate(keys=[i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11], functions=[sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#12 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#13 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true), 0.00))], output=[i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, sumsales#2])
               +- Exchange hashpartitioning(i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11, 5), true, [id=#123]
                  +- *(4) HashAggregate(keys=[i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11], functions=[partial_sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#12 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#13 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true), 0.00))], output=[i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11, sum#124, isEmpty#125])
                     +- *(4) Expand [List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, d_moy#43, s_store_id#64, 0), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, d_moy#43, null, 1), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, null, null, 3), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, null, null, null, 7), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, null, null, null, null, 15), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, null, null, null, null, null, 31), List(ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, null, null, null, null, null, null, 63), List(ss_quantity#13, ss_sales_price#12, i_category#104, null, null, null, null, null, null, null, 127), List(ss_quantity#13, ss_sales_price#12, null, null, null, null, null, null, null, null, 255)], [ss_quantity#13, ss_sales_price#12, i_category#3, i_class#4, i_brand#5, i_product_name#6, d_year#7, d_qoy#8, d_moy#9, s_store_id#10, spark_grouping_id#11]
                        +- *(4) Project [ss_quantity#13, ss_sales_price#12, i_category#104, i_class#102, i_brand#100, i_product_name#113, d_year#41, d_qoy#45, d_moy#43, s_store_id#64]
                           +- *(4) BroadcastHashJoin [ss_item_sk#16], [i_item_sk#92], Inner, BuildRight
                              :- *(4) Project [ss_item_sk#16, ss_quantity#13, ss_sales_price#12, d_year#41, d_moy#43, d_qoy#45, s_store_id#64]
                              :  +- *(4) BroadcastHashJoin [ss_store_sk#21], [s_store_sk#63], Inner, BuildRight
                              :     :- *(4) Project [ss_item_sk#16, ss_store_sk#21, ss_quantity#13, ss_sales_price#12, d_year#41, d_moy#43, d_qoy#45]
                              :     :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#14], [d_date_sk#35], Inner, BuildRight
                              :     :     :- *(4) Project [ss_sold_date_sk#14, ss_item_sk#16, ss_store_sk#21, ss_quantity#13, ss_sales_price#12]
                              :     :     :  +- *(4) Filter ((isnotnull(ss_sold_date_sk#14) AND isnotnull(ss_store_sk#21)) AND isnotnull(ss_item_sk#16))
                              :     :     :     +- *(4) ColumnarToRow
                              :     :     :        +- FileScan parquet default.store_sales[ss_sold_date_sk#14,ss_item_sk#16,ss_store_sk#21,ss_quantity#13,ss_sales_price#12] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#14), isnotnull(ss_store_sk#21), isnotnull(ss_item_sk#16)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_store_sk:int,ss_quantity:int,ss_sales_price:decimal(...
                              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#126]
                              :     :        +- *(1) Project [d_date_sk#35, d_year#41, d_moy#43, d_qoy#45]
                              :     :           +- *(1) Filter (((isnotnull(d_month_seq#38) AND (d_month_seq#38 >= 1200)) AND (d_month_seq#38 <= 1211)) AND isnotnull(d_date_sk#35))
                              :     :              +- *(1) ColumnarToRow
                              :     :                 +- FileScan parquet default.date_dim[d_date_sk#35,d_month_seq#38,d_year#41,d_moy#43,d_qoy#45] Batched: true, DataFilters: [isnotnull(d_month_seq#38), (d_month_seq#38 >= 1200), (d_month_seq#38 <= 1211), isnotnull(d_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int,d_year:int,d_moy:int,d_qoy:int>
                              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#127]
                              :        +- *(2) Project [s_store_sk#63, s_store_id#64]
                              :           +- *(2) Filter isnotnull(s_store_sk#63)
                              :              +- *(2) ColumnarToRow
                              :                 +- FileScan parquet default.store[s_store_sk#63,s_store_id#64] Batched: true, DataFilters: [isnotnull(s_store_sk#63)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint))), [id=#128]
                                 +- *(3) Project [i_item_sk#92, i_brand#100, i_class#102, i_category#104, i_product_name#113]
                                    +- *(3) Filter isnotnull(i_item_sk#92)
                                       +- *(3) ColumnarToRow
                                          +- FileScan parquet default.item[i_item_sk#92,i_brand#100,i_class#102,i_category#104,i_product_name#113] Batched: true, DataFilters: [isnotnull(i_item_sk#92)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand:string,i_class:string,i_category:string,i_product_name:string>
