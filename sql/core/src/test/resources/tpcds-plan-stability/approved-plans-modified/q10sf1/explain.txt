== Parsed Logical Plan ==
CTE [v1, v2]
:  :- 'SubqueryAlias v1
:  :  +- 'Union false, false
:  :     :- 'Project ['ws_bill_customer_sk AS customer_sk#1]
:  :     :  +- 'Filter ((('ws_sold_date_sk = 'd_date_sk) AND ('d_year = 2002)) AND (('d_moy >= 4) AND ('d_moy <= (4 + 3))))
:  :     :     +- 'Join Inner
:  :     :        :- 'UnresolvedRelation [web_sales]
:  :     :        +- 'UnresolvedRelation [date_dim]
:  :     +- 'Project ['cs_ship_customer_sk AS customer_sk#2]
:  :        +- 'Filter ((('cs_sold_date_sk = 'd_date_sk) AND ('d_year = 2002)) AND (('d_moy >= 4) AND ('d_moy <= (4 + 3))))
:  :           +- 'Join Inner
:  :              :- 'UnresolvedRelation [catalog_sales]
:  :              +- 'UnresolvedRelation [date_dim]
:  +- 'SubqueryAlias v2
:     +- 'Project ['ss_customer_sk AS customer_sk#3]
:        +- 'Filter ((('ss_sold_date_sk = 'd_date_sk) AND ('d_year = 2002)) AND (('d_moy >= 4) AND ('d_moy <= (4 + 3))))
:           +- 'Join Inner
:              :- 'UnresolvedRelation [store_sales]
:              +- 'UnresolvedRelation [date_dim]
+- 'GlobalLimit 100
   +- 'LocalLimit 100
      +- 'Sort ['cd_gender ASC NULLS FIRST, 'cd_marital_status ASC NULLS FIRST, 'cd_education_status ASC NULLS FIRST, 'cd_purchase_estimate ASC NULLS FIRST, 'cd_credit_rating ASC NULLS FIRST, 'cd_dep_count ASC NULLS FIRST, 'cd_dep_employed_count ASC NULLS FIRST, 'cd_dep_college_count ASC NULLS FIRST], true
         +- 'Aggregate ['cd_gender, 'cd_marital_status, 'cd_education_status, 'cd_purchase_estimate, 'cd_credit_rating, 'cd_dep_count, 'cd_dep_employed_count, 'cd_dep_college_count], ['cd_gender, 'cd_marital_status, 'cd_education_status, 'count(1) AS cnt1#4, 'cd_purchase_estimate, 'count(1) AS cnt2#5, 'cd_credit_rating, 'count(1) AS cnt3#6, 'cd_dep_count, 'count(1) AS cnt4#7, 'cd_dep_employed_count, 'count(1) AS cnt5#8, 'cd_dep_college_count, 'count(1) AS cnt6#9]
            +- 'Filter 'ca_county IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County)
               +- 'Join LeftSemi, ('v2.customer_sk = 'c.c_customer_sk)
                  :- 'Join LeftSemi, ('v1.customer_sk = 'c.c_customer_sk)
                  :  :- 'Join Inner, ('cd_demo_sk = 'c.c_current_cdemo_sk)
                  :  :  :- 'Join Inner, ('c.c_current_addr_sk = 'ca.ca_address_sk)
                  :  :  :  :- 'SubqueryAlias c
                  :  :  :  :  +- 'UnresolvedRelation [customer]
                  :  :  :  +- 'SubqueryAlias ca
                  :  :  :     +- 'UnresolvedRelation [customer_address]
                  :  :  +- 'UnresolvedRelation [customer_demographics]
                  :  +- 'UnresolvedRelation [v1]
                  +- 'UnresolvedRelation [v2]

== Analyzed Logical Plan ==
cd_gender: string, cd_marital_status: string, cd_education_status: string, cnt1: bigint, cd_purchase_estimate: int, cnt2: bigint, cd_credit_rating: string, cnt3: bigint, cd_dep_count: int, cnt4: bigint, cd_dep_employed_count: int, cnt5: bigint, cd_dep_college_count: int, cnt6: bigint
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#10 ASC NULLS FIRST, cd_marital_status#11 ASC NULLS FIRST, cd_education_status#12 ASC NULLS FIRST, cd_purchase_estimate#13 ASC NULLS FIRST, cd_credit_rating#14 ASC NULLS FIRST, cd_dep_count#15 ASC NULLS FIRST, cd_dep_employed_count#16 ASC NULLS FIRST, cd_dep_college_count#17 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], [cd_gender#10, cd_marital_status#11, cd_education_status#12, count(1) AS cnt1#18, cd_purchase_estimate#13, count(1) AS cnt2#19, cd_credit_rating#14, count(1) AS cnt3#20, cd_dep_count#15, count(1) AS cnt4#21, cd_dep_employed_count#16, count(1) AS cnt5#22, cd_dep_college_count#17, count(1) AS cnt6#23]
         +- Filter ca_county#24 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County)
            +- Join LeftSemi, (customer_sk#3 = c_customer_sk#25)
               :- Join LeftSemi, (customer_sk#1 = c_customer_sk#25)
               :  :- Join Inner, (cd_demo_sk#26 = c_current_cdemo_sk#27)
               :  :  :- Join Inner, (c_current_addr_sk#28 = ca_address_sk#29)
               :  :  :  :- SubqueryAlias c
               :  :  :  :  +- SubqueryAlias spark_catalog.default.customer
               :  :  :  :     +- Relation[c_customer_sk#25,c_customer_id#30,c_current_cdemo_sk#27,c_current_hdemo_sk#31,c_current_addr_sk#28,c_first_shipto_date_sk#32,c_first_sales_date_sk#33,c_salutation#34,c_first_name#35,c_last_name#36,c_preferred_cust_flag#37,c_birth_day#38,c_birth_month#39,c_birth_year#40,c_birth_country#41,c_login#42,c_email_address#43,c_last_review_date#44] parquet
               :  :  :  +- SubqueryAlias ca
               :  :  :     +- SubqueryAlias spark_catalog.default.customer_address
               :  :  :        +- Relation[ca_address_sk#29,ca_address_id#45,ca_street_number#46,ca_street_name#47,ca_street_type#48,ca_suite_number#49,ca_city#50,ca_county#24,ca_state#51,ca_zip#52,ca_country#53,ca_gmt_offset#54,ca_location_type#55] parquet
               :  :  +- SubqueryAlias spark_catalog.default.customer_demographics
               :  :     +- Relation[cd_demo_sk#26,cd_gender#10,cd_marital_status#11,cd_education_status#12,cd_purchase_estimate#13,cd_credit_rating#14,cd_dep_count#15,cd_dep_employed_count#16,cd_dep_college_count#17] parquet
               :  +- SubqueryAlias v1
               :     +- Union false, false
               :        :- Project [ws_bill_customer_sk#56 AS customer_sk#1]
               :        :  +- Filter (((ws_sold_date_sk#57 = d_date_sk#58) AND (d_year#59 = 2002)) AND ((d_moy#60 >= 4) AND (d_moy#60 <= (4 + 3))))
               :        :     +- Join Inner
               :        :        :- SubqueryAlias spark_catalog.default.web_sales
               :        :        :  +- Relation[ws_sold_date_sk#57,ws_sold_time_sk#61,ws_ship_date_sk#62,ws_item_sk#63,ws_bill_customer_sk#56,ws_bill_cdemo_sk#64,ws_bill_hdemo_sk#65,ws_bill_addr_sk#66,ws_ship_customer_sk#67,ws_ship_cdemo_sk#68,ws_ship_hdemo_sk#69,ws_ship_addr_sk#70,ws_web_page_sk#71,ws_web_site_sk#72,ws_ship_mode_sk#73,ws_warehouse_sk#74,ws_promo_sk#75,ws_order_number#76,ws_quantity#77,ws_wholesale_cost#78,ws_list_price#79,ws_sales_price#80,ws_ext_discount_amt#81,ws_ext_sales_price#82,... 10 more fields] parquet
               :        :        +- SubqueryAlias spark_catalog.default.date_dim
               :        :           +- Relation[d_date_sk#58,d_date_id#83,d_date#84,d_month_seq#85,d_week_seq#86,d_quarter_seq#87,d_year#59,d_dow#88,d_moy#60,d_dom#89,d_qoy#90,d_fy_year#91,d_fy_quarter_seq#92,d_fy_week_seq#93,d_day_name#94,d_quarter_name#95,d_holiday#96,d_weekend#97,d_following_holiday#98,d_first_dom#99,d_last_dom#100,d_same_day_ly#101,d_same_day_lq#102,d_current_day#103,... 4 more fields] parquet
               :        +- Project [cs_ship_customer_sk#104 AS customer_sk#2]
               :           +- Filter (((cs_sold_date_sk#105 = d_date_sk#58) AND (d_year#59 = 2002)) AND ((d_moy#60 >= 4) AND (d_moy#60 <= (4 + 3))))
               :              +- Join Inner
               :                 :- SubqueryAlias spark_catalog.default.catalog_sales
               :                 :  +- Relation[cs_sold_date_sk#105,cs_sold_time_sk#106,cs_ship_date_sk#107,cs_bill_customer_sk#108,cs_bill_cdemo_sk#109,cs_bill_hdemo_sk#110,cs_bill_addr_sk#111,cs_ship_customer_sk#104,cs_ship_cdemo_sk#112,cs_ship_hdemo_sk#113,cs_ship_addr_sk#114,cs_call_center_sk#115,cs_catalog_page_sk#116,cs_ship_mode_sk#117,cs_warehouse_sk#118,cs_item_sk#119,cs_promo_sk#120,cs_order_number#121,cs_quantity#122,cs_wholesale_cost#123,cs_list_price#124,cs_sales_price#125,cs_ext_discount_amt#126,cs_ext_sales_price#127,... 10 more fields] parquet
               :                 +- SubqueryAlias spark_catalog.default.date_dim
               :                    +- Relation[d_date_sk#58,d_date_id#83,d_date#84,d_month_seq#85,d_week_seq#86,d_quarter_seq#87,d_year#59,d_dow#88,d_moy#60,d_dom#89,d_qoy#90,d_fy_year#91,d_fy_quarter_seq#92,d_fy_week_seq#93,d_day_name#94,d_quarter_name#95,d_holiday#96,d_weekend#97,d_following_holiday#98,d_first_dom#99,d_last_dom#100,d_same_day_ly#101,d_same_day_lq#102,d_current_day#103,... 4 more fields] parquet
               +- SubqueryAlias v2
                  +- Project [ss_customer_sk#128 AS customer_sk#3]
                     +- Filter (((ss_sold_date_sk#129 = d_date_sk#58) AND (d_year#59 = 2002)) AND ((d_moy#60 >= 4) AND (d_moy#60 <= (4 + 3))))
                        +- Join Inner
                           :- SubqueryAlias spark_catalog.default.store_sales
                           :  +- Relation[ss_sold_date_sk#129,ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#128,ss_cdemo_sk#132,ss_hdemo_sk#133,ss_addr_sk#134,ss_store_sk#135,ss_promo_sk#136,ss_ticket_number#137,ss_quantity#138,ss_wholesale_cost#139,ss_list_price#140,ss_sales_price#141,ss_ext_discount_amt#142,ss_ext_sales_price#143,ss_ext_wholesale_cost#144,ss_ext_list_price#145,ss_ext_tax#146,ss_coupon_amt#147,ss_net_paid#148,ss_net_paid_inc_tax#149,ss_net_profit#150] parquet
                           +- SubqueryAlias spark_catalog.default.date_dim
                              +- Relation[d_date_sk#58,d_date_id#83,d_date#84,d_month_seq#85,d_week_seq#86,d_quarter_seq#87,d_year#59,d_dow#88,d_moy#60,d_dom#89,d_qoy#90,d_fy_year#91,d_fy_quarter_seq#92,d_fy_week_seq#93,d_day_name#94,d_quarter_name#95,d_holiday#96,d_weekend#97,d_following_holiday#98,d_first_dom#99,d_last_dom#100,d_same_day_ly#101,d_same_day_lq#102,d_current_day#103,... 4 more fields] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#10 ASC NULLS FIRST, cd_marital_status#11 ASC NULLS FIRST, cd_education_status#12 ASC NULLS FIRST, cd_purchase_estimate#13 ASC NULLS FIRST, cd_credit_rating#14 ASC NULLS FIRST, cd_dep_count#15 ASC NULLS FIRST, cd_dep_employed_count#16 ASC NULLS FIRST, cd_dep_college_count#17 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], [cd_gender#10, cd_marital_status#11, cd_education_status#12, count(1) AS cnt1#18, cd_purchase_estimate#13, count(1) AS cnt2#19, cd_credit_rating#14, count(1) AS cnt3#20, cd_dep_count#15, count(1) AS cnt4#21, cd_dep_employed_count#16, count(1) AS cnt5#22, cd_dep_college_count#17, count(1) AS cnt6#23]
         +- Project [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17]
            +- Join Inner, (cd_demo_sk#26 = c_current_cdemo_sk#27)
               :- Project [c_current_cdemo_sk#27]
               :  +- Join Inner, (c_current_addr_sk#28 = ca_address_sk#29)
               :     :- Project [c_current_cdemo_sk#27, c_current_addr_sk#28]
               :     :  +- Join LeftSemi, (customer_sk#3 = c_customer_sk#25)
               :     :     :- Join LeftSemi, (customer_sk#1 = c_customer_sk#25)
               :     :     :  :- Project [c_customer_sk#25, c_current_cdemo_sk#27, c_current_addr_sk#28]
               :     :     :  :  +- Filter ((isnotnull(c_customer_sk#25) AND isnotnull(c_current_addr_sk#28)) AND isnotnull(c_current_cdemo_sk#27))
               :     :     :  :     +- Relation[c_customer_sk#25,c_customer_id#30,c_current_cdemo_sk#27,c_current_hdemo_sk#31,c_current_addr_sk#28,c_first_shipto_date_sk#32,c_first_sales_date_sk#33,c_salutation#34,c_first_name#35,c_last_name#36,c_preferred_cust_flag#37,c_birth_day#38,c_birth_month#39,c_birth_year#40,c_birth_country#41,c_login#42,c_email_address#43,c_last_review_date#44] parquet
               :     :     :  +- Union false, false
               :     :     :     :- Project [ws_bill_customer_sk#56 AS customer_sk#1]
               :     :     :     :  +- Join Inner, (ws_sold_date_sk#57 = d_date_sk#58)
               :     :     :     :     :- Project [ws_sold_date_sk#57, ws_bill_customer_sk#56]
               :     :     :     :     :  +- Filter (isnotnull(ws_sold_date_sk#57) AND isnotnull(ws_bill_customer_sk#56))
               :     :     :     :     :     +- Relation[ws_sold_date_sk#57,ws_sold_time_sk#61,ws_ship_date_sk#62,ws_item_sk#63,ws_bill_customer_sk#56,ws_bill_cdemo_sk#64,ws_bill_hdemo_sk#65,ws_bill_addr_sk#66,ws_ship_customer_sk#67,ws_ship_cdemo_sk#68,ws_ship_hdemo_sk#69,ws_ship_addr_sk#70,ws_web_page_sk#71,ws_web_site_sk#72,ws_ship_mode_sk#73,ws_warehouse_sk#74,ws_promo_sk#75,ws_order_number#76,ws_quantity#77,ws_wholesale_cost#78,ws_list_price#79,ws_sales_price#80,ws_ext_discount_amt#81,ws_ext_sales_price#82,... 10 more fields] parquet
               :     :     :     :     +- Project [d_date_sk#58]
               :     :     :     :        +- Filter (((((isnotnull(d_year#59) AND isnotnull(d_moy#60)) AND (d_year#59 = 2002)) AND (d_moy#60 >= 4)) AND (d_moy#60 <= 7)) AND isnotnull(d_date_sk#58))
               :     :     :     :           +- Relation[d_date_sk#58,d_date_id#83,d_date#84,d_month_seq#85,d_week_seq#86,d_quarter_seq#87,d_year#59,d_dow#88,d_moy#60,d_dom#89,d_qoy#90,d_fy_year#91,d_fy_quarter_seq#92,d_fy_week_seq#93,d_day_name#94,d_quarter_name#95,d_holiday#96,d_weekend#97,d_following_holiday#98,d_first_dom#99,d_last_dom#100,d_same_day_ly#101,d_same_day_lq#102,d_current_day#103,... 4 more fields] parquet
               :     :     :     +- Project [cs_ship_customer_sk#104 AS customer_sk#2]
               :     :     :        +- Join Inner, (cs_sold_date_sk#105 = d_date_sk#58)
               :     :     :           :- Project [cs_sold_date_sk#105, cs_ship_customer_sk#104]
               :     :     :           :  +- Filter (isnotnull(cs_sold_date_sk#105) AND isnotnull(cs_ship_customer_sk#104))
               :     :     :           :     +- Relation[cs_sold_date_sk#105,cs_sold_time_sk#106,cs_ship_date_sk#107,cs_bill_customer_sk#108,cs_bill_cdemo_sk#109,cs_bill_hdemo_sk#110,cs_bill_addr_sk#111,cs_ship_customer_sk#104,cs_ship_cdemo_sk#112,cs_ship_hdemo_sk#113,cs_ship_addr_sk#114,cs_call_center_sk#115,cs_catalog_page_sk#116,cs_ship_mode_sk#117,cs_warehouse_sk#118,cs_item_sk#119,cs_promo_sk#120,cs_order_number#121,cs_quantity#122,cs_wholesale_cost#123,cs_list_price#124,cs_sales_price#125,cs_ext_discount_amt#126,cs_ext_sales_price#127,... 10 more fields] parquet
               :     :     :           +- Project [d_date_sk#58]
               :     :     :              +- Filter (((((isnotnull(d_year#59) AND isnotnull(d_moy#60)) AND (d_year#59 = 2002)) AND (d_moy#60 >= 4)) AND (d_moy#60 <= 7)) AND isnotnull(d_date_sk#58))
               :     :     :                 +- Relation[d_date_sk#58,d_date_id#83,d_date#84,d_month_seq#85,d_week_seq#86,d_quarter_seq#87,d_year#59,d_dow#88,d_moy#60,d_dom#89,d_qoy#90,d_fy_year#91,d_fy_quarter_seq#92,d_fy_week_seq#93,d_day_name#94,d_quarter_name#95,d_holiday#96,d_weekend#97,d_following_holiday#98,d_first_dom#99,d_last_dom#100,d_same_day_ly#101,d_same_day_lq#102,d_current_day#103,... 4 more fields] parquet
               :     :     +- Project [ss_customer_sk#128 AS customer_sk#3]
               :     :        +- Join Inner, (ss_sold_date_sk#129 = d_date_sk#58)
               :     :           :- Project [ss_sold_date_sk#129, ss_customer_sk#128]
               :     :           :  +- Filter (isnotnull(ss_sold_date_sk#129) AND isnotnull(ss_customer_sk#128))
               :     :           :     +- Relation[ss_sold_date_sk#129,ss_sold_time_sk#130,ss_item_sk#131,ss_customer_sk#128,ss_cdemo_sk#132,ss_hdemo_sk#133,ss_addr_sk#134,ss_store_sk#135,ss_promo_sk#136,ss_ticket_number#137,ss_quantity#138,ss_wholesale_cost#139,ss_list_price#140,ss_sales_price#141,ss_ext_discount_amt#142,ss_ext_sales_price#143,ss_ext_wholesale_cost#144,ss_ext_list_price#145,ss_ext_tax#146,ss_coupon_amt#147,ss_net_paid#148,ss_net_paid_inc_tax#149,ss_net_profit#150] parquet
               :     :           +- Project [d_date_sk#58]
               :     :              +- Filter (((((isnotnull(d_year#59) AND isnotnull(d_moy#60)) AND (d_year#59 = 2002)) AND (d_moy#60 >= 4)) AND (d_moy#60 <= 7)) AND isnotnull(d_date_sk#58))
               :     :                 +- Relation[d_date_sk#58,d_date_id#83,d_date#84,d_month_seq#85,d_week_seq#86,d_quarter_seq#87,d_year#59,d_dow#88,d_moy#60,d_dom#89,d_qoy#90,d_fy_year#91,d_fy_quarter_seq#92,d_fy_week_seq#93,d_day_name#94,d_quarter_name#95,d_holiday#96,d_weekend#97,d_following_holiday#98,d_first_dom#99,d_last_dom#100,d_same_day_ly#101,d_same_day_lq#102,d_current_day#103,... 4 more fields] parquet
               :     +- Project [ca_address_sk#29]
               :        +- Filter (ca_county#24 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County) AND isnotnull(ca_address_sk#29))
               :           +- Relation[ca_address_sk#29,ca_address_id#45,ca_street_number#46,ca_street_name#47,ca_street_type#48,ca_suite_number#49,ca_city#50,ca_county#24,ca_state#51,ca_zip#52,ca_country#53,ca_gmt_offset#54,ca_location_type#55] parquet
               +- Filter isnotnull(cd_demo_sk#26)
                  +- Relation[cd_demo_sk#26,cd_gender#10,cd_marital_status#11,cd_education_status#12,cd_purchase_estimate#13,cd_credit_rating#14,cd_dep_count#15,cd_dep_employed_count#16,cd_dep_college_count#17] parquet

== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[cd_gender#10 ASC NULLS FIRST,cd_marital_status#11 ASC NULLS FIRST,cd_education_status#12 ASC NULLS FIRST,cd_purchase_estimate#13 ASC NULLS FIRST,cd_credit_rating#14 ASC NULLS FIRST,cd_dep_count#15 ASC NULLS FIRST,cd_dep_employed_count#16 ASC NULLS FIRST,cd_dep_college_count#17 ASC NULLS FIRST], output=[cd_gender#10,cd_marital_status#11,cd_education_status#12,cnt1#18,cd_purchase_estimate#13,cnt2#19,cd_credit_rating#14,cnt3#20,cd_dep_count#15,cnt4#21,cd_dep_employed_count#16,cnt5#22,cd_dep_college_count#17,cnt6#23])
+- *(10) HashAggregate(keys=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], functions=[count(1)], output=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cnt1#18, cd_purchase_estimate#13, cnt2#19, cd_credit_rating#14, cnt3#20, cd_dep_count#15, cnt4#21, cd_dep_employed_count#16, cnt5#22, cd_dep_college_count#17, cnt6#23])
   +- Exchange hashpartitioning(cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17, 5), true, [id=#151]
      +- *(9) HashAggregate(keys=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17], functions=[partial_count(1)], output=[cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17, count#152])
         +- *(9) Project [cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17]
            +- *(9) BroadcastHashJoin [c_current_cdemo_sk#27], [cd_demo_sk#26], Inner, BuildRight, false
               :- *(9) Project [c_current_cdemo_sk#27]
               :  +- *(9) BroadcastHashJoin [c_current_addr_sk#28], [ca_address_sk#29], Inner, BuildRight, false
               :     :- *(9) Project [c_current_cdemo_sk#27, c_current_addr_sk#28]
               :     :  +- *(9) BroadcastHashJoin [c_customer_sk#25], [customer_sk#3], LeftSemi, BuildRight, false
               :     :     :- *(9) BroadcastHashJoin [c_customer_sk#25], [customer_sk#1], LeftSemi, BuildRight, false
               :     :     :  :- *(9) Project [c_customer_sk#25, c_current_cdemo_sk#27, c_current_addr_sk#28]
               :     :     :  :  +- *(9) Filter ((isnotnull(c_customer_sk#25) AND isnotnull(c_current_addr_sk#28)) AND isnotnull(c_current_cdemo_sk#27))
               :     :     :  :     +- *(9) ColumnarToRow
               :     :     :  :        +- FileScan parquet default.customer[c_customer_sk#25,c_current_cdemo_sk#27,c_current_addr_sk#28] Batched: true, DataFilters: [isnotnull(c_customer_sk#25), isnotnull(c_current_addr_sk#28), isnotnull(c_current_cdemo_sk..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk), IsNotNull(c_current_cdemo_sk)], ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int>
               :     :     :  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#153]
               :     :     :     +- Union
               :     :     :        :- *(2) Project [ws_bill_customer_sk#56 AS customer_sk#1]
               :     :     :        :  +- *(2) BroadcastHashJoin [ws_sold_date_sk#57], [d_date_sk#58], Inner, BuildRight, false
               :     :     :        :     :- *(2) Project [ws_sold_date_sk#57, ws_bill_customer_sk#56]
               :     :     :        :     :  +- *(2) Filter (isnotnull(ws_sold_date_sk#57) AND isnotnull(ws_bill_customer_sk#56))
               :     :     :        :     :     +- *(2) ColumnarToRow
               :     :     :        :     :        +- FileScan parquet default.web_sales[ws_sold_date_sk#57,ws_bill_customer_sk#56] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#57), isnotnull(ws_bill_customer_sk#56)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_bill_customer_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_bill_customer_sk:int>
               :     :     :        :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#154]
               :     :     :        :        +- *(1) Project [d_date_sk#58]
               :     :     :        :           +- *(1) Filter (((((isnotnull(d_year#59) AND isnotnull(d_moy#60)) AND (d_year#59 = 2002)) AND (d_moy#60 >= 4)) AND (d_moy#60 <= 7)) AND isnotnull(d_date_sk#58))
               :     :     :        :              +- *(1) ColumnarToRow
               :     :     :        :                 +- FileScan parquet default.date_dim[d_date_sk#58,d_year#59,d_moy#60] Batched: true, DataFilters: [isnotnull(d_year#59), isnotnull(d_moy#60), (d_year#59 = 2002), (d_moy#60 >= 4), (d_m..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2002), GreaterThanOrEqual(d_moy,4), LessThan..., ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :     :     :        +- *(4) Project [cs_ship_customer_sk#104 AS customer_sk#2]
               :     :     :           +- *(4) BroadcastHashJoin [cs_sold_date_sk#105], [d_date_sk#58], Inner, BuildRight, false
               :     :     :              :- *(4) Project [cs_sold_date_sk#105, cs_ship_customer_sk#104]
               :     :     :              :  +- *(4) Filter (isnotnull(cs_sold_date_sk#105) AND isnotnull(cs_ship_customer_sk#104))
               :     :     :              :     +- *(4) ColumnarToRow
               :     :     :              :        +- FileScan parquet default.catalog_sales[cs_sold_date_sk#105,cs_ship_customer_sk#104] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#105), isnotnull(cs_ship_customer_sk#104)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_ship_customer_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_ship_customer_sk:int>
               :     :     :              +- ReusedExchange [d_date_sk#58], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#154]
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#155]
               :     :        +- *(6) Project [ss_customer_sk#128 AS customer_sk#3]
               :     :           +- *(6) BroadcastHashJoin [ss_sold_date_sk#129], [d_date_sk#58], Inner, BuildRight, false
               :     :              :- *(6) Project [ss_sold_date_sk#129, ss_customer_sk#128]
               :     :              :  +- *(6) Filter (isnotnull(ss_sold_date_sk#129) AND isnotnull(ss_customer_sk#128))
               :     :              :     +- *(6) ColumnarToRow
               :     :              :        +- FileScan parquet default.store_sales[ss_sold_date_sk#129,ss_customer_sk#128] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#129), isnotnull(ss_customer_sk#128)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_customer_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int>
               :     :              +- ReusedExchange [d_date_sk#58], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#154]
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#156]
               :        +- *(7) Project [ca_address_sk#29]
               :           +- *(7) Filter (ca_county#24 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County) AND isnotnull(ca_address_sk#29))
               :              +- *(7) ColumnarToRow
               :                 +- FileScan parquet default.customer_address[ca_address_sk#29,ca_county#24] Batched: true, DataFilters: [ca_county#24 IN (Walker County,Richland County,Gaines County,Douglas County,Dona Ana County),..., Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [In(ca_county, [Walker County,Richland County,Gaines County,Douglas County,Dona Ana County]), IsN..., ReadSchema: struct<ca_address_sk:int,ca_county:string>
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#157]
                  +- *(8) Project [cd_demo_sk#26, cd_gender#10, cd_marital_status#11, cd_education_status#12, cd_purchase_estimate#13, cd_credit_rating#14, cd_dep_count#15, cd_dep_employed_count#16, cd_dep_college_count#17]
                     +- *(8) Filter isnotnull(cd_demo_sk#26)
                        +- *(8) ColumnarToRow
                           +- FileScan parquet default.customer_demographics[cd_demo_sk#26,cd_gender#10,cd_marital_status#11,cd_education_status#12,cd_purchase_estimate#13,cd_credit_rating#14,cd_dep_count#15,cd_dep_employed_count#16,cd_dep_college_count#17] Batched: true, DataFilters: [isnotnull(cd_demo_sk#26)], Format: Parquet, Location: InMemoryFileIndex[file:/Users/yi.wu/IdeaProjects/spark/sql/core/spark-warehouse/org.apache.spark...., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_marital_status:string,cd_education_status:string,cd_pur...
